/home/fs01/cl2696/workspace/ptyrad_paper
c0002
Sun Jun  8 19:20:05 EDT 2025
params_path = 01_params/py4dstem_table_tBL_WSe2.yml
/home/fs01/cl2696/workspace/ptyrad_paper
Load py4DSTEM-dev v0.0.4 (2024.12.12 CHL) from editable local repo
cupyx.jit.rawkernel is experimental. The interface can change in the future.
### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 954.71 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 1024, 1, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 496/16384 [00:00<00:03, 4957.09probe position/s]Normalizing amplitudes:   6%|▋         | 1037/16384 [00:00<00:02, 5217.60probe position/s]Normalizing amplitudes:  10%|▉         | 1559/16384 [00:00<00:02, 5183.74probe position/s]Normalizing amplitudes:  13%|█▎        | 2078/16384 [00:00<00:02, 5178.25probe position/s]Normalizing amplitudes:  17%|█▋        | 2716/16384 [00:00<00:02, 5607.92probe position/s]Normalizing amplitudes:  21%|██▏       | 3498/16384 [00:00<00:02, 6357.01probe position/s]Normalizing amplitudes:  25%|██▌       | 4134/16384 [00:00<00:02, 5910.67probe position/s]Normalizing amplitudes:  29%|██▉       | 4731/16384 [00:00<00:02, 5616.71probe position/s]Normalizing amplitudes:  32%|███▏      | 5299/16384 [00:00<00:02, 5366.16probe position/s]Normalizing amplitudes:  36%|███▌      | 5841/16384 [00:01<00:02, 5233.70probe position/s]Normalizing amplitudes:  39%|███▉      | 6380/16384 [00:01<00:01, 5277.17probe position/s]Normalizing amplitudes:  44%|████▎     | 7163/16384 [00:01<00:01, 6010.57probe position/s]Normalizing amplitudes:  47%|████▋     | 7777/16384 [00:01<00:01, 6045.44probe position/s]Normalizing amplitudes:  51%|█████     | 8386/16384 [00:01<00:01, 5794.06probe position/s]Normalizing amplitudes:  55%|█████▍    | 8971/16384 [00:01<00:01, 5494.51probe position/s]Normalizing amplitudes:  58%|█████▊    | 9526/16384 [00:01<00:01, 5296.28probe position/s]Normalizing amplitudes:  61%|██████▏   | 10060/16384 [00:01<00:01, 5219.69probe position/s]Normalizing amplitudes:  66%|██████▌   | 10839/16384 [00:01<00:00, 5939.12probe position/s]Normalizing amplitudes:  70%|███████   | 11501/16384 [00:02<00:00, 6132.43probe position/s]Normalizing amplitudes:  74%|███████▍  | 12121/16384 [00:02<00:00, 5820.44probe position/s]Normalizing amplitudes:  78%|███████▊  | 12710/16384 [00:02<00:00, 5624.16probe position/s]Normalizing amplitudes:  81%|████████  | 13278/16384 [00:02<00:00, 5515.60probe position/s]Normalizing amplitudes:  84%|████████▍ | 13834/16384 [00:02<00:00, 5464.48probe position/s]Normalizing amplitudes:  89%|████████▉ | 14616/16384 [00:02<00:00, 6131.66probe position/s]Normalizing amplitudes:  93%|█████████▎| 15260/16384 [00:02<00:00, 6220.00probe position/s]Normalizing amplitudes:  97%|█████████▋| 15887/16384 [00:02<00:00, 5889.00probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5653.33probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random1024_p1_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random1024_p1_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.02221 in 2.397 sec
Iter: 2, Total Loss: 0.006516 in 0.841 sec
Iter: 3, Total Loss: 0.006489 in 0.822 sec
Iter: 4, Total Loss: 0.006476 in 0.820 sec
Iter: 5, Total Loss: 0.006469 in 0.817 sec
Iter: 6, Total Loss: 0.006464 in 0.848 sec
Iter: 7, Total Loss: 0.006461 in 0.803 sec
Iter: 8, Total Loss: 0.006459 in 0.817 sec
Iter: 9, Total Loss: 0.006457 in 0.845 sec
Iter: 10, Total Loss: 0.006455 in 0.783 sec
Iter: 11, Total Loss: 0.006453 in 0.846 sec
Iter: 12, Total Loss: 0.006451 in 0.833 sec
Iter: 13, Total Loss: 0.006449 in 0.819 sec
Iter: 14, Total Loss: 0.006448 in 0.850 sec
Iter: 15, Total Loss: 0.006446 in 0.832 sec
Iter: 16, Total Loss: 0.006444 in 0.828 sec
Iter: 17, Total Loss: 0.006443 in 0.814 sec
Iter: 18, Total Loss: 0.006441 in 0.842 sec
Iter: 19, Total Loss: 0.006439 in 0.830 sec
Iter: 20, Total Loss: 0.006437 in 0.793 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 0.904 with std = 0.343 sec ###
### py4DSTEM ptycho solver is finished in 18.238 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 948.95 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 1024, 1, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 549/16384 [00:00<00:02, 5488.63probe position/s]Normalizing amplitudes:   7%|▋         | 1108/16384 [00:00<00:02, 5544.28probe position/s]Normalizing amplitudes:  10%|█         | 1663/16384 [00:00<00:02, 5445.94probe position/s]Normalizing amplitudes:  14%|█▎        | 2213/16384 [00:00<00:02, 5464.55probe position/s]Normalizing amplitudes:  18%|█▊        | 3012/16384 [00:00<00:02, 6365.59probe position/s]Normalizing amplitudes:  22%|██▏       | 3679/16384 [00:00<00:01, 6466.18probe position/s]Normalizing amplitudes:  26%|██▋       | 4327/16384 [00:00<00:01, 6122.00probe position/s]Normalizing amplitudes:  30%|███       | 4943/16384 [00:00<00:01, 5917.68probe position/s]Normalizing amplitudes:  34%|███▍      | 5539/16384 [00:00<00:01, 5756.32probe position/s]Normalizing amplitudes:  38%|███▊      | 6197/16384 [00:01<00:01, 5996.10probe position/s]Normalizing amplitudes:  43%|████▎     | 6998/16384 [00:01<00:01, 6586.46probe position/s]Normalizing amplitudes:  47%|████▋     | 7662/16384 [00:01<00:01, 6245.13probe position/s]Normalizing amplitudes:  51%|█████     | 8293/16384 [00:01<00:01, 6040.44probe position/s]Normalizing amplitudes:  54%|█████▍    | 8902/16384 [00:01<00:01, 5884.31probe position/s]Normalizing amplitudes:  58%|█████▊    | 9494/16384 [00:01<00:01, 5782.18probe position/s]Normalizing amplitudes:  62%|██████▏   | 10214/16384 [00:01<00:00, 6182.29probe position/s]Normalizing amplitudes:  67%|██████▋   | 10996/16384 [00:01<00:00, 6645.48probe position/s]Normalizing amplitudes:  71%|███████   | 11666/16384 [00:01<00:00, 6191.01probe position/s]Normalizing amplitudes:  75%|███████▌  | 12294/16384 [00:02<00:00, 6038.97probe position/s]Normalizing amplitudes:  79%|███████▉  | 12904/16384 [00:02<00:00, 5826.51probe position/s]Normalizing amplitudes:  82%|████████▏ | 13492/16384 [00:02<00:00, 5731.59probe position/s]Normalizing amplitudes:  87%|████████▋ | 14294/16384 [00:02<00:00, 6370.76probe position/s]Normalizing amplitudes:  91%|█████████ | 14949/16384 [00:02<00:00, 6421.26probe position/s]Normalizing amplitudes:  95%|█████████▌| 15597/16384 [00:02<00:00, 6076.68probe position/s]Normalizing amplitudes:  99%|█████████▉| 16212/16384 [00:02<00:00, 5910.54probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6037.51probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random1024_p1_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random1024_p1_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.02289 in 1.548 sec
Iter: 2, Total Loss: 0.006519 in 1.485 sec
Iter: 3, Total Loss: 0.006483 in 1.527 sec
Iter: 4, Total Loss: 0.006471 in 1.533 sec
Iter: 5, Total Loss: 0.006465 in 1.507 sec
Iter: 6, Total Loss: 0.00646 in 1.498 sec
Iter: 7, Total Loss: 0.006456 in 1.497 sec
Iter: 8, Total Loss: 0.006452 in 1.496 sec
Iter: 9, Total Loss: 0.006446 in 1.491 sec
Iter: 10, Total Loss: 0.006444 in 1.475 sec
Iter: 11, Total Loss: 0.00644 in 1.517 sec
Iter: 12, Total Loss: 0.006435 in 1.513 sec
Iter: 13, Total Loss: 0.006433 in 1.490 sec
Iter: 14, Total Loss: 0.006429 in 1.526 sec
Iter: 15, Total Loss: 0.006426 in 1.520 sec
Iter: 16, Total Loss: 0.006423 in 1.509 sec
Iter: 17, Total Loss: 0.00642 in 1.502 sec
Iter: 18, Total Loss: 0.006417 in 1.526 sec
Iter: 19, Total Loss: 0.006415 in 1.502 sec
Iter: 20, Total Loss: 0.00641 in 1.519 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 1.509 with std = 0.018 sec ###
### py4DSTEM ptycho solver is finished in 30.414 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 948.89 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 1024, 1, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 563/16384 [00:00<00:02, 5626.61probe position/s]Normalizing amplitudes:   7%|▋         | 1126/16384 [00:00<00:02, 5561.44probe position/s]Normalizing amplitudes:  10%|█         | 1683/16384 [00:00<00:02, 5556.00probe position/s]Normalizing amplitudes:  14%|█▎        | 2248/16384 [00:00<00:02, 5590.48probe position/s]Normalizing amplitudes:  18%|█▊        | 3006/16384 [00:00<00:02, 6304.04probe position/s]Normalizing amplitudes:  23%|██▎       | 3706/16384 [00:00<00:01, 6537.42probe position/s]Normalizing amplitudes:  27%|██▋       | 4360/16384 [00:00<00:01, 6191.82probe position/s]Normalizing amplitudes:  30%|███       | 4983/16384 [00:00<00:01, 5912.34probe position/s]Normalizing amplitudes:  34%|███▍      | 5579/16384 [00:00<00:01, 5819.93probe position/s]Normalizing amplitudes:  38%|███▊      | 6164/16384 [00:01<00:01, 5658.79probe position/s]Normalizing amplitudes:  42%|████▏     | 6836/16384 [00:01<00:01, 5963.07probe position/s]Normalizing amplitudes:  47%|████▋     | 7622/16384 [00:01<00:01, 6515.65probe position/s]Normalizing amplitudes:  51%|█████     | 8279/16384 [00:01<00:01, 6287.14probe position/s]Normalizing amplitudes:  54%|█████▍    | 8913/16384 [00:01<00:01, 6063.80probe position/s]Normalizing amplitudes:  58%|█████▊    | 9524/16384 [00:01<00:01, 5924.29probe position/s]Normalizing amplitudes:  62%|██████▏   | 10120/16384 [00:01<00:01, 5881.79probe position/s]Normalizing amplitudes:  65%|██████▌   | 10710/16384 [00:01<00:00, 5849.03probe position/s]Normalizing amplitudes:  70%|██████▉   | 11451/16384 [00:01<00:00, 6299.82probe position/s]Normalizing amplitudes:  74%|███████▍  | 12149/16384 [00:01<00:00, 6496.50probe position/s]Normalizing amplitudes:  78%|███████▊  | 12802/16384 [00:02<00:00, 6220.77probe position/s]Normalizing amplitudes:  82%|████████▏ | 13428/16384 [00:02<00:00, 5981.57probe position/s]Normalizing amplitudes:  86%|████████▌ | 14030/16384 [00:02<00:00, 5833.54probe position/s]Normalizing amplitudes:  89%|████████▉ | 14617/16384 [00:02<00:00, 5718.53probe position/s]Normalizing amplitudes:  94%|█████████▎| 15335/16384 [00:02<00:00, 6130.69probe position/s]Normalizing amplitudes:  98%|█████████▊| 16093/16384 [00:02<00:00, 6546.90probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6072.47probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random1024_p1_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random1024_p1_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.02383 in 2.534 sec
Iter: 2, Total Loss: 0.006563 in 2.470 sec
Iter: 3, Total Loss: 0.006503 in 2.461 sec
Iter: 4, Total Loss: 0.00649 in 2.487 sec
Iter: 5, Total Loss: 0.006478 in 2.476 sec
Iter: 6, Total Loss: 0.006472 in 2.491 sec
Iter: 7, Total Loss: 0.006466 in 2.480 sec
Iter: 8, Total Loss: 0.006456 in 2.485 sec
Iter: 9, Total Loss: 0.00645 in 2.461 sec
Iter: 10, Total Loss: 0.006445 in 2.456 sec
Iter: 11, Total Loss: 0.006442 in 2.463 sec
Iter: 12, Total Loss: 0.006435 in 2.461 sec
Iter: 13, Total Loss: 0.006432 in 2.461 sec
Iter: 14, Total Loss: 0.006428 in 2.505 sec
Iter: 15, Total Loss: 0.006424 in 2.499 sec
Iter: 16, Total Loss: 0.006416 in 2.458 sec
Iter: 17, Total Loss: 0.006413 in 2.478 sec
Iter: 18, Total Loss: 0.00641 in 2.501 sec
Iter: 19, Total Loss: 0.006407 in 2.472 sec
Iter: 20, Total Loss: 0.006402 in 2.466 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 2.478 with std = 0.019 sec ###
### py4DSTEM ptycho solver is finished in 54.112 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 945.66 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 1024, 3, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 533/16384 [00:00<00:02, 5320.06probe position/s]Normalizing amplitudes:   7%|▋         | 1085/16384 [00:00<00:02, 5435.08probe position/s]Normalizing amplitudes:  11%|█▏        | 1855/16384 [00:00<00:02, 6467.74probe position/s]Normalizing amplitudes:  16%|█▌        | 2558/16384 [00:00<00:02, 6686.79probe position/s]Normalizing amplitudes:  20%|█▉        | 3227/16384 [00:00<00:02, 6356.87probe position/s]Normalizing amplitudes:  24%|██▎       | 3866/16384 [00:00<00:02, 6068.45probe position/s]Normalizing amplitudes:  27%|██▋       | 4477/16384 [00:00<00:02, 5857.97probe position/s]Normalizing amplitudes:  31%|███       | 5066/16384 [00:00<00:01, 5731.88probe position/s]Normalizing amplitudes:  34%|███▍      | 5641/16384 [00:00<00:01, 5633.05probe position/s]Normalizing amplitudes:  39%|███▉      | 6414/16384 [00:01<00:01, 6245.01probe position/s]Normalizing amplitudes:  43%|████▎     | 7078/16384 [00:01<00:01, 6360.91probe position/s]Normalizing amplitudes:  47%|████▋     | 7718/16384 [00:01<00:01, 6117.72probe position/s]Normalizing amplitudes:  51%|█████     | 8334/16384 [00:01<00:01, 5960.22probe position/s]Normalizing amplitudes:  55%|█████▍    | 8933/16384 [00:01<00:01, 5782.42probe position/s]Normalizing amplitudes:  58%|█████▊    | 9514/16384 [00:01<00:01, 5667.73probe position/s]Normalizing amplitudes:  62%|██████▏   | 10083/16384 [00:01<00:01, 5592.81probe position/s]Normalizing amplitudes:  66%|██████▌   | 10747/16384 [00:01<00:00, 5891.23probe position/s]Normalizing amplitudes:  70%|███████   | 11520/16384 [00:01<00:00, 6422.68probe position/s]Normalizing amplitudes:  74%|███████▍  | 12166/16384 [00:02<00:00, 6133.91probe position/s]Normalizing amplitudes:  78%|███████▊  | 12785/16384 [00:02<00:00, 5948.87probe position/s]Normalizing amplitudes:  82%|████████▏ | 13384/16384 [00:02<00:00, 5743.20probe position/s]Normalizing amplitudes:  85%|████████▌ | 13962/16384 [00:02<00:00, 5645.06probe position/s]Normalizing amplitudes:  89%|████████▉ | 14544/16384 [00:02<00:00, 5692.70probe position/s]Normalizing amplitudes:  92%|█████████▏| 15121/16384 [00:02<00:00, 5712.93probe position/s]Normalizing amplitudes:  97%|█████████▋| 15915/16384 [00:02<00:00, 6358.47probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6004.37probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random1024_p3_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random1024_p3_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.06943 in 1.443 sec
Iter: 2, Total Loss: 0.006713 in 1.400 sec
Iter: 3, Total Loss: 0.006545 in 1.384 sec
Iter: 4, Total Loss: 0.006469 in 1.401 sec
Iter: 5, Total Loss: 0.006428 in 1.379 sec
Iter: 6, Total Loss: 0.0064 in 1.406 sec
Iter: 7, Total Loss: 0.00638 in 1.400 sec
Iter: 8, Total Loss: 0.006364 in 1.510 sec
Iter: 9, Total Loss: 0.006349 in 1.391 sec
Iter: 10, Total Loss: 0.006336 in 1.416 sec
Iter: 11, Total Loss: 0.006324 in 1.444 sec
Iter: 12, Total Loss: 0.006312 in 1.473 sec
Iter: 13, Total Loss: 0.006299 in 1.392 sec
Iter: 14, Total Loss: 0.006287 in 1.405 sec
Iter: 15, Total Loss: 0.006275 in 1.419 sec
Iter: 16, Total Loss: 0.006263 in 1.391 sec
Iter: 17, Total Loss: 0.006251 in 1.420 sec
Iter: 18, Total Loss: 0.006238 in 1.388 sec
Iter: 19, Total Loss: 0.006226 in 1.399 sec
Iter: 20, Total Loss: 0.006213 in 1.377 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 1.412 with std = 0.032 sec ###
### py4DSTEM ptycho solver is finished in 32.716 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 940.72 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 1024, 3, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   5%|▍         | 747/16384 [00:00<00:02, 7465.91probe position/s]Normalizing amplitudes:   9%|▉         | 1494/16384 [00:00<00:02, 7420.43probe position/s]Normalizing amplitudes:  14%|█▎        | 2237/16384 [00:00<00:02, 6386.95probe position/s]Normalizing amplitudes:  18%|█▊        | 2891/16384 [00:00<00:02, 6032.30probe position/s]Normalizing amplitudes:  21%|██▏       | 3504/16384 [00:00<00:02, 5871.79probe position/s]Normalizing amplitudes:  25%|██▌       | 4097/16384 [00:00<00:02, 5787.81probe position/s]Normalizing amplitudes:  30%|██▉       | 4857/16384 [00:00<00:01, 6336.64probe position/s]Normalizing amplitudes:  34%|███▍      | 5558/16384 [00:00<00:01, 6539.68probe position/s]Normalizing amplitudes:  38%|███▊      | 6218/16384 [00:00<00:01, 6116.55probe position/s]Normalizing amplitudes:  42%|████▏     | 6838/16384 [00:01<00:01, 5953.38probe position/s]Normalizing amplitudes:  45%|████▌     | 7439/16384 [00:01<00:01, 5852.47probe position/s]Normalizing amplitudes:  49%|████▉     | 8028/16384 [00:01<00:01, 5799.92probe position/s]Normalizing amplitudes:  53%|█████▎    | 8611/16384 [00:01<00:01, 5760.26probe position/s]Normalizing amplitudes:  57%|█████▋    | 9320/16384 [00:01<00:01, 6142.68probe position/s]Normalizing amplitudes:  62%|██████▏   | 10078/16384 [00:01<00:00, 6544.21probe position/s]Normalizing amplitudes:  66%|██████▌   | 10736/16384 [00:01<00:00, 6148.02probe position/s]Normalizing amplitudes:  69%|██████▉   | 11358/16384 [00:01<00:00, 5972.40probe position/s]Normalizing amplitudes:  73%|███████▎  | 11960/16384 [00:01<00:00, 5875.87probe position/s]Normalizing amplitudes:  77%|███████▋  | 12551/16384 [00:02<00:00, 5748.96probe position/s]Normalizing amplitudes:  80%|████████  | 13129/16384 [00:02<00:00, 5691.35probe position/s]Normalizing amplitudes:  84%|████████▍ | 13831/16384 [00:02<00:00, 6069.22probe position/s]Normalizing amplitudes:  89%|████████▉ | 14637/16384 [00:02<00:00, 6644.30probe position/s]Normalizing amplitudes:  93%|█████████▎| 15306/16384 [00:02<00:00, 6127.62probe position/s]Normalizing amplitudes:  97%|█████████▋| 15929/16384 [00:02<00:00, 5981.95probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6070.39probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random1024_p3_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random1024_p3_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.06912 in 3.396 sec
Iter: 2, Total Loss: 0.007191 in 3.335 sec
Iter: 3, Total Loss: 0.006685 in 3.347 sec
Iter: 4, Total Loss: 0.006569 in 3.323 sec
Iter: 5, Total Loss: 0.006513 in 3.319 sec
Iter: 6, Total Loss: 0.006474 in 3.314 sec
Iter: 7, Total Loss: 0.006445 in 3.343 sec
Iter: 8, Total Loss: 0.006417 in 3.365 sec
Iter: 9, Total Loss: 0.006394 in 3.301 sec
Iter: 10, Total Loss: 0.006372 in 3.305 sec
Iter: 11, Total Loss: 0.006353 in 3.312 sec
Iter: 12, Total Loss: 0.006334 in 3.574 sec
Iter: 13, Total Loss: 0.006317 in 3.360 sec
Iter: 14, Total Loss: 0.0063 in 3.341 sec
Iter: 15, Total Loss: 0.006285 in 3.309 sec
Iter: 16, Total Loss: 0.00627 in 3.287 sec
Iter: 17, Total Loss: 0.006257 in 3.322 sec
Iter: 18, Total Loss: 0.006243 in 3.349 sec
Iter: 19, Total Loss: 0.00623 in 3.317 sec
Iter: 20, Total Loss: 0.006217 in 3.356 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 3.344 with std = 0.059 sec ###
### py4DSTEM ptycho solver is finished in 1 min 7.094 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 940.65 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 1024, 3, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 645/16384 [00:00<00:02, 6446.36probe position/s]Normalizing amplitudes:   9%|▊         | 1420/16384 [00:00<00:02, 7208.21probe position/s]Normalizing amplitudes:  13%|█▎        | 2141/16384 [00:00<00:02, 6407.31probe position/s]Normalizing amplitudes:  17%|█▋        | 2792/16384 [00:00<00:02, 5897.67probe position/s]Normalizing amplitudes:  21%|██        | 3391/16384 [00:00<00:02, 5698.91probe position/s]Normalizing amplitudes:  24%|██▍       | 3966/16384 [00:00<00:02, 5612.22probe position/s]Normalizing amplitudes:  28%|██▊       | 4531/16384 [00:00<00:02, 5537.64probe position/s]Normalizing amplitudes:  32%|███▏      | 5179/16384 [00:00<00:01, 5816.83probe position/s]Normalizing amplitudes:  36%|███▋      | 5949/16384 [00:00<00:01, 6376.88probe position/s]Normalizing amplitudes:  40%|████      | 6592/16384 [00:01<00:01, 6034.30probe position/s]Normalizing amplitudes:  44%|████▍     | 7202/16384 [00:01<00:01, 5775.84probe position/s]Normalizing amplitudes:  48%|████▊     | 7785/16384 [00:01<00:01, 5699.14probe position/s]Normalizing amplitudes:  51%|█████     | 8359/16384 [00:01<00:01, 5561.58probe position/s]Normalizing amplitudes:  54%|█████▍    | 8918/16384 [00:01<00:01, 5495.36probe position/s]Normalizing amplitudes:  58%|█████▊    | 9500/16384 [00:01<00:01, 5587.57probe position/s]Normalizing amplitudes:  62%|██████▏   | 10213/16384 [00:01<00:01, 6033.27probe position/s]Normalizing amplitudes:  66%|██████▌   | 10820/16384 [00:01<00:00, 5959.85probe position/s]Normalizing amplitudes:  70%|██████▉   | 11419/16384 [00:01<00:00, 5687.15probe position/s]Normalizing amplitudes:  73%|███████▎  | 11992/16384 [00:02<00:00, 5569.90probe position/s]Normalizing amplitudes:  77%|███████▋  | 12552/16384 [00:02<00:00, 5492.76probe position/s]Normalizing amplitudes:  80%|███████▉  | 13103/16384 [00:02<00:00, 5417.99probe position/s]Normalizing amplitudes:  83%|████████▎ | 13662/16384 [00:02<00:00, 5464.80probe position/s]Normalizing amplitudes:  88%|████████▊ | 14441/16384 [00:02<00:00, 6138.34probe position/s]Normalizing amplitudes:  92%|█████████▏| 15097/16384 [00:02<00:00, 6259.73probe position/s]Normalizing amplitudes:  96%|█████████▌| 15726/16384 [00:02<00:00, 5952.67probe position/s]Normalizing amplitudes: 100%|█████████▉| 16326/16384 [00:02<00:00, 5739.99probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5801.03probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random1024_p3_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random1024_p3_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.06914 in 6.428 sec
Iter: 2, Total Loss: 0.007762 in 6.210 sec
Iter: 3, Total Loss: 0.006839 in 6.258 sec
Iter: 4, Total Loss: 0.006635 in 6.227 sec
Iter: 5, Total Loss: 0.006531 in 6.375 sec
Iter: 6, Total Loss: 0.006457 in 6.333 sec
Iter: 7, Total Loss: 0.006405 in 6.215 sec
Iter: 8, Total Loss: 0.006362 in 6.166 sec
Iter: 9, Total Loss: 0.006332 in 6.195 sec
Iter: 10, Total Loss: 0.0063 in 6.171 sec
Iter: 11, Total Loss: 0.006277 in 6.199 sec
Iter: 12, Total Loss: 0.006251 in 6.156 sec
Iter: 13, Total Loss: 0.006233 in 6.161 sec
Iter: 14, Total Loss: 0.006213 in 6.147 sec
Iter: 15, Total Loss: 0.006197 in 6.161 sec
Iter: 16, Total Loss: 0.00618 in 6.179 sec
Iter: 17, Total Loss: 0.006167 in 6.283 sec
Iter: 18, Total Loss: 0.006152 in 6.229 sec
Iter: 19, Total Loss: 0.006138 in 6.521 sec
Iter: 20, Total Loss: 0.006124 in 6.161 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 6.239 with std = 0.099 sec ###
### py4DSTEM ptycho solver is finished in 2 min 5.154 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 939.98 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 1024, 6, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 609/16384 [00:00<00:02, 6088.29probe position/s]Normalizing amplitudes:   8%|▊         | 1241/16384 [00:00<00:02, 6220.90probe position/s]Normalizing amplitudes:  11%|█▏        | 1864/16384 [00:00<00:02, 6068.81probe position/s]Normalizing amplitudes:  15%|█▌        | 2498/16384 [00:00<00:02, 6170.80probe position/s]Normalizing amplitudes:  19%|█▉        | 3177/16384 [00:00<00:02, 6390.54probe position/s]Normalizing amplitudes:  24%|██▍       | 3929/16384 [00:00<00:01, 6771.62probe position/s]Normalizing amplitudes:  28%|██▊       | 4607/16384 [00:00<00:01, 6356.55probe position/s]Normalizing amplitudes:  32%|███▏      | 5248/16384 [00:00<00:01, 6162.94probe position/s]Normalizing amplitudes:  36%|███▌      | 5869/16384 [00:00<00:01, 6000.34probe position/s]Normalizing amplitudes:  40%|███▉      | 6472/16384 [00:01<00:01, 5929.44probe position/s]Normalizing amplitudes:  43%|████▎     | 7067/16384 [00:01<00:01, 5811.29probe position/s]Normalizing amplitudes:  47%|████▋     | 7684/16384 [00:01<00:01, 5912.26probe position/s]Normalizing amplitudes:  52%|█████▏    | 8453/16384 [00:01<00:01, 6430.40probe position/s]Normalizing amplitudes:  56%|█████▌    | 9204/16384 [00:01<00:01, 6748.13probe position/s]Normalizing amplitudes:  60%|██████    | 9882/16384 [00:01<00:01, 6391.57probe position/s]Normalizing amplitudes:  64%|██████▍   | 10527/16384 [00:01<00:00, 6188.50probe position/s]Normalizing amplitudes:  68%|██████▊   | 11151/16384 [00:01<00:00, 6002.44probe position/s]Normalizing amplitudes:  72%|███████▏  | 11755/16384 [00:01<00:00, 5895.38probe position/s]Normalizing amplitudes:  75%|███████▌  | 12347/16384 [00:02<00:00, 5890.94probe position/s]Normalizing amplitudes:  79%|███████▉  | 12976/16384 [00:02<00:00, 6005.12probe position/s]Normalizing amplitudes:  84%|████████▍ | 13760/16384 [00:02<00:00, 6537.12probe position/s]Normalizing amplitudes:  88%|████████▊ | 14417/16384 [00:02<00:00, 6410.99probe position/s]Normalizing amplitudes:  92%|█████████▏| 15061/16384 [00:02<00:00, 6180.67probe position/s]Normalizing amplitudes:  96%|█████████▌| 15682/16384 [00:02<00:00, 5889.09probe position/s]Normalizing amplitudes:  99%|█████████▉| 16275/16384 [00:02<00:00, 5878.28probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6138.00probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random1024_p6_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random1024_p6_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.2044 in 2.288 sec
Iter: 2, Total Loss: 0.006913 in 2.253 sec
Iter: 3, Total Loss: 0.006651 in 2.235 sec
Iter: 4, Total Loss: 0.00653 in 2.255 sec
Iter: 5, Total Loss: 0.006462 in 2.258 sec
Iter: 6, Total Loss: 0.006416 in 2.284 sec
Iter: 7, Total Loss: 0.006381 in 2.247 sec
Iter: 8, Total Loss: 0.006352 in 2.242 sec
Iter: 9, Total Loss: 0.006327 in 2.248 sec
Iter: 10, Total Loss: 0.006305 in 2.257 sec
Iter: 11, Total Loss: 0.006283 in 2.352 sec
Iter: 12, Total Loss: 0.006263 in 2.263 sec
Iter: 13, Total Loss: 0.006243 in 2.258 sec
Iter: 14, Total Loss: 0.006224 in 2.251 sec
Iter: 15, Total Loss: 0.006205 in 2.259 sec
Iter: 16, Total Loss: 0.006186 in 2.397 sec
Iter: 17, Total Loss: 0.006168 in 2.611 sec
Iter: 18, Total Loss: 0.00615 in 2.480 sec
Iter: 19, Total Loss: 0.006133 in 2.305 sec
Iter: 20, Total Loss: 0.006117 in 2.273 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 2.301 with std = 0.092 sec ###
### py4DSTEM ptycho solver is finished in 46.244 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 939.97 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 1024, 6, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 565/16384 [00:00<00:02, 5644.37probe position/s]Normalizing amplitudes:   7%|▋         | 1137/16384 [00:00<00:02, 5668.96probe position/s]Normalizing amplitudes:  11%|█         | 1728/16384 [00:00<00:02, 5777.92probe position/s]Normalizing amplitudes:  14%|█▍        | 2306/16384 [00:00<00:02, 5720.31probe position/s]Normalizing amplitudes:  18%|█▊        | 2879/16384 [00:00<00:02, 5682.72probe position/s]Normalizing amplitudes:  22%|██▏       | 3656/16384 [00:00<00:01, 6383.32probe position/s]Normalizing amplitudes:  26%|██▌       | 4296/16384 [00:00<00:01, 6384.42probe position/s]Normalizing amplitudes:  30%|███       | 4935/16384 [00:00<00:01, 6060.90probe position/s]Normalizing amplitudes:  34%|███▍      | 5545/16384 [00:00<00:01, 5920.61probe position/s]Normalizing amplitudes:  37%|███▋      | 6140/16384 [00:01<00:01, 5826.70probe position/s]Normalizing amplitudes:  41%|████      | 6753/16384 [00:01<00:01, 5914.81probe position/s]Normalizing amplitudes:  45%|████▍     | 7347/16384 [00:01<00:01, 5908.46probe position/s]Normalizing amplitudes:  49%|████▉     | 8021/16384 [00:01<00:01, 6153.23probe position/s]Normalizing amplitudes:  54%|█████▎    | 8800/16384 [00:01<00:01, 6637.29probe position/s]Normalizing amplitudes:  58%|█████▊    | 9466/16384 [00:01<00:01, 6350.74probe position/s]Normalizing amplitudes:  62%|██████▏   | 10105/16384 [00:01<00:01, 6029.13probe position/s]Normalizing amplitudes:  65%|██████▌   | 10713/16384 [00:01<00:00, 5876.88probe position/s]Normalizing amplitudes:  69%|██████▉   | 11305/16384 [00:01<00:00, 5745.08probe position/s]Normalizing amplitudes:  73%|███████▎  | 11882/16384 [00:01<00:00, 5685.61probe position/s]Normalizing amplitudes:  76%|███████▌  | 12473/16384 [00:02<00:00, 5747.77probe position/s]Normalizing amplitudes:  81%|████████  | 13254/16384 [00:02<00:00, 6342.86probe position/s]Normalizing amplitudes:  85%|████████▍ | 13892/16384 [00:02<00:00, 6307.19probe position/s]Normalizing amplitudes:  89%|████████▊ | 14525/16384 [00:02<00:00, 6068.60probe position/s]Normalizing amplitudes:  92%|█████████▏| 15135/16384 [00:02<00:00, 5920.01probe position/s]Normalizing amplitudes:  96%|█████████▌| 15730/16384 [00:02<00:00, 5801.63probe position/s]Normalizing amplitudes: 100%|█████████▉| 16312/16384 [00:02<00:00, 5729.74probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5971.91probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random1024_p6_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random1024_p6_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.1972 in 6.134 sec
Iter: 2, Total Loss: 0.007948 in 6.161 sec
Iter: 3, Total Loss: 0.007036 in 6.173 sec
Iter: 4, Total Loss: 0.006763 in 6.164 sec
Iter: 5, Total Loss: 0.006622 in 6.148 sec
Iter: 6, Total Loss: 0.006528 in 6.156 sec
Iter: 7, Total Loss: 0.006456 in 6.169 sec
Iter: 8, Total Loss: 0.006397 in 6.143 sec
Iter: 9, Total Loss: 0.006348 in 6.176 sec
Iter: 10, Total Loss: 0.006304 in 6.195 sec
Iter: 11, Total Loss: 0.006268 in 6.110 sec
Iter: 12, Total Loss: 0.006234 in 6.154 sec
Iter: 13, Total Loss: 0.006204 in 6.132 sec
Iter: 14, Total Loss: 0.006176 in 6.200 sec
Iter: 15, Total Loss: 0.006151 in 6.144 sec
Iter: 16, Total Loss: 0.006128 in 6.151 sec
Iter: 17, Total Loss: 0.006106 in 6.136 sec
Iter: 18, Total Loss: 0.006085 in 6.180 sec
Iter: 19, Total Loss: 0.006066 in 6.137 sec
Iter: 20, Total Loss: 0.006048 in 6.120 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 6.154 with std = 0.023 sec ###
### py4DSTEM ptycho solver is finished in 2 min 3.377 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 939.86 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 1024, 6, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 558/16384 [00:00<00:02, 5549.53probe position/s]Normalizing amplitudes:   7%|▋         | 1113/16384 [00:00<00:02, 5377.31probe position/s]Normalizing amplitudes:  11%|█         | 1742/16384 [00:00<00:02, 5783.64probe position/s]Normalizing amplitudes:  15%|█▍        | 2382/16384 [00:00<00:02, 6023.67probe position/s]Normalizing amplitudes:  19%|█▉        | 3152/16384 [00:00<00:01, 6622.13probe position/s]Normalizing amplitudes:  23%|██▎       | 3816/16384 [00:00<00:02, 6233.30probe position/s]Normalizing amplitudes:  27%|██▋       | 4444/16384 [00:00<00:02, 5850.31probe position/s]Normalizing amplitudes:  31%|███       | 5036/16384 [00:00<00:01, 5678.27probe position/s]Normalizing amplitudes:  34%|███▍      | 5609/16384 [00:00<00:01, 5510.04probe position/s]Normalizing amplitudes:  38%|███▊      | 6163/16384 [00:01<00:01, 5411.68probe position/s]Normalizing amplitudes:  41%|████      | 6706/16384 [00:01<00:01, 5398.06probe position/s]Normalizing amplitudes:  46%|████▌     | 7463/16384 [00:01<00:01, 6024.27probe position/s]Normalizing amplitudes:  50%|████▉     | 8126/16384 [00:01<00:01, 6200.78probe position/s]Normalizing amplitudes:  53%|█████▎    | 8750/16384 [00:01<00:01, 5951.92probe position/s]Normalizing amplitudes:  57%|█████▋    | 9350/16384 [00:01<00:01, 5737.80probe position/s]Normalizing amplitudes:  61%|██████    | 9928/16384 [00:01<00:01, 5603.05probe position/s]Normalizing amplitudes:  64%|██████▍   | 10491/16384 [00:01<00:01, 5482.85probe position/s]Normalizing amplitudes:  67%|██████▋   | 11042/16384 [00:01<00:00, 5401.77probe position/s]Normalizing amplitudes:  71%|███████▏  | 11679/16384 [00:02<00:00, 5675.16probe position/s]Normalizing amplitudes:  76%|███████▌  | 12464/16384 [00:02<00:00, 6301.60probe position/s]Normalizing amplitudes:  80%|███████▉  | 13099/16384 [00:02<00:00, 6104.28probe position/s]Normalizing amplitudes:  84%|████████▎ | 13714/16384 [00:02<00:00, 5857.19probe position/s]Normalizing amplitudes:  87%|████████▋ | 14304/16384 [00:02<00:00, 5681.42probe position/s]Normalizing amplitudes:  91%|█████████ | 14876/16384 [00:02<00:00, 5577.32probe position/s]Normalizing amplitudes:  94%|█████████▍| 15436/16384 [00:02<00:00, 5512.91probe position/s]Normalizing amplitudes:  98%|█████████▊| 15989/16384 [00:02<00:00, 5436.56probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5762.86probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random1024_p6_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random1024_p6_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.194 in 11.901 sec
Iter: 2, Total Loss: 0.009296 in 11.822 sec
Iter: 3, Total Loss: 0.007522 in 11.856 sec
Iter: 4, Total Loss: 0.006997 in 11.846 sec
Iter: 5, Total Loss: 0.006737 in 11.810 sec
Iter: 6, Total Loss: 0.006571 in 11.811 sec
Iter: 7, Total Loss: 0.006455 in 11.794 sec
Iter: 8, Total Loss: 0.006364 in 11.806 sec
Iter: 9, Total Loss: 0.006293 in 12.109 sec
Iter: 10, Total Loss: 0.006237 in 11.826 sec
Iter: 11, Total Loss: 0.006191 in 11.752 sec
Iter: 12, Total Loss: 0.006151 in 11.765 sec
Iter: 13, Total Loss: 0.006118 in 11.887 sec
Iter: 14, Total Loss: 0.00609 in 11.924 sec
Iter: 15, Total Loss: 0.006063 in 11.829 sec
Iter: 16, Total Loss: 0.00604 in 11.810 sec
Iter: 17, Total Loss: 0.006019 in 11.797 sec
Iter: 18, Total Loss: 0.005999 in 11.759 sec
Iter: 19, Total Loss: 0.005981 in 11.736 sec
Iter: 20, Total Loss: 0.005964 in 11.718 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 11.828 with std = 0.083 sec ###
### py4DSTEM ptycho solver is finished in 3 min 56.862 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 939.74 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 1024, 12, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 602/16384 [00:00<00:02, 6019.42probe position/s]Normalizing amplitudes:   8%|▊         | 1374/16384 [00:00<00:02, 7018.19probe position/s]Normalizing amplitudes:  13%|█▎        | 2076/16384 [00:00<00:02, 6535.02probe position/s]Normalizing amplitudes:  17%|█▋        | 2734/16384 [00:00<00:02, 6086.03probe position/s]Normalizing amplitudes:  20%|██        | 3348/16384 [00:00<00:02, 5841.93probe position/s]Normalizing amplitudes:  24%|██▍       | 3936/16384 [00:00<00:02, 5765.74probe position/s]Normalizing amplitudes:  28%|██▊       | 4515/16384 [00:00<00:02, 5720.35probe position/s]Normalizing amplitudes:  31%|███       | 5089/16384 [00:00<00:01, 5655.45probe position/s]Normalizing amplitudes:  36%|███▌      | 5857/16384 [00:00<00:01, 6258.86probe position/s]Normalizing amplitudes:  40%|███▉      | 6507/16384 [00:01<00:01, 6330.55probe position/s]Normalizing amplitudes:  44%|████▎     | 7143/16384 [00:01<00:01, 6067.81probe position/s]Normalizing amplitudes:  47%|████▋     | 7754/16384 [00:01<00:01, 5910.45probe position/s]Normalizing amplitudes:  51%|█████     | 8348/16384 [00:01<00:01, 5801.25probe position/s]Normalizing amplitudes:  55%|█████▍    | 8930/16384 [00:01<00:01, 5726.75probe position/s]Normalizing amplitudes:  58%|█████▊    | 9504/16384 [00:01<00:01, 5677.98probe position/s]Normalizing amplitudes:  62%|██████▏   | 10159/16384 [00:01<00:01, 5928.39probe position/s]Normalizing amplitudes:  67%|██████▋   | 10929/16384 [00:01<00:00, 6445.02probe position/s]Normalizing amplitudes:  71%|███████   | 11576/16384 [00:01<00:00, 6134.06probe position/s]Normalizing amplitudes:  74%|███████▍  | 12194/16384 [00:02<00:00, 5978.72probe position/s]Normalizing amplitudes:  78%|███████▊  | 12796/16384 [00:02<00:00, 5846.08probe position/s]Normalizing amplitudes:  82%|████████▏ | 13384/16384 [00:02<00:00, 5712.61probe position/s]Normalizing amplitudes:  85%|████████▌ | 13957/16384 [00:02<00:00, 5685.68probe position/s]Normalizing amplitudes:  89%|████████▊ | 14527/16384 [00:02<00:00, 5681.21probe position/s]Normalizing amplitudes:  93%|█████████▎| 15273/16384 [00:02<00:00, 6197.81probe position/s]Normalizing amplitudes:  97%|█████████▋| 15895/16384 [00:02<00:00, 6110.50probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5968.93probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random1024_p12_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random1024_p12_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.5332 in 4.250 sec
Iter: 2, Total Loss: 0.00719 in 4.125 sec
Iter: 3, Total Loss: 0.006801 in 4.100 sec
Iter: 4, Total Loss: 0.006625 in 4.146 sec
Iter: 5, Total Loss: 0.006527 in 4.161 sec
Iter: 6, Total Loss: 0.006465 in 4.109 sec
Iter: 7, Total Loss: 0.00642 in 4.126 sec
Iter: 8, Total Loss: 0.006384 in 4.109 sec
Iter: 9, Total Loss: 0.006353 in 4.144 sec
Iter: 10, Total Loss: 0.006325 in 4.107 sec
Iter: 11, Total Loss: 0.0063 in 4.208 sec
Iter: 12, Total Loss: 0.006276 in 4.250 sec
Iter: 13, Total Loss: 0.006254 in 4.279 sec
Iter: 14, Total Loss: 0.006232 in 4.230 sec
Iter: 15, Total Loss: 0.006211 in 4.334 sec
Iter: 16, Total Loss: 0.006191 in 4.569 sec
Iter: 17, Total Loss: 0.006173 in 4.239 sec
Iter: 18, Total Loss: 0.006155 in 4.238 sec
Iter: 19, Total Loss: 0.006137 in 4.248 sec
Iter: 20, Total Loss: 0.006121 in 4.209 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 4.209 with std = 0.106 sec ###
### py4DSTEM ptycho solver is finished in 1 min 24.517 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 939.56 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 1024, 12, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   5%|▍         | 774/16384 [00:00<00:02, 7733.83probe position/s]Normalizing amplitudes:   9%|▉         | 1548/16384 [00:00<00:02, 5780.09probe position/s]Normalizing amplitudes:  13%|█▎        | 2156/16384 [00:00<00:02, 5253.18probe position/s]Normalizing amplitudes:  16%|█▋        | 2697/16384 [00:00<00:02, 5109.29probe position/s]Normalizing amplitudes:  20%|█▉        | 3216/16384 [00:00<00:02, 5126.42probe position/s]Normalizing amplitudes:  24%|██▍       | 3939/16384 [00:00<00:02, 5773.06probe position/s]Normalizing amplitudes:  28%|██▊       | 4627/16384 [00:00<00:01, 6089.13probe position/s]Normalizing amplitudes:  32%|███▏      | 5245/16384 [00:00<00:02, 5470.36probe position/s]Normalizing amplitudes:  35%|███▌      | 5808/16384 [00:01<00:01, 5291.51probe position/s]Normalizing amplitudes:  39%|███▊      | 6348/16384 [00:01<00:01, 5082.69probe position/s]Normalizing amplitudes:  42%|████▏     | 6864/16384 [00:01<00:01, 5026.47probe position/s]Normalizing amplitudes:  47%|████▋     | 7648/16384 [00:01<00:01, 5808.88probe position/s]Normalizing amplitudes:  50%|█████     | 8268/16384 [00:01<00:01, 5917.54probe position/s]Normalizing amplitudes:  54%|█████▍    | 8868/16384 [00:01<00:01, 5477.26probe position/s]Normalizing amplitudes:  58%|█████▊    | 9427/16384 [00:01<00:01, 5261.67probe position/s]Normalizing amplitudes:  61%|██████    | 9962/16384 [00:01<00:01, 5098.42probe position/s]Normalizing amplitudes:  64%|██████▍   | 10478/16384 [00:01<00:01, 5006.71probe position/s]Normalizing amplitudes:  69%|██████▊   | 11255/16384 [00:02<00:00, 5769.40probe position/s]Normalizing amplitudes:  73%|███████▎  | 11911/16384 [00:02<00:00, 5990.37probe position/s]Normalizing amplitudes:  76%|███████▋  | 12518/16384 [00:02<00:00, 5658.14probe position/s]Normalizing amplitudes:  80%|███████▉  | 13093/16384 [00:02<00:00, 5289.66probe position/s]Normalizing amplitudes:  83%|████████▎ | 13632/16384 [00:02<00:00, 5049.56probe position/s]Normalizing amplitudes:  87%|████████▋ | 14213/16384 [00:02<00:00, 5253.49probe position/s]Normalizing amplitudes:  92%|█████████▏| 15000/16384 [00:02<00:00, 5977.26probe position/s]Normalizing amplitudes:  95%|█████████▌| 15609/16384 [00:02<00:00, 5641.22probe position/s]Normalizing amplitudes:  99%|█████████▉| 16184/16384 [00:02<00:00, 5331.06probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:03<00:00, 5452.96probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random1024_p12_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random1024_p12_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
An error occurred for (round, batch, pmode, slice) = (1, 1024, 12, 3): Out of memory allocating 1,610,612,736 bytes (allocated so far: 18,790,481,920 bytes).
### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 939.24 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 1024, 12, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 434/16384 [00:00<00:03, 4338.50probe position/s]Normalizing amplitudes:   5%|▌         | 901/16384 [00:00<00:03, 4529.37probe position/s]Normalizing amplitudes:  10%|▉         | 1598/16384 [00:00<00:02, 5641.86probe position/s]Normalizing amplitudes:  14%|█▍        | 2340/16384 [00:00<00:02, 6333.43probe position/s]Normalizing amplitudes:  18%|█▊        | 2974/16384 [00:00<00:02, 5494.94probe position/s]Normalizing amplitudes:  22%|██▏       | 3540/16384 [00:00<00:02, 5158.33probe position/s]Normalizing amplitudes:  25%|██▍       | 4068/16384 [00:00<00:02, 4992.45probe position/s]Normalizing amplitudes:  28%|██▊       | 4575/16384 [00:00<00:02, 4955.26probe position/s]Normalizing amplitudes:  33%|███▎      | 5351/16384 [00:00<00:01, 5759.36probe position/s]Normalizing amplitudes:  36%|███▋      | 5959/16384 [00:01<00:01, 5851.55probe position/s]Normalizing amplitudes:  40%|███▉      | 6552/16384 [00:01<00:01, 5424.80probe position/s]Normalizing amplitudes:  43%|████▎     | 7105/16384 [00:01<00:01, 5163.98probe position/s]Normalizing amplitudes:  47%|████▋     | 7630/16384 [00:01<00:01, 4895.60probe position/s]Normalizing amplitudes:  50%|████▉     | 8173/16384 [00:01<00:01, 5039.20probe position/s]Normalizing amplitudes:  55%|█████▍    | 8952/16384 [00:01<00:01, 5803.03probe position/s]Normalizing amplitudes:  58%|█████▊    | 9544/16384 [00:01<00:01, 5795.50probe position/s]Normalizing amplitudes:  62%|██████▏   | 10132/16384 [00:01<00:01, 5520.55probe position/s]Normalizing amplitudes:  65%|██████▌   | 10692/16384 [00:01<00:01, 5235.66probe position/s]Normalizing amplitudes:  68%|██████▊   | 11223/16384 [00:02<00:01, 5034.19probe position/s]Normalizing amplitudes:  72%|███████▏  | 11806/16384 [00:02<00:00, 5250.60probe position/s]Normalizing amplitudes:  77%|███████▋  | 12580/16384 [00:02<00:00, 5947.93probe position/s]Normalizing amplitudes:  80%|████████  | 13184/16384 [00:02<00:00, 5692.42probe position/s]Normalizing amplitudes:  84%|████████▍ | 13762/16384 [00:02<00:00, 5272.23probe position/s]Normalizing amplitudes:  87%|████████▋ | 14300/16384 [00:02<00:00, 5068.42probe position/s]Normalizing amplitudes:  90%|█████████ | 14814/16384 [00:02<00:00, 4921.30probe position/s]Normalizing amplitudes:  95%|█████████▍| 15504/16384 [00:02<00:00, 5456.03probe position/s]Normalizing amplitudes:  99%|█████████▉| 16243/16384 [00:02<00:00, 5993.68probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:03<00:00, 5415.88probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random1024_p12_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random1024_p12_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
An error occurred for (round, batch, pmode, slice) = (1, 1024, 12, 6): Out of memory allocating 1,610,612,736 bytes (allocated so far: 18,790,481,920 bytes).
### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 939.46 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 512, 1, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 598/16384 [00:00<00:02, 5979.04probe position/s]Normalizing amplitudes:   7%|▋         | 1196/16384 [00:00<00:02, 5255.52probe position/s]Normalizing amplitudes:  11%|█         | 1728/16384 [00:00<00:02, 4919.08probe position/s]Normalizing amplitudes:  14%|█▎        | 2224/16384 [00:00<00:02, 4799.47probe position/s]Normalizing amplitudes:  17%|█▋        | 2706/16384 [00:00<00:02, 4765.73probe position/s]Normalizing amplitudes:  21%|██▏       | 3491/16384 [00:00<00:02, 5754.86probe position/s]Normalizing amplitudes:  25%|██▍       | 4083/16384 [00:00<00:02, 5798.53probe position/s]Normalizing amplitudes:  28%|██▊       | 4668/16384 [00:00<00:02, 5367.75probe position/s]Normalizing amplitudes:  32%|███▏      | 5214/16384 [00:00<00:02, 5232.22probe position/s]Normalizing amplitudes:  35%|███▌      | 5743/16384 [00:01<00:02, 4990.12probe position/s]Normalizing amplitudes:  38%|███▊      | 6247/16384 [00:01<00:02, 4943.93probe position/s]Normalizing amplitudes:  43%|████▎     | 7030/16384 [00:01<00:01, 5760.36probe position/s]Normalizing amplitudes:  47%|████▋     | 7634/16384 [00:01<00:01, 5839.89probe position/s]Normalizing amplitudes:  50%|█████     | 8225/16384 [00:01<00:01, 5440.44probe position/s]Normalizing amplitudes:  54%|█████▎    | 8778/16384 [00:01<00:01, 5156.06probe position/s]Normalizing amplitudes:  57%|█████▋    | 9302/16384 [00:01<00:01, 4951.21probe position/s]Normalizing amplitudes:  60%|██████    | 9854/16384 [00:01<00:01, 5104.26probe position/s]Normalizing amplitudes:  65%|██████▍   | 10628/16384 [00:01<00:00, 5840.17probe position/s]Normalizing amplitudes:  68%|██████▊   | 11222/16384 [00:02<00:00, 5628.94probe position/s]Normalizing amplitudes:  72%|███████▏  | 11793/16384 [00:02<00:00, 5363.93probe position/s]Normalizing amplitudes:  75%|███████▌  | 12337/16384 [00:02<00:00, 5191.60probe position/s]Normalizing amplitudes:  78%|███████▊  | 12861/16384 [00:02<00:00, 4961.51probe position/s]Normalizing amplitudes:  82%|████████▏ | 13505/16384 [00:02<00:00, 5363.25probe position/s]Normalizing amplitudes:  87%|████████▋ | 14285/16384 [00:02<00:00, 6045.17probe position/s]Normalizing amplitudes:  91%|█████████ | 14900/16384 [00:02<00:00, 5522.02probe position/s]Normalizing amplitudes:  94%|█████████▍| 15467/16384 [00:02<00:00, 5462.24probe position/s]Normalizing amplitudes:  98%|█████████▊| 16023/16384 [00:03<00:00, 5201.24probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:03<00:00, 5311.92probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random512_p1_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random512_p1_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.01437 in 0.897 sec
Iter: 2, Total Loss: 0.00651 in 0.931 sec
Iter: 3, Total Loss: 0.006486 in 0.883 sec
Iter: 4, Total Loss: 0.006475 in 0.901 sec
Iter: 5, Total Loss: 0.006467 in 0.916 sec
Iter: 6, Total Loss: 0.006463 in 0.856 sec
Iter: 7, Total Loss: 0.006459 in 0.932 sec
Iter: 8, Total Loss: 0.006455 in 0.864 sec
Iter: 9, Total Loss: 0.006452 in 0.936 sec
Iter: 10, Total Loss: 0.006449 in 0.901 sec
Iter: 11, Total Loss: 0.006445 in 0.906 sec
Iter: 12, Total Loss: 0.006442 in 0.911 sec
Iter: 13, Total Loss: 0.006438 in 0.858 sec
Iter: 14, Total Loss: 0.006435 in 0.914 sec
Iter: 15, Total Loss: 0.006431 in 0.854 sec
Iter: 16, Total Loss: 0.006428 in 0.933 sec
Iter: 17, Total Loss: 0.006425 in 0.890 sec
Iter: 18, Total Loss: 0.006421 in 0.919 sec
Iter: 19, Total Loss: 0.006417 in 0.915 sec
Iter: 20, Total Loss: 0.006414 in 0.885 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 0.900 with std = 0.026 sec ###
### py4DSTEM ptycho solver is finished in 18.274 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 939.50 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 512, 1, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 637/16384 [00:00<00:02, 6364.51probe position/s]Normalizing amplitudes:   8%|▊         | 1274/16384 [00:00<00:02, 5170.76probe position/s]Normalizing amplitudes:  11%|█         | 1805/16384 [00:00<00:02, 4968.35probe position/s]Normalizing amplitudes:  14%|█▍        | 2309/16384 [00:00<00:02, 4811.90probe position/s]Normalizing amplitudes:  17%|█▋        | 2794/16384 [00:00<00:02, 4815.95probe position/s]Normalizing amplitudes:  22%|██▏       | 3577/16384 [00:00<00:02, 5775.97probe position/s]Normalizing amplitudes:  25%|██▌       | 4172/16384 [00:00<00:02, 5829.46probe position/s]Normalizing amplitudes:  29%|██▉       | 4761/16384 [00:00<00:02, 5417.18probe position/s]Normalizing amplitudes:  32%|███▏      | 5312/16384 [00:01<00:02, 5130.11probe position/s]Normalizing amplitudes:  36%|███▌      | 5833/16384 [00:01<00:02, 4943.51probe position/s]Normalizing amplitudes:  39%|███▊      | 6338/16384 [00:01<00:02, 4972.93probe position/s]Normalizing amplitudes:  43%|████▎     | 7119/16384 [00:01<00:01, 5777.45probe position/s]Normalizing amplitudes:  47%|████▋     | 7740/16384 [00:01<00:01, 5902.07probe position/s]Normalizing amplitudes:  51%|█████     | 8337/16384 [00:01<00:01, 5825.23probe position/s]Normalizing amplitudes:  54%|█████▍    | 8925/16384 [00:01<00:01, 5518.00probe position/s]Normalizing amplitudes:  58%|█████▊    | 9483/16384 [00:01<00:01, 5255.31probe position/s]Normalizing amplitudes:  61%|██████    | 10015/16384 [00:01<00:01, 5101.47probe position/s]Normalizing amplitudes:  66%|██████▌   | 10789/16384 [00:01<00:00, 5830.23probe position/s]Normalizing amplitudes:  70%|██████▉   | 11417/16384 [00:02<00:00, 5954.17probe position/s]Normalizing amplitudes:  73%|███████▎  | 12020/16384 [00:02<00:00, 5499.81probe position/s]Normalizing amplitudes:  77%|███████▋  | 12581/16384 [00:02<00:00, 5189.82probe position/s]Normalizing amplitudes:  80%|████████  | 13110/16384 [00:02<00:00, 5025.34probe position/s]Normalizing amplitudes:  84%|████████▎ | 13694/16384 [00:02<00:00, 5243.66probe position/s]Normalizing amplitudes:  88%|████████▊ | 14477/16384 [00:02<00:00, 5962.00probe position/s]Normalizing amplitudes:  92%|█████████▏| 15084/16384 [00:02<00:00, 5680.58probe position/s]Normalizing amplitudes:  96%|█████████▌| 15662/16384 [00:02<00:00, 5269.30probe position/s]Normalizing amplitudes:  99%|█████████▉| 16200/16384 [00:03<00:00, 5093.25probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:03<00:00, 5368.07probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random512_p1_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random512_p1_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.01472 in 1.701 sec
Iter: 2, Total Loss: 0.006507 in 1.699 sec
Iter: 3, Total Loss: 0.006483 in 1.710 sec
Iter: 4, Total Loss: 0.006472 in 1.667 sec
Iter: 5, Total Loss: 0.006464 in 1.657 sec
Iter: 6, Total Loss: 0.006458 in 1.692 sec
Iter: 7, Total Loss: 0.006452 in 1.679 sec
Iter: 8, Total Loss: 0.006446 in 1.692 sec
Iter: 9, Total Loss: 0.006439 in 1.674 sec
Iter: 10, Total Loss: 0.006432 in 1.665 sec
Iter: 11, Total Loss: 0.006427 in 1.744 sec
Iter: 12, Total Loss: 0.006422 in 1.688 sec
Iter: 13, Total Loss: 0.006417 in 1.687 sec
Iter: 14, Total Loss: 0.006412 in 1.709 sec
Iter: 15, Total Loss: 0.006406 in 1.698 sec
Iter: 16, Total Loss: 0.006402 in 1.685 sec
Iter: 17, Total Loss: 0.006397 in 1.671 sec
Iter: 18, Total Loss: 0.006392 in 1.677 sec
Iter: 19, Total Loss: 0.006386 in 1.707 sec
Iter: 20, Total Loss: 0.006381 in 1.672 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 1.689 with std = 0.020 sec ###
### py4DSTEM ptycho solver is finished in 34.164 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 939.48 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 512, 1, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 515/16384 [00:00<00:03, 5144.13probe position/s]Normalizing amplitudes:   6%|▋         | 1030/16384 [00:00<00:03, 4898.52probe position/s]Normalizing amplitudes:   9%|▉         | 1521/16384 [00:00<00:03, 4849.50probe position/s]Normalizing amplitudes:  12%|█▏        | 2007/16384 [00:00<00:02, 4809.81probe position/s]Normalizing amplitudes:  16%|█▌        | 2548/16384 [00:00<00:02, 5021.26probe position/s]Normalizing amplitudes:  20%|██        | 3347/16384 [00:00<00:02, 6015.72probe position/s]Normalizing amplitudes:  24%|██▍       | 3951/16384 [00:00<00:02, 5921.73probe position/s]Normalizing amplitudes:  28%|██▊       | 4545/16384 [00:00<00:02, 5558.73probe position/s]Normalizing amplitudes:  31%|███       | 5106/16384 [00:00<00:02, 5329.70probe position/s]Normalizing amplitudes:  34%|███▍      | 5644/16384 [00:01<00:02, 5148.63probe position/s]Normalizing amplitudes:  38%|███▊      | 6178/16384 [00:01<00:01, 5202.00probe position/s]Normalizing amplitudes:  43%|████▎     | 6973/16384 [00:01<00:01, 5993.73probe position/s]Normalizing amplitudes:  46%|████▋     | 7579/16384 [00:01<00:01, 5863.84probe position/s]Normalizing amplitudes:  50%|████▉     | 8170/16384 [00:01<00:01, 5409.42probe position/s]Normalizing amplitudes:  53%|█████▎    | 8720/16384 [00:01<00:01, 5176.85probe position/s]Normalizing amplitudes:  56%|█████▋    | 9245/16384 [00:01<00:01, 5063.92probe position/s]Normalizing amplitudes:  60%|██████    | 9909/16384 [00:01<00:01, 5495.72probe position/s]Normalizing amplitudes:  65%|██████▌   | 10707/16384 [00:01<00:00, 6195.28probe position/s]Normalizing amplitudes:  69%|██████▉   | 11337/16384 [00:02<00:00, 5688.18probe position/s]Normalizing amplitudes:  73%|███████▎  | 11920/16384 [00:02<00:00, 5385.04probe position/s]Normalizing amplitudes:  76%|███████▌  | 12470/16384 [00:02<00:00, 5178.18probe position/s]Normalizing amplitudes:  79%|███████▉  | 12996/16384 [00:02<00:00, 5046.85probe position/s]Normalizing amplitudes:  84%|████████▍ | 13779/16384 [00:02<00:00, 5800.74probe position/s]Normalizing amplitudes:  88%|████████▊ | 14435/16384 [00:02<00:00, 6010.07probe position/s]Normalizing amplitudes:  92%|█████████▏| 15046/16384 [00:02<00:00, 5517.76probe position/s]Normalizing amplitudes:  95%|█████████▌| 15612/16384 [00:02<00:00, 5279.01probe position/s]Normalizing amplitudes:  99%|█████████▊| 16150/16384 [00:02<00:00, 5089.50probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:03<00:00, 5398.17probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random512_p1_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random512_p1_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.01513 in 2.922 sec
Iter: 2, Total Loss: 0.006537 in 2.829 sec
Iter: 3, Total Loss: 0.006509 in 2.834 sec
Iter: 4, Total Loss: 0.006492 in 2.858 sec
Iter: 5, Total Loss: 0.006481 in 2.814 sec
Iter: 6, Total Loss: 0.006471 in 2.835 sec
Iter: 7, Total Loss: 0.006462 in 2.832 sec
Iter: 8, Total Loss: 0.006451 in 2.836 sec
Iter: 9, Total Loss: 0.006444 in 2.816 sec
Iter: 10, Total Loss: 0.006436 in 2.831 sec
Iter: 11, Total Loss: 0.006428 in 2.817 sec
Iter: 12, Total Loss: 0.006421 in 2.821 sec
Iter: 13, Total Loss: 0.006412 in 2.809 sec
Iter: 14, Total Loss: 0.006408 in 2.813 sec
Iter: 15, Total Loss: 0.006399 in 2.816 sec
Iter: 16, Total Loss: 0.006393 in 2.831 sec
Iter: 17, Total Loss: 0.006385 in 2.787 sec
Iter: 18, Total Loss: 0.006379 in 2.806 sec
Iter: 19, Total Loss: 0.006373 in 2.796 sec
Iter: 20, Total Loss: 0.006368 in 2.798 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 2.825 with std = 0.027 sec ###
### py4DSTEM ptycho solver is finished in 56.974 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 939.48 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 512, 3, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 473/16384 [00:00<00:03, 4725.66probe position/s]Normalizing amplitudes:   6%|▌         | 963/16384 [00:00<00:03, 4825.32probe position/s]Normalizing amplitudes:   9%|▉         | 1446/16384 [00:00<00:03, 4783.17probe position/s]Normalizing amplitudes:  13%|█▎        | 2135/16384 [00:00<00:02, 5608.56probe position/s]Normalizing amplitudes:  18%|█▊        | 2923/16384 [00:00<00:02, 6420.50probe position/s]Normalizing amplitudes:  22%|██▏       | 3566/16384 [00:00<00:02, 5673.08probe position/s]Normalizing amplitudes:  25%|██▌       | 4148/16384 [00:00<00:02, 5411.65probe position/s]Normalizing amplitudes:  29%|██▊       | 4700/16384 [00:00<00:02, 5230.69probe position/s]Normalizing amplitudes:  32%|███▏      | 5230/16384 [00:00<00:02, 5228.19probe position/s]Normalizing amplitudes:  37%|███▋      | 6011/16384 [00:01<00:01, 5969.30probe position/s]Normalizing amplitudes:  40%|████      | 6617/16384 [00:01<00:01, 5964.35probe position/s]Normalizing amplitudes:  44%|████▍     | 7220/16384 [00:01<00:01, 5504.06probe position/s]Normalizing amplitudes:  47%|████▋     | 7781/16384 [00:01<00:01, 5347.68probe position/s]Normalizing amplitudes:  51%|█████     | 8323/16384 [00:01<00:01, 5179.41probe position/s]Normalizing amplitudes:  55%|█████▍    | 8956/16384 [00:01<00:01, 5496.93probe position/s]Normalizing amplitudes:  59%|█████▉    | 9744/16384 [00:01<00:01, 6170.50probe position/s]Normalizing amplitudes:  63%|██████▎   | 10370/16384 [00:01<00:01, 5736.24probe position/s]Normalizing amplitudes:  67%|██████▋   | 10955/16384 [00:01<00:00, 5440.86probe position/s]Normalizing amplitudes:  70%|███████   | 11509/16384 [00:02<00:00, 5301.52probe position/s]Normalizing amplitudes:  74%|███████▎  | 12046/16384 [00:02<00:00, 5208.42probe position/s]Normalizing amplitudes:  78%|███████▊  | 12823/16384 [00:02<00:00, 5915.25probe position/s]Normalizing amplitudes:  82%|████████▏ | 13453/16384 [00:02<00:00, 6023.99probe position/s]Normalizing amplitudes:  86%|████████▌ | 14063/16384 [00:02<00:00, 5574.90probe position/s]Normalizing amplitudes:  89%|████████▉ | 14631/16384 [00:02<00:00, 5319.24probe position/s]Normalizing amplitudes:  93%|█████████▎| 15172/16384 [00:02<00:00, 5258.42probe position/s]Normalizing amplitudes:  96%|█████████▋| 15794/16384 [00:02<00:00, 5522.32probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5584.34probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random512_p3_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random512_p3_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.03883 in 1.631 sec
Iter: 2, Total Loss: 0.006606 in 1.562 sec
Iter: 3, Total Loss: 0.006477 in 1.569 sec
Iter: 4, Total Loss: 0.00642 in 1.577 sec
Iter: 5, Total Loss: 0.006387 in 1.555 sec
Iter: 6, Total Loss: 0.006362 in 1.596 sec
Iter: 7, Total Loss: 0.006342 in 1.550 sec
Iter: 8, Total Loss: 0.006322 in 1.578 sec
Iter: 9, Total Loss: 0.006304 in 1.557 sec
Iter: 10, Total Loss: 0.006286 in 1.556 sec
Iter: 11, Total Loss: 0.006268 in 1.566 sec
Iter: 12, Total Loss: 0.00625 in 1.545 sec
Iter: 13, Total Loss: 0.006232 in 1.602 sec
Iter: 14, Total Loss: 0.006214 in 1.548 sec
Iter: 15, Total Loss: 0.006196 in 1.610 sec
Iter: 16, Total Loss: 0.006179 in 1.546 sec
Iter: 17, Total Loss: 0.006161 in 1.593 sec
Iter: 18, Total Loss: 0.006144 in 1.587 sec
Iter: 19, Total Loss: 0.006128 in 1.577 sec
Iter: 20, Total Loss: 0.006111 in 1.580 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 1.574 with std = 0.023 sec ###
### py4DSTEM ptycho solver is finished in 31.770 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 939.47 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 512, 3, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 472/16384 [00:00<00:03, 4716.78probe position/s]Normalizing amplitudes:   6%|▋         | 1056/16384 [00:00<00:02, 5376.19probe position/s]Normalizing amplitudes:  11%|█         | 1817/16384 [00:00<00:02, 6394.61probe position/s]Normalizing amplitudes:  15%|█▍        | 2457/16384 [00:00<00:02, 6298.46probe position/s]Normalizing amplitudes:  19%|█▉        | 3088/16384 [00:00<00:02, 5535.69probe position/s]Normalizing amplitudes:  22%|██▏       | 3655/16384 [00:00<00:02, 5196.69probe position/s]Normalizing amplitudes:  26%|██▌       | 4185/16384 [00:00<00:02, 5061.58probe position/s]Normalizing amplitudes:  29%|██▉       | 4828/16384 [00:00<00:02, 5453.77probe position/s]Normalizing amplitudes:  34%|███▍      | 5554/16384 [00:00<00:01, 5977.26probe position/s]Normalizing amplitudes:  38%|███▊      | 6162/16384 [00:01<00:01, 5410.31probe position/s]Normalizing amplitudes:  41%|████      | 6719/16384 [00:01<00:01, 5271.23probe position/s]Normalizing amplitudes:  44%|████▍     | 7257/16384 [00:01<00:01, 5096.98probe position/s]Normalizing amplitudes:  48%|████▊     | 7789/16384 [00:01<00:01, 5156.26probe position/s]Normalizing amplitudes:  52%|█████▏    | 8536/16384 [00:01<00:01, 5806.00probe position/s]Normalizing amplitudes:  56%|█████▌    | 9147/16384 [00:01<00:01, 5892.93probe position/s]Normalizing amplitudes:  59%|█████▉    | 9743/16384 [00:01<00:01, 5568.88probe position/s]Normalizing amplitudes:  63%|██████▎   | 10308/16384 [00:01<00:01, 5392.10probe position/s]Normalizing amplitudes:  66%|██████▌   | 10853/16384 [00:02<00:01, 5080.56probe position/s]Normalizing amplitudes:  69%|██████▉   | 11368/16384 [00:02<00:00, 5076.04probe position/s]Normalizing amplitudes:  73%|███████▎  | 12018/16384 [00:02<00:00, 5471.95probe position/s]Normalizing amplitudes:  77%|███████▋  | 12572/16384 [00:02<00:00, 5180.77probe position/s]Normalizing amplitudes:  80%|███████▉  | 13097/16384 [00:02<00:00, 5148.94probe position/s]Normalizing amplitudes:  83%|████████▎ | 13617/16384 [00:02<00:00, 5087.12probe position/s]Normalizing amplitudes:  86%|████████▌ | 14129/16384 [00:02<00:00, 4993.30probe position/s]Normalizing amplitudes:  90%|████████▉ | 14697/16384 [00:02<00:00, 5185.76probe position/s]Normalizing amplitudes:  93%|█████████▎| 15308/16384 [00:02<00:00, 5446.21probe position/s]Normalizing amplitudes:  97%|█████████▋| 15856/16384 [00:02<00:00, 5098.54probe position/s]Normalizing amplitudes: 100%|█████████▉| 16372/16384 [00:03<00:00, 4888.20probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:03<00:00, 5314.17probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random512_p3_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random512_p3_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.03935 in 3.939 sec
Iter: 2, Total Loss: 0.006762 in 3.860 sec
Iter: 3, Total Loss: 0.006485 in 3.843 sec
Iter: 4, Total Loss: 0.006411 in 3.870 sec
Iter: 5, Total Loss: 0.006367 in 3.842 sec
Iter: 6, Total Loss: 0.006331 in 3.782 sec
Iter: 7, Total Loss: 0.006299 in 3.823 sec
Iter: 8, Total Loss: 0.006269 in 3.834 sec
Iter: 9, Total Loss: 0.006242 in 3.885 sec
Iter: 10, Total Loss: 0.006216 in 3.917 sec
Iter: 11, Total Loss: 0.006191 in 3.838 sec
Iter: 12, Total Loss: 0.006168 in 3.797 sec
Iter: 13, Total Loss: 0.006146 in 3.898 sec
Iter: 14, Total Loss: 0.006125 in 3.868 sec
Iter: 15, Total Loss: 0.006104 in 3.812 sec
Iter: 16, Total Loss: 0.006085 in 3.803 sec
Iter: 17, Total Loss: 0.006065 in 3.783 sec
Iter: 18, Total Loss: 0.006047 in 3.780 sec
Iter: 19, Total Loss: 0.006028 in 3.817 sec
Iter: 20, Total Loss: 0.00601 in 3.764 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 3.838 with std = 0.047 sec ###
### py4DSTEM ptycho solver is finished in 1 min 17.341 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 939.32 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 512, 3, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 533/16384 [00:00<00:02, 5329.24probe position/s]Normalizing amplitudes:   7%|▋         | 1066/16384 [00:00<00:02, 5311.13probe position/s]Normalizing amplitudes:  11%|█         | 1824/16384 [00:00<00:02, 6341.57probe position/s]Normalizing amplitudes:  16%|█▌        | 2588/16384 [00:00<00:02, 6850.36probe position/s]Normalizing amplitudes:  20%|█▉        | 3274/16384 [00:00<00:01, 6791.21probe position/s]Normalizing amplitudes:  25%|██▍       | 4065/16384 [00:00<00:01, 7166.48probe position/s]Normalizing amplitudes:  30%|██▉       | 4847/16384 [00:00<00:01, 7378.02probe position/s]Normalizing amplitudes:  34%|███▍      | 5632/16384 [00:00<00:01, 7525.67probe position/s]Normalizing amplitudes:  39%|███▉      | 6404/16384 [00:00<00:01, 7583.46probe position/s]Normalizing amplitudes:  44%|████▍     | 7191/16384 [00:01<00:01, 7669.03probe position/s]Normalizing amplitudes:  49%|████▊     | 7959/16384 [00:01<00:01, 7664.67probe position/s]Normalizing amplitudes:  53%|█████▎    | 8748/16384 [00:01<00:00, 7730.73probe position/s]Normalizing amplitudes:  58%|█████▊    | 9526/16384 [00:01<00:00, 7744.90probe position/s]Normalizing amplitudes:  63%|██████▎   | 10301/16384 [00:01<00:00, 7417.84probe position/s]Normalizing amplitudes:  67%|██████▋   | 11046/16384 [00:01<00:00, 6749.01probe position/s]Normalizing amplitudes:  72%|███████▏  | 11734/16384 [00:01<00:00, 6400.02probe position/s]Normalizing amplitudes:  76%|███████▌  | 12385/16384 [00:01<00:00, 6162.93probe position/s]Normalizing amplitudes:  80%|████████  | 13124/16384 [00:01<00:00, 6493.08probe position/s]Normalizing amplitudes:  85%|████████▍ | 13902/16384 [00:01<00:00, 6851.21probe position/s]Normalizing amplitudes:  89%|████████▉ | 14597/16384 [00:02<00:00, 6602.24probe position/s]Normalizing amplitudes:  93%|█████████▎| 15265/16384 [00:02<00:00, 6299.94probe position/s]Normalizing amplitudes:  97%|█████████▋| 15902/16384 [00:02<00:00, 6022.21probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6743.02probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random512_p3_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random512_p3_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.04035 in 6.754 sec
Iter: 2, Total Loss: 0.006903 in 6.740 sec
Iter: 3, Total Loss: 0.006513 in 6.729 sec
Iter: 4, Total Loss: 0.006408 in 6.732 sec
Iter: 5, Total Loss: 0.006343 in 6.768 sec
Iter: 6, Total Loss: 0.00629 in 6.721 sec
Iter: 7, Total Loss: 0.006251 in 6.725 sec
Iter: 8, Total Loss: 0.006217 in 6.806 sec
Iter: 9, Total Loss: 0.006186 in 6.791 sec
Iter: 10, Total Loss: 0.006157 in 6.875 sec
Iter: 11, Total Loss: 0.00613 in 6.806 sec
Iter: 12, Total Loss: 0.006106 in 6.801 sec
Iter: 13, Total Loss: 0.00608 in 6.797 sec
Iter: 14, Total Loss: 0.006059 in 6.742 sec
Iter: 15, Total Loss: 0.006035 in 6.772 sec
Iter: 16, Total Loss: 0.006015 in 6.743 sec
Iter: 17, Total Loss: 0.005991 in 6.774 sec
Iter: 18, Total Loss: 0.005972 in 6.781 sec
Iter: 19, Total Loss: 0.005949 in 6.784 sec
Iter: 20, Total Loss: 0.005931 in 6.778 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 6.771 with std = 0.036 sec ###
### py4DSTEM ptycho solver is finished in 2 min 15.802 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 939.31 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 512, 6, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 541/16384 [00:00<00:02, 5403.72probe position/s]Normalizing amplitudes:   7%|▋         | 1090/16384 [00:00<00:02, 5453.50probe position/s]Normalizing amplitudes:  10%|▉         | 1636/16384 [00:00<00:02, 5443.43probe position/s]Normalizing amplitudes:  13%|█▎        | 2187/16384 [00:00<00:02, 5468.69probe position/s]Normalizing amplitudes:  17%|█▋        | 2746/16384 [00:00<00:02, 5512.27probe position/s]Normalizing amplitudes:  22%|██▏       | 3549/16384 [00:00<00:02, 6365.75probe position/s]Normalizing amplitudes:  26%|██▌       | 4202/16384 [00:00<00:01, 6417.54probe position/s]Normalizing amplitudes:  30%|██▉       | 4844/16384 [00:00<00:01, 6081.00probe position/s]Normalizing amplitudes:  33%|███▎      | 5456/16384 [00:00<00:01, 5811.83probe position/s]Normalizing amplitudes:  37%|███▋      | 6042/16384 [00:01<00:01, 5694.65probe position/s]Normalizing amplitudes:  40%|████      | 6615/16384 [00:01<00:01, 5607.59probe position/s]Normalizing amplitudes:  44%|████▍     | 7178/16384 [00:01<00:01, 5559.15probe position/s]Normalizing amplitudes:  48%|████▊     | 7941/16384 [00:01<00:01, 6158.52probe position/s]Normalizing amplitudes:  53%|█████▎    | 8669/16384 [00:01<00:01, 6485.11probe position/s]Normalizing amplitudes:  57%|█████▋    | 9321/16384 [00:01<00:01, 6160.18probe position/s]Normalizing amplitudes:  61%|██████    | 9943/16384 [00:01<00:01, 5977.52probe position/s]Normalizing amplitudes:  64%|██████▍   | 10545/16384 [00:01<00:01, 5837.02probe position/s]Normalizing amplitudes:  68%|██████▊   | 11132/16384 [00:01<00:00, 5748.08probe position/s]Normalizing amplitudes:  71%|███████▏  | 11709/16384 [00:02<00:00, 5709.33probe position/s]Normalizing amplitudes:  76%|███████▌  | 12400/16384 [00:02<00:00, 6052.34probe position/s]Normalizing amplitudes:  81%|████████  | 13202/16384 [00:02<00:00, 6624.47probe position/s]Normalizing amplitudes:  85%|████████▍ | 13868/16384 [00:02<00:00, 6124.62probe position/s]Normalizing amplitudes:  88%|████████▊ | 14490/16384 [00:02<00:00, 5859.41probe position/s]Normalizing amplitudes:  92%|█████████▏| 15084/16384 [00:02<00:00, 5815.36probe position/s]Normalizing amplitudes:  96%|█████████▌| 15671/16384 [00:02<00:00, 5681.55probe position/s]Normalizing amplitudes:  99%|█████████▉| 16243/16384 [00:02<00:00, 5622.77probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5876.33probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random512_p6_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random512_p6_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.1066 in 2.545 sec
Iter: 2, Total Loss: 0.006727 in 2.492 sec
Iter: 3, Total Loss: 0.006527 in 2.489 sec
Iter: 4, Total Loss: 0.006445 in 2.501 sec
Iter: 5, Total Loss: 0.006401 in 2.497 sec
Iter: 6, Total Loss: 0.006371 in 2.498 sec
Iter: 7, Total Loss: 0.006348 in 2.486 sec
Iter: 8, Total Loss: 0.006327 in 2.475 sec
Iter: 9, Total Loss: 0.006306 in 2.511 sec
Iter: 10, Total Loss: 0.006287 in 2.498 sec
Iter: 11, Total Loss: 0.006269 in 2.469 sec
Iter: 12, Total Loss: 0.00625 in 2.485 sec
Iter: 13, Total Loss: 0.006231 in 2.481 sec
Iter: 14, Total Loss: 0.006214 in 2.494 sec
Iter: 15, Total Loss: 0.006195 in 2.477 sec
Iter: 16, Total Loss: 0.006177 in 2.465 sec
Iter: 17, Total Loss: 0.006159 in 2.506 sec
Iter: 18, Total Loss: 0.006142 in 2.474 sec
Iter: 19, Total Loss: 0.006124 in 2.511 sec
Iter: 20, Total Loss: 0.006108 in 2.469 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 2.491 with std = 0.018 sec ###
### py4DSTEM ptycho solver is finished in 50.114 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 939.27 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 512, 6, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 574/16384 [00:00<00:02, 5731.42probe position/s]Normalizing amplitudes:   8%|▊         | 1298/16384 [00:00<00:02, 6614.44probe position/s]Normalizing amplitudes:  13%|█▎        | 2069/16384 [00:00<00:02, 7111.77probe position/s]Normalizing amplitudes:  17%|█▋        | 2781/16384 [00:00<00:02, 6404.12probe position/s]Normalizing amplitudes:  21%|██        | 3431/16384 [00:00<00:02, 6142.89probe position/s]Normalizing amplitudes:  25%|██▍       | 4052/16384 [00:00<00:02, 6012.83probe position/s]Normalizing amplitudes:  28%|██▊       | 4658/16384 [00:00<00:02, 5808.57probe position/s]Normalizing amplitudes:  32%|███▏      | 5285/16384 [00:00<00:01, 5943.95probe position/s]Normalizing amplitudes:  37%|███▋      | 6087/16384 [00:00<00:01, 6559.53probe position/s]Normalizing amplitudes:  41%|████      | 6749/16384 [00:01<00:01, 6339.48probe position/s]Normalizing amplitudes:  45%|████▌     | 7388/16384 [00:01<00:01, 6034.58probe position/s]Normalizing amplitudes:  49%|████▉     | 7997/16384 [00:01<00:01, 5847.17probe position/s]Normalizing amplitudes:  52%|█████▏    | 8586/16384 [00:01<00:01, 5785.38probe position/s]Normalizing amplitudes:  56%|█████▌    | 9167/16384 [00:01<00:01, 5672.44probe position/s]Normalizing amplitudes:  60%|██████    | 9891/16384 [00:01<00:01, 6117.54probe position/s]Normalizing amplitudes:  65%|██████▌   | 10681/16384 [00:01<00:00, 6622.72probe position/s]Normalizing amplitudes:  69%|██████▉   | 11348/16384 [00:01<00:00, 6170.75probe position/s]Normalizing amplitudes:  73%|███████▎  | 11974/16384 [00:01<00:00, 5959.16probe position/s]Normalizing amplitudes:  77%|███████▋  | 12577/16384 [00:02<00:00, 5817.85probe position/s]Normalizing amplitudes:  80%|████████  | 13164/16384 [00:02<00:00, 5708.84probe position/s]Normalizing amplitudes:  84%|████████▍ | 13738/16384 [00:02<00:00, 5693.74probe position/s]Normalizing amplitudes:  89%|████████▊ | 14521/16384 [00:02<00:00, 6302.36probe position/s]Normalizing amplitudes:  93%|█████████▎| 15187/16384 [00:02<00:00, 6405.79probe position/s]Normalizing amplitudes:  97%|█████████▋| 15832/16384 [00:02<00:00, 6147.88probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6081.62probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random512_p6_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random512_p6_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.1059 in 6.713 sec
Iter: 2, Total Loss: 0.007172 in 6.669 sec
Iter: 3, Total Loss: 0.006625 in 6.702 sec
Iter: 4, Total Loss: 0.006477 in 6.737 sec
Iter: 5, Total Loss: 0.006399 in 6.714 sec
Iter: 6, Total Loss: 0.00634 in 6.702 sec
Iter: 7, Total Loss: 0.00629 in 6.661 sec
Iter: 8, Total Loss: 0.006248 in 6.648 sec
Iter: 9, Total Loss: 0.00621 in 6.695 sec
Iter: 10, Total Loss: 0.006174 in 6.677 sec
Iter: 11, Total Loss: 0.006143 in 6.672 sec
Iter: 12, Total Loss: 0.006114 in 6.691 sec
Iter: 13, Total Loss: 0.006085 in 6.724 sec
Iter: 14, Total Loss: 0.006058 in 6.734 sec
Iter: 15, Total Loss: 0.006032 in 6.806 sec
Iter: 16, Total Loss: 0.006007 in 6.755 sec
Iter: 17, Total Loss: 0.005982 in 7.089 sec
Iter: 18, Total Loss: 0.005958 in 6.864 sec
Iter: 19, Total Loss: 0.005935 in 6.803 sec
Iter: 20, Total Loss: 0.005912 in 6.789 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 6.742 with std = 0.096 sec ###
### py4DSTEM ptycho solver is finished in 2 min 15.225 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 939.27 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 512, 6, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 558/16384 [00:00<00:02, 5576.20probe position/s]Normalizing amplitudes:   8%|▊         | 1329/16384 [00:00<00:02, 6829.37probe position/s]Normalizing amplitudes:  12%|█▏        | 2012/16384 [00:00<00:02, 6624.23probe position/s]Normalizing amplitudes:  16%|█▋        | 2676/16384 [00:00<00:02, 5969.77probe position/s]Normalizing amplitudes:  20%|██        | 3282/16384 [00:00<00:02, 5797.93probe position/s]Normalizing amplitudes:  24%|██▎       | 3867/16384 [00:00<00:02, 5650.63probe position/s]Normalizing amplitudes:  27%|██▋       | 4436/16384 [00:00<00:02, 5563.37probe position/s]Normalizing amplitudes:  30%|███       | 4995/16384 [00:00<00:02, 5494.77probe position/s]Normalizing amplitudes:  35%|███▍      | 5725/16384 [00:00<00:01, 6028.94probe position/s]Normalizing amplitudes:  39%|███▉      | 6440/16384 [00:01<00:01, 6360.99probe position/s]Normalizing amplitudes:  43%|████▎     | 7080/16384 [00:01<00:01, 5956.97probe position/s]Normalizing amplitudes:  47%|████▋     | 7683/16384 [00:01<00:01, 5806.01probe position/s]Normalizing amplitudes:  50%|█████     | 8269/16384 [00:01<00:01, 5679.03probe position/s]Normalizing amplitudes:  54%|█████▍    | 8841/16384 [00:01<00:01, 5555.38probe position/s]Normalizing amplitudes:  57%|█████▋    | 9399/16384 [00:01<00:01, 5451.13probe position/s]Normalizing amplitudes:  61%|██████▏   | 10064/16384 [00:01<00:01, 5789.61probe position/s]Normalizing amplitudes:  66%|██████▌   | 10844/16384 [00:01<00:00, 6368.81probe position/s]Normalizing amplitudes:  70%|███████   | 11486/16384 [00:01<00:00, 5951.08probe position/s]Normalizing amplitudes:  74%|███████▍  | 12090/16384 [00:02<00:00, 5712.99probe position/s]Normalizing amplitudes:  77%|███████▋  | 12668/16384 [00:02<00:00, 5616.14probe position/s]Normalizing amplitudes:  81%|████████  | 13234/16384 [00:02<00:00, 5456.11probe position/s]Normalizing amplitudes:  84%|████████▍ | 13783/16384 [00:02<00:00, 5409.05probe position/s]Normalizing amplitudes:  88%|████████▊ | 14432/16384 [00:02<00:00, 5712.68probe position/s]Normalizing amplitudes:  93%|█████████▎| 15208/16384 [00:02<00:00, 6299.57probe position/s]Normalizing amplitudes:  97%|█████████▋| 15843/16384 [00:02<00:00, 6027.84probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5840.45probe position/s]
More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`). Consider using `matplotlib.pyplot.close()`.
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random512_p6_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random512_p6_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.1068 in 13.005 sec
Iter: 2, Total Loss: 0.00783 in 12.918 sec
Iter: 3, Total Loss: 0.006778 in 13.011 sec
Iter: 4, Total Loss: 0.006518 in 12.917 sec
Iter: 5, Total Loss: 0.006384 in 12.987 sec
Iter: 6, Total Loss: 0.006294 in 13.073 sec
Iter: 7, Total Loss: 0.006229 in 13.000 sec
Iter: 8, Total Loss: 0.006177 in 13.048 sec
Iter: 9, Total Loss: 0.006134 in 12.994 sec
Iter: 10, Total Loss: 0.006097 in 13.007 sec
Iter: 11, Total Loss: 0.006064 in 13.009 sec
Iter: 12, Total Loss: 0.006035 in 13.084 sec
Iter: 13, Total Loss: 0.006008 in 13.081 sec
Iter: 14, Total Loss: 0.005982 in 12.970 sec
Iter: 15, Total Loss: 0.005959 in 13.075 sec
Iter: 16, Total Loss: 0.005936 in 12.989 sec
Iter: 17, Total Loss: 0.005914 in 12.998 sec
Iter: 18, Total Loss: 0.005893 in 13.018 sec
Iter: 19, Total Loss: 0.005873 in 13.016 sec
Iter: 20, Total Loss: 0.005853 in 12.843 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 13.002 with std = 0.058 sec ###
### py4DSTEM ptycho solver is finished in 4 min 20.421 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 939.26 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 512, 12, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   5%|▍         | 781/16384 [00:00<00:01, 7808.82probe position/s]Normalizing amplitudes:  10%|▉         | 1562/16384 [00:00<00:02, 6951.23probe position/s]Normalizing amplitudes:  14%|█▍        | 2264/16384 [00:00<00:02, 6428.38probe position/s]Normalizing amplitudes:  18%|█▊        | 2912/16384 [00:00<00:02, 6116.47probe position/s]Normalizing amplitudes:  22%|██▏       | 3527/16384 [00:00<00:02, 5989.60probe position/s]Normalizing amplitudes:  25%|██▌       | 4128/16384 [00:00<00:02, 5861.25probe position/s]Normalizing amplitudes:  29%|██▉       | 4715/16384 [00:00<00:02, 5765.89probe position/s]Normalizing amplitudes:  33%|███▎      | 5454/16384 [00:00<00:01, 6251.83probe position/s]Normalizing amplitudes:  38%|███▊      | 6146/16384 [00:00<00:01, 6449.71probe position/s]Normalizing amplitudes:  41%|████▏     | 6794/16384 [00:01<00:01, 6136.15probe position/s]Normalizing amplitudes:  45%|████▌     | 7413/16384 [00:01<00:01, 5907.04probe position/s]Normalizing amplitudes:  49%|████▉     | 8008/16384 [00:01<00:01, 5892.00probe position/s]Normalizing amplitudes:  52%|█████▏    | 8600/16384 [00:01<00:01, 5820.21probe position/s]Normalizing amplitudes:  56%|█████▌    | 9184/16384 [00:01<00:01, 5796.17probe position/s]Normalizing amplitudes:  60%|█████▉    | 9790/16384 [00:01<00:01, 5872.70probe position/s]Normalizing amplitudes:  65%|██████▍   | 10577/16384 [00:01<00:00, 6457.07probe position/s]Normalizing amplitudes:  69%|██████▊   | 11225/16384 [00:01<00:00, 6308.95probe position/s]Normalizing amplitudes:  72%|███████▏  | 11858/16384 [00:01<00:00, 6087.22probe position/s]Normalizing amplitudes:  76%|███████▌  | 12470/16384 [00:02<00:00, 5902.20probe position/s]Normalizing amplitudes:  80%|███████▉  | 13063/16384 [00:02<00:00, 5797.48probe position/s]Normalizing amplitudes:  83%|████████▎ | 13645/16384 [00:02<00:00, 5732.74probe position/s]Normalizing amplitudes:  87%|████████▋ | 14220/16384 [00:02<00:00, 5727.56probe position/s]Normalizing amplitudes:  91%|█████████ | 14891/16384 [00:02<00:00, 6011.50probe position/s]Normalizing amplitudes:  96%|█████████▌| 15675/16384 [00:02<00:00, 6544.71probe position/s]Normalizing amplitudes: 100%|█████████▉| 16332/16384 [00:02<00:00, 6190.01probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6086.68probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random512_p12_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random512_p12_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.2743 in 4.599 sec
Iter: 2, Total Loss: 0.006924 in 4.552 sec
Iter: 3, Total Loss: 0.006616 in 4.590 sec
Iter: 4, Total Loss: 0.006487 in 4.547 sec
Iter: 5, Total Loss: 0.006418 in 4.588 sec
Iter: 6, Total Loss: 0.006372 in 4.530 sec
Iter: 7, Total Loss: 0.006337 in 4.554 sec
Iter: 8, Total Loss: 0.006307 in 4.561 sec
Iter: 9, Total Loss: 0.006279 in 4.523 sec
Iter: 10, Total Loss: 0.006253 in 4.548 sec
Iter: 11, Total Loss: 0.006228 in 4.543 sec
Iter: 12, Total Loss: 0.006203 in 4.587 sec
Iter: 13, Total Loss: 0.00618 in 4.553 sec
Iter: 14, Total Loss: 0.006157 in 4.593 sec
Iter: 15, Total Loss: 0.006134 in 4.570 sec
Iter: 16, Total Loss: 0.006113 in 4.569 sec
Iter: 17, Total Loss: 0.006091 in 4.536 sec
Iter: 18, Total Loss: 0.00607 in 4.577 sec
Iter: 19, Total Loss: 0.006049 in 4.534 sec
Iter: 20, Total Loss: 0.006029 in 4.568 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 4.561 with std = 0.022 sec ###
### py4DSTEM ptycho solver is finished in 1 min 31.885 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 939.24 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 512, 12, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   5%|▍         | 778/16384 [00:00<00:02, 7778.80probe position/s]Normalizing amplitudes:   9%|▉         | 1556/16384 [00:00<00:02, 7238.82probe position/s]Normalizing amplitudes:  14%|█▍        | 2283/16384 [00:00<00:02, 6339.24probe position/s]Normalizing amplitudes:  18%|█▊        | 2928/16384 [00:00<00:02, 5979.35probe position/s]Normalizing amplitudes:  22%|██▏       | 3533/16384 [00:00<00:02, 5744.05probe position/s]Normalizing amplitudes:  26%|██▌       | 4295/16384 [00:00<00:01, 6316.09probe position/s]Normalizing amplitudes:  31%|███       | 5079/16384 [00:00<00:01, 6778.10probe position/s]Normalizing amplitudes:  35%|███▌      | 5767/16384 [00:00<00:01, 6526.04probe position/s]Normalizing amplitudes:  39%|███▉      | 6428/16384 [00:01<00:01, 6099.37probe position/s]Normalizing amplitudes:  43%|████▎     | 7047/16384 [00:01<00:01, 5894.88probe position/s]Normalizing amplitudes:  47%|████▋     | 7643/16384 [00:01<00:01, 5792.96probe position/s]Normalizing amplitudes:  51%|█████▏    | 8433/16384 [00:01<00:01, 6383.13probe position/s]Normalizing amplitudes:  56%|█████▌    | 9213/16384 [00:01<00:01, 6787.94probe position/s]Normalizing amplitudes:  60%|██████    | 9900/16384 [00:01<00:01, 6442.65probe position/s]Normalizing amplitudes:  64%|██████▍   | 10553/16384 [00:01<00:00, 6104.63probe position/s]Normalizing amplitudes:  68%|██████▊   | 11172/16384 [00:01<00:00, 5839.63probe position/s]Normalizing amplitudes:  72%|███████▏  | 11826/16384 [00:01<00:00, 6029.32probe position/s]Normalizing amplitudes:  77%|███████▋  | 12568/16384 [00:01<00:00, 6418.69probe position/s]Normalizing amplitudes:  81%|████████▏ | 13314/16384 [00:02<00:00, 6715.16probe position/s]Normalizing amplitudes:  85%|████████▌ | 13993/16384 [00:02<00:00, 6259.41probe position/s]Normalizing amplitudes:  89%|████████▉ | 14629/16384 [00:02<00:00, 5937.65probe position/s]Normalizing amplitudes:  93%|█████████▎| 15232/16384 [00:02<00:00, 5755.36probe position/s]Normalizing amplitudes:  97%|█████████▋| 15958/16384 [00:02<00:00, 6164.51probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6269.10probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random512_p12_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random512_p12_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.2706 in 12.764 sec
Iter: 2, Total Loss: 0.007614 in 12.772 sec
Iter: 3, Total Loss: 0.006802 in 12.730 sec
Iter: 4, Total Loss: 0.006554 in 12.736 sec
Iter: 5, Total Loss: 0.006424 in 13.074 sec
Iter: 6, Total Loss: 0.006334 in 13.083 sec
Iter: 7, Total Loss: 0.006267 in 13.081 sec
Iter: 8, Total Loss: 0.006212 in 13.134 sec
Iter: 9, Total Loss: 0.006164 in 13.132 sec
Iter: 10, Total Loss: 0.006123 in 13.122 sec
Iter: 11, Total Loss: 0.006086 in 13.041 sec
Iter: 12, Total Loss: 0.006051 in 13.065 sec
Iter: 13, Total Loss: 0.006019 in 13.055 sec
Iter: 14, Total Loss: 0.005989 in 13.091 sec
Iter: 15, Total Loss: 0.00596 in 12.990 sec
Iter: 16, Total Loss: 0.005932 in 12.958 sec
Iter: 17, Total Loss: 0.005906 in 12.923 sec
Iter: 18, Total Loss: 0.00588 in 12.930 sec
Iter: 19, Total Loss: 0.005855 in 12.955 sec
Iter: 20, Total Loss: 0.00583 in 12.901 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 12.977 with std = 0.132 sec ###
### py4DSTEM ptycho solver is finished in 4 min 19.954 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 939.21 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 512, 12, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 549/16384 [00:00<00:02, 5479.27probe position/s]Normalizing amplitudes:   7%|▋         | 1189/16384 [00:00<00:02, 6019.94probe position/s]Normalizing amplitudes:  12%|█▏        | 1972/16384 [00:00<00:02, 6843.91probe position/s]Normalizing amplitudes:  16%|█▌        | 2657/16384 [00:00<00:02, 6434.12probe position/s]Normalizing amplitudes:  20%|██        | 3304/16384 [00:00<00:02, 6115.49probe position/s]Normalizing amplitudes:  24%|██▍       | 3920/16384 [00:00<00:02, 5960.31probe position/s]Normalizing amplitudes:  28%|██▊       | 4519/16384 [00:00<00:02, 5695.67probe position/s]Normalizing amplitudes:  31%|███       | 5092/16384 [00:00<00:02, 5611.43probe position/s]Normalizing amplitudes:  36%|███▌      | 5858/16384 [00:00<00:01, 6210.79probe position/s]Normalizing amplitudes:  40%|███▉      | 6545/16384 [00:01<00:01, 6403.82probe position/s]Normalizing amplitudes:  44%|████▍     | 7190/16384 [00:01<00:01, 6056.46probe position/s]Normalizing amplitudes:  48%|████▊     | 7802/16384 [00:01<00:01, 5769.90probe position/s]Normalizing amplitudes:  51%|█████     | 8385/16384 [00:01<00:01, 5717.04probe position/s]Normalizing amplitudes:  55%|█████▍    | 8961/16384 [00:01<00:01, 5616.88probe position/s]Normalizing amplitudes:  58%|█████▊    | 9548/16384 [00:01<00:01, 5688.31probe position/s]Normalizing amplitudes:  63%|██████▎   | 10334/16384 [00:01<00:00, 6314.23probe position/s]Normalizing amplitudes:  67%|██████▋   | 10970/16384 [00:01<00:00, 6201.02probe position/s]Normalizing amplitudes:  71%|███████   | 11594/16384 [00:01<00:00, 5852.16probe position/s]Normalizing amplitudes:  74%|███████▍  | 12185/16384 [00:02<00:00, 5715.90probe position/s]Normalizing amplitudes:  78%|███████▊  | 12761/16384 [00:02<00:00, 5680.24probe position/s]Normalizing amplitudes:  81%|████████▏ | 13332/16384 [00:02<00:00, 5628.91probe position/s]Normalizing amplitudes:  85%|████████▍ | 13917/16384 [00:02<00:00, 5690.30probe position/s]Normalizing amplitudes:  90%|████████▉ | 14706/16384 [00:02<00:00, 6328.65probe position/s]Normalizing amplitudes:  94%|█████████▎| 15342/16384 [00:02<00:00, 6252.49probe position/s]Normalizing amplitudes:  97%|█████████▋| 15970/16384 [00:02<00:00, 5950.38probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5930.04probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random512_p12_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random512_p12_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.2706 in 25.420 sec
Iter: 2, Total Loss: 0.009172 in 25.405 sec
Iter: 3, Total Loss: 0.007287 in 25.324 sec
Iter: 4, Total Loss: 0.006748 in 25.341 sec
Iter: 5, Total Loss: 0.006494 in 25.312 sec
Iter: 6, Total Loss: 0.006339 in 25.234 sec
Iter: 7, Total Loss: 0.006231 in 24.992 sec
Iter: 8, Total Loss: 0.006151 in 25.080 sec
Iter: 9, Total Loss: 0.006088 in 24.996 sec
Iter: 10, Total Loss: 0.006036 in 25.430 sec
Iter: 11, Total Loss: 0.005993 in 25.312 sec
Iter: 12, Total Loss: 0.005955 in 25.640 sec
Iter: 13, Total Loss: 0.00592 in 26.020 sec
Iter: 14, Total Loss: 0.005888 in 25.924 sec
Iter: 15, Total Loss: 0.00586 in 25.702 sec
Iter: 16, Total Loss: 0.005834 in 25.886 sec
Iter: 17, Total Loss: 0.005809 in 26.052 sec
Iter: 18, Total Loss: 0.005785 in 26.094 sec
Iter: 19, Total Loss: 0.005763 in 26.053 sec
Iter: 20, Total Loss: 0.005742 in 26.189 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 25.570 with std = 0.381 sec ###
### py4DSTEM ptycho solver is finished in 8 min 31.905 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 939.22 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 256, 1, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 526/16384 [00:00<00:03, 5253.15probe position/s]Normalizing amplitudes:   7%|▋         | 1101/16384 [00:00<00:02, 5540.67probe position/s]Normalizing amplitudes:  10%|█         | 1656/16384 [00:00<00:02, 5468.90probe position/s]Normalizing amplitudes:  13%|█▎        | 2203/16384 [00:00<00:02, 5441.14probe position/s]Normalizing amplitudes:  18%|█▊        | 2958/16384 [00:00<00:02, 6193.26probe position/s]Normalizing amplitudes:  22%|██▏       | 3630/16384 [00:00<00:02, 6368.70probe position/s]Normalizing amplitudes:  26%|██▌       | 4268/16384 [00:00<00:02, 5972.95probe position/s]Normalizing amplitudes:  30%|██▉       | 4871/16384 [00:00<00:02, 5726.96probe position/s]Normalizing amplitudes:  33%|███▎      | 5449/16384 [00:00<00:01, 5634.47probe position/s]Normalizing amplitudes:  37%|███▋      | 6016/16384 [00:01<00:01, 5515.80probe position/s]Normalizing amplitudes:  40%|████      | 6570/16384 [00:01<00:01, 5459.11probe position/s]Normalizing amplitudes:  44%|████▍     | 7219/16384 [00:01<00:01, 5757.44probe position/s]Normalizing amplitudes:  49%|████▉     | 8003/16384 [00:01<00:01, 6365.05probe position/s]Normalizing amplitudes:  53%|█████▎    | 8644/16384 [00:01<00:01, 5980.95probe position/s]Normalizing amplitudes:  56%|█████▋    | 9249/16384 [00:01<00:01, 5703.65probe position/s]Normalizing amplitudes:  60%|█████▉    | 9826/16384 [00:01<00:01, 5639.86probe position/s]Normalizing amplitudes:  63%|██████▎   | 10395/16384 [00:01<00:01, 5547.72probe position/s]Normalizing amplitudes:  67%|██████▋   | 10953/16384 [00:01<00:00, 5457.11probe position/s]Normalizing amplitudes:  70%|███████   | 11501/16384 [00:02<00:00, 5448.47probe position/s]Normalizing amplitudes:  75%|███████▍  | 12287/16384 [00:02<00:00, 6140.78probe position/s]Normalizing amplitudes:  79%|███████▉  | 12909/16384 [00:02<00:00, 6162.02probe position/s]Normalizing amplitudes:  83%|████████▎ | 13528/16384 [00:02<00:00, 5891.13probe position/s]Normalizing amplitudes:  86%|████████▌ | 14122/16384 [00:02<00:00, 5727.18probe position/s]Normalizing amplitudes:  90%|████████▉ | 14698/16384 [00:02<00:00, 5641.83probe position/s]Normalizing amplitudes:  93%|█████████▎| 15265/16384 [00:02<00:00, 5577.91probe position/s]Normalizing amplitudes:  97%|█████████▋| 15825/16384 [00:02<00:00, 5522.68probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5751.31probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random256_p1_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random256_p1_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.01046 in 0.899 sec
Iter: 2, Total Loss: 0.006511 in 0.862 sec
Iter: 3, Total Loss: 0.006487 in 0.861 sec
Iter: 4, Total Loss: 0.006475 in 0.873 sec
Iter: 5, Total Loss: 0.006465 in 0.870 sec
Iter: 6, Total Loss: 0.006459 in 0.882 sec
Iter: 7, Total Loss: 0.006453 in 0.877 sec
Iter: 8, Total Loss: 0.006445 in 0.883 sec
Iter: 9, Total Loss: 0.006439 in 0.880 sec
Iter: 10, Total Loss: 0.006432 in 0.867 sec
Iter: 11, Total Loss: 0.006425 in 0.804 sec
Iter: 12, Total Loss: 0.006418 in 0.812 sec
Iter: 13, Total Loss: 0.00641 in 0.820 sec
Iter: 14, Total Loss: 0.006403 in 0.821 sec
Iter: 15, Total Loss: 0.006395 in 0.813 sec
Iter: 16, Total Loss: 0.006387 in 0.819 sec
Iter: 17, Total Loss: 0.00638 in 0.817 sec
Iter: 18, Total Loss: 0.006372 in 0.813 sec
Iter: 19, Total Loss: 0.006364 in 0.805 sec
Iter: 20, Total Loss: 0.006356 in 0.806 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 0.844 with std = 0.032 sec ###
### py4DSTEM ptycho solver is finished in 17.180 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 939.21 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 256, 1, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 574/16384 [00:00<00:02, 5688.79probe position/s]Normalizing amplitudes:   7%|▋         | 1198/16384 [00:00<00:02, 6010.49probe position/s]Normalizing amplitudes:  12%|█▏        | 1990/16384 [00:00<00:02, 6877.94probe position/s]Normalizing amplitudes:  16%|█▋        | 2679/16384 [00:00<00:02, 6837.70probe position/s]Normalizing amplitudes:  21%|██        | 3363/16384 [00:00<00:01, 6525.50probe position/s]Normalizing amplitudes:  25%|██▍       | 4018/16384 [00:00<00:01, 6257.22probe position/s]Normalizing amplitudes:  28%|██▊       | 4647/16384 [00:00<00:01, 6214.00probe position/s]Normalizing amplitudes:  32%|███▏      | 5271/16384 [00:00<00:01, 6107.69probe position/s]Normalizing amplitudes:  36%|███▌      | 5924/16384 [00:00<00:01, 6233.85probe position/s]Normalizing amplitudes:  41%|████      | 6717/16384 [00:01<00:01, 6740.10probe position/s]Normalizing amplitudes:  45%|████▌     | 7394/16384 [00:01<00:01, 6598.97probe position/s]Normalizing amplitudes:  49%|████▉     | 8056/16384 [00:01<00:01, 6352.82probe position/s]Normalizing amplitudes:  53%|█████▎    | 8695/16384 [00:01<00:01, 6265.41probe position/s]Normalizing amplitudes:  57%|█████▋    | 9324/16384 [00:01<00:01, 6130.65probe position/s]Normalizing amplitudes:  61%|██████    | 9939/16384 [00:01<00:01, 6053.44probe position/s]Normalizing amplitudes:  65%|██████▍   | 10641/16384 [00:01<00:00, 6331.71probe position/s]Normalizing amplitudes:  70%|██████▉   | 11441/16384 [00:01<00:00, 6815.82probe position/s]Normalizing amplitudes:  74%|███████▍  | 12126/16384 [00:01<00:00, 6481.40probe position/s]Normalizing amplitudes:  78%|███████▊  | 12780/16384 [00:02<00:00, 6276.17probe position/s]Normalizing amplitudes:  82%|████████▏ | 13412/16384 [00:02<00:00, 6201.68probe position/s]Normalizing amplitudes:  86%|████████▌ | 14035/16384 [00:02<00:00, 6130.28probe position/s]Normalizing amplitudes:  89%|████████▉ | 14650/16384 [00:02<00:00, 6046.98probe position/s]Normalizing amplitudes:  94%|█████████▍| 15382/16384 [00:02<00:00, 6412.26probe position/s]Normalizing amplitudes:  99%|█████████▊| 16139/16384 [00:02<00:00, 6723.06probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6373.22probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random256_p1_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random256_p1_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.01066 in 1.809 sec
Iter: 2, Total Loss: 0.006518 in 1.741 sec
Iter: 3, Total Loss: 0.006496 in 1.755 sec
Iter: 4, Total Loss: 0.006483 in 1.772 sec
Iter: 5, Total Loss: 0.006471 in 1.738 sec
Iter: 6, Total Loss: 0.00646 in 1.770 sec
Iter: 7, Total Loss: 0.00645 in 1.744 sec
Iter: 8, Total Loss: 0.00644 in 1.765 sec
Iter: 9, Total Loss: 0.00643 in 1.769 sec
Iter: 10, Total Loss: 0.006418 in 1.735 sec
Iter: 11, Total Loss: 0.00641 in 1.762 sec
Iter: 12, Total Loss: 0.006401 in 1.750 sec
Iter: 13, Total Loss: 0.006389 in 1.754 sec
Iter: 14, Total Loss: 0.00638 in 1.762 sec
Iter: 15, Total Loss: 0.00637 in 1.766 sec
Iter: 16, Total Loss: 0.006361 in 1.766 sec
Iter: 17, Total Loss: 0.006352 in 1.743 sec
Iter: 18, Total Loss: 0.006342 in 1.752 sec
Iter: 19, Total Loss: 0.006333 in 1.734 sec
Iter: 20, Total Loss: 0.006324 in 1.771 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 1.758 with std = 0.017 sec ###
### py4DSTEM ptycho solver is finished in 35.497 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 939.20 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 256, 1, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 656/16384 [00:00<00:02, 6537.45probe position/s]Normalizing amplitudes:   8%|▊         | 1310/16384 [00:00<00:02, 6157.10probe position/s]Normalizing amplitudes:  12%|█▏        | 1928/16384 [00:00<00:02, 6011.52probe position/s]Normalizing amplitudes:  15%|█▌        | 2530/16384 [00:00<00:02, 6007.65probe position/s]Normalizing amplitudes:  19%|█▉        | 3132/16384 [00:00<00:02, 6000.37probe position/s]Normalizing amplitudes:  23%|██▎       | 3745/16384 [00:00<00:02, 6041.56probe position/s]Normalizing amplitudes:  28%|██▊       | 4542/16384 [00:00<00:01, 6662.36probe position/s]Normalizing amplitudes:  32%|███▏      | 5210/16384 [00:00<00:01, 6540.49probe position/s]Normalizing amplitudes:  36%|███▌      | 5866/16384 [00:00<00:01, 6362.75probe position/s]Normalizing amplitudes:  40%|███▉      | 6504/16384 [00:01<00:01, 6159.39probe position/s]Normalizing amplitudes:  43%|████▎     | 7122/16384 [00:01<00:01, 6111.86probe position/s]Normalizing amplitudes:  47%|████▋     | 7735/16384 [00:01<00:01, 6059.30probe position/s]Normalizing amplitudes:  51%|█████     | 8376/16384 [00:01<00:01, 6160.89probe position/s]Normalizing amplitudes:  56%|█████▌    | 9168/16384 [00:01<00:01, 6677.38probe position/s]Normalizing amplitudes:  60%|██████    | 9838/16384 [00:01<00:00, 6554.99probe position/s]Normalizing amplitudes:  64%|██████▍   | 10496/16384 [00:01<00:00, 6264.86probe position/s]Normalizing amplitudes:  68%|██████▊   | 11126/16384 [00:01<00:00, 6186.72probe position/s]Normalizing amplitudes:  72%|███████▏  | 11747/16384 [00:01<00:00, 6125.58probe position/s]Normalizing amplitudes:  75%|███████▌  | 12361/16384 [00:01<00:00, 6033.95probe position/s]Normalizing amplitudes:  79%|███████▉  | 13010/16384 [00:02<00:00, 6163.73probe position/s]Normalizing amplitudes:  84%|████████▍ | 13805/16384 [00:02<00:00, 6684.41probe position/s]Normalizing amplitudes:  88%|████████▊ | 14476/16384 [00:02<00:00, 6495.90probe position/s]Normalizing amplitudes:  92%|█████████▏| 15129/16384 [00:02<00:00, 6306.80probe position/s]Normalizing amplitudes:  96%|█████████▌| 15763/16384 [00:02<00:00, 6216.15probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6240.41probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random256_p1_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random256_p1_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.01096 in 3.175 sec
Iter: 2, Total Loss: 0.00656 in 3.087 sec
Iter: 3, Total Loss: 0.006533 in 3.116 sec
Iter: 4, Total Loss: 0.006515 in 3.131 sec
Iter: 5, Total Loss: 0.006498 in 3.109 sec
Iter: 6, Total Loss: 0.006482 in 3.116 sec
Iter: 7, Total Loss: 0.006466 in 3.125 sec
Iter: 8, Total Loss: 0.006453 in 3.108 sec
Iter: 9, Total Loss: 0.00644 in 3.115 sec
Iter: 10, Total Loss: 0.006427 in 3.118 sec
Iter: 11, Total Loss: 0.006415 in 3.086 sec
Iter: 12, Total Loss: 0.006401 in 3.280 sec
Iter: 13, Total Loss: 0.006389 in 3.235 sec
Iter: 14, Total Loss: 0.006376 in 3.258 sec
Iter: 15, Total Loss: 0.006364 in 3.287 sec
Iter: 16, Total Loss: 0.006352 in 3.219 sec
Iter: 17, Total Loss: 0.00634 in 3.266 sec
Iter: 18, Total Loss: 0.006327 in 3.282 sec
Iter: 19, Total Loss: 0.006315 in 3.231 sec
Iter: 20, Total Loss: 0.006303 in 3.290 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 3.182 with std = 0.075 sec ###
### py4DSTEM ptycho solver is finished in 1 min 4.057 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 939.20 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 256, 3, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 537/16384 [00:00<00:02, 5363.19probe position/s]Normalizing amplitudes:   7%|▋         | 1084/16384 [00:00<00:02, 5422.36probe position/s]Normalizing amplitudes:  10%|█         | 1649/16384 [00:00<00:02, 5525.40probe position/s]Normalizing amplitudes:  13%|█▎        | 2202/16384 [00:00<00:02, 5491.66probe position/s]Normalizing amplitudes:  17%|█▋        | 2752/16384 [00:00<00:02, 5447.35probe position/s]Normalizing amplitudes:  21%|██        | 3418/16384 [00:00<00:02, 5854.13probe position/s]Normalizing amplitudes:  26%|██▌       | 4211/16384 [00:00<00:01, 6526.45probe position/s]Normalizing amplitudes:  30%|██▉       | 4865/16384 [00:00<00:01, 6160.23probe position/s]Normalizing amplitudes:  33%|███▎      | 5486/16384 [00:00<00:01, 5822.86probe position/s]Normalizing amplitudes:  37%|███▋      | 6074/16384 [00:01<00:01, 5712.87probe position/s]Normalizing amplitudes:  41%|████      | 6649/16384 [00:01<00:01, 5671.02probe position/s]Normalizing amplitudes:  44%|████▍     | 7219/16384 [00:01<00:01, 5574.82probe position/s]Normalizing amplitudes:  48%|████▊     | 7913/16384 [00:01<00:01, 5966.32probe position/s]Normalizing amplitudes:  53%|█████▎    | 8702/16384 [00:01<00:01, 6525.71probe position/s]Normalizing amplitudes:  57%|█████▋    | 9359/16384 [00:01<00:01, 5982.17probe position/s]Normalizing amplitudes:  61%|██████    | 9969/16384 [00:01<00:01, 5855.66probe position/s]Normalizing amplitudes:  64%|██████▍   | 10563/16384 [00:01<00:01, 5692.65probe position/s]Normalizing amplitudes:  68%|██████▊   | 11138/16384 [00:01<00:00, 5599.45probe position/s]Normalizing amplitudes:  71%|███████▏  | 11702/16384 [00:02<00:00, 5578.93probe position/s]Normalizing amplitudes:  76%|███████▌  | 12447/16384 [00:02<00:00, 6109.81probe position/s]Normalizing amplitudes:  80%|████████  | 13152/16384 [00:02<00:00, 6376.84probe position/s]Normalizing amplitudes:  84%|████████▍ | 13794/16384 [00:02<00:00, 6012.47probe position/s]Normalizing amplitudes:  88%|████████▊ | 14402/16384 [00:02<00:00, 5806.25probe position/s]Normalizing amplitudes:  91%|█████████▏| 14988/16384 [00:02<00:00, 5718.70probe position/s]Normalizing amplitudes:  95%|█████████▍| 15564/16384 [00:02<00:00, 5529.40probe position/s]Normalizing amplitudes:  98%|█████████▊| 16120/16384 [00:02<00:00, 5529.12probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5809.85probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random256_p3_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random256_p3_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.02266 in 1.830 sec
Iter: 2, Total Loss: 0.006527 in 1.782 sec
Iter: 3, Total Loss: 0.006426 in 1.762 sec
Iter: 4, Total Loss: 0.006376 in 1.824 sec
Iter: 5, Total Loss: 0.006341 in 1.799 sec
Iter: 6, Total Loss: 0.00631 in 1.751 sec
Iter: 7, Total Loss: 0.00628 in 1.809 sec
Iter: 8, Total Loss: 0.00625 in 1.798 sec
Iter: 9, Total Loss: 0.006221 in 1.739 sec
Iter: 10, Total Loss: 0.006192 in 1.814 sec
Iter: 11, Total Loss: 0.006163 in 1.778 sec
Iter: 12, Total Loss: 0.006134 in 1.726 sec
Iter: 13, Total Loss: 0.006106 in 1.791 sec
Iter: 14, Total Loss: 0.006079 in 1.766 sec
Iter: 15, Total Loss: 0.006052 in 1.752 sec
Iter: 16, Total Loss: 0.006026 in 1.802 sec
Iter: 17, Total Loss: 0.005999 in 1.813 sec
Iter: 18, Total Loss: 0.005973 in 1.769 sec
Iter: 19, Total Loss: 0.005948 in 1.785 sec
Iter: 20, Total Loss: 0.005923 in 1.779 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 1.784 with std = 0.028 sec ###
### py4DSTEM ptycho solver is finished in 35.985 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 939.19 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 256, 3, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 536/16384 [00:00<00:02, 5335.38probe position/s]Normalizing amplitudes:   7%|▋         | 1085/16384 [00:00<00:02, 5425.84probe position/s]Normalizing amplitudes:  11%|█         | 1753/16384 [00:00<00:02, 5996.42probe position/s]Normalizing amplitudes:  16%|█▌        | 2541/16384 [00:00<00:02, 6738.40probe position/s]Normalizing amplitudes:  20%|█▉        | 3215/16384 [00:00<00:02, 6189.77probe position/s]Normalizing amplitudes:  23%|██▎       | 3841/16384 [00:00<00:02, 5914.61probe position/s]Normalizing amplitudes:  27%|██▋       | 4439/16384 [00:00<00:02, 5827.59probe position/s]Normalizing amplitudes:  31%|███       | 5026/16384 [00:00<00:02, 5644.83probe position/s]Normalizing amplitudes:  34%|███▍      | 5594/16384 [00:00<00:01, 5586.07probe position/s]Normalizing amplitudes:  38%|███▊      | 6276/16384 [00:01<00:01, 5944.15probe position/s]Normalizing amplitudes:  43%|████▎     | 7074/16384 [00:01<00:01, 6541.03probe position/s]Normalizing amplitudes:  47%|████▋     | 7733/16384 [00:01<00:01, 6029.17probe position/s]Normalizing amplitudes:  51%|█████     | 8347/16384 [00:01<00:01, 5806.45probe position/s]Normalizing amplitudes:  55%|█████▍    | 8936/16384 [00:01<00:01, 5706.27probe position/s]Normalizing amplitudes:  58%|█████▊    | 9512/16384 [00:01<00:01, 5644.65probe position/s]Normalizing amplitudes:  62%|██████▏   | 10080/16384 [00:01<00:01, 5573.74probe position/s]Normalizing amplitudes:  66%|██████▌   | 10743/16384 [00:01<00:00, 5872.69probe position/s]Normalizing amplitudes:  70%|███████   | 11543/16384 [00:01<00:00, 6486.12probe position/s]Normalizing amplitudes:  74%|███████▍  | 12197/16384 [00:02<00:00, 6067.67probe position/s]Normalizing amplitudes:  78%|███████▊  | 12812/16384 [00:02<00:00, 5739.78probe position/s]Normalizing amplitudes:  82%|████████▏ | 13394/16384 [00:02<00:00, 5667.85probe position/s]Normalizing amplitudes:  85%|████████▌ | 13966/16384 [00:02<00:00, 5650.86probe position/s]Normalizing amplitudes:  89%|████████▊ | 14535/16384 [00:02<00:00, 5487.00probe position/s]Normalizing amplitudes:  93%|█████████▎| 15235/16384 [00:02<00:00, 5912.54probe position/s]Normalizing amplitudes:  98%|█████████▊| 16035/16384 [00:02<00:00, 6509.44probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5930.23probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random256_p3_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random256_p3_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.02394 in 4.561 sec
Iter: 2, Total Loss: 0.006544 in 4.486 sec
Iter: 3, Total Loss: 0.006361 in 4.462 sec
Iter: 4, Total Loss: 0.006293 in 4.504 sec
Iter: 5, Total Loss: 0.006242 in 4.459 sec
Iter: 6, Total Loss: 0.006197 in 4.437 sec
Iter: 7, Total Loss: 0.006158 in 4.440 sec
Iter: 8, Total Loss: 0.006122 in 4.454 sec
Iter: 9, Total Loss: 0.006086 in 4.497 sec
Iter: 10, Total Loss: 0.006053 in 4.539 sec
Iter: 11, Total Loss: 0.006021 in 4.526 sec
Iter: 12, Total Loss: 0.005989 in 4.458 sec
Iter: 13, Total Loss: 0.00596 in 4.449 sec
Iter: 14, Total Loss: 0.00593 in 4.411 sec
Iter: 15, Total Loss: 0.005902 in 4.451 sec
Iter: 16, Total Loss: 0.005875 in 4.454 sec
Iter: 17, Total Loss: 0.005848 in 4.498 sec
Iter: 18, Total Loss: 0.005822 in 4.437 sec
Iter: 19, Total Loss: 0.005797 in 4.479 sec
Iter: 20, Total Loss: 0.005773 in 4.412 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 4.471 with std = 0.039 sec ###
### py4DSTEM ptycho solver is finished in 1 min 29.831 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 938.98 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 256, 3, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   5%|▍         | 781/16384 [00:00<00:02, 7800.28probe position/s]Normalizing amplitudes:  10%|▉         | 1562/16384 [00:00<00:02, 6730.07probe position/s]Normalizing amplitudes:  14%|█▎        | 2245/16384 [00:00<00:02, 6131.09probe position/s]Normalizing amplitudes:  17%|█▋        | 2866/16384 [00:00<00:02, 5886.03probe position/s]Normalizing amplitudes:  21%|██        | 3459/16384 [00:00<00:02, 5701.00probe position/s]Normalizing amplitudes:  25%|██▍       | 4031/16384 [00:00<00:02, 5603.15probe position/s]Normalizing amplitudes:  29%|██▊       | 4689/16384 [00:00<00:01, 5897.09probe position/s]Normalizing amplitudes:  33%|███▎      | 5473/16384 [00:00<00:01, 6481.13probe position/s]Normalizing amplitudes:  37%|███▋      | 6127/16384 [00:01<00:01, 6152.47probe position/s]Normalizing amplitudes:  41%|████      | 6749/16384 [00:01<00:01, 6002.43probe position/s]Normalizing amplitudes:  45%|████▍     | 7354/16384 [00:01<00:01, 5883.08probe position/s]Normalizing amplitudes:  48%|████▊     | 7946/16384 [00:01<00:01, 5734.80probe position/s]Normalizing amplitudes:  52%|█████▏    | 8522/16384 [00:01<00:01, 5647.02probe position/s]Normalizing amplitudes:  56%|█████▌    | 9115/16384 [00:01<00:01, 5727.55probe position/s]Normalizing amplitudes:  60%|██████    | 9899/16384 [00:01<00:01, 6338.57probe position/s]Normalizing amplitudes:  64%|██████▍   | 10537/16384 [00:01<00:00, 6246.90probe position/s]Normalizing amplitudes:  68%|██████▊   | 11165/16384 [00:01<00:00, 6014.07probe position/s]Normalizing amplitudes:  72%|███████▏  | 11770/16384 [00:01<00:00, 5848.04probe position/s]Normalizing amplitudes:  75%|███████▌  | 12358/16384 [00:02<00:00, 5684.82probe position/s]Normalizing amplitudes:  79%|███████▉  | 12929/16384 [00:02<00:00, 5583.59probe position/s]Normalizing amplitudes:  82%|████████▏ | 13505/16384 [00:02<00:00, 5631.49probe position/s]Normalizing amplitudes:  87%|████████▋ | 14289/16384 [00:02<00:00, 6265.99probe position/s]Normalizing amplitudes:  91%|█████████ | 14923/16384 [00:02<00:00, 6281.22probe position/s]Normalizing amplitudes:  95%|█████████▍| 15554/16384 [00:02<00:00, 5915.67probe position/s]Normalizing amplitudes:  99%|█████████▊| 16152/16384 [00:02<00:00, 5820.33probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5950.58probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random256_p3_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random256_p3_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.02429 in 8.736 sec
Iter: 2, Total Loss: 0.00653 in 8.632 sec
Iter: 3, Total Loss: 0.006326 in 8.680 sec
Iter: 4, Total Loss: 0.006241 in 8.731 sec
Iter: 5, Total Loss: 0.006177 in 8.766 sec
Iter: 6, Total Loss: 0.006124 in 8.709 sec
Iter: 7, Total Loss: 0.006077 in 8.672 sec
Iter: 8, Total Loss: 0.006032 in 8.751 sec
Iter: 9, Total Loss: 0.005992 in 8.682 sec
Iter: 10, Total Loss: 0.005953 in 8.692 sec
Iter: 11, Total Loss: 0.005916 in 8.703 sec
Iter: 12, Total Loss: 0.005882 in 8.666 sec
Iter: 13, Total Loss: 0.005848 in 8.640 sec
Iter: 14, Total Loss: 0.005815 in 8.592 sec
Iter: 15, Total Loss: 0.005784 in 8.624 sec
Iter: 16, Total Loss: 0.005753 in 8.657 sec
Iter: 17, Total Loss: 0.005724 in 8.750 sec
Iter: 18, Total Loss: 0.005696 in 8.715 sec
Iter: 19, Total Loss: 0.00567 in 8.685 sec
Iter: 20, Total Loss: 0.005643 in 8.664 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 8.687 with std = 0.045 sec ###
### py4DSTEM ptycho solver is finished in 2 min 54.190 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 939.19 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 256, 6, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 563/16384 [00:00<00:02, 5624.37probe position/s]Normalizing amplitudes:   7%|▋         | 1126/16384 [00:00<00:02, 5504.60probe position/s]Normalizing amplitudes:  10%|█         | 1677/16384 [00:00<00:02, 5462.35probe position/s]Normalizing amplitudes:  14%|█▎        | 2224/16384 [00:00<00:02, 5444.18probe position/s]Normalizing amplitudes:  18%|█▊        | 2877/16384 [00:00<00:02, 5829.94probe position/s]Normalizing amplitudes:  22%|██▏       | 3662/16384 [00:00<00:01, 6509.03probe position/s]Normalizing amplitudes:  26%|██▋       | 4314/16384 [00:00<00:01, 6064.72probe position/s]Normalizing amplitudes:  30%|███       | 4927/16384 [00:00<00:01, 5769.84probe position/s]Normalizing amplitudes:  34%|███▎      | 5510/16384 [00:00<00:01, 5652.40probe position/s]Normalizing amplitudes:  37%|███▋      | 6079/16384 [00:01<00:01, 5538.48probe position/s]Normalizing amplitudes:  41%|████      | 6636/16384 [00:01<00:01, 5454.51probe position/s]Normalizing amplitudes:  44%|████▍     | 7279/16384 [00:01<00:01, 5733.39probe position/s]Normalizing amplitudes:  49%|████▉     | 8060/16384 [00:01<00:01, 6336.91probe position/s]Normalizing amplitudes:  53%|█████▎    | 8698/16384 [00:01<00:01, 6029.55probe position/s]Normalizing amplitudes:  57%|█████▋    | 9307/16384 [00:01<00:01, 5862.07probe position/s]Normalizing amplitudes:  60%|██████    | 9898/16384 [00:01<00:01, 5736.02probe position/s]Normalizing amplitudes:  64%|██████▍   | 10475/16384 [00:01<00:01, 5618.28probe position/s]Normalizing amplitudes:  67%|██████▋   | 11039/16384 [00:01<00:00, 5531.60probe position/s]Normalizing amplitudes:  71%|███████   | 11641/16384 [00:02<00:00, 5669.68probe position/s]Normalizing amplitudes:  76%|███████▌  | 12425/16384 [00:02<00:00, 6295.87probe position/s]Normalizing amplitudes:  80%|███████▉  | 13059/16384 [00:02<00:00, 6209.50probe position/s]Normalizing amplitudes:  84%|████████▎ | 13683/16384 [00:02<00:00, 5936.96probe position/s]Normalizing amplitudes:  87%|████████▋ | 14281/16384 [00:02<00:00, 5758.12probe position/s]Normalizing amplitudes:  91%|█████████ | 14860/16384 [00:02<00:00, 5597.51probe position/s]Normalizing amplitudes:  94%|█████████▍| 15423/16384 [00:02<00:00, 5558.91probe position/s]Normalizing amplitudes:  98%|█████████▊| 15981/16384 [00:02<00:00, 5542.82probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5806.85probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random256_p6_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random256_p6_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.05665 in 3.175 sec
Iter: 2, Total Loss: 0.006611 in 3.093 sec
Iter: 3, Total Loss: 0.006446 in 3.080 sec
Iter: 4, Total Loss: 0.006368 in 3.080 sec
Iter: 5, Total Loss: 0.006316 in 3.102 sec
Iter: 6, Total Loss: 0.006275 in 3.110 sec
Iter: 7, Total Loss: 0.006237 in 3.120 sec
Iter: 8, Total Loss: 0.006203 in 3.067 sec
Iter: 9, Total Loss: 0.006168 in 3.052 sec
Iter: 10, Total Loss: 0.006136 in 3.084 sec
Iter: 11, Total Loss: 0.006103 in 3.086 sec
Iter: 12, Total Loss: 0.006073 in 3.056 sec
Iter: 13, Total Loss: 0.006041 in 3.051 sec
Iter: 14, Total Loss: 0.006012 in 3.060 sec
Iter: 15, Total Loss: 0.005982 in 2.951 sec
Iter: 16, Total Loss: 0.005952 in 3.111 sec
Iter: 17, Total Loss: 0.005924 in 3.071 sec
Iter: 18, Total Loss: 0.005895 in 3.101 sec
Iter: 19, Total Loss: 0.005867 in 3.110 sec
Iter: 20, Total Loss: 0.00584 in 3.104 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 3.083 with std = 0.041 sec ###
### py4DSTEM ptycho solver is finished in 1 min 2.064 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 938.93 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 256, 6, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 538/16384 [00:00<00:02, 5375.87probe position/s]Normalizing amplitudes:   7%|▋         | 1114/16384 [00:00<00:02, 5598.99probe position/s]Normalizing amplitudes:  12%|█▏        | 1897/16384 [00:00<00:02, 6614.54probe position/s]Normalizing amplitudes:  16%|█▌        | 2559/16384 [00:00<00:02, 6540.65probe position/s]Normalizing amplitudes:  20%|█▉        | 3214/16384 [00:00<00:02, 6115.74probe position/s]Normalizing amplitudes:  23%|██▎       | 3830/16384 [00:00<00:02, 5837.86probe position/s]Normalizing amplitudes:  27%|██▋       | 4418/16384 [00:00<00:02, 5735.04probe position/s]Normalizing amplitudes:  30%|███       | 4994/16384 [00:00<00:02, 5624.07probe position/s]Normalizing amplitudes:  34%|███▍      | 5558/16384 [00:00<00:01, 5514.42probe position/s]Normalizing amplitudes:  38%|███▊      | 6298/16384 [00:01<00:01, 6064.24probe position/s]Normalizing amplitudes:  43%|████▎     | 7021/16384 [00:01<00:01, 6407.30probe position/s]Normalizing amplitudes:  47%|████▋     | 7666/16384 [00:01<00:01, 6067.29probe position/s]Normalizing amplitudes:  51%|█████     | 8279/16384 [00:01<00:01, 5908.60probe position/s]Normalizing amplitudes:  54%|█████▍    | 8875/16384 [00:01<00:01, 5774.13probe position/s]Normalizing amplitudes:  58%|█████▊    | 9456/16384 [00:01<00:01, 5659.18probe position/s]Normalizing amplitudes:  61%|██████    | 10024/16384 [00:01<00:01, 5590.05probe position/s]Normalizing amplitudes:  65%|██████▍   | 10602/16384 [00:01<00:01, 5644.11probe position/s]Normalizing amplitudes:  70%|██████▉   | 11391/16384 [00:01<00:00, 6294.43probe position/s]Normalizing amplitudes:  73%|███████▎  | 12024/16384 [00:02<00:00, 6261.07probe position/s]Normalizing amplitudes:  77%|███████▋  | 12653/16384 [00:02<00:00, 5947.43probe position/s]Normalizing amplitudes:  81%|████████  | 13253/16384 [00:02<00:00, 5727.47probe position/s]Normalizing amplitudes:  84%|████████▍ | 13830/16384 [00:02<00:00, 5635.22probe position/s]Normalizing amplitudes:  88%|████████▊ | 14397/16384 [00:02<00:00, 5564.03probe position/s]Normalizing amplitudes:  91%|█████████▏| 14956/16384 [00:02<00:00, 5510.87probe position/s]Normalizing amplitudes:  96%|█████████▌| 15692/16384 [00:02<00:00, 6041.08probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5957.42probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random256_p6_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random256_p6_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.05742 in 8.690 sec
Iter: 2, Total Loss: 0.006752 in 8.539 sec
Iter: 3, Total Loss: 0.006393 in 8.638 sec
Iter: 4, Total Loss: 0.006275 in 8.537 sec
Iter: 5, Total Loss: 0.006199 in 8.525 sec
Iter: 6, Total Loss: 0.006137 in 8.547 sec
Iter: 7, Total Loss: 0.006082 in 8.566 sec
Iter: 8, Total Loss: 0.006032 in 8.528 sec
Iter: 9, Total Loss: 0.005985 in 8.571 sec
Iter: 10, Total Loss: 0.005939 in 8.559 sec
Iter: 11, Total Loss: 0.005895 in 8.539 sec
Iter: 12, Total Loss: 0.005853 in 8.522 sec
Iter: 13, Total Loss: 0.005811 in 8.563 sec
Iter: 14, Total Loss: 0.00577 in 8.502 sec
Iter: 15, Total Loss: 0.005732 in 8.461 sec
Iter: 16, Total Loss: 0.005694 in 8.430 sec
Iter: 17, Total Loss: 0.005658 in 8.409 sec
Iter: 18, Total Loss: 0.005623 in 8.274 sec
Iter: 19, Total Loss: 0.00559 in 8.396 sec
Iter: 20, Total Loss: 0.005559 in 8.322 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 8.506 with std = 0.097 sec ###
### py4DSTEM ptycho solver is finished in 2 min 50.556 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 939.15 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 256, 6, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 555/16384 [00:00<00:02, 5547.90probe position/s]Normalizing amplitudes:   8%|▊         | 1328/16384 [00:00<00:02, 6829.24probe position/s]Normalizing amplitudes:  12%|█▏        | 2011/16384 [00:00<00:02, 6509.24probe position/s]Normalizing amplitudes:  16%|█▋        | 2664/16384 [00:00<00:02, 6092.33probe position/s]Normalizing amplitudes:  20%|██        | 3278/16384 [00:00<00:02, 5893.35probe position/s]Normalizing amplitudes:  24%|██▎       | 3870/16384 [00:00<00:02, 5805.01probe position/s]Normalizing amplitudes:  27%|██▋       | 4452/16384 [00:00<00:02, 5694.08probe position/s]Normalizing amplitudes:  31%|███       | 5075/16384 [00:00<00:01, 5854.06probe position/s]Normalizing amplitudes:  36%|███▌      | 5857/16384 [00:00<00:01, 6444.69probe position/s]Normalizing amplitudes:  40%|███▉      | 6505/16384 [00:01<00:01, 6255.91probe position/s]Normalizing amplitudes:  44%|████▎     | 7134/16384 [00:01<00:01, 6001.16probe position/s]Normalizing amplitudes:  47%|████▋     | 7738/16384 [00:01<00:01, 5864.83probe position/s]Normalizing amplitudes:  51%|█████     | 8327/16384 [00:01<00:01, 5841.67probe position/s]Normalizing amplitudes:  54%|█████▍    | 8913/16384 [00:01<00:01, 5732.89probe position/s]Normalizing amplitudes:  58%|█████▊    | 9514/16384 [00:01<00:01, 5812.07probe position/s]Normalizing amplitudes:  63%|██████▎   | 10293/16384 [00:01<00:00, 6386.62probe position/s]Normalizing amplitudes:  67%|██████▋   | 10935/16384 [00:01<00:00, 6260.00probe position/s]Normalizing amplitudes:  71%|███████   | 11564/16384 [00:01<00:00, 6012.86probe position/s]Normalizing amplitudes:  74%|███████▍  | 12169/16384 [00:02<00:00, 5837.68probe position/s]Normalizing amplitudes:  78%|███████▊  | 12756/16384 [00:02<00:00, 5778.27probe position/s]Normalizing amplitudes:  81%|████████▏ | 13336/16384 [00:02<00:00, 5741.36probe position/s]Normalizing amplitudes:  85%|████████▌ | 13936/16384 [00:02<00:00, 5815.78probe position/s]Normalizing amplitudes:  90%|████████▉ | 14719/16384 [00:02<00:00, 6402.54probe position/s]Normalizing amplitudes:  94%|█████████▍| 15362/16384 [00:02<00:00, 6280.02probe position/s]Normalizing amplitudes:  98%|█████████▊| 15993/16384 [00:02<00:00, 5935.50probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5992.13probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random256_p6_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random256_p6_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.05908 in 16.346 sec
Iter: 2, Total Loss: 0.006825 in 16.204 sec
Iter: 3, Total Loss: 0.006369 in 16.220 sec
Iter: 4, Total Loss: 0.006236 in 16.200 sec
Iter: 5, Total Loss: 0.006154 in 16.099 sec
Iter: 6, Total Loss: 0.006089 in 16.136 sec
Iter: 7, Total Loss: 0.006033 in 16.187 sec
Iter: 8, Total Loss: 0.005984 in 16.259 sec
Iter: 9, Total Loss: 0.005938 in 16.203 sec
Iter: 10, Total Loss: 0.005893 in 16.301 sec
Iter: 11, Total Loss: 0.005851 in 16.282 sec
Iter: 12, Total Loss: 0.005812 in 16.391 sec
Iter: 13, Total Loss: 0.005774 in 16.327 sec
Iter: 14, Total Loss: 0.005738 in 16.445 sec
Iter: 15, Total Loss: 0.005703 in 16.357 sec
Iter: 16, Total Loss: 0.00567 in 16.246 sec
Iter: 17, Total Loss: 0.005638 in 16.223 sec
Iter: 18, Total Loss: 0.005607 in 16.324 sec
Iter: 19, Total Loss: 0.005578 in 16.214 sec
Iter: 20, Total Loss: 0.005548 in 16.234 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 16.260 with std = 0.084 sec ###
### py4DSTEM ptycho solver is finished in 5 min 25.765 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 948.59 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 256, 12, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 541/16384 [00:00<00:02, 5399.04probe position/s]Normalizing amplitudes:   7%|▋         | 1081/16384 [00:00<00:02, 5367.33probe position/s]Normalizing amplitudes:  10%|█         | 1639/16384 [00:00<00:02, 5462.67probe position/s]Normalizing amplitudes:  15%|█▍        | 2384/16384 [00:00<00:02, 6244.77probe position/s]Normalizing amplitudes:  19%|█▉        | 3166/16384 [00:00<00:01, 6810.86probe position/s]Normalizing amplitudes:  23%|██▎       | 3848/16384 [00:00<00:01, 6560.40probe position/s]Normalizing amplitudes:  28%|██▊       | 4506/16384 [00:00<00:01, 6158.50probe position/s]Normalizing amplitudes:  31%|███▏      | 5127/16384 [00:00<00:01, 5965.36probe position/s]Normalizing amplitudes:  35%|███▍      | 5728/16384 [00:00<00:01, 5762.08probe position/s]Normalizing amplitudes:  39%|███▊      | 6308/16384 [00:01<00:01, 5625.63probe position/s]Normalizing amplitudes:  42%|████▏     | 6873/16384 [00:01<00:01, 5617.35probe position/s]Normalizing amplitudes:  47%|████▋     | 7656/16384 [00:01<00:01, 6256.21probe position/s]Normalizing amplitudes:  52%|█████▏    | 8438/16384 [00:01<00:01, 6712.00probe position/s]Normalizing amplitudes:  56%|█████▌    | 9114/16384 [00:01<00:01, 6298.39probe position/s]Normalizing amplitudes:  60%|█████▉    | 9752/16384 [00:01<00:01, 5976.92probe position/s]Normalizing amplitudes:  63%|██████▎   | 10358/16384 [00:01<00:01, 5829.75probe position/s]Normalizing amplitudes:  67%|██████▋   | 10946/16384 [00:01<00:00, 5687.04probe position/s]Normalizing amplitudes:  70%|███████   | 11518/16384 [00:01<00:00, 5510.17probe position/s]Normalizing amplitudes:  74%|███████▍  | 12145/16384 [00:02<00:00, 5720.58probe position/s]Normalizing amplitudes:  79%|███████▉  | 12930/16384 [00:02<00:00, 6324.25probe position/s]Normalizing amplitudes:  84%|████████▎ | 13712/16384 [00:02<00:00, 6752.76probe position/s]Normalizing amplitudes:  88%|████████▊ | 14393/16384 [00:02<00:00, 6164.07probe position/s]Normalizing amplitudes:  92%|█████████▏| 15023/16384 [00:02<00:00, 5908.45probe position/s]Normalizing amplitudes:  95%|█████████▌| 15624/16384 [00:02<00:00, 5783.12probe position/s]Normalizing amplitudes:  99%|█████████▉| 16209/16384 [00:02<00:00, 5649.76probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5963.00probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random256_p12_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random256_p12_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.1419 in 5.754 sec
Iter: 2, Total Loss: 0.006712 in 5.754 sec
Iter: 3, Total Loss: 0.006477 in 5.738 sec
Iter: 4, Total Loss: 0.006376 in 5.737 sec
Iter: 5, Total Loss: 0.006312 in 5.706 sec
Iter: 6, Total Loss: 0.006262 in 5.727 sec
Iter: 7, Total Loss: 0.006219 in 5.786 sec
Iter: 8, Total Loss: 0.006179 in 5.744 sec
Iter: 9, Total Loss: 0.00614 in 5.732 sec
Iter: 10, Total Loss: 0.006104 in 5.720 sec
Iter: 11, Total Loss: 0.006069 in 5.700 sec
Iter: 12, Total Loss: 0.006034 in 5.705 sec
Iter: 13, Total Loss: 0.005999 in 5.719 sec
Iter: 14, Total Loss: 0.005964 in 5.764 sec
Iter: 15, Total Loss: 0.00593 in 5.653 sec
Iter: 16, Total Loss: 0.005897 in 5.681 sec
Iter: 17, Total Loss: 0.005863 in 5.872 sec
Iter: 18, Total Loss: 0.005831 in 5.770 sec
Iter: 19, Total Loss: 0.005799 in 5.728 sec
Iter: 20, Total Loss: 0.005768 in 5.671 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 5.733 with std = 0.045 sec ###
### py4DSTEM ptycho solver is finished in 1 min 55.076 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 940.46 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 256, 12, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   5%|▍         | 764/16384 [00:00<00:02, 7636.04probe position/s]Normalizing amplitudes:   9%|▉         | 1528/16384 [00:00<00:02, 7137.48probe position/s]Normalizing amplitudes:  14%|█▎        | 2244/16384 [00:00<00:02, 6073.02probe position/s]Normalizing amplitudes:  17%|█▋        | 2867/16384 [00:00<00:02, 5615.98probe position/s]Normalizing amplitudes:  21%|██        | 3439/16384 [00:00<00:02, 5517.24probe position/s]Normalizing amplitudes:  24%|██▍       | 3997/16384 [00:00<00:02, 5377.80probe position/s]Normalizing amplitudes:  28%|██▊       | 4604/16384 [00:00<00:02, 5582.43probe position/s]Normalizing amplitudes:  33%|███▎      | 5380/16384 [00:00<00:01, 6230.10probe position/s]Normalizing amplitudes:  38%|███▊      | 6145/16384 [00:00<00:01, 6651.61probe position/s]Normalizing amplitudes:  42%|████▏     | 6818/16384 [00:01<00:01, 6077.59probe position/s]Normalizing amplitudes:  45%|████▌     | 7439/16384 [00:01<00:01, 5903.14probe position/s]Normalizing amplitudes:  49%|████▉     | 8039/16384 [00:01<00:01, 5747.08probe position/s]Normalizing amplitudes:  53%|█████▎    | 8620/16384 [00:01<00:01, 5563.20probe position/s]Normalizing amplitudes:  56%|█████▌    | 9181/16384 [00:01<00:01, 5502.10probe position/s]Normalizing amplitudes:  60%|██████    | 9881/16384 [00:01<00:01, 5922.65probe position/s]Normalizing amplitudes:  65%|██████▌   | 10652/16384 [00:01<00:00, 6434.46probe position/s]Normalizing amplitudes:  69%|██████▉   | 11302/16384 [00:01<00:00, 6442.72probe position/s]Normalizing amplitudes:  73%|███████▎  | 11951/16384 [00:01<00:00, 6052.07probe position/s]Normalizing amplitudes:  77%|███████▋  | 12564/16384 [00:02<00:00, 5843.30probe position/s]Normalizing amplitudes:  80%|████████  | 13154/16384 [00:02<00:00, 5734.04probe position/s]Normalizing amplitudes:  84%|████████▍ | 13732/16384 [00:02<00:00, 5623.04probe position/s]Normalizing amplitudes:  87%|████████▋ | 14297/16384 [00:02<00:00, 5600.40probe position/s]Normalizing amplitudes:  91%|█████████▏| 14988/16384 [00:02<00:00, 5973.90probe position/s]Normalizing amplitudes:  96%|█████████▌| 15719/16384 [00:02<00:00, 6359.40probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6443.36probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6009.62probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random256_p12_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random256_p12_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.1427 in 16.272 sec
Iter: 2, Total Loss: 0.00693 in 16.482 sec
Iter: 3, Total Loss: 0.006469 in 16.226 sec
Iter: 4, Total Loss: 0.006332 in 16.178 sec
Iter: 5, Total Loss: 0.00625 in 16.157 sec
Iter: 6, Total Loss: 0.006187 in 16.327 sec
Iter: 7, Total Loss: 0.006133 in 16.258 sec
Iter: 8, Total Loss: 0.006084 in 16.136 sec
Iter: 9, Total Loss: 0.006039 in 16.203 sec
Iter: 10, Total Loss: 0.005996 in 16.239 sec
Iter: 11, Total Loss: 0.005955 in 16.404 sec
Iter: 12, Total Loss: 0.005915 in 14.904 sec
Iter: 13, Total Loss: 0.005877 in 15.257 sec
Iter: 14, Total Loss: 0.005839 in 16.376 sec
Iter: 15, Total Loss: 0.005803 in 16.570 sec
Iter: 16, Total Loss: 0.005768 in 16.688 sec
Iter: 17, Total Loss: 0.005735 in 16.411 sec
Iter: 18, Total Loss: 0.005703 in 16.414 sec
Iter: 19, Total Loss: 0.005671 in 16.296 sec
Iter: 20, Total Loss: 0.00564 in 16.337 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 16.207 with std = 0.403 sec ###
### py4DSTEM ptycho solver is finished in 5 min 24.658 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 939.95 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 256, 12, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 694/16384 [00:00<00:02, 6931.71probe position/s]Normalizing amplitudes:   9%|▉         | 1481/16384 [00:00<00:01, 7478.48probe position/s]Normalizing amplitudes:  14%|█▎        | 2229/16384 [00:00<00:02, 6201.53probe position/s]Normalizing amplitudes:  18%|█▊        | 2871/16384 [00:00<00:02, 5863.21probe position/s]Normalizing amplitudes:  21%|██        | 3471/16384 [00:00<00:02, 5689.09probe position/s]Normalizing amplitudes:  25%|██▍       | 4048/16384 [00:00<00:02, 5521.46probe position/s]Normalizing amplitudes:  28%|██▊       | 4605/16384 [00:00<00:02, 5482.96probe position/s]Normalizing amplitudes:  33%|███▎      | 5345/16384 [00:00<00:01, 6047.68probe position/s]Normalizing amplitudes:  37%|███▋      | 6096/16384 [00:00<00:01, 6478.69probe position/s]Normalizing amplitudes:  41%|████      | 6751/16384 [00:01<00:01, 6046.65probe position/s]Normalizing amplitudes:  45%|████▍     | 7365/16384 [00:01<00:01, 5869.51probe position/s]Normalizing amplitudes:  49%|████▊     | 7959/16384 [00:01<00:01, 5734.26probe position/s]Normalizing amplitudes:  52%|█████▏    | 8537/16384 [00:01<00:01, 5621.87probe position/s]Normalizing amplitudes:  56%|█████▌    | 9102/16384 [00:01<00:01, 5552.85probe position/s]Normalizing amplitudes:  60%|█████▉    | 9788/16384 [00:01<00:01, 5922.84probe position/s]Normalizing amplitudes:  65%|██████▍   | 10578/16384 [00:01<00:00, 6492.78probe position/s]Normalizing amplitudes:  69%|██████▊   | 11232/16384 [00:01<00:00, 5979.83probe position/s]Normalizing amplitudes:  72%|███████▏  | 11841/16384 [00:01<00:00, 5854.78probe position/s]Normalizing amplitudes:  76%|███████▌  | 12434/16384 [00:02<00:00, 5733.29probe position/s]Normalizing amplitudes:  79%|███████▉  | 13013/16384 [00:02<00:00, 5616.41probe position/s]Normalizing amplitudes:  83%|████████▎ | 13578/16384 [00:02<00:00, 5566.83probe position/s]Normalizing amplitudes:  87%|████████▋ | 14240/16384 [00:02<00:00, 5864.60probe position/s]Normalizing amplitudes:  92%|█████████▏| 15027/16384 [00:02<00:00, 6443.30probe position/s]Normalizing amplitudes:  96%|█████████▌| 15676/16384 [00:02<00:00, 6123.37probe position/s]Normalizing amplitudes:  99%|█████████▉| 16295/16384 [00:02<00:00, 5904.42probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5931.28probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random256_p12_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random256_p12_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.1448 in 32.266 sec
Iter: 2, Total Loss: 0.007482 in 31.705 sec
Iter: 3, Total Loss: 0.006506 in 32.126 sec
Iter: 4, Total Loss: 0.006261 in 31.509 sec
Iter: 5, Total Loss: 0.006132 in 31.366 sec
Iter: 6, Total Loss: 0.006043 in 31.091 sec
Iter: 7, Total Loss: 0.005974 in 32.004 sec
Iter: 8, Total Loss: 0.005915 in 31.560 sec
Iter: 9, Total Loss: 0.005861 in 32.577 sec
Iter: 10, Total Loss: 0.005812 in 33.569 sec
Iter: 11, Total Loss: 0.005767 in 33.715 sec
Iter: 12, Total Loss: 0.005724 in 33.575 sec
Iter: 13, Total Loss: 0.005682 in 33.367 sec
Iter: 14, Total Loss: 0.005644 in 33.754 sec
Iter: 15, Total Loss: 0.005607 in 33.700 sec
Iter: 16, Total Loss: 0.005571 in 33.650 sec
Iter: 17, Total Loss: 0.005537 in 33.245 sec
Iter: 18, Total Loss: 0.005505 in 33.016 sec
Iter: 19, Total Loss: 0.005473 in 32.351 sec
Iter: 20, Total Loss: 0.005442 in 32.522 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 32.633 with std = 0.882 sec ###
### py4DSTEM ptycho solver is finished in 10 min 53.235 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 948.53 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 128, 1, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 552/16384 [00:00<00:02, 5519.66probe position/s]Normalizing amplitudes:   7%|▋         | 1104/16384 [00:00<00:02, 5517.95probe position/s]Normalizing amplitudes:  10%|█         | 1662/16384 [00:00<00:02, 5544.31probe position/s]Normalizing amplitudes:  15%|█▍        | 2415/16384 [00:00<00:02, 6324.83probe position/s]Normalizing amplitudes:  19%|█▉        | 3103/16384 [00:00<00:02, 6524.00probe position/s]Normalizing amplitudes:  23%|██▎       | 3756/16384 [00:00<00:02, 6153.58probe position/s]Normalizing amplitudes:  27%|██▋       | 4376/16384 [00:00<00:02, 5848.85probe position/s]Normalizing amplitudes:  30%|███       | 4966/16384 [00:00<00:01, 5714.96probe position/s]Normalizing amplitudes:  34%|███▍      | 5541/16384 [00:00<00:01, 5630.88probe position/s]Normalizing amplitudes:  37%|███▋      | 6106/16384 [00:01<00:01, 5535.95probe position/s]Normalizing amplitudes:  42%|████▏     | 6812/16384 [00:01<00:01, 5977.18probe position/s]Normalizing amplitudes:  46%|████▋     | 7594/16384 [00:01<00:01, 6514.59probe position/s]Normalizing amplitudes:  50%|█████     | 8250/16384 [00:01<00:01, 5879.15probe position/s]Normalizing amplitudes:  54%|█████▍    | 8852/16384 [00:01<00:01, 5788.60probe position/s]Normalizing amplitudes:  58%|█████▊    | 9441/16384 [00:01<00:01, 5708.44probe position/s]Normalizing amplitudes:  61%|██████    | 10018/16384 [00:01<00:01, 5602.41probe position/s]Normalizing amplitudes:  65%|██████▍   | 10583/16384 [00:01<00:01, 5484.28probe position/s]Normalizing amplitudes:  69%|██████▊   | 11236/16384 [00:01<00:00, 5778.53probe position/s]Normalizing amplitudes:  73%|███████▎  | 12026/16384 [00:02<00:00, 6385.53probe position/s]Normalizing amplitudes:  77%|███████▋  | 12670/16384 [00:02<00:00, 6066.73probe position/s]Normalizing amplitudes:  81%|████████  | 13284/16384 [00:02<00:00, 5890.52probe position/s]Normalizing amplitudes:  85%|████████▍ | 13878/16384 [00:02<00:00, 5725.23probe position/s]Normalizing amplitudes:  88%|████████▊ | 14455/16384 [00:02<00:00, 5612.28probe position/s]Normalizing amplitudes:  92%|█████████▏| 15019/16384 [00:02<00:00, 5474.05probe position/s]Normalizing amplitudes:  95%|█████████▌| 15619/16384 [00:02<00:00, 5620.96probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5889.02probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random128_p1_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random128_p1_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.008513 in 1.267 sec
Iter: 2, Total Loss: 0.006514 in 1.169 sec
Iter: 3, Total Loss: 0.006488 in 1.227 sec
Iter: 4, Total Loss: 0.006472 in 1.168 sec
Iter: 5, Total Loss: 0.006459 in 1.223 sec
Iter: 6, Total Loss: 0.006445 in 1.168 sec
Iter: 7, Total Loss: 0.006432 in 1.220 sec
Iter: 8, Total Loss: 0.006419 in 1.169 sec
Iter: 9, Total Loss: 0.006403 in 1.215 sec
Iter: 10, Total Loss: 0.006389 in 1.167 sec
Iter: 11, Total Loss: 0.006373 in 1.224 sec
Iter: 12, Total Loss: 0.006358 in 1.178 sec
Iter: 13, Total Loss: 0.006342 in 1.230 sec
Iter: 14, Total Loss: 0.006327 in 1.166 sec
Iter: 15, Total Loss: 0.006312 in 1.213 sec
Iter: 16, Total Loss: 0.006297 in 1.166 sec
Iter: 17, Total Loss: 0.006283 in 1.210 sec
Iter: 18, Total Loss: 0.00627 in 1.176 sec
Iter: 19, Total Loss: 0.006257 in 1.209 sec
Iter: 20, Total Loss: 0.006245 in 1.203 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 1.198 with std = 0.029 sec ###
### py4DSTEM ptycho solver is finished in 24.367 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 948.53 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 128, 1, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 536/16384 [00:00<00:02, 5356.80probe position/s]Normalizing amplitudes:   7%|▋         | 1072/16384 [00:00<00:02, 5343.50probe position/s]Normalizing amplitudes:  10%|▉         | 1607/16384 [00:00<00:02, 5329.57probe position/s]Normalizing amplitudes:  13%|█▎        | 2150/16384 [00:00<00:02, 5368.71probe position/s]Normalizing amplitudes:  16%|█▋        | 2702/16384 [00:00<00:02, 5420.78probe position/s]Normalizing amplitudes:  21%|██        | 3407/16384 [00:00<00:02, 5973.49probe position/s]Normalizing amplitudes:  25%|██▌       | 4177/16384 [00:00<00:01, 6514.01probe position/s]Normalizing amplitudes:  29%|██▉       | 4829/16384 [00:00<00:01, 5962.18probe position/s]Normalizing amplitudes:  33%|███▎      | 5434/16384 [00:00<00:01, 5834.36probe position/s]Normalizing amplitudes:  37%|███▋      | 6024/16384 [00:01<00:01, 5689.75probe position/s]Normalizing amplitudes:  40%|████      | 6597/16384 [00:01<00:01, 5599.99probe position/s]Normalizing amplitudes:  44%|████▎     | 7160/16384 [00:01<00:01, 5491.37probe position/s]Normalizing amplitudes:  48%|████▊     | 7823/16384 [00:01<00:01, 5817.31probe position/s]Normalizing amplitudes:  53%|█████▎    | 8610/16384 [00:01<00:01, 6412.35probe position/s]Normalizing amplitudes:  56%|█████▋    | 9256/16384 [00:01<00:01, 6099.44probe position/s]Normalizing amplitudes:  60%|██████    | 9872/16384 [00:01<00:01, 5814.54probe position/s]Normalizing amplitudes:  64%|██████▍   | 10460/16384 [00:01<00:01, 5695.21probe position/s]Normalizing amplitudes:  67%|██████▋   | 11034/16384 [00:01<00:00, 5601.65probe position/s]Normalizing amplitudes:  71%|███████   | 11597/16384 [00:02<00:00, 5543.52probe position/s]Normalizing amplitudes:  75%|███████▍  | 12215/16384 [00:02<00:00, 5722.89probe position/s]Normalizing amplitudes:  79%|███████▉  | 12996/16384 [00:02<00:00, 6324.66probe position/s]Normalizing amplitudes:  83%|████████▎ | 13633/16384 [00:02<00:00, 6241.68probe position/s]Normalizing amplitudes:  87%|████████▋ | 14260/16384 [00:02<00:00, 5907.29probe position/s]Normalizing amplitudes:  91%|█████████ | 14856/16384 [00:02<00:00, 5727.16probe position/s]Normalizing amplitudes:  94%|█████████▍| 15433/16384 [00:02<00:00, 5678.08probe position/s]Normalizing amplitudes:  98%|█████████▊| 16004/16384 [00:02<00:00, 5592.73probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5771.52probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random128_p1_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random128_p1_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.008619 in 2.739 sec
Iter: 2, Total Loss: 0.006519 in 2.690 sec
Iter: 3, Total Loss: 0.006495 in 2.640 sec
Iter: 4, Total Loss: 0.006473 in 2.724 sec
Iter: 5, Total Loss: 0.006453 in 2.664 sec
Iter: 6, Total Loss: 0.006434 in 2.684 sec
Iter: 7, Total Loss: 0.006415 in 2.739 sec
Iter: 8, Total Loss: 0.006398 in 2.666 sec
Iter: 9, Total Loss: 0.006377 in 2.716 sec
Iter: 10, Total Loss: 0.006359 in 2.673 sec
Iter: 11, Total Loss: 0.006342 in 2.712 sec
Iter: 12, Total Loss: 0.006324 in 2.691 sec
Iter: 13, Total Loss: 0.006308 in 2.657 sec
Iter: 14, Total Loss: 0.006291 in 2.696 sec
Iter: 15, Total Loss: 0.006275 in 2.671 sec
Iter: 16, Total Loss: 0.006261 in 2.723 sec
Iter: 17, Total Loss: 0.006246 in 2.736 sec
Iter: 18, Total Loss: 0.006232 in 2.691 sec
Iter: 19, Total Loss: 0.006218 in 2.706 sec
Iter: 20, Total Loss: 0.006207 in 2.653 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 2.694 with std = 0.029 sec ###
### py4DSTEM ptycho solver is finished in 54.399 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 948.57 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 128, 1, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 598/16384 [00:00<00:02, 5973.67probe position/s]Normalizing amplitudes:   7%|▋         | 1196/16384 [00:00<00:02, 5501.54probe position/s]Normalizing amplitudes:  11%|█         | 1749/16384 [00:00<00:02, 5454.50probe position/s]Normalizing amplitudes:  14%|█▍        | 2300/16384 [00:00<00:02, 5475.57probe position/s]Normalizing amplitudes:  17%|█▋        | 2849/16384 [00:00<00:02, 5465.74probe position/s]Normalizing amplitudes:  21%|██        | 3397/16384 [00:00<00:02, 5450.80probe position/s]Normalizing amplitudes:  25%|██▌       | 4132/16384 [00:00<00:02, 6061.22probe position/s]Normalizing amplitudes:  30%|██▉       | 4882/16384 [00:00<00:01, 6513.80probe position/s]Normalizing amplitudes:  34%|███▍      | 5535/16384 [00:00<00:01, 5962.27probe position/s]Normalizing amplitudes:  37%|███▋      | 6141/16384 [00:01<00:01, 5828.01probe position/s]Normalizing amplitudes:  41%|████      | 6731/16384 [00:01<00:01, 5687.93probe position/s]Normalizing amplitudes:  45%|████▍     | 7305/16384 [00:01<00:01, 5589.69probe position/s]Normalizing amplitudes:  48%|████▊     | 7867/16384 [00:01<00:01, 5558.88probe position/s]Normalizing amplitudes:  52%|█████▏    | 8535/16384 [00:01<00:01, 5881.00probe position/s]Normalizing amplitudes:  57%|█████▋    | 9323/16384 [00:01<00:01, 6461.75probe position/s]Normalizing amplitudes:  61%|██████    | 9974/16384 [00:01<00:01, 6133.44probe position/s]Normalizing amplitudes:  65%|██████▍   | 10594/16384 [00:01<00:00, 5853.26probe position/s]Normalizing amplitudes:  68%|██████▊   | 11185/16384 [00:01<00:00, 5698.99probe position/s]Normalizing amplitudes:  72%|███████▏  | 11759/16384 [00:02<00:00, 5580.10probe position/s]Normalizing amplitudes:  75%|███████▌  | 12320/16384 [00:02<00:00, 5438.49probe position/s]Normalizing amplitudes:  79%|███████▉  | 12960/16384 [00:02<00:00, 5707.19probe position/s]Normalizing amplitudes:  84%|████████▍ | 13750/16384 [00:02<00:00, 6332.06probe position/s]Normalizing amplitudes:  88%|████████▊ | 14389/16384 [00:02<00:00, 6078.70probe position/s]Normalizing amplitudes:  92%|█████████▏| 15003/16384 [00:02<00:00, 5763.70probe position/s]Normalizing amplitudes:  95%|█████████▌| 15586/16384 [00:02<00:00, 5700.73probe position/s]Normalizing amplitudes:  99%|█████████▊| 16160/16384 [00:02<00:00, 5597.51probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5784.77probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random128_p1_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random128_p1_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.00878 in 4.915 sec
Iter: 2, Total Loss: 0.006564 in 4.880 sec
Iter: 3, Total Loss: 0.006529 in 4.931 sec
Iter: 4, Total Loss: 0.006499 in 4.876 sec
Iter: 5, Total Loss: 0.006473 in 4.854 sec
Iter: 6, Total Loss: 0.006448 in 4.841 sec
Iter: 7, Total Loss: 0.006425 in 4.860 sec
Iter: 8, Total Loss: 0.006403 in 4.860 sec
Iter: 9, Total Loss: 0.006381 in 4.887 sec
Iter: 10, Total Loss: 0.006359 in 4.833 sec
Iter: 11, Total Loss: 0.006342 in 4.841 sec
Iter: 12, Total Loss: 0.006319 in 4.824 sec
Iter: 13, Total Loss: 0.0063 in 4.831 sec
Iter: 14, Total Loss: 0.00628 in 4.903 sec
Iter: 15, Total Loss: 0.00626 in 4.896 sec
Iter: 16, Total Loss: 0.006244 in 4.880 sec
Iter: 17, Total Loss: 0.006226 in 5.165 sec
Iter: 18, Total Loss: 0.006209 in 4.901 sec
Iter: 19, Total Loss: 0.006191 in 4.785 sec
Iter: 20, Total Loss: 0.006174 in 4.773 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 4.877 with std = 0.077 sec ###
### py4DSTEM ptycho solver is finished in 1 min 38.088 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 939.93 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 128, 3, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 529/16384 [00:00<00:02, 5289.24probe position/s]Normalizing amplitudes:   7%|▋         | 1105/16384 [00:00<00:02, 5562.12probe position/s]Normalizing amplitudes:  11%|█         | 1824/16384 [00:00<00:02, 6304.14probe position/s]Normalizing amplitudes:  16%|█▌        | 2570/16384 [00:00<00:02, 6759.16probe position/s]Normalizing amplitudes:  20%|█▉        | 3246/16384 [00:00<00:02, 6277.78probe position/s]Normalizing amplitudes:  24%|██▎       | 3880/16384 [00:00<00:02, 6010.06probe position/s]Normalizing amplitudes:  27%|██▋       | 4486/16384 [00:00<00:02, 5923.79probe position/s]Normalizing amplitudes:  31%|███       | 5082/16384 [00:00<00:01, 5763.53probe position/s]Normalizing amplitudes:  35%|███▍      | 5661/16384 [00:00<00:01, 5716.61probe position/s]Normalizing amplitudes:  39%|███▉      | 6443/16384 [00:01<00:01, 6333.54probe position/s]Normalizing amplitudes:  43%|████▎     | 7105/16384 [00:01<00:01, 6415.18probe position/s]Normalizing amplitudes:  47%|████▋     | 7750/16384 [00:01<00:01, 6111.53probe position/s]Normalizing amplitudes:  51%|█████     | 8366/16384 [00:01<00:01, 5806.40probe position/s]Normalizing amplitudes:  55%|█████▍    | 8952/16384 [00:01<00:01, 5765.66probe position/s]Normalizing amplitudes:  58%|█████▊    | 9532/16384 [00:01<00:01, 5628.11probe position/s]Normalizing amplitudes:  62%|██████▏   | 10138/16384 [00:01<00:01, 5749.80probe position/s]Normalizing amplitudes:  67%|██████▋   | 10923/16384 [00:01<00:00, 6352.87probe position/s]Normalizing amplitudes:  71%|███████   | 11563/16384 [00:01<00:00, 6285.07probe position/s]Normalizing amplitudes:  74%|███████▍  | 12195/16384 [00:02<00:00, 6021.16probe position/s]Normalizing amplitudes:  78%|███████▊  | 12802/16384 [00:02<00:00, 5868.69probe position/s]Normalizing amplitudes:  82%|████████▏ | 13392/16384 [00:02<00:00, 5766.62probe position/s]Normalizing amplitudes:  85%|████████▌ | 13971/16384 [00:02<00:00, 5666.87probe position/s]Normalizing amplitudes:  89%|████████▉ | 14645/16384 [00:02<00:00, 5971.13probe position/s]Normalizing amplitudes:  94%|█████████▍| 15430/16384 [00:02<00:00, 6512.85probe position/s]Normalizing amplitudes:  98%|█████████▊| 16085/16384 [00:02<00:00, 6178.11probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6013.43probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random128_p3_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random128_p3_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.01468 in 2.486 sec
Iter: 2, Total Loss: 0.006478 in 2.471 sec
Iter: 3, Total Loss: 0.006403 in 2.481 sec
Iter: 4, Total Loss: 0.006354 in 2.417 sec
Iter: 5, Total Loss: 0.006311 in 2.493 sec
Iter: 6, Total Loss: 0.006266 in 2.470 sec
Iter: 7, Total Loss: 0.006219 in 2.447 sec
Iter: 8, Total Loss: 0.006173 in 2.465 sec
Iter: 9, Total Loss: 0.006124 in 2.477 sec
Iter: 10, Total Loss: 0.00608 in 2.431 sec
Iter: 11, Total Loss: 0.006034 in 2.481 sec
Iter: 12, Total Loss: 0.005991 in 2.429 sec
Iter: 13, Total Loss: 0.005949 in 2.452 sec
Iter: 14, Total Loss: 0.005909 in 2.461 sec
Iter: 15, Total Loss: 0.005871 in 2.460 sec
Iter: 16, Total Loss: 0.005834 in 2.434 sec
Iter: 17, Total Loss: 0.005799 in 2.468 sec
Iter: 18, Total Loss: 0.005764 in 2.463 sec
Iter: 19, Total Loss: 0.005732 in 2.461 sec
Iter: 20, Total Loss: 0.005702 in 2.456 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 2.460 with std = 0.020 sec ###
### py4DSTEM ptycho solver is finished in 54.592 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 939.94 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 128, 3, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   5%|▍         | 747/16384 [00:00<00:02, 7466.95probe position/s]Normalizing amplitudes:   9%|▉         | 1494/16384 [00:00<00:02, 7363.65probe position/s]Normalizing amplitudes:  14%|█▎        | 2231/16384 [00:00<00:02, 6469.27probe position/s]Normalizing amplitudes:  18%|█▊        | 2889/16384 [00:00<00:02, 6092.94probe position/s]Normalizing amplitudes:  21%|██▏       | 3506/16384 [00:00<00:02, 5937.06probe position/s]Normalizing amplitudes:  25%|██▌       | 4104/16384 [00:00<00:02, 5777.59probe position/s]Normalizing amplitudes:  29%|██▉       | 4778/16384 [00:00<00:01, 6066.08probe position/s]Normalizing amplitudes:  34%|███▍      | 5576/16384 [00:00<00:01, 6641.11probe position/s]Normalizing amplitudes:  38%|███▊      | 6247/16384 [00:00<00:01, 6397.29probe position/s]Normalizing amplitudes:  42%|████▏     | 6892/16384 [00:01<00:01, 6227.93probe position/s]Normalizing amplitudes:  46%|████▌     | 7519/16384 [00:01<00:01, 6024.31probe position/s]Normalizing amplitudes:  50%|████▉     | 8125/16384 [00:01<00:01, 5859.79probe position/s]Normalizing amplitudes:  53%|█████▎    | 8714/16384 [00:01<00:01, 5768.12probe position/s]Normalizing amplitudes:  58%|█████▊    | 9425/16384 [00:01<00:01, 6149.35probe position/s]Normalizing amplitudes:  62%|██████▏   | 10218/16384 [00:01<00:00, 6661.42probe position/s]Normalizing amplitudes:  66%|██████▋   | 10889/16384 [00:01<00:00, 6197.88probe position/s]Normalizing amplitudes:  70%|███████   | 11518/16384 [00:01<00:00, 5999.89probe position/s]Normalizing amplitudes:  74%|███████▍  | 12125/16384 [00:01<00:00, 5841.52probe position/s]Normalizing amplitudes:  78%|███████▊  | 12714/16384 [00:02<00:00, 5761.37probe position/s]Normalizing amplitudes:  81%|████████  | 13293/16384 [00:02<00:00, 5748.51probe position/s]Normalizing amplitudes:  86%|████████▌ | 14088/16384 [00:02<00:00, 6377.02probe position/s]Normalizing amplitudes:  90%|████████▉ | 14745/16384 [00:02<00:00, 6430.47probe position/s]Normalizing amplitudes:  94%|█████████▍| 15392/16384 [00:02<00:00, 6142.90probe position/s]Normalizing amplitudes:  98%|█████████▊| 16011/16384 [00:02<00:00, 6003.16probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6134.15probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random128_p3_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random128_p3_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.01512 in 6.577 sec
Iter: 2, Total Loss: 0.00643 in 6.522 sec
Iter: 3, Total Loss: 0.006333 in 6.540 sec
Iter: 4, Total Loss: 0.006269 in 6.478 sec
Iter: 5, Total Loss: 0.006207 in 6.486 sec
Iter: 6, Total Loss: 0.006149 in 6.537 sec
Iter: 7, Total Loss: 0.00609 in 6.519 sec
Iter: 8, Total Loss: 0.006034 in 6.497 sec
Iter: 9, Total Loss: 0.005976 in 6.565 sec
Iter: 10, Total Loss: 0.005921 in 6.481 sec
Iter: 11, Total Loss: 0.005866 in 6.379 sec
Iter: 12, Total Loss: 0.005814 in 6.700 sec
Iter: 13, Total Loss: 0.005763 in 6.744 sec
Iter: 14, Total Loss: 0.005715 in 6.700 sec
Iter: 15, Total Loss: 0.00567 in 6.700 sec
Iter: 16, Total Loss: 0.005628 in 6.752 sec
Iter: 17, Total Loss: 0.005589 in 6.659 sec
Iter: 18, Total Loss: 0.005552 in 6.694 sec
Iter: 19, Total Loss: 0.00552 in 6.686 sec
Iter: 20, Total Loss: 0.00549 in 6.700 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 6.596 with std = 0.106 sec ###
### py4DSTEM ptycho solver is finished in 2 min 12.441 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 939.92 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 128, 3, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 600/16384 [00:00<00:02, 5998.96probe position/s]Normalizing amplitudes:   7%|▋         | 1200/16384 [00:00<00:02, 5748.45probe position/s]Normalizing amplitudes:  11%|█         | 1776/16384 [00:00<00:02, 5653.88probe position/s]Normalizing amplitudes:  14%|█▍        | 2342/16384 [00:00<00:02, 5528.83probe position/s]Normalizing amplitudes:  18%|█▊        | 2908/16384 [00:00<00:02, 5572.34probe position/s]Normalizing amplitudes:  21%|██        | 3466/16384 [00:00<00:02, 5558.31probe position/s]Normalizing amplitudes:  25%|██▌       | 4137/16384 [00:00<00:02, 5928.38probe position/s]Normalizing amplitudes:  30%|███       | 4922/16384 [00:00<00:01, 6532.32probe position/s]Normalizing amplitudes:  34%|███▍      | 5577/16384 [00:00<00:01, 6170.39probe position/s]Normalizing amplitudes:  38%|███▊      | 6199/16384 [00:01<00:01, 5974.06probe position/s]Normalizing amplitudes:  42%|████▏     | 6801/16384 [00:01<00:01, 5744.99probe position/s]Normalizing amplitudes:  45%|████▌     | 7379/16384 [00:01<00:01, 5612.00probe position/s]Normalizing amplitudes:  49%|████▊     | 7950/16384 [00:01<00:01, 5637.86probe position/s]Normalizing amplitudes:  52%|█████▏    | 8516/16384 [00:01<00:01, 5575.94probe position/s]Normalizing amplitudes:  57%|█████▋    | 9264/16384 [00:01<00:01, 6126.17probe position/s]Normalizing amplitudes:  61%|██████    | 9943/16384 [00:01<00:01, 6310.60probe position/s]Normalizing amplitudes:  65%|██████▍   | 10577/16384 [00:01<00:00, 6012.37probe position/s]Normalizing amplitudes:  68%|██████▊   | 11183/16384 [00:01<00:00, 5856.82probe position/s]Normalizing amplitudes:  72%|███████▏  | 11773/16384 [00:02<00:00, 5730.52probe position/s]Normalizing amplitudes:  75%|███████▌  | 12349/16384 [00:02<00:00, 5715.48probe position/s]Normalizing amplitudes:  79%|███████▉  | 12923/16384 [00:02<00:00, 5688.88probe position/s]Normalizing amplitudes:  82%|████████▏ | 13493/16384 [00:02<00:00, 5685.97probe position/s]Normalizing amplitudes:  87%|████████▋ | 14281/16384 [00:02<00:00, 6328.06probe position/s]Normalizing amplitudes:  91%|█████████ | 14916/16384 [00:02<00:00, 6305.04probe position/s]Normalizing amplitudes:  95%|█████████▍| 15548/16384 [00:02<00:00, 5998.48probe position/s]Normalizing amplitudes:  99%|█████████▊| 16152/16384 [00:02<00:00, 5888.16probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5875.18probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random128_p3_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random128_p3_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.0158 in 12.900 sec
Iter: 2, Total Loss: 0.006393 in 12.751 sec
Iter: 3, Total Loss: 0.006248 in 12.795 sec
Iter: 4, Total Loss: 0.006161 in 12.822 sec
Iter: 5, Total Loss: 0.006083 in 12.774 sec
Iter: 6, Total Loss: 0.006011 in 12.814 sec
Iter: 7, Total Loss: 0.00594 in 12.830 sec
Iter: 8, Total Loss: 0.005874 in 12.749 sec
Iter: 9, Total Loss: 0.005811 in 12.575 sec
Iter: 10, Total Loss: 0.005752 in 12.556 sec
Iter: 11, Total Loss: 0.005698 in 12.520 sec
Iter: 12, Total Loss: 0.005647 in 12.438 sec
Iter: 13, Total Loss: 0.0056 in 12.445 sec
Iter: 14, Total Loss: 0.005557 in 12.360 sec
Iter: 15, Total Loss: 0.005518 in 12.460 sec
Iter: 16, Total Loss: 0.005481 in 12.393 sec
Iter: 17, Total Loss: 0.005448 in 12.456 sec
Iter: 18, Total Loss: 0.00542 in 12.519 sec
Iter: 19, Total Loss: 0.005393 in 12.475 sec
Iter: 20, Total Loss: 0.005368 in 12.316 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 12.597 with std = 0.181 sec ###
### py4DSTEM ptycho solver is finished in 4 min 12.488 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 943.61 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 128, 6, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 539/16384 [00:00<00:02, 5387.41probe position/s]Normalizing amplitudes:   8%|▊         | 1315/16384 [00:00<00:02, 6781.21probe position/s]Normalizing amplitudes:  12%|█▏        | 1994/16384 [00:00<00:02, 6378.04probe position/s]Normalizing amplitudes:  16%|█▌        | 2635/16384 [00:00<00:02, 6166.69probe position/s]Normalizing amplitudes:  20%|█▉        | 3254/16384 [00:00<00:02, 5715.22probe position/s]Normalizing amplitudes:  23%|██▎       | 3831/16384 [00:00<00:02, 5671.81probe position/s]Normalizing amplitudes:  27%|██▋       | 4403/16384 [00:00<00:02, 5685.07probe position/s]Normalizing amplitudes:  32%|███▏      | 5179/16384 [00:00<00:01, 6316.45probe position/s]Normalizing amplitudes:  36%|███▌      | 5844/16384 [00:00<00:01, 6416.45probe position/s]Normalizing amplitudes:  40%|███▉      | 6489/16384 [00:01<00:01, 6225.96probe position/s]Normalizing amplitudes:  43%|████▎     | 7115/16384 [00:01<00:01, 6061.59probe position/s]Normalizing amplitudes:  47%|████▋     | 7724/16384 [00:01<00:01, 5639.89probe position/s]Normalizing amplitudes:  51%|█████     | 8295/16384 [00:01<00:01, 5656.39probe position/s]Normalizing amplitudes:  55%|█████▌    | 9038/16384 [00:01<00:01, 6160.28probe position/s]Normalizing amplitudes:  59%|█████▉    | 9736/16384 [00:01<00:01, 6395.67probe position/s]Normalizing amplitudes:  63%|██████▎   | 10381/16384 [00:01<00:00, 6256.22probe position/s]Normalizing amplitudes:  67%|██████▋   | 11011/16384 [00:01<00:00, 6030.63probe position/s]Normalizing amplitudes:  71%|███████   | 11619/16384 [00:01<00:00, 5955.48probe position/s]Normalizing amplitudes:  75%|███████▍  | 12218/16384 [00:02<00:00, 5864.05probe position/s]Normalizing amplitudes:  78%|███████▊  | 12807/16384 [00:02<00:00, 5761.94probe position/s]Normalizing amplitudes:  83%|████████▎ | 13550/16384 [00:02<00:00, 6238.28probe position/s]Normalizing amplitudes:  87%|████████▋ | 14214/16384 [00:02<00:00, 6352.67probe position/s]Normalizing amplitudes:  91%|█████████ | 14852/16384 [00:07<00:03, 403.21probe position/s] Normalizing amplitudes:  95%|█████████▍| 15535/16384 [00:07<00:01, 569.39probe position/s]Normalizing amplitudes:  98%|█████████▊| 16111/16384 [00:07<00:00, 754.29probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:07<00:00, 2119.59probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random128_p6_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random128_p6_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.03199 in 4.421 sec
Iter: 2, Total Loss: 0.006509 in 4.356 sec
Iter: 3, Total Loss: 0.006376 in 4.337 sec
Iter: 4, Total Loss: 0.006293 in 4.393 sec
Iter: 5, Total Loss: 0.006228 in 4.380 sec
Iter: 6, Total Loss: 0.006167 in 4.377 sec
Iter: 7, Total Loss: 0.00611 in 4.380 sec
Iter: 8, Total Loss: 0.006053 in 4.452 sec
Iter: 9, Total Loss: 0.005998 in 4.362 sec
Iter: 10, Total Loss: 0.005944 in 4.470 sec
Iter: 11, Total Loss: 0.00589 in 4.498 sec
Iter: 12, Total Loss: 0.005839 in 4.376 sec
Iter: 13, Total Loss: 0.00579 in 4.425 sec
Iter: 14, Total Loss: 0.005743 in 4.373 sec
Iter: 15, Total Loss: 0.005699 in 4.412 sec
Iter: 16, Total Loss: 0.005658 in 4.516 sec
Iter: 17, Total Loss: 0.005619 in 4.520 sec
Iter: 18, Total Loss: 0.005582 in 4.481 sec
Iter: 19, Total Loss: 0.005548 in 4.506 sec
Iter: 20, Total Loss: 0.005516 in 4.511 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 4.427 with std = 0.060 sec ###
### py4DSTEM ptycho solver is finished in 1 min 29.132 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 946.64 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 128, 6, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 534/16384 [00:00<00:02, 5329.04probe position/s]Normalizing amplitudes:   7%|▋         | 1070/16384 [00:00<00:02, 5346.72probe position/s]Normalizing amplitudes:  10%|▉         | 1614/16384 [00:00<00:02, 5386.74probe position/s]Normalizing amplitudes:  13%|█▎        | 2153/16384 [00:00<00:02, 5332.81probe position/s]Normalizing amplitudes:  17%|█▋        | 2833/16384 [00:00<00:02, 5856.60probe position/s]Normalizing amplitudes:  22%|██▏       | 3628/16384 [00:00<00:01, 6564.37probe position/s]Normalizing amplitudes:  26%|██▌       | 4286/16384 [00:00<00:01, 6051.24probe position/s]Normalizing amplitudes:  30%|██▉       | 4899/16384 [00:00<00:01, 5818.98probe position/s]Normalizing amplitudes:  33%|███▎      | 5487/16384 [00:00<00:01, 5623.29probe position/s]Normalizing amplitudes:  37%|███▋      | 6054/16384 [00:01<00:01, 5538.14probe position/s]Normalizing amplitudes:  41%|████      | 6637/16384 [00:01<00:01, 5621.20probe position/s]Normalizing amplitudes:  45%|████▌     | 7437/16384 [00:01<00:01, 6311.46probe position/s]Normalizing amplitudes:  49%|████▉     | 8074/16384 [00:01<00:01, 6318.96probe position/s]Normalizing amplitudes:  53%|█████▎    | 8710/16384 [00:01<00:01, 5936.47probe position/s]Normalizing amplitudes:  57%|█████▋    | 9311/16384 [00:01<00:01, 5680.68probe position/s]Normalizing amplitudes:  60%|██████    | 9885/16384 [00:01<00:01, 5572.77probe position/s]Normalizing amplitudes:  64%|██████▍   | 10447/16384 [00:01<00:01, 5472.73probe position/s]Normalizing amplitudes:  68%|██████▊   | 11060/16384 [00:01<00:00, 5656.75probe position/s]Normalizing amplitudes:  72%|███████▏  | 11850/16384 [00:02<00:00, 6300.02probe position/s]Normalizing amplitudes:  76%|███████▌  | 12486/16384 [00:02<00:00, 6228.71probe position/s]Normalizing amplitudes:  80%|████████  | 13113/16384 [00:02<00:00, 5912.95probe position/s]Normalizing amplitudes:  84%|████████▎ | 13710/16384 [00:02<00:00, 5743.35probe position/s]Normalizing amplitudes:  87%|████████▋ | 14289/16384 [00:02<00:00, 5583.24probe position/s]Normalizing amplitudes:  91%|█████████ | 14851/16384 [00:02<00:00, 5499.63probe position/s]Normalizing amplitudes:  95%|█████████▌| 15568/16384 [00:02<00:00, 5971.21probe position/s]Normalizing amplitudes: 100%|█████████▉| 16323/16384 [00:02<00:00, 6412.47probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5887.51probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random128_p6_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random128_p6_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.03277 in 12.938 sec
Iter: 2, Total Loss: 0.006483 in 12.817 sec
Iter: 3, Total Loss: 0.006298 in 12.773 sec
Iter: 4, Total Loss: 0.00621 in 12.880 sec
Iter: 5, Total Loss: 0.006136 in 12.688 sec
Iter: 6, Total Loss: 0.006067 in 12.884 sec
Iter: 7, Total Loss: 0.005997 in 12.898 sec
Iter: 8, Total Loss: 0.005928 in 12.915 sec
Iter: 9, Total Loss: 0.00586 in 12.722 sec
Iter: 10, Total Loss: 0.005796 in 12.809 sec
Iter: 11, Total Loss: 0.005733 in 12.874 sec
Iter: 12, Total Loss: 0.005675 in 12.983 sec
Iter: 13, Total Loss: 0.005619 in 12.790 sec
Iter: 14, Total Loss: 0.005566 in 12.689 sec
Iter: 15, Total Loss: 0.005517 in 12.869 sec
Iter: 16, Total Loss: 0.005471 in 12.866 sec
Iter: 17, Total Loss: 0.005427 in 12.916 sec
Iter: 18, Total Loss: 0.005387 in 12.996 sec
Iter: 19, Total Loss: 0.00535 in 12.976 sec
Iter: 20, Total Loss: 0.005315 in 12.851 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 12.857 with std = 0.089 sec ###
### py4DSTEM ptycho solver is finished in 4 min 18.303 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 939.59 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 128, 6, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 540/16384 [00:00<00:02, 5390.48probe position/s]Normalizing amplitudes:   7%|▋         | 1080/16384 [00:00<00:02, 5338.59probe position/s]Normalizing amplitudes:  10%|▉         | 1614/16384 [00:00<00:02, 5292.67probe position/s]Normalizing amplitudes:  14%|█▍        | 2350/16384 [00:00<00:02, 6100.85probe position/s]Normalizing amplitudes:  19%|█▉        | 3077/16384 [00:00<00:02, 6518.09probe position/s]Normalizing amplitudes:  23%|██▎       | 3730/16384 [00:00<00:02, 6071.93probe position/s]Normalizing amplitudes:  27%|██▋       | 4343/16384 [00:00<00:02, 5853.62probe position/s]Normalizing amplitudes:  30%|███       | 4933/16384 [00:00<00:01, 5805.75probe position/s]Normalizing amplitudes:  34%|███▎      | 5517/16384 [00:00<00:01, 5779.16probe position/s]Normalizing amplitudes:  37%|███▋      | 6097/16384 [00:01<00:01, 5623.07probe position/s]Normalizing amplitudes:  42%|████▏     | 6849/16384 [00:01<00:01, 6175.46probe position/s]Normalizing amplitudes:  46%|████▌     | 7509/16384 [00:01<00:01, 6298.68probe position/s]Normalizing amplitudes:  50%|████▉     | 8142/16384 [00:01<00:01, 6071.00probe position/s]Normalizing amplitudes:  53%|█████▎    | 8753/16384 [00:01<00:01, 5844.60probe position/s]Normalizing amplitudes:  57%|█████▋    | 9341/16384 [00:01<00:01, 5750.02probe position/s]Normalizing amplitudes:  61%|██████    | 9919/16384 [00:01<00:01, 5644.79probe position/s]Normalizing amplitudes:  64%|██████▍   | 10486/16384 [00:01<00:01, 5599.76probe position/s]Normalizing amplitudes:  69%|██████▊   | 11224/16384 [00:01<00:00, 6110.14probe position/s]Normalizing amplitudes:  73%|███████▎  | 11889/16384 [00:01<00:00, 6265.58probe position/s]Normalizing amplitudes:  76%|███████▋  | 12519/16384 [00:02<00:00, 5913.59probe position/s]Normalizing amplitudes:  80%|████████  | 13116/16384 [00:02<00:00, 5799.53probe position/s]Normalizing amplitudes:  84%|████████▎ | 13700/16384 [00:02<00:00, 5701.88probe position/s]Normalizing amplitudes:  87%|████████▋ | 14273/16384 [00:02<00:00, 5647.17probe position/s]Normalizing amplitudes:  91%|█████████ | 14874/16384 [00:02<00:00, 5749.93probe position/s]Normalizing amplitudes:  96%|█████████▌| 15660/16384 [00:02<00:00, 6361.41probe position/s]Normalizing amplitudes:  99%|█████████▉| 16300/16384 [00:02<00:00, 6256.95probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5941.10probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random128_p6_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random128_p6_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.03368 in 24.706 sec
Iter: 2, Total Loss: 0.006524 in 24.805 sec
Iter: 3, Total Loss: 0.00619 in 24.770 sec
Iter: 4, Total Loss: 0.006059 in 24.775 sec
Iter: 5, Total Loss: 0.005955 in 25.427 sec
Iter: 6, Total Loss: 0.005861 in 25.115 sec
Iter: 7, Total Loss: 0.005771 in 25.152 sec
Iter: 8, Total Loss: 0.005689 in 25.077 sec
Iter: 9, Total Loss: 0.00561 in 25.223 sec
Iter: 10, Total Loss: 0.005538 in 25.176 sec
Iter: 11, Total Loss: 0.005473 in 25.144 sec
Iter: 12, Total Loss: 0.005413 in 25.302 sec
Iter: 13, Total Loss: 0.00536 in 25.007 sec
Iter: 14, Total Loss: 0.005312 in 25.431 sec
Iter: 15, Total Loss: 0.005268 in 24.792 sec
Iter: 16, Total Loss: 0.005229 in 24.321 sec
Iter: 17, Total Loss: 0.005193 in 24.222 sec
Iter: 18, Total Loss: 0.00516 in 24.204 sec
Iter: 19, Total Loss: 0.005129 in 24.171 sec
Iter: 20, Total Loss: 0.005101 in 24.209 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 24.851 with std = 0.415 sec ###
### py4DSTEM ptycho solver is finished in 8 min 17.634 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 939.43 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 128, 12, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   5%|▍         | 782/16384 [00:00<00:01, 7810.31probe position/s]Normalizing amplitudes:  10%|▉         | 1564/16384 [00:00<00:02, 6635.24probe position/s]Normalizing amplitudes:  14%|█▎        | 2239/16384 [00:00<00:02, 6090.39probe position/s]Normalizing amplitudes:  17%|█▋        | 2856/16384 [00:00<00:02, 5846.63probe position/s]Normalizing amplitudes:  21%|██        | 3445/16384 [00:00<00:02, 5692.44probe position/s]Normalizing amplitudes:  25%|██▍       | 4016/16384 [00:00<00:02, 5652.31probe position/s]Normalizing amplitudes:  29%|██▉       | 4728/16384 [00:00<00:01, 6100.08probe position/s]Normalizing amplitudes:  33%|███▎      | 5481/16384 [00:00<00:01, 6533.71probe position/s]Normalizing amplitudes:  37%|███▋      | 6139/16384 [00:01<00:01, 6105.47probe position/s]Normalizing amplitudes:  41%|████      | 6758/16384 [00:01<00:01, 5906.47probe position/s]Normalizing amplitudes:  45%|████▍     | 7355/16384 [00:01<00:01, 5723.47probe position/s]Normalizing amplitudes:  48%|████▊     | 7932/16384 [00:01<00:01, 5641.92probe position/s]Normalizing amplitudes:  52%|█████▏    | 8499/16384 [00:01<00:01, 5594.20probe position/s]Normalizing amplitudes:  56%|█████▋    | 9245/16384 [00:01<00:01, 6126.46probe position/s]Normalizing amplitudes:  61%|██████    | 9935/16384 [00:01<00:01, 6342.35probe position/s]Normalizing amplitudes:  65%|██████▍   | 10573/16384 [00:01<00:00, 6047.70probe position/s]Normalizing amplitudes:  68%|██████▊   | 11183/16384 [00:01<00:00, 5780.14probe position/s]Normalizing amplitudes:  72%|███████▏  | 11766/16384 [00:01<00:00, 5687.99probe position/s]Normalizing amplitudes:  75%|███████▌  | 12338/16384 [00:02<00:00, 5626.77probe position/s]Normalizing amplitudes:  79%|███████▉  | 12903/16384 [00:02<00:00, 5603.04probe position/s]Normalizing amplitudes:  83%|████████▎ | 13605/16384 [00:02<00:00, 6009.98probe position/s]Normalizing amplitudes:  88%|████████▊ | 14362/16384 [00:02<00:00, 6461.76probe position/s]Normalizing amplitudes:  92%|█████████▏| 15012/16384 [00:02<00:00, 6036.65probe position/s]Normalizing amplitudes:  95%|█████████▌| 15624/16384 [00:02<00:00, 5858.71probe position/s]Normalizing amplitudes:  99%|█████████▉| 16216/16384 [00:02<00:00, 5674.44probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5920.07probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random128_p12_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random128_p12_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.07498 in 8.674 sec
Iter: 2, Total Loss: 0.006543 in 8.634 sec
Iter: 3, Total Loss: 0.006377 in 8.652 sec
Iter: 4, Total Loss: 0.006279 in 8.690 sec
Iter: 5, Total Loss: 0.006201 in 8.668 sec
Iter: 6, Total Loss: 0.006132 in 8.697 sec
Iter: 7, Total Loss: 0.006065 in 8.726 sec
Iter: 8, Total Loss: 0.006001 in 8.610 sec
Iter: 9, Total Loss: 0.005938 in 8.620 sec
Iter: 10, Total Loss: 0.005879 in 8.626 sec
Iter: 11, Total Loss: 0.005823 in 8.592 sec
Iter: 12, Total Loss: 0.005772 in 8.550 sec
Iter: 13, Total Loss: 0.005725 in 8.614 sec
Iter: 14, Total Loss: 0.00568 in 8.600 sec
Iter: 15, Total Loss: 0.00564 in 8.490 sec
Iter: 16, Total Loss: 0.005602 in 8.357 sec
Iter: 17, Total Loss: 0.005567 in 8.353 sec
Iter: 18, Total Loss: 0.005534 in 8.391 sec
Iter: 19, Total Loss: 0.005502 in 8.386 sec
Iter: 20, Total Loss: 0.005471 in 8.363 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 8.565 with std = 0.123 sec ###
### py4DSTEM ptycho solver is finished in 2 min 51.832 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 942.27 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 128, 12, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 591/16384 [00:00<00:02, 5903.12probe position/s]Normalizing amplitudes:   8%|▊         | 1280/16384 [00:00<00:02, 6479.22probe position/s]Normalizing amplitudes:  12%|█▏        | 1942/16384 [00:00<00:02, 6538.33probe position/s]Normalizing amplitudes:  16%|█▌        | 2596/16384 [00:00<00:02, 6056.35probe position/s]Normalizing amplitudes:  20%|█▉        | 3207/16384 [00:00<00:02, 5674.70probe position/s]Normalizing amplitudes:  23%|██▎       | 3781/16384 [00:00<00:02, 5543.20probe position/s]Normalizing amplitudes:  27%|██▋       | 4481/16384 [00:00<00:01, 5984.19probe position/s]Normalizing amplitudes:  32%|███▏      | 5239/16384 [00:00<00:01, 6465.05probe position/s]Normalizing amplitudes:  36%|███▌      | 5892/16384 [00:00<00:01, 6126.60probe position/s]Normalizing amplitudes:  40%|███▉      | 6512/16384 [00:01<00:01, 5677.67probe position/s]Normalizing amplitudes:  43%|████▎     | 7090/16384 [00:01<00:01, 5545.11probe position/s]Normalizing amplitudes:  47%|████▋     | 7659/16384 [00:01<00:01, 5584.51probe position/s]Normalizing amplitudes:  51%|█████     | 8360/16384 [00:01<00:01, 5988.16probe position/s]Normalizing amplitudes:  56%|█████▌    | 9144/16384 [00:01<00:01, 6520.53probe position/s]Normalizing amplitudes:  60%|█████▉    | 9803/16384 [00:01<00:01, 6092.41probe position/s]Normalizing amplitudes:  64%|██████▎   | 10422/16384 [00:01<00:01, 5854.86probe position/s]Normalizing amplitudes:  67%|██████▋   | 11015/16384 [00:01<00:00, 5789.33probe position/s]Normalizing amplitudes:  71%|███████   | 11599/16384 [00:01<00:00, 5711.15probe position/s]Normalizing amplitudes:  76%|███████▌  | 12377/16384 [00:02<00:00, 6294.09probe position/s]Normalizing amplitudes:  80%|███████▉  | 13052/16384 [00:02<00:00, 6423.47probe position/s]Normalizing amplitudes:  84%|████████▎ | 13700/16384 [00:02<00:00, 6148.91probe position/s]Normalizing amplitudes:  87%|████████▋ | 14321/16384 [00:02<00:00, 5939.51probe position/s]Normalizing amplitudes:  91%|█████████ | 14920/16384 [00:02<00:00, 5783.17probe position/s]Normalizing amplitudes:  95%|█████████▍| 15502/16384 [00:02<00:00, 5771.16probe position/s]Normalizing amplitudes:  99%|█████████▉| 16284/16384 [00:02<00:00, 6354.99probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6032.28probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random128_p12_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random128_p12_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.07534 in 24.195 sec
Iter: 2, Total Loss: 0.00657 in 24.202 sec
Iter: 3, Total Loss: 0.006255 in 23.846 sec
Iter: 4, Total Loss: 0.006119 in 23.671 sec
Iter: 5, Total Loss: 0.006016 in 23.719 sec
Iter: 6, Total Loss: 0.005925 in 23.697 sec
Iter: 7, Total Loss: 0.00584 in 23.656 sec
Iter: 8, Total Loss: 0.00576 in 24.222 sec
Iter: 9, Total Loss: 0.005686 in 24.822 sec
Iter: 10, Total Loss: 0.005618 in 24.836 sec
Iter: 11, Total Loss: 0.005554 in 24.953 sec
Iter: 12, Total Loss: 0.005496 in 24.817 sec
Iter: 13, Total Loss: 0.005442 in 24.913 sec
Iter: 14, Total Loss: 0.005393 in 24.878 sec
Iter: 15, Total Loss: 0.005348 in 24.932 sec
Iter: 16, Total Loss: 0.005306 in 24.891 sec
Iter: 17, Total Loss: 0.005268 in 24.716 sec
Iter: 18, Total Loss: 0.005232 in 24.643 sec
Iter: 19, Total Loss: 0.005199 in 24.706 sec
Iter: 20, Total Loss: 0.005167 in 24.648 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 24.448 with std = 0.479 sec ###
### py4DSTEM ptycho solver is finished in 8 min 9.810 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 939.23 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 128, 12, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   5%|▍         | 765/16384 [00:00<00:02, 7638.88probe position/s]Normalizing amplitudes:   9%|▉         | 1529/16384 [00:00<00:02, 6874.44probe position/s]Normalizing amplitudes:  14%|█▎        | 2222/16384 [00:00<00:02, 6145.21probe position/s]Normalizing amplitudes:  17%|█▋        | 2845/16384 [00:00<00:02, 5908.00probe position/s]Normalizing amplitudes:  21%|██        | 3440/16384 [00:00<00:02, 5818.56probe position/s]Normalizing amplitudes:  25%|██▍       | 4024/16384 [00:00<00:02, 5690.97probe position/s]Normalizing amplitudes:  28%|██▊       | 4664/16384 [00:00<00:01, 5906.87probe position/s]Normalizing amplitudes:  33%|███▎      | 5440/16384 [00:00<00:01, 6467.16probe position/s]Normalizing amplitudes:  37%|███▋      | 6091/16384 [00:00<00:01, 6184.02probe position/s]Normalizing amplitudes:  41%|████      | 6715/16384 [00:01<00:01, 6001.60probe position/s]Normalizing amplitudes:  45%|████▍     | 7319/16384 [00:01<00:01, 5833.85probe position/s]Normalizing amplitudes:  48%|████▊     | 7906/16384 [00:01<00:01, 5672.29probe position/s]Normalizing amplitudes:  52%|█████▏    | 8476/16384 [00:01<00:01, 5626.16probe position/s]Normalizing amplitudes:  56%|█████▌    | 9130/16384 [00:01<00:01, 5887.20probe position/s]Normalizing amplitudes:  60%|██████    | 9904/16384 [00:01<00:01, 6424.32probe position/s]Normalizing amplitudes:  64%|██████▍   | 10551/16384 [00:01<00:00, 6128.01probe position/s]Normalizing amplitudes:  68%|██████▊   | 11169/16384 [00:01<00:00, 5935.02probe position/s]Normalizing amplitudes:  72%|███████▏  | 11767/16384 [00:01<00:00, 5772.71probe position/s]Normalizing amplitudes:  75%|███████▌  | 12348/16384 [00:02<00:00, 5679.21probe position/s]Normalizing amplitudes:  79%|███████▉  | 12918/16384 [00:02<00:00, 5562.43probe position/s]Normalizing amplitudes:  83%|████████▎ | 13649/16384 [00:02<00:00, 6057.44probe position/s]Normalizing amplitudes:  88%|████████▊ | 14376/16384 [00:02<00:00, 6406.41probe position/s]Normalizing amplitudes:  92%|█████████▏| 15021/16384 [00:02<00:00, 6035.63probe position/s]Normalizing amplitudes:  95%|█████████▌| 15632/16384 [00:02<00:00, 5820.78probe position/s]Normalizing amplitudes:  99%|█████████▉| 16220/16384 [00:02<00:00, 5716.54probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5944.36probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random128_p12_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random128_p12_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.07727 in 49.436 sec
Iter: 2, Total Loss: 0.006763 in 49.339 sec
Iter: 3, Total Loss: 0.006199 in 49.119 sec
Iter: 4, Total Loss: 0.006023 in 49.208 sec
Iter: 5, Total Loss: 0.005905 in 49.157 sec
Iter: 6, Total Loss: 0.005806 in 49.366 sec
Iter: 7, Total Loss: 0.005719 in 49.585 sec
Iter: 8, Total Loss: 0.00564 in 49.700 sec
Iter: 9, Total Loss: 0.005569 in 48.980 sec
Iter: 10, Total Loss: 0.005504 in 48.484 sec
Iter: 11, Total Loss: 0.005445 in 49.381 sec
Iter: 12, Total Loss: 0.00539 in 49.527 sec
Iter: 13, Total Loss: 0.005341 in 49.202 sec
Iter: 14, Total Loss: 0.005294 in 49.566 sec
Iter: 15, Total Loss: 0.005252 in 48.557 sec
Iter: 16, Total Loss: 0.005213 in 48.256 sec
Iter: 17, Total Loss: 0.005177 in 48.142 sec
Iter: 18, Total Loss: 0.005144 in 47.864 sec
Iter: 19, Total Loss: 0.005112 in 48.484 sec
Iter: 20, Total Loss: 0.005083 in 47.458 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 48.940 with std = 0.623 sec ###
### py4DSTEM ptycho solver is finished in 16 min 19.497 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 942.35 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 64, 1, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 596/16384 [00:00<00:02, 5923.23probe position/s]Normalizing amplitudes:   7%|▋         | 1225/16384 [00:00<00:02, 6135.35probe position/s]Normalizing amplitudes:  12%|█▏        | 2017/16384 [00:00<00:02, 6947.66probe position/s]Normalizing amplitudes:  17%|█▋        | 2712/16384 [00:00<00:02, 6566.44probe position/s]Normalizing amplitudes:  21%|██        | 3372/16384 [00:00<00:02, 6240.45probe position/s]Normalizing amplitudes:  24%|██▍       | 4000/16384 [00:00<00:02, 6016.15probe position/s]Normalizing amplitudes:  28%|██▊       | 4605/16384 [00:00<00:01, 5900.22probe position/s]Normalizing amplitudes:  32%|███▏      | 5197/16384 [00:00<00:01, 5797.46probe position/s]Normalizing amplitudes:  36%|███▌      | 5883/16384 [00:00<00:01, 6111.61probe position/s]Normalizing amplitudes:  41%|████      | 6670/16384 [00:01<00:01, 6631.40probe position/s]Normalizing amplitudes:  45%|████▍     | 7337/16384 [00:01<00:01, 6226.58probe position/s]Normalizing amplitudes:  49%|████▊     | 7967/16384 [00:01<00:01, 6059.07probe position/s]Normalizing amplitudes:  52%|█████▏    | 8578/16384 [00:01<00:01, 5901.68probe position/s]Normalizing amplitudes:  56%|█████▌    | 9172/16384 [00:01<00:01, 5862.11probe position/s]Normalizing amplitudes:  60%|█████▉    | 9761/16384 [00:01<00:01, 5865.20probe position/s]Normalizing amplitudes:  64%|██████▍   | 10465/16384 [00:01<00:00, 6205.25probe position/s]Normalizing amplitudes:  69%|██████▊   | 11231/16384 [00:01<00:00, 6627.74probe position/s]Normalizing amplitudes:  73%|███████▎  | 11897/16384 [00:01<00:00, 6208.39probe position/s]Normalizing amplitudes:  76%|███████▋  | 12525/16384 [00:02<00:00, 5933.34probe position/s]Normalizing amplitudes:  80%|████████  | 13125/16384 [00:02<00:00, 5907.09probe position/s]Normalizing amplitudes:  84%|████████▎ | 13720/16384 [00:02<00:00, 5855.74probe position/s]Normalizing amplitudes:  87%|████████▋ | 14309/16384 [00:02<00:00, 5720.36probe position/s]Normalizing amplitudes:  92%|█████████▏| 15040/16384 [00:02<00:00, 6170.50probe position/s]Normalizing amplitudes:  96%|█████████▋| 15781/16384 [00:02<00:00, 6527.53probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6132.53probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random64_p1_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random64_p1_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.007547 in 1.952 sec
Iter: 2, Total Loss: 0.006518 in 1.961 sec
Iter: 3, Total Loss: 0.006488 in 1.903 sec
Iter: 4, Total Loss: 0.00646 in 1.940 sec
Iter: 5, Total Loss: 0.006433 in 1.908 sec
Iter: 6, Total Loss: 0.006404 in 1.931 sec
Iter: 7, Total Loss: 0.006376 in 1.922 sec
Iter: 8, Total Loss: 0.006347 in 1.941 sec
Iter: 9, Total Loss: 0.006319 in 1.940 sec
Iter: 10, Total Loss: 0.006292 in 1.961 sec
Iter: 11, Total Loss: 0.006269 in 1.952 sec
Iter: 12, Total Loss: 0.006245 in 1.943 sec
Iter: 13, Total Loss: 0.006225 in 1.926 sec
Iter: 14, Total Loss: 0.006205 in 1.959 sec
Iter: 15, Total Loss: 0.006189 in 1.912 sec
Iter: 16, Total Loss: 0.006172 in 1.934 sec
Iter: 17, Total Loss: 0.006158 in 1.966 sec
Iter: 18, Total Loss: 0.006144 in 1.914 sec
Iter: 19, Total Loss: 0.006134 in 1.907 sec
Iter: 20, Total Loss: 0.006123 in 1.930 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 1.935 with std = 0.019 sec ###
### py4DSTEM ptycho solver is finished in 39.328 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 942.34 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 64, 1, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 561/16384 [00:00<00:02, 5607.01probe position/s]Normalizing amplitudes:   8%|▊         | 1354/16384 [00:00<00:02, 6970.11probe position/s]Normalizing amplitudes:  13%|█▎        | 2051/16384 [00:00<00:02, 6749.35probe position/s]Normalizing amplitudes:  17%|█▋        | 2727/16384 [00:00<00:02, 6275.34probe position/s]Normalizing amplitudes:  21%|██        | 3359/16384 [00:00<00:02, 6137.19probe position/s]Normalizing amplitudes:  24%|██▍       | 3976/16384 [00:00<00:02, 5972.94probe position/s]Normalizing amplitudes:  28%|██▊       | 4576/16384 [00:00<00:02, 5806.52probe position/s]Normalizing amplitudes:  32%|███▏      | 5236/16384 [00:00<00:01, 6043.51probe position/s]Normalizing amplitudes:  37%|███▋      | 6005/16384 [00:00<00:01, 6534.73probe position/s]Normalizing amplitudes:  41%|████      | 6663/16384 [00:01<00:01, 6330.26probe position/s]Normalizing amplitudes:  45%|████▍     | 7300/16384 [00:01<00:01, 6071.45probe position/s]Normalizing amplitudes:  48%|████▊     | 7911/16384 [00:01<00:01, 5968.04probe position/s]Normalizing amplitudes:  52%|█████▏    | 8511/16384 [00:01<00:01, 5886.48probe position/s]Normalizing amplitudes:  56%|█████▌    | 9102/16384 [00:01<00:01, 5811.66probe position/s]Normalizing amplitudes:  60%|██████    | 9893/16384 [00:01<00:01, 6414.24probe position/s]Normalizing amplitudes:  64%|██████▍   | 10563/16384 [00:01<00:00, 6495.70probe position/s]Normalizing amplitudes:  68%|██████▊   | 11216/16384 [00:01<00:00, 6236.01probe position/s]Normalizing amplitudes:  72%|███████▏  | 11844/16384 [00:01<00:00, 6039.70probe position/s]Normalizing amplitudes:  76%|███████▌  | 12452/16384 [00:02<00:00, 5891.90probe position/s]Normalizing amplitudes:  80%|███████▉  | 13044/16384 [00:02<00:00, 5872.43probe position/s]Normalizing amplitudes:  84%|████████▍ | 13748/16384 [00:02<00:00, 6205.50probe position/s]Normalizing amplitudes:  89%|████████▊ | 14534/16384 [00:02<00:00, 6680.30probe position/s]Normalizing amplitudes:  93%|█████████▎| 15206/16384 [00:02<00:00, 6255.37probe position/s]Normalizing amplitudes:  97%|█████████▋| 15839/16384 [00:02<00:00, 6120.88probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6148.12probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random64_p1_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random64_p1_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.007625 in 4.525 sec
Iter: 2, Total Loss: 0.006528 in 4.444 sec
Iter: 3, Total Loss: 0.006485 in 4.460 sec
Iter: 4, Total Loss: 0.006448 in 4.460 sec
Iter: 5, Total Loss: 0.00641 in 4.422 sec
Iter: 6, Total Loss: 0.006375 in 4.458 sec
Iter: 7, Total Loss: 0.006342 in 4.421 sec
Iter: 8, Total Loss: 0.006312 in 4.431 sec
Iter: 9, Total Loss: 0.006283 in 4.436 sec
Iter: 10, Total Loss: 0.006256 in 4.417 sec
Iter: 11, Total Loss: 0.006232 in 4.442 sec
Iter: 12, Total Loss: 0.006209 in 4.471 sec
Iter: 13, Total Loss: 0.006187 in 4.444 sec
Iter: 14, Total Loss: 0.006171 in 4.430 sec
Iter: 15, Total Loss: 0.006152 in 4.398 sec
Iter: 16, Total Loss: 0.006137 in 4.370 sec
Iter: 17, Total Loss: 0.006124 in 4.455 sec
Iter: 18, Total Loss: 0.00611 in 4.454 sec
Iter: 19, Total Loss: 0.006096 in 4.474 sec
Iter: 20, Total Loss: 0.006087 in 4.447 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 4.443 with std = 0.031 sec ###
### py4DSTEM ptycho solver is finished in 1 min 29.432 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 942.32 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 64, 1, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 583/16384 [00:00<00:02, 5828.69probe position/s]Normalizing amplitudes:   7%|▋         | 1166/16384 [00:00<00:02, 5717.72probe position/s]Normalizing amplitudes:  11%|█         | 1738/16384 [00:00<00:02, 5651.86probe position/s]Normalizing amplitudes:  14%|█▍        | 2329/16384 [00:00<00:02, 5746.79probe position/s]Normalizing amplitudes:  18%|█▊        | 2904/16384 [00:00<00:02, 5653.00probe position/s]Normalizing amplitudes:  22%|██▏       | 3679/16384 [00:00<00:02, 6351.76probe position/s]Normalizing amplitudes:  26%|██▋       | 4330/16384 [00:00<00:01, 6389.12probe position/s]Normalizing amplitudes:  30%|███       | 4970/16384 [00:00<00:01, 6007.23probe position/s]Normalizing amplitudes:  34%|███▍      | 5576/16384 [00:00<00:01, 6011.30probe position/s]Normalizing amplitudes:  38%|███▊      | 6181/16384 [00:01<00:01, 5848.97probe position/s]Normalizing amplitudes:  41%|████▏     | 6769/16384 [00:01<00:01, 5713.89probe position/s]Normalizing amplitudes:  46%|████▌     | 7482/16384 [00:01<00:01, 6122.58probe position/s]Normalizing amplitudes:  50%|█████     | 8251/16384 [00:01<00:01, 6574.49probe position/s]Normalizing amplitudes:  54%|█████▍    | 8913/16384 [00:01<00:01, 6116.59probe position/s]Normalizing amplitudes:  58%|█████▊    | 9534/16384 [00:01<00:01, 5961.77probe position/s]Normalizing amplitudes:  62%|██████▏   | 10137/16384 [00:01<00:01, 5829.38probe position/s]Normalizing amplitudes:  65%|██████▌   | 10724/16384 [00:01<00:00, 5764.98probe position/s]Normalizing amplitudes:  70%|██████▉   | 11447/16384 [00:01<00:00, 6179.62probe position/s]Normalizing amplitudes:  74%|███████▍  | 12185/16384 [00:02<00:00, 6522.14probe position/s]Normalizing amplitudes:  78%|███████▊  | 12842/16384 [00:02<00:00, 6221.63probe position/s]Normalizing amplitudes:  82%|████████▏ | 13470/16384 [00:02<00:00, 5980.14probe position/s]Normalizing amplitudes:  86%|████████▌ | 14073/16384 [00:02<00:00, 5917.79probe position/s]Normalizing amplitudes:  90%|████████▉ | 14668/16384 [00:02<00:00, 5843.85probe position/s]Normalizing amplitudes:  94%|█████████▎| 15346/16384 [00:02<00:00, 6108.60probe position/s]Normalizing amplitudes:  98%|█████████▊| 16122/16384 [00:02<00:00, 6585.60probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6075.91probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random64_p1_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random64_p1_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.007774 in 8.302 sec
Iter: 2, Total Loss: 0.006577 in 8.205 sec
Iter: 3, Total Loss: 0.006526 in 8.385 sec
Iter: 4, Total Loss: 0.006472 in 8.139 sec
Iter: 5, Total Loss: 0.006431 in 8.231 sec
Iter: 6, Total Loss: 0.006395 in 8.251 sec
Iter: 7, Total Loss: 0.006353 in 8.126 sec
Iter: 8, Total Loss: 0.006322 in 8.197 sec
Iter: 9, Total Loss: 0.006291 in 8.181 sec
Iter: 10, Total Loss: 0.00626 in 8.086 sec
Iter: 11, Total Loss: 0.006233 in 8.320 sec
Iter: 12, Total Loss: 0.006208 in 8.442 sec
Iter: 13, Total Loss: 0.006184 in 8.436 sec
Iter: 14, Total Loss: 0.006158 in 8.432 sec
Iter: 15, Total Loss: 0.006139 in 8.472 sec
Iter: 16, Total Loss: 0.006118 in 8.548 sec
Iter: 17, Total Loss: 0.006096 in 8.266 sec
Iter: 18, Total Loss: 0.006079 in 8.434 sec
Iter: 19, Total Loss: 0.006058 in 8.443 sec
Iter: 20, Total Loss: 0.006044 in 8.437 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 8.317 with std = 0.132 sec ###
### py4DSTEM ptycho solver is finished in 2 min 48.857 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 942.32 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 64, 3, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 538/16384 [00:00<00:02, 5379.85probe position/s]Normalizing amplitudes:   7%|▋         | 1076/16384 [00:00<00:02, 5288.43probe position/s]Normalizing amplitudes:  10%|▉         | 1605/16384 [00:00<00:02, 5243.03probe position/s]Normalizing amplitudes:  15%|█▍        | 2384/16384 [00:00<00:02, 6235.73probe position/s]Normalizing amplitudes:  19%|█▊        | 3059/16384 [00:00<00:02, 6417.83probe position/s]Normalizing amplitudes:  23%|██▎       | 3702/16384 [00:00<00:02, 6036.05probe position/s]Normalizing amplitudes:  26%|██▋       | 4310/16384 [00:00<00:02, 5748.25probe position/s]Normalizing amplitudes:  30%|██▉       | 4890/16384 [00:00<00:02, 5610.45probe position/s]Normalizing amplitudes:  33%|███▎      | 5455/16384 [00:00<00:01, 5508.61probe position/s]Normalizing amplitudes:  37%|███▋      | 6008/16384 [00:01<00:01, 5443.41probe position/s]Normalizing amplitudes:  41%|████      | 6744/16384 [00:01<00:01, 5998.88probe position/s]Normalizing amplitudes:  46%|████▌     | 7469/16384 [00:01<00:01, 6364.62probe position/s]Normalizing amplitudes:  49%|████▉     | 8110/16384 [00:01<00:01, 5938.45probe position/s]Normalizing amplitudes:  53%|█████▎    | 8712/16384 [00:01<00:01, 5751.37probe position/s]Normalizing amplitudes:  57%|█████▋    | 9293/16384 [00:01<00:01, 5636.58probe position/s]Normalizing amplitudes:  60%|██████    | 9861/16384 [00:01<00:01, 5553.45probe position/s]Normalizing amplitudes:  64%|██████▎   | 10419/16384 [00:01<00:01, 5475.13probe position/s]Normalizing amplitudes:  68%|██████▊   | 11068/16384 [00:01<00:00, 5763.76probe position/s]Normalizing amplitudes:  72%|███████▏  | 11855/16384 [00:02<00:00, 6371.75probe position/s]Normalizing amplitudes:  76%|███████▋  | 12497/16384 [00:02<00:00, 6069.10probe position/s]Normalizing amplitudes:  80%|████████  | 13110/16384 [00:02<00:00, 5826.49probe position/s]Normalizing amplitudes:  84%|████████▎ | 13698/16384 [00:02<00:00, 5721.80probe position/s]Normalizing amplitudes:  87%|████████▋ | 14274/16384 [00:02<00:00, 5631.85probe position/s]Normalizing amplitudes:  91%|█████████ | 14840/16384 [00:02<00:00, 5549.17probe position/s]Normalizing amplitudes:  94%|█████████▍| 15400/16384 [00:02<00:00, 5563.32probe position/s]Normalizing amplitudes:  99%|█████████▉| 16189/16384 [00:02<00:00, 6234.97probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5855.96probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random64_p3_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random64_p3_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.01068 in 4.225 sec
Iter: 2, Total Loss: 0.006445 in 4.173 sec
Iter: 3, Total Loss: 0.006357 in 4.207 sec
Iter: 4, Total Loss: 0.006279 in 4.222 sec
Iter: 5, Total Loss: 0.006197 in 4.198 sec
Iter: 6, Total Loss: 0.006117 in 4.210 sec
Iter: 7, Total Loss: 0.006038 in 4.202 sec
Iter: 8, Total Loss: 0.005964 in 4.209 sec
Iter: 9, Total Loss: 0.005896 in 4.245 sec
Iter: 10, Total Loss: 0.005833 in 4.143 sec
Iter: 11, Total Loss: 0.005775 in 4.206 sec
Iter: 12, Total Loss: 0.005722 in 4.183 sec
Iter: 13, Total Loss: 0.005674 in 4.214 sec
Iter: 14, Total Loss: 0.005629 in 4.174 sec
Iter: 15, Total Loss: 0.00559 in 4.154 sec
Iter: 16, Total Loss: 0.005555 in 4.186 sec
Iter: 17, Total Loss: 0.005525 in 4.189 sec
Iter: 18, Total Loss: 0.005496 in 4.139 sec
Iter: 19, Total Loss: 0.005472 in 4.162 sec
Iter: 20, Total Loss: 0.005449 in 4.173 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 4.191 with std = 0.028 sec ###
### py4DSTEM ptycho solver is finished in 1 min 24.376 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 942.32 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 64, 3, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 561/16384 [00:00<00:02, 5605.70probe position/s]Normalizing amplitudes:   7%|▋         | 1122/16384 [00:00<00:02, 5504.14probe position/s]Normalizing amplitudes:  10%|█         | 1696/16384 [00:00<00:02, 5605.10probe position/s]Normalizing amplitudes:  14%|█▍        | 2279/16384 [00:00<00:02, 5692.22probe position/s]Normalizing amplitudes:  19%|█▊        | 3047/16384 [00:00<00:02, 6404.64probe position/s]Normalizing amplitudes:  23%|██▎       | 3688/16384 [00:00<00:02, 6332.44probe position/s]Normalizing amplitudes:  26%|██▋       | 4322/16384 [00:00<00:01, 6101.13probe position/s]Normalizing amplitudes:  30%|███       | 4934/16384 [00:00<00:01, 5903.06probe position/s]Normalizing amplitudes:  34%|███▎      | 5527/16384 [00:00<00:01, 5738.19probe position/s]Normalizing amplitudes:  38%|███▊      | 6149/16384 [00:01<00:01, 5878.86probe position/s]Normalizing amplitudes:  42%|████▏     | 6941/16384 [00:01<00:01, 6478.45probe position/s]Normalizing amplitudes:  46%|████▋     | 7593/16384 [00:01<00:01, 6447.86probe position/s]Normalizing amplitudes:  50%|█████     | 8241/16384 [00:01<00:01, 6168.57probe position/s]Normalizing amplitudes:  54%|█████▍    | 8862/16384 [00:01<00:01, 5967.78probe position/s]Normalizing amplitudes:  58%|█████▊    | 9463/16384 [00:01<00:01, 5771.56probe position/s]Normalizing amplitudes:  61%|██████▏   | 10043/16384 [00:01<00:01, 5689.41probe position/s]Normalizing amplitudes:  66%|██████▌   | 10810/16384 [00:01<00:00, 6249.44probe position/s]Normalizing amplitudes:  70%|██████▉   | 11465/16384 [00:01<00:00, 6333.79probe position/s]Normalizing amplitudes:  74%|███████▍  | 12102/16384 [00:02<00:00, 5960.18probe position/s]Normalizing amplitudes:  78%|███████▊  | 12705/16384 [00:02<00:00, 5825.76probe position/s]Normalizing amplitudes:  81%|████████  | 13292/16384 [00:02<00:00, 5712.00probe position/s]Normalizing amplitudes:  85%|████████▍ | 13867/16384 [00:02<00:00, 5648.56probe position/s]Normalizing amplitudes:  88%|████████▊ | 14460/16384 [00:02<00:00, 5726.76probe position/s]Normalizing amplitudes:  93%|█████████▎| 15255/16384 [00:02<00:00, 6368.86probe position/s]Normalizing amplitudes:  97%|█████████▋| 15896/16384 [00:02<00:00, 6268.73probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5985.99probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random64_p3_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random64_p3_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.01121 in 11.181 sec
Iter: 2, Total Loss: 0.006354 in 11.251 sec
Iter: 3, Total Loss: 0.006203 in 11.202 sec
Iter: 4, Total Loss: 0.006093 in 11.225 sec
Iter: 5, Total Loss: 0.005989 in 11.168 sec
Iter: 6, Total Loss: 0.005892 in 11.235 sec
Iter: 7, Total Loss: 0.005803 in 11.246 sec
Iter: 8, Total Loss: 0.005723 in 11.217 sec
Iter: 9, Total Loss: 0.005653 in 11.220 sec
Iter: 10, Total Loss: 0.005591 in 11.266 sec
Iter: 11, Total Loss: 0.005539 in 11.271 sec
Iter: 12, Total Loss: 0.005492 in 11.224 sec
Iter: 13, Total Loss: 0.005452 in 11.190 sec
Iter: 14, Total Loss: 0.005417 in 11.185 sec
Iter: 15, Total Loss: 0.005385 in 11.203 sec
Iter: 16, Total Loss: 0.005356 in 11.149 sec
Iter: 17, Total Loss: 0.00533 in 11.203 sec
Iter: 18, Total Loss: 0.005307 in 11.196 sec
Iter: 19, Total Loss: 0.005285 in 10.997 sec
Iter: 20, Total Loss: 0.005264 in 11.228 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 11.203 with std = 0.056 sec ###
### py4DSTEM ptycho solver is finished in 3 min 44.660 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 942.28 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 64, 3, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 567/16384 [00:00<00:02, 5665.04probe position/s]Normalizing amplitudes:   7%|▋         | 1134/16384 [00:00<00:02, 5524.53probe position/s]Normalizing amplitudes:  10%|█         | 1708/16384 [00:00<00:02, 5620.15probe position/s]Normalizing amplitudes:  15%|█▌        | 2488/16384 [00:00<00:02, 6473.14probe position/s]Normalizing amplitudes:  19%|█▉        | 3137/16384 [00:00<00:02, 6351.04probe position/s]Normalizing amplitudes:  23%|██▎       | 3774/16384 [00:00<00:02, 6086.78probe position/s]Normalizing amplitudes:  27%|██▋       | 4385/16384 [00:00<00:02, 5897.01probe position/s]Normalizing amplitudes:  30%|███       | 4977/16384 [00:00<00:01, 5745.45probe position/s]Normalizing amplitudes:  34%|███▍      | 5554/16384 [00:00<00:01, 5657.71probe position/s]Normalizing amplitudes:  37%|███▋      | 6121/16384 [00:01<00:01, 5632.87probe position/s]Normalizing amplitudes:  41%|████▏     | 6778/16384 [00:01<00:01, 5908.01probe position/s]Normalizing amplitudes:  46%|████▌     | 7554/16384 [00:01<00:01, 6455.70probe position/s]Normalizing amplitudes:  50%|█████     | 8203/16384 [00:01<00:01, 6148.91probe position/s]Normalizing amplitudes:  54%|█████▍    | 8823/16384 [00:01<00:01, 5915.83probe position/s]Normalizing amplitudes:  57%|█████▋    | 9419/16384 [00:01<00:01, 5668.64probe position/s]Normalizing amplitudes:  61%|██████    | 9990/16384 [00:01<00:01, 5648.55probe position/s]Normalizing amplitudes:  64%|██████▍   | 10558/16384 [00:01<00:01, 5577.46probe position/s]Normalizing amplitudes:  68%|██████▊   | 11118/16384 [00:01<00:00, 5580.70probe position/s]Normalizing amplitudes:  73%|███████▎  | 11892/16384 [00:02<00:00, 6205.57probe position/s]Normalizing amplitudes:  77%|███████▋  | 12566/16384 [00:02<00:00, 6359.71probe position/s]Normalizing amplitudes:  81%|████████  | 13205/16384 [00:02<00:00, 6146.76probe position/s]Normalizing amplitudes:  84%|████████▍ | 13823/16384 [00:02<00:00, 5959.91probe position/s]Normalizing amplitudes:  88%|████████▊ | 14422/16384 [00:02<00:00, 5868.12probe position/s]Normalizing amplitudes:  92%|█████████▏| 15011/16384 [00:02<00:00, 5755.20probe position/s]Normalizing amplitudes:  95%|█████████▌| 15588/16384 [00:02<00:00, 5701.69probe position/s]Normalizing amplitudes: 100%|█████████▉| 16327/16384 [00:02<00:00, 6186.66probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5948.54probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random64_p3_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random64_p3_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.01174 in 21.749 sec
Iter: 2, Total Loss: 0.006287 in 21.644 sec
Iter: 3, Total Loss: 0.006091 in 21.534 sec
Iter: 4, Total Loss: 0.005949 in 21.773 sec
Iter: 5, Total Loss: 0.005826 in 21.694 sec
Iter: 6, Total Loss: 0.005723 in 21.902 sec
Iter: 7, Total Loss: 0.005639 in 21.455 sec
Iter: 8, Total Loss: 0.00557 in 21.435 sec
Iter: 9, Total Loss: 0.005513 in 21.549 sec
Iter: 10, Total Loss: 0.005467 in 21.539 sec
Iter: 11, Total Loss: 0.005425 in 21.831 sec
Iter: 12, Total Loss: 0.00539 in 21.760 sec
Iter: 13, Total Loss: 0.005359 in 21.488 sec
Iter: 14, Total Loss: 0.005332 in 21.448 sec
Iter: 15, Total Loss: 0.005308 in 21.475 sec
Iter: 16, Total Loss: 0.005286 in 21.516 sec
Iter: 17, Total Loss: 0.005267 in 21.608 sec
Iter: 18, Total Loss: 0.005248 in 21.729 sec
Iter: 19, Total Loss: 0.005231 in 21.861 sec
Iter: 20, Total Loss: 0.005214 in 21.790 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 21.639 with std = 0.148 sec ###
### py4DSTEM ptycho solver is finished in 7 min 13.446 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 942.30 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 64, 6, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 569/16384 [00:00<00:02, 5688.92probe position/s]Normalizing amplitudes:   8%|▊         | 1348/16384 [00:00<00:02, 6920.49probe position/s]Normalizing amplitudes:  12%|█▏        | 2041/16384 [00:00<00:02, 6526.21probe position/s]Normalizing amplitudes:  16%|█▋        | 2697/16384 [00:00<00:02, 6051.02probe position/s]Normalizing amplitudes:  20%|██        | 3308/16384 [00:00<00:02, 5760.97probe position/s]Normalizing amplitudes:  24%|██▎       | 3888/16384 [00:00<00:02, 5647.69probe position/s]Normalizing amplitudes:  27%|██▋       | 4455/16384 [00:00<00:02, 5502.09probe position/s]Normalizing amplitudes:  31%|███       | 5025/16384 [00:00<00:02, 5558.82probe position/s]Normalizing amplitudes:  35%|███▌      | 5811/16384 [00:00<00:01, 6242.31probe position/s]Normalizing amplitudes:  39%|███▉      | 6465/16384 [00:01<00:01, 6330.67probe position/s]Normalizing amplitudes:  43%|████▎     | 7102/16384 [00:01<00:01, 5996.29probe position/s]Normalizing amplitudes:  47%|████▋     | 7707/16384 [00:01<00:01, 5781.09probe position/s]Normalizing amplitudes:  51%|█████     | 8290/16384 [00:01<00:01, 5684.10probe position/s]Normalizing amplitudes:  54%|█████▍    | 8862/16384 [00:01<00:01, 5559.27probe position/s]Normalizing amplitudes:  57%|█████▋    | 9420/16384 [00:01<00:01, 5468.28probe position/s]Normalizing amplitudes:  62%|██████▏   | 10119/16384 [00:01<00:01, 5900.52probe position/s]Normalizing amplitudes:  67%|██████▋   | 10901/16384 [00:01<00:00, 6455.21probe position/s]Normalizing amplitudes:  71%|███████   | 11552/16384 [00:01<00:00, 6081.52probe position/s]Normalizing amplitudes:  74%|███████▍  | 12168/16384 [00:02<00:00, 5836.46probe position/s]Normalizing amplitudes:  78%|███████▊  | 12758/16384 [00:02<00:00, 5670.27probe position/s]Normalizing amplitudes:  81%|████████▏ | 13330/16384 [00:02<00:00, 5556.41probe position/s]Normalizing amplitudes:  85%|████████▍ | 13889/16384 [00:02<00:00, 5501.45probe position/s]Normalizing amplitudes:  88%|████████▊ | 14470/16384 [00:02<00:00, 5588.66probe position/s]Normalizing amplitudes:  93%|█████████▎| 15256/16384 [00:02<00:00, 6241.74probe position/s]Normalizing amplitudes:  97%|█████████▋| 15885/16384 [00:02<00:00, 6163.24probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5886.42probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random64_p6_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random64_p6_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.01945 in 7.753 sec
Iter: 2, Total Loss: 0.006473 in 7.789 sec
Iter: 3, Total Loss: 0.006316 in 7.790 sec
Iter: 4, Total Loss: 0.006211 in 7.740 sec
Iter: 5, Total Loss: 0.006119 in 7.723 sec
Iter: 6, Total Loss: 0.00603 in 7.764 sec
Iter: 7, Total Loss: 0.005945 in 7.746 sec
Iter: 8, Total Loss: 0.005865 in 7.775 sec
Iter: 9, Total Loss: 0.005792 in 7.747 sec
Iter: 10, Total Loss: 0.005725 in 7.734 sec
Iter: 11, Total Loss: 0.005664 in 7.676 sec
Iter: 12, Total Loss: 0.005609 in 7.768 sec
Iter: 13, Total Loss: 0.005559 in 7.711 sec
Iter: 14, Total Loss: 0.005514 in 7.755 sec
Iter: 15, Total Loss: 0.005472 in 7.645 sec
Iter: 16, Total Loss: 0.005433 in 7.708 sec
Iter: 17, Total Loss: 0.005396 in 7.756 sec
Iter: 18, Total Loss: 0.005359 in 7.712 sec
Iter: 19, Total Loss: 0.005322 in 7.732 sec
Iter: 20, Total Loss: 0.005286 in 7.668 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 7.735 with std = 0.038 sec ###
### py4DSTEM ptycho solver is finished in 2 min 35.331 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 942.27 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 64, 6, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 528/16384 [00:00<00:03, 5275.77probe position/s]Normalizing amplitudes:   6%|▋         | 1058/16384 [00:00<00:02, 5288.46probe position/s]Normalizing amplitudes:  10%|▉         | 1590/16384 [00:00<00:02, 5299.16probe position/s]Normalizing amplitudes:  13%|█▎        | 2125/16384 [00:00<00:02, 5318.49probe position/s]Normalizing amplitudes:  16%|█▌        | 2657/16384 [00:00<00:02, 5256.28probe position/s]Normalizing amplitudes:  20%|██        | 3303/16384 [00:00<00:02, 5662.07probe position/s]Normalizing amplitudes:  25%|██▍       | 4087/16384 [00:00<00:01, 6366.39probe position/s]Normalizing amplitudes:  29%|██▉       | 4725/16384 [00:00<00:01, 6065.56probe position/s]Normalizing amplitudes:  33%|███▎      | 5335/16384 [00:00<00:01, 5812.67probe position/s]Normalizing amplitudes:  36%|███▌      | 5920/16384 [00:01<00:01, 5709.07probe position/s]Normalizing amplitudes:  40%|███▉      | 6494/16384 [00:01<00:01, 5631.60probe position/s]Normalizing amplitudes:  43%|████▎     | 7059/16384 [00:01<00:01, 5548.75probe position/s]Normalizing amplitudes:  46%|████▋     | 7615/16384 [00:01<00:01, 5549.83probe position/s]Normalizing amplitudes:  51%|█████     | 8389/16384 [00:01<00:01, 6189.85probe position/s]Normalizing amplitudes:  55%|█████▌    | 9039/16384 [00:01<00:01, 6271.13probe position/s]Normalizing amplitudes:  59%|█████▉    | 9669/16384 [00:01<00:01, 6023.77probe position/s]Normalizing amplitudes:  63%|██████▎   | 10275/16384 [00:01<00:01, 5846.14probe position/s]Normalizing amplitudes:  66%|██████▋   | 10863/16384 [00:01<00:00, 5688.71probe position/s]Normalizing amplitudes:  70%|██████▉   | 11435/16384 [00:01<00:00, 5584.58probe position/s]Normalizing amplitudes:  73%|███████▎  | 11995/16384 [00:02<00:00, 5508.68probe position/s]Normalizing amplitudes:  77%|███████▋  | 12652/16384 [00:02<00:00, 5811.76probe position/s]Normalizing amplitudes:  82%|████████▏ | 13439/16384 [00:02<00:00, 6408.15probe position/s]Normalizing amplitudes:  86%|████████▌ | 14084/16384 [00:02<00:00, 6037.91probe position/s]Normalizing amplitudes:  90%|████████▉ | 14695/16384 [00:02<00:00, 5758.80probe position/s]Normalizing amplitudes:  93%|█████████▎| 15277/16384 [00:02<00:00, 5604.80probe position/s]Normalizing amplitudes:  97%|█████████▋| 15842/16384 [00:02<00:00, 5531.61probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5723.69probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random64_p6_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random64_p6_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.02013 in 21.729 sec
Iter: 2, Total Loss: 0.006399 in 21.616 sec
Iter: 3, Total Loss: 0.006197 in 21.669 sec
Iter: 4, Total Loss: 0.006075 in 21.725 sec
Iter: 5, Total Loss: 0.005957 in 21.772 sec
Iter: 6, Total Loss: 0.005845 in 21.865 sec
Iter: 7, Total Loss: 0.005737 in 21.838 sec
Iter: 8, Total Loss: 0.005641 in 21.876 sec
Iter: 9, Total Loss: 0.005554 in 21.501 sec
Iter: 10, Total Loss: 0.005477 in 21.710 sec
Iter: 11, Total Loss: 0.005411 in 21.721 sec
Iter: 12, Total Loss: 0.00535 in 21.746 sec
Iter: 13, Total Loss: 0.005294 in 21.900 sec
Iter: 14, Total Loss: 0.005241 in 21.826 sec
Iter: 15, Total Loss: 0.005191 in 21.880 sec
Iter: 16, Total Loss: 0.005142 in 21.736 sec
Iter: 17, Total Loss: 0.005094 in 21.802 sec
Iter: 18, Total Loss: 0.005047 in 21.500 sec
Iter: 19, Total Loss: 0.005002 in 21.254 sec
Iter: 20, Total Loss: 0.00496 in 21.153 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 21.691 with std = 0.196 sec ###
### py4DSTEM ptycho solver is finished in 7 min 14.656 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 942.29 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 64, 6, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   5%|▍         | 777/16384 [00:00<00:02, 7768.49probe position/s]Normalizing amplitudes:   9%|▉         | 1554/16384 [00:00<00:02, 6523.74probe position/s]Normalizing amplitudes:  14%|█▎        | 2219/16384 [00:00<00:02, 6110.70probe position/s]Normalizing amplitudes:  17%|█▋        | 2837/16384 [00:00<00:02, 5915.25probe position/s]Normalizing amplitudes:  21%|██        | 3432/16384 [00:00<00:02, 5771.75probe position/s]Normalizing amplitudes:  24%|██▍       | 4011/16384 [00:00<00:02, 5682.77probe position/s]Normalizing amplitudes:  28%|██▊       | 4610/16384 [00:00<00:02, 5775.68probe position/s]Normalizing amplitudes:  33%|███▎      | 5395/16384 [00:00<00:01, 6404.29probe position/s]Normalizing amplitudes:  37%|███▋      | 6040/16384 [00:00<00:01, 6286.27probe position/s]Normalizing amplitudes:  41%|████      | 6672/16384 [00:01<00:01, 6068.95probe position/s]Normalizing amplitudes:  44%|████▍     | 7282/16384 [00:01<00:01, 5934.62probe position/s]Normalizing amplitudes:  48%|████▊     | 7878/16384 [00:01<00:01, 5827.05probe position/s]Normalizing amplitudes:  52%|█████▏    | 8463/16384 [00:01<00:01, 5765.21probe position/s]Normalizing amplitudes:  55%|█████▌    | 9041/16384 [00:01<00:01, 5685.93probe position/s]Normalizing amplitudes:  60%|█████▉    | 9782/16384 [00:01<00:01, 6184.05probe position/s]Normalizing amplitudes:  64%|██████▍   | 10488/16384 [00:01<00:00, 6429.00probe position/s]Normalizing amplitudes:  68%|██████▊   | 11134/16384 [00:01<00:00, 6075.44probe position/s]Normalizing amplitudes:  72%|███████▏  | 11747/16384 [00:01<00:00, 5950.27probe position/s]Normalizing amplitudes:  75%|███████▌  | 12346/16384 [00:02<00:00, 5836.35probe position/s]Normalizing amplitudes:  79%|███████▉  | 12933/16384 [00:02<00:00, 5670.90probe position/s]Normalizing amplitudes:  82%|████████▏ | 13503/16384 [00:02<00:00, 5635.80probe position/s]Normalizing amplitudes:  86%|████████▋ | 14135/16384 [00:02<00:00, 5829.72probe position/s]Normalizing amplitudes:  91%|█████████ | 14899/16384 [00:02<00:00, 6352.65probe position/s]Normalizing amplitudes:  95%|█████████▍| 15538/16384 [00:02<00:00, 6093.67probe position/s]Normalizing amplitudes:  99%|█████████▊| 16152/16384 [00:02<00:00, 5959.81probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5990.39probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random64_p6_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random64_p6_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.02169 in 42.153 sec
Iter: 2, Total Loss: 0.006485 in 43.254 sec
Iter: 3, Total Loss: 0.006038 in 41.245 sec
Iter: 4, Total Loss: 0.005847 in 41.456 sec
Iter: 5, Total Loss: 0.005692 in 43.200 sec
Iter: 6, Total Loss: 0.005562 in 43.660 sec
Iter: 7, Total Loss: 0.005454 in 43.542 sec
Iter: 8, Total Loss: 0.005364 in 43.289 sec
Iter: 9, Total Loss: 0.00529 in 42.491 sec
Iter: 10, Total Loss: 0.005227 in 42.220 sec
Iter: 11, Total Loss: 0.00517 in 42.123 sec
Iter: 12, Total Loss: 0.005117 in 42.072 sec
Iter: 13, Total Loss: 0.005067 in 42.601 sec
Iter: 14, Total Loss: 0.005019 in 42.937 sec
Iter: 15, Total Loss: 0.004975 in 43.023 sec
Iter: 16, Total Loss: 0.004932 in 43.028 sec
Iter: 17, Total Loss: 0.004893 in 43.205 sec
Iter: 18, Total Loss: 0.004858 in 42.919 sec
Iter: 19, Total Loss: 0.004827 in 42.015 sec
Iter: 20, Total Loss: 0.004801 in 41.630 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 42.603 with std = 0.689 sec ###
### py4DSTEM ptycho solver is finished in 14 min 12.829 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 942.19 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 64, 12, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 574/16384 [00:00<00:02, 5736.45probe position/s]Normalizing amplitudes:   7%|▋         | 1154/16384 [00:00<00:02, 5770.34probe position/s]Normalizing amplitudes:  11%|█         | 1732/16384 [00:00<00:02, 5713.46probe position/s]Normalizing amplitudes:  14%|█▍        | 2304/16384 [00:00<00:02, 5702.13probe position/s]Normalizing amplitudes:  18%|█▊        | 2974/16384 [00:00<00:02, 6059.33probe position/s]Normalizing amplitudes:  23%|██▎       | 3708/16384 [00:00<00:01, 6492.94probe position/s]Normalizing amplitudes:  27%|██▋       | 4358/16384 [00:00<00:01, 6155.44probe position/s]Normalizing amplitudes:  30%|███       | 4977/16384 [00:00<00:01, 6000.82probe position/s]Normalizing amplitudes:  34%|███▍      | 5580/16384 [00:00<00:01, 5884.22probe position/s]Normalizing amplitudes:  38%|███▊      | 6171/16384 [00:01<00:01, 5848.74probe position/s]Normalizing amplitudes:  41%|████      | 6758/16384 [00:01<00:01, 5786.45probe position/s]Normalizing amplitudes:  45%|████▌     | 7427/16384 [00:01<00:01, 6051.86probe position/s]Normalizing amplitudes:  50%|█████     | 8193/16384 [00:01<00:01, 6526.43probe position/s]Normalizing amplitudes:  54%|█████▍    | 8848/16384 [00:01<00:01, 6297.13probe position/s]Normalizing amplitudes:  58%|█████▊    | 9481/16384 [00:01<00:01, 6095.47probe position/s]Normalizing amplitudes:  62%|██████▏   | 10094/16384 [00:01<00:01, 5979.55probe position/s]Normalizing amplitudes:  65%|██████▌   | 10694/16384 [00:01<00:00, 5904.03probe position/s]Normalizing amplitudes:  69%|██████▉   | 11286/16384 [00:01<00:00, 5802.72probe position/s]Normalizing amplitudes:  72%|███████▏  | 11868/16384 [00:01<00:00, 5765.68probe position/s]Normalizing amplitudes:  77%|███████▋  | 12637/16384 [00:02<00:00, 6320.37probe position/s]Normalizing amplitudes:  81%|████████  | 13281/16384 [00:02<00:00, 6352.93probe position/s]Normalizing amplitudes:  85%|████████▍ | 13919/16384 [00:02<00:00, 6126.51probe position/s]Normalizing amplitudes:  89%|████████▊ | 14535/16384 [00:02<00:00, 5996.15probe position/s]Normalizing amplitudes:  92%|█████████▏| 15137/16384 [00:02<00:00, 5929.06probe position/s]Normalizing amplitudes:  96%|█████████▌| 15732/16384 [00:02<00:00, 5844.69probe position/s]Normalizing amplitudes: 100%|█████████▉| 16318/16384 [00:02<00:00, 5756.32probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5993.08probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random64_p12_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random64_p12_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.04088 in 14.526 sec
Iter: 2, Total Loss: 0.006485 in 14.511 sec
Iter: 3, Total Loss: 0.0063 in 14.500 sec
Iter: 4, Total Loss: 0.006173 in 14.414 sec
Iter: 5, Total Loss: 0.006056 in 14.491 sec
Iter: 6, Total Loss: 0.005946 in 14.469 sec
Iter: 7, Total Loss: 0.005843 in 14.433 sec
Iter: 8, Total Loss: 0.00575 in 14.520 sec
Iter: 9, Total Loss: 0.00567 in 15.050 sec
Iter: 10, Total Loss: 0.005599 in 15.062 sec
Iter: 11, Total Loss: 0.005535 in 14.983 sec
Iter: 12, Total Loss: 0.005476 in 15.046 sec
Iter: 13, Total Loss: 0.00542 in 15.117 sec
Iter: 14, Total Loss: 0.005366 in 15.084 sec
Iter: 15, Total Loss: 0.005315 in 15.164 sec
Iter: 16, Total Loss: 0.005265 in 15.044 sec
Iter: 17, Total Loss: 0.005216 in 15.053 sec
Iter: 18, Total Loss: 0.005168 in 14.997 sec
Iter: 19, Total Loss: 0.005119 in 15.016 sec
Iter: 20, Total Loss: 0.005073 in 14.834 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 14.816 with std = 0.279 sec ###
### py4DSTEM ptycho solver is finished in 4 min 57.074 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 942.24 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 64, 12, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 538/16384 [00:00<00:02, 5375.42probe position/s]Normalizing amplitudes:   7%|▋         | 1207/16384 [00:00<00:02, 6146.75probe position/s]Normalizing amplitudes:  12%|█▏        | 1979/16384 [00:00<00:02, 6864.04probe position/s]Normalizing amplitudes:  16%|█▋        | 2666/16384 [00:00<00:02, 6275.34probe position/s]Normalizing amplitudes:  20%|██        | 3301/16384 [00:00<00:02, 5962.42probe position/s]Normalizing amplitudes:  24%|██▍       | 3903/16384 [00:00<00:02, 5815.43probe position/s]Normalizing amplitudes:  27%|██▋       | 4488/16384 [00:00<00:02, 5659.74probe position/s]Normalizing amplitudes:  31%|███       | 5057/16384 [00:00<00:02, 5568.96probe position/s]Normalizing amplitudes:  35%|███▌      | 5750/16384 [00:00<00:01, 5968.79probe position/s]Normalizing amplitudes:  40%|███▉      | 6521/16384 [00:01<00:01, 6481.64probe position/s]Normalizing amplitudes:  44%|████▍     | 7174/16384 [00:01<00:01, 6075.41probe position/s]Normalizing amplitudes:  48%|████▊     | 7789/16384 [00:01<00:01, 5777.38probe position/s]Normalizing amplitudes:  51%|█████     | 8374/16384 [00:01<00:01, 5711.86probe position/s]Normalizing amplitudes:  55%|█████▍    | 8950/16384 [00:01<00:01, 5610.54probe position/s]Normalizing amplitudes:  58%|█████▊    | 9514/16384 [00:01<00:01, 5490.72probe position/s]Normalizing amplitudes:  62%|██████▏   | 10180/16384 [00:01<00:01, 5819.86probe position/s]Normalizing amplitudes:  67%|██████▋   | 10958/16384 [00:01<00:00, 6382.49probe position/s]Normalizing amplitudes:  71%|███████   | 11602/16384 [00:01<00:00, 6062.74probe position/s]Normalizing amplitudes:  75%|███████▍  | 12215/16384 [00:02<00:00, 5846.90probe position/s]Normalizing amplitudes:  78%|███████▊  | 12805/16384 [00:02<00:00, 5653.55probe position/s]Normalizing amplitudes:  82%|████████▏ | 13375/16384 [00:02<00:00, 5570.67probe position/s]Normalizing amplitudes:  85%|████████▌ | 13935/16384 [00:02<00:00, 5482.05probe position/s]Normalizing amplitudes:  89%|████████▉ | 14583/16384 [00:02<00:00, 5763.57probe position/s]Normalizing amplitudes:  94%|█████████▍| 15363/16384 [00:02<00:00, 6347.57probe position/s]Normalizing amplitudes:  98%|█████████▊| 16003/16384 [00:02<00:00, 6011.50probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5887.54probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random64_p12_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random64_p12_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.04169 in 42.587 sec
Iter: 2, Total Loss: 0.006405 in 42.464 sec
Iter: 3, Total Loss: 0.006107 in 42.599 sec
Iter: 4, Total Loss: 0.005933 in 42.652 sec
Iter: 5, Total Loss: 0.005783 in 42.582 sec
Iter: 6, Total Loss: 0.005652 in 42.690 sec
Iter: 7, Total Loss: 0.005544 in 42.686 sec
Iter: 8, Total Loss: 0.005454 in 43.550 sec
Iter: 9, Total Loss: 0.005376 in 46.008 sec
Iter: 10, Total Loss: 0.005308 in 43.137 sec
Iter: 11, Total Loss: 0.005244 in 42.478 sec
Iter: 12, Total Loss: 0.005183 in 42.103 sec
Iter: 13, Total Loss: 0.005125 in 42.336 sec
Iter: 14, Total Loss: 0.00507 in 42.080 sec
Iter: 15, Total Loss: 0.005017 in 41.636 sec
Iter: 16, Total Loss: 0.004967 in 42.013 sec
Iter: 17, Total Loss: 0.004919 in 42.660 sec
Iter: 18, Total Loss: 0.004875 in 42.270 sec
Iter: 19, Total Loss: 0.004835 in 42.356 sec
Iter: 20, Total Loss: 0.0048 in 42.268 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 42.658 with std = 0.864 sec ###
### py4DSTEM ptycho solver is finished in 14 min 13.877 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 942.16 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 64, 12, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 541/16384 [00:00<00:02, 5401.04probe position/s]Normalizing amplitudes:   7%|▋         | 1099/16384 [00:00<00:02, 5502.93probe position/s]Normalizing amplitudes:  11%|█         | 1843/16384 [00:00<00:02, 6384.27probe position/s]Normalizing amplitudes:  16%|█▌        | 2591/16384 [00:00<00:02, 6814.48probe position/s]Normalizing amplitudes:  20%|█▉        | 3273/16384 [00:00<00:02, 5924.48probe position/s]Normalizing amplitudes:  24%|██▎       | 3883/16384 [00:00<00:02, 5519.97probe position/s]Normalizing amplitudes:  27%|██▋       | 4449/16384 [00:00<00:02, 5400.05probe position/s]Normalizing amplitudes:  31%|███       | 4998/16384 [00:00<00:02, 5215.65probe position/s]Normalizing amplitudes:  35%|███▍      | 5707/16384 [00:00<00:01, 5743.43probe position/s]Normalizing amplitudes:  39%|███▉      | 6468/16384 [00:01<00:01, 6279.44probe position/s]Normalizing amplitudes:  43%|████▎     | 7107/16384 [00:01<00:01, 6214.79probe position/s]Normalizing amplitudes:  47%|████▋     | 7736/16384 [00:01<00:01, 5715.90probe position/s]Normalizing amplitudes:  51%|█████     | 8320/16384 [00:01<00:01, 5451.53probe position/s]Normalizing amplitudes:  54%|█████▍    | 8875/16384 [00:01<00:01, 5217.74probe position/s]Normalizing amplitudes:  57%|█████▋    | 9404/16384 [00:01<00:01, 5207.08probe position/s]Normalizing amplitudes:  62%|██████▏   | 10138/16384 [00:01<00:01, 5797.13probe position/s]Normalizing amplitudes:  66%|██████▋   | 10881/16384 [00:01<00:00, 6257.55probe position/s]Normalizing amplitudes:  70%|███████   | 11516/16384 [00:01<00:00, 5896.05probe position/s]Normalizing amplitudes:  74%|███████▍  | 12115/16384 [00:02<00:00, 5570.14probe position/s]Normalizing amplitudes:  77%|███████▋  | 12681/16384 [00:02<00:00, 5389.61probe position/s]Normalizing amplitudes:  81%|████████  | 13226/16384 [00:02<00:00, 5208.76probe position/s]Normalizing amplitudes:  85%|████████▍ | 13881/16384 [00:02<00:00, 5574.75probe position/s]Normalizing amplitudes:  89%|████████▉ | 14654/16384 [00:02<00:00, 6177.42probe position/s]Normalizing amplitudes:  94%|█████████▎| 15330/16384 [00:02<00:00, 6343.21probe position/s]Normalizing amplitudes:  97%|█████████▋| 15972/16384 [00:02<00:00, 5836.08probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5735.18probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random64_p12_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random64_p12_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.04247 in 84.106 sec
Iter: 2, Total Loss: 0.006282 in 83.721 sec
Iter: 3, Total Loss: 0.005963 in 84.746 sec
Iter: 4, Total Loss: 0.005776 in 85.098 sec
Iter: 5, Total Loss: 0.005625 in 83.832 sec
Iter: 6, Total Loss: 0.0055 in 85.938 sec
Iter: 7, Total Loss: 0.005396 in 84.646 sec
Iter: 8, Total Loss: 0.005308 in 84.636 sec
Iter: 9, Total Loss: 0.005231 in 83.678 sec
Iter: 10, Total Loss: 0.005162 in 82.982 sec
Iter: 11, Total Loss: 0.005098 in 83.482 sec
Iter: 12, Total Loss: 0.005039 in 84.352 sec
Iter: 13, Total Loss: 0.004983 in 84.578 sec
Iter: 14, Total Loss: 0.004927 in 84.693 sec
Iter: 15, Total Loss: 0.004873 in 84.319 sec
Iter: 16, Total Loss: 0.004823 in 82.756 sec
Iter: 17, Total Loss: 0.004778 in 82.045 sec
Iter: 18, Total Loss: 0.004738 in 83.819 sec
Iter: 19, Total Loss: 0.004704 in 84.195 sec
Iter: 20, Total Loss: 0.004675 in 84.274 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 84.095 with std = 0.844 sec ###
### py4DSTEM ptycho solver is finished in 28 min 2.732 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 942.09 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 32, 1, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 541/16384 [00:00<00:02, 5409.52probe position/s]Normalizing amplitudes:   7%|▋         | 1082/16384 [00:00<00:02, 5354.66probe position/s]Normalizing amplitudes:  10%|▉         | 1618/16384 [00:00<00:02, 5322.26probe position/s]Normalizing amplitudes:  13%|█▎        | 2163/16384 [00:00<00:02, 5369.47probe position/s]Normalizing amplitudes:  17%|█▋        | 2713/16384 [00:00<00:02, 5415.64probe position/s]Normalizing amplitudes:  21%|██        | 3441/16384 [00:00<00:02, 6045.18probe position/s]Normalizing amplitudes:  25%|██▍       | 4057/16384 [00:00<00:02, 6081.86probe position/s]Normalizing amplitudes:  28%|██▊       | 4666/16384 [00:00<00:02, 5794.66probe position/s]Normalizing amplitudes:  32%|███▏      | 5249/16384 [00:00<00:01, 5689.72probe position/s]Normalizing amplitudes:  36%|███▌      | 5820/16384 [00:01<00:01, 5609.13probe position/s]Normalizing amplitudes:  39%|███▉      | 6383/16384 [00:01<00:01, 5557.75probe position/s]Normalizing amplitudes:  42%|████▏     | 6940/16384 [00:01<00:01, 5486.89probe position/s]Normalizing amplitudes:  46%|████▌     | 7490/16384 [00:01<00:01, 5413.86probe position/s]Normalizing amplitudes:  50%|████▉     | 8117/16384 [00:01<00:01, 5663.66probe position/s]Normalizing amplitudes:  54%|█████▍    | 8885/16384 [00:01<00:01, 6255.41probe position/s]Normalizing amplitudes:  58%|█████▊    | 9513/16384 [00:01<00:01, 5947.76probe position/s]Normalizing amplitudes:  62%|██████▏   | 10113/16384 [00:01<00:01, 5809.40probe position/s]Normalizing amplitudes:  65%|██████▌   | 10698/16384 [00:01<00:01, 5561.21probe position/s]Normalizing amplitudes:  69%|██████▊   | 11258/16384 [00:01<00:00, 5566.12probe position/s]Normalizing amplitudes:  72%|███████▏  | 11818/16384 [00:02<00:00, 5399.13probe position/s]Normalizing amplitudes:  75%|███████▌  | 12361/16384 [00:02<00:00, 5379.24probe position/s]Normalizing amplitudes:  79%|███████▉  | 12922/16384 [00:02<00:00, 5443.53probe position/s]Normalizing amplitudes:  84%|████████▎ | 13703/16384 [00:02<00:00, 6130.55probe position/s]Normalizing amplitudes:  87%|████████▋ | 14329/16384 [00:02<00:00, 6166.59probe position/s]Normalizing amplitudes:  91%|█████████ | 14948/16384 [00:02<00:00, 5926.23probe position/s]Normalizing amplitudes:  95%|█████████▍| 15544/16384 [00:02<00:00, 5684.17probe position/s]Normalizing amplitudes:  98%|█████████▊| 16117/16384 [00:02<00:00, 5596.11probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5672.92probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random32_p1_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random32_p1_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.007086 in 3.876 sec
Iter: 2, Total Loss: 0.006532 in 3.904 sec
Iter: 3, Total Loss: 0.00648 in 3.955 sec
Iter: 4, Total Loss: 0.006426 in 3.827 sec
Iter: 5, Total Loss: 0.006371 in 3.893 sec
Iter: 6, Total Loss: 0.006321 in 3.835 sec
Iter: 7, Total Loss: 0.006277 in 4.131 sec
Iter: 8, Total Loss: 0.006237 in 3.939 sec
Iter: 9, Total Loss: 0.006207 in 4.056 sec
Iter: 10, Total Loss: 0.00618 in 3.937 sec
Iter: 11, Total Loss: 0.006159 in 3.980 sec
Iter: 12, Total Loss: 0.006143 in 4.099 sec
Iter: 13, Total Loss: 0.006128 in 4.117 sec
Iter: 14, Total Loss: 0.006116 in 4.061 sec
Iter: 15, Total Loss: 0.006107 in 3.973 sec
Iter: 16, Total Loss: 0.006097 in 3.847 sec
Iter: 17, Total Loss: 0.006091 in 3.849 sec
Iter: 18, Total Loss: 0.006086 in 3.926 sec
Iter: 19, Total Loss: 0.006081 in 3.866 sec
Iter: 20, Total Loss: 0.006077 in 3.917 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 3.949 with std = 0.094 sec ###
### py4DSTEM ptycho solver is finished in 1 min 19.755 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 942.17 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 32, 1, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 550/16384 [00:00<00:02, 5492.12probe position/s]Normalizing amplitudes:   7%|▋         | 1119/16384 [00:00<00:02, 5606.17probe position/s]Normalizing amplitudes:  12%|█▏        | 1886/16384 [00:00<00:02, 6543.68probe position/s]Normalizing amplitudes:  16%|█▌        | 2541/16384 [00:00<00:02, 6516.65probe position/s]Normalizing amplitudes:  19%|█▉        | 3193/16384 [00:00<00:02, 6028.78probe position/s]Normalizing amplitudes:  23%|██▎       | 3802/16384 [00:00<00:02, 5903.15probe position/s]Normalizing amplitudes:  27%|██▋       | 4396/16384 [00:00<00:02, 5769.00probe position/s]Normalizing amplitudes:  30%|███       | 4976/16384 [00:00<00:02, 5680.29probe position/s]Normalizing amplitudes:  34%|███▍      | 5546/16384 [00:00<00:01, 5637.99probe position/s]Normalizing amplitudes:  38%|███▊      | 6187/16384 [00:01<00:01, 5864.73probe position/s]Normalizing amplitudes:  43%|████▎     | 6980/16384 [00:01<00:01, 6477.06probe position/s]Normalizing amplitudes:  47%|████▋     | 7631/16384 [00:01<00:01, 6098.18probe position/s]Normalizing amplitudes:  50%|█████     | 8247/16384 [00:01<00:01, 5930.02probe position/s]Normalizing amplitudes:  54%|█████▍    | 8845/16384 [00:01<00:01, 5754.82probe position/s]Normalizing amplitudes:  58%|█████▊    | 9424/16384 [00:01<00:01, 5618.71probe position/s]Normalizing amplitudes:  61%|██████    | 9989/16384 [00:01<00:01, 5518.31probe position/s]Normalizing amplitudes:  64%|██████▍   | 10543/16384 [00:01<00:01, 5497.27probe position/s]Normalizing amplitudes:  69%|██████▉   | 11319/16384 [00:01<00:00, 6144.89probe position/s]Normalizing amplitudes:  73%|███████▎  | 11938/16384 [00:02<00:00, 6053.37probe position/s]Normalizing amplitudes:  77%|███████▋  | 12546/16384 [00:02<00:00, 5906.89probe position/s]Normalizing amplitudes:  80%|████████  | 13139/16384 [00:02<00:00, 5726.09probe position/s]Normalizing amplitudes:  84%|████████▎ | 13714/16384 [00:02<00:00, 5650.13probe position/s]Normalizing amplitudes:  87%|████████▋ | 14281/16384 [00:02<00:00, 5541.06probe position/s]Normalizing amplitudes:  91%|█████████ | 14837/16384 [00:02<00:00, 5446.32probe position/s]Normalizing amplitudes:  95%|█████████▍| 15484/16384 [00:02<00:00, 5737.77probe position/s]Normalizing amplitudes:  99%|█████████▉| 16273/16384 [00:02<00:00, 6362.02probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5913.85probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random32_p1_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random32_p1_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.007136 in 9.164 sec
Iter: 2, Total Loss: 0.006526 in 9.162 sec
Iter: 3, Total Loss: 0.006455 in 8.954 sec
Iter: 4, Total Loss: 0.00639 in 9.222 sec
Iter: 5, Total Loss: 0.006335 in 9.224 sec
Iter: 6, Total Loss: 0.006285 in 9.202 sec
Iter: 7, Total Loss: 0.006244 in 9.082 sec
Iter: 8, Total Loss: 0.006209 in 8.851 sec
Iter: 9, Total Loss: 0.006179 in 8.935 sec
Iter: 10, Total Loss: 0.006154 in 8.811 sec
Iter: 11, Total Loss: 0.006135 in 8.719 sec
Iter: 12, Total Loss: 0.006116 in 8.897 sec
Iter: 13, Total Loss: 0.006101 in 8.943 sec
Iter: 14, Total Loss: 0.006089 in 8.778 sec
Iter: 15, Total Loss: 0.006079 in 9.267 sec
Iter: 16, Total Loss: 0.006068 in 8.786 sec
Iter: 17, Total Loss: 0.006061 in 9.007 sec
Iter: 18, Total Loss: 0.006053 in 8.998 sec
Iter: 19, Total Loss: 0.006046 in 9.017 sec
Iter: 20, Total Loss: 0.006041 in 8.970 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 8.999 with std = 0.162 sec ###
### py4DSTEM ptycho solver is finished in 3 min 0.737 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 942.10 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 32, 1, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 553/16384 [00:00<00:02, 5520.40probe position/s]Normalizing amplitudes:   7%|▋         | 1152/16384 [00:00<00:02, 5794.90probe position/s]Normalizing amplitudes:  12%|█▏        | 1914/16384 [00:00<00:02, 6626.42probe position/s]Normalizing amplitudes:  16%|█▌        | 2577/16384 [00:00<00:02, 6328.39probe position/s]Normalizing amplitudes:  20%|█▉        | 3212/16384 [00:00<00:02, 6088.56probe position/s]Normalizing amplitudes:  23%|██▎       | 3824/16384 [00:00<00:02, 5943.63probe position/s]Normalizing amplitudes:  27%|██▋       | 4420/16384 [00:00<00:02, 5755.19probe position/s]Normalizing amplitudes:  30%|███       | 4997/16384 [00:00<00:02, 5652.06probe position/s]Normalizing amplitudes:  34%|███▍      | 5564/16384 [00:00<00:01, 5609.20probe position/s]Normalizing amplitudes:  38%|███▊      | 6236/16384 [00:01<00:01, 5936.44probe position/s]Normalizing amplitudes:  43%|████▎     | 7015/16384 [00:01<00:01, 6486.49probe position/s]Normalizing amplitudes:  47%|████▋     | 7667/16384 [00:01<00:01, 6095.24probe position/s]Normalizing amplitudes:  51%|█████     | 8283/16384 [00:01<00:01, 5902.44probe position/s]Normalizing amplitudes:  54%|█████▍    | 8879/16384 [00:01<00:01, 5734.52probe position/s]Normalizing amplitudes:  58%|█████▊    | 9456/16384 [00:01<00:01, 5697.94probe position/s]Normalizing amplitudes:  61%|██████    | 10029/16384 [00:01<00:01, 5617.33probe position/s]Normalizing amplitudes:  65%|██████▍   | 10593/16384 [00:01<00:01, 5470.94probe position/s]Normalizing amplitudes:  69%|██████▉   | 11312/16384 [00:01<00:00, 5959.36probe position/s]Normalizing amplitudes:  73%|███████▎  | 12022/16384 [00:02<00:00, 6288.71probe position/s]Normalizing amplitudes:  77%|███████▋  | 12655/16384 [00:02<00:00, 6063.18probe position/s]Normalizing amplitudes:  81%|████████  | 13266/16384 [00:02<00:00, 5829.64probe position/s]Normalizing amplitudes:  85%|████████▍ | 13853/16384 [00:02<00:00, 5655.11probe position/s]Normalizing amplitudes:  88%|████████▊ | 14422/16384 [00:02<00:00, 5526.89probe position/s]Normalizing amplitudes:  91%|█████████▏| 14977/16384 [00:02<00:00, 5493.58probe position/s]Normalizing amplitudes:  95%|█████████▍| 15528/16384 [00:02<00:00, 5490.92probe position/s]Normalizing amplitudes:  99%|█████████▉| 16267/16384 [00:02<00:00, 6037.54probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5885.52probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random32_p1_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random32_p1_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.007216 in 16.691 sec
Iter: 2, Total Loss: 0.00657 in 16.632 sec
Iter: 3, Total Loss: 0.006485 in 16.638 sec
Iter: 4, Total Loss: 0.006415 in 16.629 sec
Iter: 5, Total Loss: 0.006356 in 16.532 sec
Iter: 6, Total Loss: 0.006308 in 16.663 sec
Iter: 7, Total Loss: 0.006266 in 16.662 sec
Iter: 8, Total Loss: 0.00623 in 16.751 sec
Iter: 9, Total Loss: 0.006194 in 16.818 sec
Iter: 10, Total Loss: 0.006169 in 16.837 sec
Iter: 11, Total Loss: 0.006143 in 16.847 sec
Iter: 12, Total Loss: 0.006122 in 16.905 sec
Iter: 13, Total Loss: 0.0061 in 16.676 sec
Iter: 14, Total Loss: 0.006081 in 16.742 sec
Iter: 15, Total Loss: 0.006063 in 16.695 sec
Iter: 16, Total Loss: 0.006045 in 16.644 sec
Iter: 17, Total Loss: 0.006027 in 16.616 sec
Iter: 18, Total Loss: 0.006011 in 16.751 sec
Iter: 19, Total Loss: 0.005995 in 16.790 sec
Iter: 20, Total Loss: 0.00598 in 16.804 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 16.716 with std = 0.093 sec ###
### py4DSTEM ptycho solver is finished in 5 min 35.115 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 942.04 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 32, 3, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 538/16384 [00:00<00:02, 5375.30probe position/s]Normalizing amplitudes:   7%|▋         | 1092/16384 [00:00<00:02, 5469.57probe position/s]Normalizing amplitudes:  10%|█         | 1639/16384 [00:00<00:02, 5403.35probe position/s]Normalizing amplitudes:  15%|█▍        | 2409/16384 [00:00<00:02, 6300.07probe position/s]Normalizing amplitudes:  19%|█▊        | 3060/16384 [00:00<00:02, 6374.97probe position/s]Normalizing amplitudes:  23%|██▎       | 3698/16384 [00:00<00:02, 5992.25probe position/s]Normalizing amplitudes:  26%|██▋       | 4302/16384 [00:00<00:02, 5642.14probe position/s]Normalizing amplitudes:  30%|██▉       | 4872/16384 [00:00<00:02, 5528.57probe position/s]Normalizing amplitudes:  33%|███▎      | 5429/16384 [00:00<00:02, 5428.61probe position/s]Normalizing amplitudes:  36%|███▋      | 5975/16384 [00:01<00:01, 5344.76probe position/s]Normalizing amplitudes:  40%|███▉      | 6511/16384 [00:01<00:01, 5347.09probe position/s]Normalizing amplitudes:  44%|████▍     | 7271/16384 [00:01<00:01, 6004.93probe position/s]Normalizing amplitudes:  48%|████▊     | 7923/16384 [00:01<00:01, 6120.18probe position/s]Normalizing amplitudes:  52%|█████▏    | 8538/16384 [00:01<00:01, 5772.70probe position/s]Normalizing amplitudes:  56%|█████▌    | 9121/16384 [00:01<00:01, 5670.99probe position/s]Normalizing amplitudes:  59%|█████▉    | 9692/16384 [00:01<00:01, 5538.38probe position/s]Normalizing amplitudes:  63%|██████▎   | 10249/16384 [00:01<00:01, 5490.66probe position/s]Normalizing amplitudes:  66%|██████▌   | 10800/16384 [00:01<00:01, 5378.62probe position/s]Normalizing amplitudes:  69%|██████▉   | 11351/16384 [00:02<00:00, 5415.37probe position/s]Normalizing amplitudes:  74%|███████▎  | 12070/16384 [00:02<00:00, 5928.40probe position/s]Normalizing amplitudes:  77%|███████▋  | 12690/16384 [00:02<00:00, 6005.03probe position/s]Normalizing amplitudes:  81%|████████  | 13293/16384 [00:02<00:00, 5755.10probe position/s]Normalizing amplitudes:  85%|████████▍ | 13872/16384 [00:02<00:00, 5603.69probe position/s]Normalizing amplitudes:  88%|████████▊ | 14436/16384 [00:02<00:00, 5520.50probe position/s]Normalizing amplitudes:  91%|█████████▏| 14990/16384 [00:02<00:00, 5427.31probe position/s]Normalizing amplitudes:  95%|█████████▍| 15534/16384 [00:02<00:00, 5381.17probe position/s]Normalizing amplitudes:  98%|█████████▊| 16073/16384 [00:02<00:00, 5365.50probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5649.84probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random32_p3_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random32_p3_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.00864 in 8.104 sec
Iter: 2, Total Loss: 0.006411 in 8.350 sec
Iter: 3, Total Loss: 0.006263 in 8.378 sec
Iter: 4, Total Loss: 0.006118 in 8.053 sec
Iter: 5, Total Loss: 0.005985 in 7.838 sec
Iter: 6, Total Loss: 0.005868 in 8.134 sec
Iter: 7, Total Loss: 0.005772 in 8.048 sec
Iter: 8, Total Loss: 0.005694 in 8.029 sec
Iter: 9, Total Loss: 0.005629 in 8.038 sec
Iter: 10, Total Loss: 0.005573 in 8.086 sec
Iter: 11, Total Loss: 0.005524 in 7.994 sec
Iter: 12, Total Loss: 0.005481 in 7.914 sec
Iter: 13, Total Loss: 0.005441 in 7.972 sec
Iter: 14, Total Loss: 0.005403 in 7.943 sec
Iter: 15, Total Loss: 0.005368 in 8.018 sec
Iter: 16, Total Loss: 0.005337 in 8.047 sec
Iter: 17, Total Loss: 0.005311 in 8.030 sec
Iter: 18, Total Loss: 0.005289 in 7.997 sec
Iter: 19, Total Loss: 0.00527 in 7.990 sec
Iter: 20, Total Loss: 0.005255 in 8.012 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 8.049 with std = 0.123 sec ###
### py4DSTEM ptycho solver is finished in 2 min 41.694 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 942.09 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 32, 3, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 544/16384 [00:00<00:02, 5433.18probe position/s]Normalizing amplitudes:   7%|▋         | 1088/16384 [00:00<00:02, 5362.91probe position/s]Normalizing amplitudes:  10%|█         | 1647/16384 [00:00<00:02, 5462.65probe position/s]Normalizing amplitudes:  13%|█▎        | 2194/16384 [00:00<00:02, 5421.84probe position/s]Normalizing amplitudes:  17%|█▋        | 2742/16384 [00:00<00:02, 5442.18probe position/s]Normalizing amplitudes:  21%|██▏       | 3521/16384 [00:00<00:02, 6235.27probe position/s]Normalizing amplitudes:  26%|██▌       | 4178/16384 [00:00<00:01, 6340.35probe position/s]Normalizing amplitudes:  29%|██▉       | 4813/16384 [00:00<00:01, 5983.62probe position/s]Normalizing amplitudes:  33%|███▎      | 5416/16384 [00:00<00:01, 5794.55probe position/s]Normalizing amplitudes:  37%|███▋      | 6000/16384 [00:01<00:01, 5806.83probe position/s]Normalizing amplitudes:  40%|████      | 6584/16384 [00:01<00:01, 5687.31probe position/s]Normalizing amplitudes:  44%|████▎     | 7155/16384 [00:01<00:01, 5541.47probe position/s]Normalizing amplitudes:  47%|████▋     | 7725/16384 [00:01<00:01, 5579.01probe position/s]Normalizing amplitudes:  52%|█████▏    | 8484/16384 [00:01<00:01, 6163.35probe position/s]Normalizing amplitudes:  56%|█████▌    | 9160/16384 [00:01<00:01, 6309.60probe position/s]Normalizing amplitudes:  60%|█████▉    | 9794/16384 [00:01<00:01, 6015.04probe position/s]Normalizing amplitudes:  63%|██████▎   | 10400/16384 [00:01<00:01, 5825.44probe position/s]Normalizing amplitudes:  67%|██████▋   | 10986/16384 [00:01<00:00, 5785.96probe position/s]Normalizing amplitudes:  71%|███████   | 11567/16384 [00:01<00:00, 5638.68probe position/s]Normalizing amplitudes:  74%|███████▍  | 12133/16384 [00:02<00:00, 5475.25probe position/s]Normalizing amplitudes:  78%|███████▊  | 12701/16384 [00:02<00:00, 5533.03probe position/s]Normalizing amplitudes:  82%|████████▏ | 13489/16384 [00:02<00:00, 6208.28probe position/s]Normalizing amplitudes:  86%|████████▋ | 14156/16384 [00:02<00:00, 6341.77probe position/s]Normalizing amplitudes:  90%|█████████ | 14794/16384 [00:02<00:00, 6058.81probe position/s]Normalizing amplitudes:  94%|█████████▍| 15405/16384 [00:02<00:00, 5857.74probe position/s]Normalizing amplitudes:  98%|█████████▊| 15995/16384 [00:02<00:00, 5712.63probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5812.10probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random32_p3_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random32_p3_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.008671 in 21.530 sec
Iter: 2, Total Loss: 0.006245 in 21.366 sec
Iter: 3, Total Loss: 0.006021 in 21.507 sec
Iter: 4, Total Loss: 0.005839 in 21.414 sec
Iter: 5, Total Loss: 0.005701 in 21.299 sec
Iter: 6, Total Loss: 0.005598 in 21.439 sec
Iter: 7, Total Loss: 0.005515 in 21.821 sec
Iter: 8, Total Loss: 0.005447 in 21.892 sec
Iter: 9, Total Loss: 0.005388 in 21.878 sec
Iter: 10, Total Loss: 0.005335 in 21.860 sec
Iter: 11, Total Loss: 0.005287 in 21.791 sec
Iter: 12, Total Loss: 0.005242 in 21.712 sec
Iter: 13, Total Loss: 0.005203 in 21.781 sec
Iter: 14, Total Loss: 0.005169 in 21.984 sec
Iter: 15, Total Loss: 0.005143 in 21.600 sec
Iter: 16, Total Loss: 0.005121 in 21.843 sec
Iter: 17, Total Loss: 0.005103 in 21.805 sec
Iter: 18, Total Loss: 0.005087 in 21.791 sec
Iter: 19, Total Loss: 0.005074 in 21.787 sec
Iter: 20, Total Loss: 0.005062 in 23.464 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 21.778 with std = 0.432 sec ###
### py4DSTEM ptycho solver is finished in 7 min 16.374 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 942.02 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 32, 3, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   5%|▍         | 775/16384 [00:00<00:02, 7747.27probe position/s]Normalizing amplitudes:   9%|▉         | 1550/16384 [00:00<00:02, 5518.82probe position/s]Normalizing amplitudes:  13%|█▎        | 2140/16384 [00:00<00:02, 5104.46probe position/s]Normalizing amplitudes:  16%|█▋        | 2669/16384 [00:00<00:02, 4912.97probe position/s]Normalizing amplitudes:  19%|█▉        | 3170/16384 [00:00<00:02, 4818.05probe position/s]Normalizing amplitudes:  24%|██▍       | 3939/16384 [00:00<00:02, 5677.20probe position/s]Normalizing amplitudes:  28%|██▊       | 4576/16384 [00:00<00:02, 5884.02probe position/s]Normalizing amplitudes:  32%|███▏      | 5177/16384 [00:00<00:02, 5430.03probe position/s]Normalizing amplitudes:  35%|███▍      | 5734/16384 [00:01<00:02, 5176.74probe position/s]Normalizing amplitudes:  38%|███▊      | 6262/16384 [00:01<00:02, 4970.37probe position/s]Normalizing amplitudes:  41%|████▏     | 6766/16384 [00:01<00:01, 4812.98probe position/s]Normalizing amplitudes:  46%|████▌     | 7515/16384 [00:01<00:01, 5545.31probe position/s]Normalizing amplitudes:  50%|████▉     | 8190/16384 [00:01<00:01, 5881.76probe position/s]Normalizing amplitudes:  54%|█████▎    | 8789/16384 [00:01<00:01, 5443.37probe position/s]Normalizing amplitudes:  57%|█████▋    | 9346/16384 [00:01<00:01, 5193.86probe position/s]Normalizing amplitudes:  60%|██████    | 9875/16384 [00:01<00:01, 4992.68probe position/s]Normalizing amplitudes:  63%|██████▎   | 10381/16384 [00:01<00:01, 4880.77probe position/s]Normalizing amplitudes:  68%|██████▊   | 11101/16384 [00:02<00:00, 5512.76probe position/s]Normalizing amplitudes:  72%|███████▏  | 11773/16384 [00:02<00:00, 5849.52probe position/s]Normalizing amplitudes:  75%|███████▌  | 12367/16384 [00:02<00:00, 5405.02probe position/s]Normalizing amplitudes:  79%|███████▉  | 12920/16384 [00:02<00:00, 5142.97probe position/s]Normalizing amplitudes:  82%|████████▏ | 13444/16384 [00:02<00:00, 4957.67probe position/s]Normalizing amplitudes:  85%|████████▌ | 13947/16384 [00:02<00:00, 4796.77probe position/s]Normalizing amplitudes:  89%|████████▉ | 14633/16384 [00:02<00:00, 5353.67probe position/s]Normalizing amplitudes:  94%|█████████▍| 15371/16384 [00:02<00:00, 5917.12probe position/s]Normalizing amplitudes:  97%|█████████▋| 15974/16384 [00:02<00:00, 5408.39probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:03<00:00, 5314.17probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random32_p3_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random32_p3_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.009412 in 42.098 sec
Iter: 2, Total Loss: 0.006223 in 39.733 sec
Iter: 3, Total Loss: 0.005993 in 39.891 sec
Iter: 4, Total Loss: 0.005808 in 39.725 sec
Iter: 5, Total Loss: 0.005659 in 39.775 sec
Iter: 6, Total Loss: 0.005546 in 39.771 sec
Iter: 7, Total Loss: 0.005462 in 40.343 sec
Iter: 8, Total Loss: 0.005398 in 41.950 sec
Iter: 9, Total Loss: 0.005348 in 41.945 sec
Iter: 10, Total Loss: 0.005303 in 41.882 sec
Iter: 11, Total Loss: 0.005263 in 42.083 sec
Iter: 12, Total Loss: 0.005227 in 42.249 sec
Iter: 13, Total Loss: 0.005192 in 42.301 sec
Iter: 14, Total Loss: 0.005161 in 40.360 sec
Iter: 15, Total Loss: 0.005133 in 40.467 sec
Iter: 16, Total Loss: 0.005109 in 40.495 sec
Iter: 17, Total Loss: 0.005088 in 40.546 sec
Iter: 18, Total Loss: 0.00507 in 40.331 sec
Iter: 19, Total Loss: 0.005054 in 40.822 sec
Iter: 20, Total Loss: 0.005041 in 40.847 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 40.881 with std = 0.935 sec ###
### py4DSTEM ptycho solver is finished in 13 min 38.398 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 939.30 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 32, 6, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 587/16384 [00:00<00:02, 5863.10probe position/s]Normalizing amplitudes:   7%|▋         | 1220/16384 [00:00<00:02, 6133.71probe position/s]Normalizing amplitudes:  12%|█▏        | 1917/16384 [00:00<00:02, 6511.88probe position/s]Normalizing amplitudes:  16%|█▌        | 2569/16384 [00:00<00:02, 6513.20probe position/s]Normalizing amplitudes:  20%|█▉        | 3223/16384 [00:00<00:02, 6520.84probe position/s]Normalizing amplitudes:  24%|██▍       | 4000/16384 [00:00<00:01, 6944.06probe position/s]Normalizing amplitudes:  29%|██▊       | 4695/16384 [00:00<00:01, 6591.39probe position/s]Normalizing amplitudes:  33%|███▎      | 5358/16384 [00:00<00:01, 6382.07probe position/s]Normalizing amplitudes:  37%|███▋      | 6000/16384 [00:00<00:01, 6120.30probe position/s]Normalizing amplitudes:  40%|████      | 6616/16384 [00:01<00:01, 6042.90probe position/s]Normalizing amplitudes:  44%|████▍     | 7223/16384 [00:01<00:01, 5954.30probe position/s]Normalizing amplitudes:  48%|████▊     | 7834/16384 [00:01<00:01, 5999.14probe position/s]Normalizing amplitudes:  53%|█████▎    | 8611/16384 [00:01<00:01, 6515.89probe position/s]Normalizing amplitudes:  57%|█████▋    | 9266/16384 [00:01<00:01, 6387.17probe position/s]Normalizing amplitudes:  60%|██████    | 9907/16384 [00:01<00:01, 6134.13probe position/s]Normalizing amplitudes:  64%|██████▍   | 10524/16384 [00:01<00:00, 5872.37probe position/s]Normalizing amplitudes:  68%|██████▊   | 11115/16384 [00:01<00:00, 5637.02probe position/s]Normalizing amplitudes:  71%|███████▏  | 11696/16384 [00:01<00:00, 5683.66probe position/s]Normalizing amplitudes:  75%|███████▌  | 12305/16384 [00:02<00:00, 5796.98probe position/s]Normalizing amplitudes:  80%|███████▉  | 13081/16384 [00:02<00:00, 6361.04probe position/s]Normalizing amplitudes:  84%|████████▍ | 13722/16384 [00:02<00:00, 6150.07probe position/s]Normalizing amplitudes:  88%|████████▊ | 14341/16384 [00:02<00:00, 6050.19probe position/s]Normalizing amplitudes:  91%|█████████ | 14949/16384 [00:02<00:00, 6012.58probe position/s]Normalizing amplitudes:  95%|█████████▍| 15553/16384 [00:02<00:00, 5846.91probe position/s]Normalizing amplitudes:  99%|█████████▊| 16140/16384 [00:02<00:00, 5846.72probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6099.77probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random32_p6_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random32_p6_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.01305 in 14.706 sec
Iter: 2, Total Loss: 0.006423 in 14.309 sec
Iter: 3, Total Loss: 0.006271 in 14.390 sec
Iter: 4, Total Loss: 0.006126 in 14.406 sec
Iter: 5, Total Loss: 0.005989 in 14.375 sec
Iter: 6, Total Loss: 0.005862 in 14.652 sec
Iter: 7, Total Loss: 0.005752 in 14.311 sec
Iter: 8, Total Loss: 0.005658 in 14.084 sec
Iter: 9, Total Loss: 0.005576 in 14.081 sec
Iter: 10, Total Loss: 0.005502 in 14.150 sec
Iter: 11, Total Loss: 0.005433 in 14.134 sec
Iter: 12, Total Loss: 0.005363 in 14.071 sec
Iter: 13, Total Loss: 0.005292 in 14.080 sec
Iter: 14, Total Loss: 0.005219 in 14.131 sec
Iter: 15, Total Loss: 0.005152 in 14.024 sec
Iter: 16, Total Loss: 0.005095 in 13.677 sec
Iter: 17, Total Loss: 0.00505 in 13.790 sec
Iter: 18, Total Loss: 0.005015 in 13.752 sec
Iter: 19, Total Loss: 0.004985 in 13.838 sec
Iter: 20, Total Loss: 0.004961 in 13.878 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 14.142 with std = 0.274 sec ###
### py4DSTEM ptycho solver is finished in 4 min 43.581 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 935.21 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 32, 6, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 537/16384 [00:00<00:02, 5361.08probe position/s]Normalizing amplitudes:   7%|▋         | 1074/16384 [00:00<00:02, 5359.03probe position/s]Normalizing amplitudes:  10%|▉         | 1614/16384 [00:00<00:02, 5376.07probe position/s]Normalizing amplitudes:  13%|█▎        | 2152/16384 [00:00<00:02, 5264.19probe position/s]Normalizing amplitudes:  17%|█▋        | 2752/16384 [00:00<00:02, 5525.26probe position/s]Normalizing amplitudes:  21%|██        | 3433/16384 [00:00<00:02, 5957.72probe position/s]Normalizing amplitudes:  25%|██▍       | 4030/16384 [00:00<00:02, 5923.99probe position/s]Normalizing amplitudes:  28%|██▊       | 4623/16384 [00:00<00:02, 5749.51probe position/s]Normalizing amplitudes:  32%|███▏      | 5200/16384 [00:00<00:01, 5609.33probe position/s]Normalizing amplitudes:  35%|███▌      | 5763/16384 [00:01<00:01, 5491.56probe position/s]Normalizing amplitudes:  39%|███▊      | 6326/16384 [00:01<00:01, 5530.22probe position/s]Normalizing amplitudes:  43%|████▎     | 7029/16384 [00:01<00:01, 5971.41probe position/s]Normalizing amplitudes:  47%|████▋     | 7634/16384 [00:01<00:01, 5991.92probe position/s]Normalizing amplitudes:  50%|█████     | 8235/16384 [00:01<00:01, 5833.02probe position/s]Normalizing amplitudes:  54%|█████▍    | 8820/16384 [00:01<00:01, 5725.91probe position/s]Normalizing amplitudes:  57%|█████▋    | 9394/16384 [00:01<00:01, 5627.26probe position/s]Normalizing amplitudes:  61%|██████    | 9958/16384 [00:01<00:01, 5562.06probe position/s]Normalizing amplitudes:  66%|██████▌   | 10748/16384 [00:01<00:00, 6238.50probe position/s]Normalizing amplitudes:  70%|██████▉   | 11410/16384 [00:01<00:00, 6348.55probe position/s]Normalizing amplitudes:  74%|███████▎  | 12048/16384 [00:02<00:00, 6037.43probe position/s]Normalizing amplitudes:  77%|███████▋  | 12657/16384 [00:02<00:00, 5860.23probe position/s]Normalizing amplitudes:  81%|████████  | 13247/16384 [00:02<00:00, 5702.28probe position/s]Normalizing amplitudes:  84%|████████▍ | 13820/16384 [00:02<00:00, 5643.18probe position/s]Normalizing amplitudes:  89%|████████▉ | 14558/16384 [00:02<00:00, 6136.44probe position/s]Normalizing amplitudes:  93%|█████████▎| 15188/16384 [00:02<00:00, 6181.84probe position/s]Normalizing amplitudes:  96%|█████████▋| 15809/16384 [00:02<00:00, 5887.12probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5791.70probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random32_p6_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random32_p6_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.01322 in 40.257 sec
Iter: 2, Total Loss: 0.00622 in 40.926 sec
Iter: 3, Total Loss: 0.005963 in 41.005 sec
Iter: 4, Total Loss: 0.005755 in 41.086 sec
Iter: 5, Total Loss: 0.005587 in 40.820 sec
Iter: 6, Total Loss: 0.005455 in 41.158 sec
Iter: 7, Total Loss: 0.005342 in 40.140 sec
Iter: 8, Total Loss: 0.00524 in 38.741 sec
Iter: 9, Total Loss: 0.005144 in 38.686 sec
Iter: 10, Total Loss: 0.005055 in 39.252 sec
Iter: 11, Total Loss: 0.004981 in 39.716 sec
Iter: 12, Total Loss: 0.004924 in 40.976 sec
Iter: 13, Total Loss: 0.004882 in 40.710 sec
Iter: 14, Total Loss: 0.004849 in 40.870 sec
Iter: 15, Total Loss: 0.004823 in 40.432 sec
Iter: 16, Total Loss: 0.004801 in 40.538 sec
Iter: 17, Total Loss: 0.004781 in 40.380 sec
Iter: 18, Total Loss: 0.004765 in 40.310 sec
Iter: 19, Total Loss: 0.00475 in 40.519 sec
Iter: 20, Total Loss: 0.004737 in 40.708 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 40.361 with std = 0.714 sec ###
### py4DSTEM ptycho solver is finished in 13 min 28.357 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.98 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 32, 6, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 552/16384 [00:00<00:02, 5517.56probe position/s]Normalizing amplitudes:   7%|▋         | 1218/16384 [00:00<00:02, 6184.61probe position/s]Normalizing amplitudes:  11%|█▏        | 1855/16384 [00:00<00:02, 6266.55probe position/s]Normalizing amplitudes:  15%|█▌        | 2482/16384 [00:00<00:02, 5876.65probe position/s]Normalizing amplitudes:  19%|█▉        | 3074/16384 [00:00<00:02, 5594.66probe position/s]Normalizing amplitudes:  22%|██▏       | 3637/16384 [00:00<00:02, 5592.20probe position/s]Normalizing amplitudes:  26%|██▌       | 4199/16384 [00:00<00:02, 5507.26probe position/s]Normalizing amplitudes:  29%|██▉       | 4752/16384 [00:00<00:02, 5503.21probe position/s]Normalizing amplitudes:  32%|███▏      | 5304/16384 [00:00<00:02, 5401.48probe position/s]Normalizing amplitudes:  36%|███▌      | 5880/16384 [00:01<00:01, 5507.66probe position/s]Normalizing amplitudes:  40%|████      | 6576/16384 [00:01<00:01, 5939.44probe position/s]Normalizing amplitudes:  44%|████▍     | 7172/16384 [00:01<00:01, 5757.61probe position/s]Normalizing amplitudes:  47%|████▋     | 7750/16384 [00:01<00:01, 5602.95probe position/s]Normalizing amplitudes:  51%|█████     | 8313/16384 [00:01<00:01, 5560.56probe position/s]Normalizing amplitudes:  54%|█████▍    | 8871/16384 [00:01<00:01, 5504.39probe position/s]Normalizing amplitudes:  58%|█████▊    | 9438/16384 [00:01<00:01, 5550.93probe position/s]Normalizing amplitudes:  61%|██████    | 9994/16384 [00:01<00:01, 5410.50probe position/s]Normalizing amplitudes:  65%|██████▍   | 10571/16384 [00:01<00:01, 5513.33probe position/s]Normalizing amplitudes:  69%|██████▊   | 11248/16384 [00:01<00:00, 5878.42probe position/s]Normalizing amplitudes:  73%|███████▎  | 11902/16384 [00:02<00:00, 6067.34probe position/s]Normalizing amplitudes:  76%|███████▋  | 12511/16384 [00:02<00:00, 5786.66probe position/s]Normalizing amplitudes:  80%|███████▉  | 13094/16384 [00:02<00:00, 5630.98probe position/s]Normalizing amplitudes:  83%|████████▎ | 13660/16384 [00:02<00:00, 5556.83probe position/s]Normalizing amplitudes:  87%|████████▋ | 14218/16384 [00:02<00:00, 5513.86probe position/s]Normalizing amplitudes:  90%|█████████ | 14771/16384 [00:02<00:00, 5509.51probe position/s]Normalizing amplitudes:  94%|█████████▎| 15323/16384 [00:02<00:00, 5453.01probe position/s]Normalizing amplitudes:  98%|█████████▊| 16043/16384 [00:02<00:00, 5961.90probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5713.91probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random32_p6_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random32_p6_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.01428 in 79.154 sec
Iter: 2, Total Loss: 0.006071 in 80.409 sec
Iter: 3, Total Loss: 0.005678 in 80.930 sec
Iter: 4, Total Loss: 0.005463 in 80.800 sec
Iter: 5, Total Loss: 0.005317 in 79.222 sec
Iter: 6, Total Loss: 0.005199 in 79.871 sec
Iter: 7, Total Loss: 0.005094 in 80.528 sec
Iter: 8, Total Loss: 0.005004 in 80.863 sec
Iter: 9, Total Loss: 0.004927 in 79.720 sec
Iter: 10, Total Loss: 0.004868 in 78.616 sec
Iter: 11, Total Loss: 0.004821 in 76.700 sec
Iter: 12, Total Loss: 0.004786 in 74.980 sec
Iter: 13, Total Loss: 0.004757 in 80.389 sec
Iter: 14, Total Loss: 0.004733 in 80.112 sec
Iter: 15, Total Loss: 0.004713 in 77.966 sec
Iter: 16, Total Loss: 0.004696 in 78.063 sec
Iter: 17, Total Loss: 0.00468 in 76.943 sec
Iter: 18, Total Loss: 0.004666 in 77.734 sec
Iter: 19, Total Loss: 0.004655 in 81.587 sec
Iter: 20, Total Loss: 0.004643 in 80.450 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 79.252 with std = 1.676 sec ###
### py4DSTEM ptycho solver is finished in 26 min 25.883 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 935.09 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 32, 12, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 546/16384 [00:00<00:02, 5452.48probe position/s]Normalizing amplitudes:   7%|▋         | 1100/16384 [00:00<00:02, 5501.84probe position/s]Normalizing amplitudes:  10%|█         | 1651/16384 [00:00<00:02, 5483.90probe position/s]Normalizing amplitudes:  14%|█▍        | 2352/16384 [00:00<00:02, 6081.77probe position/s]Normalizing amplitudes:  18%|█▊        | 2961/16384 [00:00<00:02, 6026.90probe position/s]Normalizing amplitudes:  22%|██▏       | 3564/16384 [00:00<00:02, 5774.47probe position/s]Normalizing amplitudes:  25%|██▌       | 4144/16384 [00:00<00:02, 5628.93probe position/s]Normalizing amplitudes:  29%|██▊       | 4709/16384 [00:00<00:02, 5492.90probe position/s]Normalizing amplitudes:  32%|███▏      | 5260/16384 [00:00<00:02, 5471.44probe position/s]Normalizing amplitudes:  36%|███▌      | 5841/16384 [00:01<00:01, 5569.14probe position/s]Normalizing amplitudes:  39%|███▉      | 6399/16384 [00:01<00:01, 5536.02probe position/s]Normalizing amplitudes:  43%|████▎     | 7081/16384 [00:01<00:01, 5917.71probe position/s]Normalizing amplitudes:  47%|████▋     | 7675/16384 [00:01<00:01, 5872.66probe position/s]Normalizing amplitudes:  50%|█████     | 8264/16384 [00:01<00:01, 5709.26probe position/s]Normalizing amplitudes:  54%|█████▍    | 8837/16384 [00:01<00:01, 5597.98probe position/s]Normalizing amplitudes:  57%|█████▋    | 9398/16384 [00:01<00:01, 5480.89probe position/s]Normalizing amplitudes:  61%|██████    | 9948/16384 [00:01<00:01, 5471.86probe position/s]Normalizing amplitudes:  64%|██████▍   | 10496/16384 [00:01<00:01, 5422.96probe position/s]Normalizing amplitudes:  67%|██████▋   | 11039/16384 [00:01<00:00, 5420.74probe position/s]Normalizing amplitudes:  72%|███████▏  | 11718/16384 [00:02<00:00, 5821.28probe position/s]Normalizing amplitudes:  75%|███████▌  | 12327/16384 [00:02<00:00, 5898.35probe position/s]Normalizing amplitudes:  79%|███████▉  | 12918/16384 [00:02<00:00, 5714.04probe position/s]Normalizing amplitudes:  82%|████████▏ | 13492/16384 [00:02<00:00, 5580.34probe position/s]Normalizing amplitudes:  86%|████████▌ | 14052/16384 [00:02<00:00, 5528.08probe position/s]Normalizing amplitudes:  89%|████████▉ | 14606/16384 [00:02<00:00, 5459.07probe position/s]Normalizing amplitudes:  93%|█████████▎| 15160/16384 [00:02<00:00, 5478.70probe position/s]Normalizing amplitudes:  96%|█████████▌| 15709/16384 [00:02<00:00, 5472.20probe position/s]Normalizing amplitudes: 100%|█████████▉| 16362/16384 [00:02<00:00, 5782.78probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5643.60probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random32_p12_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random32_p12_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.0238 in 27.705 sec
Iter: 2, Total Loss: 0.006393 in 27.153 sec
Iter: 3, Total Loss: 0.006188 in 27.584 sec
Iter: 4, Total Loss: 0.006014 in 27.358 sec
Iter: 5, Total Loss: 0.00586 in 27.490 sec
Iter: 6, Total Loss: 0.005735 in 27.498 sec
Iter: 7, Total Loss: 0.005633 in 27.355 sec
Iter: 8, Total Loss: 0.005541 in 26.508 sec
Iter: 9, Total Loss: 0.005453 in 26.239 sec
Iter: 10, Total Loss: 0.005368 in 27.286 sec
Iter: 11, Total Loss: 0.005283 in 27.841 sec
Iter: 12, Total Loss: 0.005196 in 27.818 sec
Iter: 13, Total Loss: 0.005115 in 27.851 sec
Iter: 14, Total Loss: 0.005046 in 28.099 sec
Iter: 15, Total Loss: 0.004989 in 27.976 sec
Iter: 16, Total Loss: 0.004944 in 27.852 sec
Iter: 17, Total Loss: 0.004906 in 28.055 sec
Iter: 18, Total Loss: 0.004875 in 28.009 sec
Iter: 19, Total Loss: 0.004848 in 27.849 sec
Iter: 20, Total Loss: 0.004825 in 27.899 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 27.571 with std = 0.481 sec ###
### py4DSTEM ptycho solver is finished in 9 min 12.295 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.98 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 32, 12, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   5%|▍         | 782/16384 [00:00<00:01, 7817.51probe position/s]Normalizing amplitudes:  10%|▉         | 1564/16384 [00:00<00:02, 6356.05probe position/s]Normalizing amplitudes:  14%|█▎        | 2217/16384 [00:00<00:02, 5843.90probe position/s]Normalizing amplitudes:  17%|█▋        | 2811/16384 [00:00<00:02, 5661.08probe position/s]Normalizing amplitudes:  21%|██        | 3382/16384 [00:00<00:02, 5421.36probe position/s]Normalizing amplitudes:  24%|██▍       | 3927/16384 [00:00<00:02, 5287.68probe position/s]Normalizing amplitudes:  27%|██▋       | 4457/16384 [00:00<00:02, 5291.24probe position/s]Normalizing amplitudes:  31%|███▏      | 5121/16384 [00:00<00:01, 5691.18probe position/s]Normalizing amplitudes:  35%|███▌      | 5739/16384 [00:00<00:01, 5837.03probe position/s]Normalizing amplitudes:  39%|███▊      | 6326/16384 [00:01<00:01, 5645.79probe position/s]Normalizing amplitudes:  42%|████▏     | 6894/16384 [00:01<00:01, 5554.21probe position/s]Normalizing amplitudes:  45%|████▌     | 7452/16384 [00:01<00:01, 5485.62probe position/s]Normalizing amplitudes:  49%|████▉     | 8002/16384 [00:01<00:01, 5412.01probe position/s]Normalizing amplitudes:  52%|█████▏    | 8545/16384 [00:01<00:01, 5416.90probe position/s]Normalizing amplitudes:  55%|█████▌    | 9088/16384 [00:01<00:01, 5396.55probe position/s]Normalizing amplitudes:  60%|█████▉    | 9750/16384 [00:01<00:01, 5756.32probe position/s]Normalizing amplitudes:  64%|██████▍   | 10451/16384 [00:01<00:00, 6125.52probe position/s]Normalizing amplitudes:  68%|██████▊   | 11065/16384 [00:01<00:00, 5804.87probe position/s]Normalizing amplitudes:  71%|███████   | 11650/16384 [00:02<00:00, 5614.30probe position/s]Normalizing amplitudes:  75%|███████▍  | 12216/16384 [00:02<00:00, 5369.82probe position/s]Normalizing amplitudes:  78%|███████▊  | 12757/16384 [00:02<00:00, 5146.63probe position/s]Normalizing amplitudes:  81%|████████  | 13275/16384 [00:02<00:00, 5031.57probe position/s]Normalizing amplitudes:  85%|████████▌ | 13959/16384 [00:02<00:00, 5532.75probe position/s]Normalizing amplitudes:  89%|████████▉ | 14575/16384 [00:02<00:00, 5708.42probe position/s]Normalizing amplitudes:  92%|█████████▏| 15151/16384 [00:02<00:00, 5407.26probe position/s]Normalizing amplitudes:  96%|█████████▌| 15698/16384 [00:02<00:00, 5143.21probe position/s]Normalizing amplitudes:  99%|█████████▉| 16218/16384 [00:02<00:00, 5066.81probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5484.90probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random32_p12_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random32_p12_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.02427 in 78.072 sec
Iter: 2, Total Loss: 0.006206 in 76.433 sec
Iter: 3, Total Loss: 0.005866 in 80.035 sec
Iter: 4, Total Loss: 0.005627 in 79.840 sec
Iter: 5, Total Loss: 0.005451 in 79.033 sec
Iter: 6, Total Loss: 0.005315 in 77.980 sec
Iter: 7, Total Loss: 0.005196 in 78.541 sec
Iter: 8, Total Loss: 0.005086 in 77.459 sec
Iter: 9, Total Loss: 0.004985 in 76.511 sec
Iter: 10, Total Loss: 0.004901 in 76.865 sec
Iter: 11, Total Loss: 0.004836 in 76.596 sec
Iter: 12, Total Loss: 0.004784 in 76.784 sec
Iter: 13, Total Loss: 0.004744 in 78.128 sec
Iter: 14, Total Loss: 0.004711 in 79.247 sec
Iter: 15, Total Loss: 0.004684 in 80.312 sec
Iter: 16, Total Loss: 0.00466 in 80.375 sec
Iter: 17, Total Loss: 0.004639 in 79.696 sec
Iter: 18, Total Loss: 0.004621 in 80.601 sec
Iter: 19, Total Loss: 0.004604 in 83.462 sec
Iter: 20, Total Loss: 0.004589 in 82.550 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 78.926 with std = 1.926 sec ###
### py4DSTEM ptycho solver is finished in 26 min 19.467 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 936.40 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 32, 12, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 444/16384 [00:00<00:03, 4436.65probe position/s]Normalizing amplitudes:   7%|▋         | 1215/16384 [00:00<00:02, 6359.35probe position/s]Normalizing amplitudes:  12%|█▏        | 1985/16384 [00:00<00:02, 6970.51probe position/s]Normalizing amplitudes:  16%|█▋        | 2683/16384 [00:00<00:02, 5941.62probe position/s]Normalizing amplitudes:  20%|██        | 3297/16384 [00:00<00:02, 5371.99probe position/s]Normalizing amplitudes:  24%|██▎       | 3852/16384 [00:00<00:02, 5128.91probe position/s]Normalizing amplitudes:  27%|██▋       | 4376/16384 [00:00<00:02, 4951.24probe position/s]Normalizing amplitudes:  30%|██▉       | 4878/16384 [00:00<00:02, 4938.60probe position/s]Normalizing amplitudes:  34%|███▍      | 5649/16384 [00:01<00:01, 5724.52probe position/s]Normalizing amplitudes:  38%|███▊      | 6233/16384 [00:01<00:01, 5727.12probe position/s]Normalizing amplitudes:  42%|████▏     | 6814/16384 [00:01<00:01, 5348.60probe position/s]Normalizing amplitudes:  45%|████▍     | 7358/16384 [00:01<00:01, 5047.05probe position/s]Normalizing amplitudes:  48%|████▊     | 7871/16384 [00:01<00:01, 4922.97probe position/s]Normalizing amplitudes:  51%|█████     | 8369/16384 [00:01<00:01, 4802.22probe position/s]Normalizing amplitudes:  54%|█████▍    | 8853/16384 [00:01<00:01, 4702.73probe position/s]Normalizing amplitudes:  59%|█████▊    | 9622/16384 [00:01<00:01, 5532.08probe position/s]Normalizing amplitudes:  63%|██████▎   | 10399/16384 [00:01<00:00, 6166.47probe position/s]Normalizing amplitudes:  67%|██████▋   | 11026/16384 [00:02<00:00, 5833.60probe position/s]Normalizing amplitudes:  71%|███████   | 11619/16384 [00:02<00:00, 5367.26probe position/s]Normalizing amplitudes:  74%|███████▍  | 12168/16384 [00:02<00:00, 5096.74probe position/s]Normalizing amplitudes:  77%|███████▋  | 12687/16384 [00:02<00:00, 4923.94probe position/s]Normalizing amplitudes:  80%|████████  | 13186/16384 [00:02<00:00, 4815.44probe position/s]Normalizing amplitudes:  85%|████████▌ | 13952/16384 [00:02<00:00, 5585.40probe position/s]Normalizing amplitudes:  89%|████████▉ | 14648/16384 [00:02<00:00, 5968.17probe position/s]Normalizing amplitudes:  93%|█████████▎| 15256/16384 [00:02<00:00, 5798.75probe position/s]Normalizing amplitudes:  97%|█████████▋| 15844/16384 [00:02<00:00, 5369.48probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:03<00:00, 5355.14probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random32_p12_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random32_p12_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.02573 in 161.957 sec
Iter: 2, Total Loss: 0.006205 in 159.994 sec
Iter: 3, Total Loss: 0.005658 in 154.671 sec
Iter: 4, Total Loss: 0.005426 in 149.708 sec
Iter: 5, Total Loss: 0.005261 in 157.019 sec
Iter: 6, Total Loss: 0.005119 in 156.561 sec
Iter: 7, Total Loss: 0.004992 in 154.242 sec
Iter: 8, Total Loss: 0.004888 in 159.308 sec
Iter: 9, Total Loss: 0.004811 in 156.051 sec
Iter: 10, Total Loss: 0.004754 in 156.474 sec
Iter: 11, Total Loss: 0.00471 in 156.370 sec
Iter: 12, Total Loss: 0.004676 in 153.325 sec
Iter: 13, Total Loss: 0.004646 in 155.561 sec
Iter: 14, Total Loss: 0.004621 in 157.613 sec
Iter: 15, Total Loss: 0.0046 in 155.850 sec
Iter: 16, Total Loss: 0.00458 in 158.115 sec
Iter: 17, Total Loss: 0.004564 in 156.998 sec
Iter: 18, Total Loss: 0.004549 in 153.793 sec
Iter: 19, Total Loss: 0.004535 in 153.853 sec
Iter: 20, Total Loss: 0.004524 in 153.295 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 156.038 with std = 2.653 sec ###
### py4DSTEM ptycho solver is finished in 52 min 1.692 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.89 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 16, 1, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 686/16384 [00:00<00:02, 6849.42probe position/s]Normalizing amplitudes:   8%|▊         | 1371/16384 [00:00<00:02, 6183.13probe position/s]Normalizing amplitudes:  12%|█▏        | 1994/16384 [00:00<00:02, 5880.47probe position/s]Normalizing amplitudes:  16%|█▌        | 2585/16384 [00:00<00:02, 5670.98probe position/s]Normalizing amplitudes:  19%|█▉        | 3154/16384 [00:00<00:02, 5528.11probe position/s]Normalizing amplitudes:  23%|██▎       | 3721/16384 [00:00<00:02, 5564.94probe position/s]Normalizing amplitudes:  26%|██▋       | 4316/16384 [00:00<00:02, 5683.96probe position/s]Normalizing amplitudes:  31%|███       | 5055/16384 [00:00<00:01, 6208.22probe position/s]Normalizing amplitudes:  35%|███▍      | 5679/16384 [00:00<00:01, 6071.24probe position/s]Normalizing amplitudes:  38%|███▊      | 6289/16384 [00:01<00:01, 5928.54probe position/s]Normalizing amplitudes:  42%|████▏     | 6884/16384 [00:01<00:01, 5803.13probe position/s]Normalizing amplitudes:  46%|████▌     | 7466/16384 [00:01<00:01, 5755.52probe position/s]Normalizing amplitudes:  49%|████▉     | 8043/16384 [00:01<00:01, 5722.59probe position/s]Normalizing amplitudes:  53%|█████▎    | 8677/16384 [00:01<00:01, 5901.39probe position/s]Normalizing amplitudes:  58%|█████▊    | 9451/16384 [00:01<00:01, 6441.33probe position/s]Normalizing amplitudes:  62%|██████▏   | 10097/16384 [00:01<00:01, 6178.28probe position/s]Normalizing amplitudes:  65%|██████▌   | 10719/16384 [00:01<00:00, 5948.84probe position/s]Normalizing amplitudes:  69%|██████▉   | 11318/16384 [00:01<00:00, 5775.07probe position/s]Normalizing amplitudes:  73%|███████▎  | 11899/16384 [00:02<00:00, 5712.90probe position/s]Normalizing amplitudes:  76%|███████▌  | 12472/16384 [00:02<00:00, 5682.29probe position/s]Normalizing amplitudes:  80%|███████▉  | 13081/16384 [00:02<00:00, 5798.98probe position/s]Normalizing amplitudes:  84%|████████▍ | 13751/16384 [00:02<00:00, 6061.13probe position/s]Normalizing amplitudes:  88%|████████▊ | 14359/16384 [00:02<00:00, 5972.33probe position/s]Normalizing amplitudes:  91%|█████████▏| 14958/16384 [00:02<00:00, 5869.44probe position/s]Normalizing amplitudes:  95%|█████████▍| 15547/16384 [00:02<00:00, 5740.61probe position/s]Normalizing amplitudes:  98%|█████████▊| 16123/16384 [00:02<00:00, 5731.74probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5872.91probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random16_p1_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random16_p1_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.006893 in 7.231 sec
Iter: 2, Total Loss: 0.006557 in 7.210 sec
Iter: 3, Total Loss: 0.006461 in 7.100 sec
Iter: 4, Total Loss: 0.006368 in 7.169 sec
Iter: 5, Total Loss: 0.006292 in 7.213 sec
Iter: 6, Total Loss: 0.006239 in 7.218 sec
Iter: 7, Total Loss: 0.006201 in 7.172 sec
Iter: 8, Total Loss: 0.006176 in 7.280 sec
Iter: 9, Total Loss: 0.006157 in 7.173 sec
Iter: 10, Total Loss: 0.006146 in 7.094 sec
Iter: 11, Total Loss: 0.006137 in 7.077 sec
Iter: 12, Total Loss: 0.006132 in 7.086 sec
Iter: 13, Total Loss: 0.006127 in 7.097 sec
Iter: 14, Total Loss: 0.006123 in 7.725 sec
Iter: 15, Total Loss: 0.006119 in 7.638 sec
Iter: 16, Total Loss: 0.006117 in 7.709 sec
Iter: 17, Total Loss: 0.006114 in 7.680 sec
Iter: 18, Total Loss: 0.006113 in 7.624 sec
Iter: 19, Total Loss: 0.006109 in 7.684 sec
Iter: 20, Total Loss: 0.006107 in 7.569 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 7.337 with std = 0.245 sec ###
### py4DSTEM ptycho solver is finished in 2 min 27.511 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.87 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 16, 1, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 580/16384 [00:00<00:02, 5789.80probe position/s]Normalizing amplitudes:   7%|▋         | 1159/16384 [00:00<00:02, 5526.69probe position/s]Normalizing amplitudes:  10%|█         | 1713/16384 [00:00<00:02, 5438.53probe position/s]Normalizing amplitudes:  14%|█▍        | 2269/16384 [00:00<00:02, 5478.43probe position/s]Normalizing amplitudes:  17%|█▋        | 2818/16384 [00:00<00:02, 5418.35probe position/s]Normalizing amplitudes:  21%|██        | 3361/16384 [00:00<00:02, 5412.79probe position/s]Normalizing amplitudes:  24%|██▍       | 4002/16384 [00:00<00:02, 5732.51probe position/s]Normalizing amplitudes:  29%|██▊       | 4690/16384 [00:00<00:01, 6091.65probe position/s]Normalizing amplitudes:  32%|███▏      | 5300/16384 [00:00<00:01, 5890.26probe position/s]Normalizing amplitudes:  36%|███▌      | 5891/16384 [00:01<00:01, 5745.94probe position/s]Normalizing amplitudes:  39%|███▉      | 6468/16384 [00:01<00:01, 5615.09probe position/s]Normalizing amplitudes:  43%|████▎     | 7031/16384 [00:01<00:01, 5553.70probe position/s]Normalizing amplitudes:  46%|████▋     | 7588/16384 [00:01<00:01, 5450.05probe position/s]Normalizing amplitudes:  50%|████▉     | 8134/16384 [00:01<00:01, 5350.31probe position/s]Normalizing amplitudes:  54%|█████▎    | 8803/16384 [00:01<00:01, 5736.41probe position/s]Normalizing amplitudes:  58%|█████▊    | 9456/16384 [00:01<00:01, 5965.92probe position/s]Normalizing amplitudes:  61%|██████▏   | 10055/16384 [00:01<00:01, 5670.39probe position/s]Normalizing amplitudes:  65%|██████▍   | 10627/16384 [00:01<00:01, 5599.96probe position/s]Normalizing amplitudes:  68%|██████▊   | 11190/16384 [00:01<00:00, 5510.54probe position/s]Normalizing amplitudes:  72%|███████▏  | 11743/16384 [00:02<00:00, 5442.89probe position/s]Normalizing amplitudes:  75%|███████▌  | 12289/16384 [00:02<00:00, 5397.47probe position/s]Normalizing amplitudes:  78%|███████▊  | 12842/16384 [00:02<00:00, 5434.97probe position/s]Normalizing amplitudes:  83%|████████▎ | 13527/16384 [00:02<00:00, 5846.09probe position/s]Normalizing amplitudes:  86%|████████▋ | 14134/16384 [00:02<00:00, 5909.28probe position/s]Normalizing amplitudes:  90%|████████▉ | 14727/16384 [00:02<00:00, 5652.32probe position/s]Normalizing amplitudes:  93%|█████████▎| 15296/16384 [00:02<00:00, 5605.03probe position/s]Normalizing amplitudes:  97%|█████████▋| 15859/16384 [00:02<00:00, 5567.81probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5615.59probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random16_p1_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random16_p1_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.00692 in 17.984 sec
Iter: 2, Total Loss: 0.006519 in 18.059 sec
Iter: 3, Total Loss: 0.006408 in 18.070 sec
Iter: 4, Total Loss: 0.006323 in 18.113 sec
Iter: 5, Total Loss: 0.006258 in 18.000 sec
Iter: 6, Total Loss: 0.006214 in 18.049 sec
Iter: 7, Total Loss: 0.006184 in 18.263 sec
Iter: 8, Total Loss: 0.006162 in 18.215 sec
Iter: 9, Total Loss: 0.006144 in 18.001 sec
Iter: 10, Total Loss: 0.006127 in 17.764 sec
Iter: 11, Total Loss: 0.006118 in 17.731 sec
Iter: 12, Total Loss: 0.006108 in 17.837 sec
Iter: 13, Total Loss: 0.006101 in 17.959 sec
Iter: 14, Total Loss: 0.006094 in 17.987 sec
Iter: 15, Total Loss: 0.006087 in 17.935 sec
Iter: 16, Total Loss: 0.006082 in 17.879 sec
Iter: 17, Total Loss: 0.006076 in 17.774 sec
Iter: 18, Total Loss: 0.006069 in 17.751 sec
Iter: 19, Total Loss: 0.006066 in 17.735 sec
Iter: 20, Total Loss: 0.006059 in 17.867 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 17.949 with std = 0.152 sec ###
### py4DSTEM ptycho solver is finished in 5 min 59.778 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.96 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 16, 1, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 621/16384 [00:00<00:02, 6204.98probe position/s]Normalizing amplitudes:   8%|▊         | 1339/16384 [00:00<00:02, 6775.25probe position/s]Normalizing amplitudes:  12%|█▏        | 2017/16384 [00:00<00:02, 6156.13probe position/s]Normalizing amplitudes:  16%|█▌        | 2639/16384 [00:00<00:02, 5842.19probe position/s]Normalizing amplitudes:  20%|█▉        | 3228/16384 [00:00<00:02, 5726.16probe position/s]Normalizing amplitudes:  23%|██▎       | 3804/16384 [00:00<00:02, 5647.48probe position/s]Normalizing amplitudes:  27%|██▋       | 4371/16384 [00:00<00:02, 5519.23probe position/s]Normalizing amplitudes:  30%|███       | 4937/16384 [00:00<00:02, 5559.65probe position/s]Normalizing amplitudes:  34%|███▍      | 5646/16384 [00:00<00:01, 6019.31probe position/s]Normalizing amplitudes:  38%|███▊      | 6251/16384 [00:01<00:01, 6017.87probe position/s]Normalizing amplitudes:  42%|████▏     | 6855/16384 [00:01<00:01, 5671.99probe position/s]Normalizing amplitudes:  45%|████▌     | 7427/16384 [00:01<00:01, 5593.50probe position/s]Normalizing amplitudes:  49%|████▉     | 7990/16384 [00:01<00:01, 5522.53probe position/s]Normalizing amplitudes:  52%|█████▏    | 8545/16384 [00:01<00:01, 5479.16probe position/s]Normalizing amplitudes:  56%|█████▌    | 9095/16384 [00:01<00:01, 5435.28probe position/s]Normalizing amplitudes:  60%|█████▉    | 9774/16384 [00:01<00:01, 5827.86probe position/s]Normalizing amplitudes:  64%|██████▍   | 10533/16384 [00:01<00:00, 6340.33probe position/s]Normalizing amplitudes:  68%|██████▊   | 11170/16384 [00:01<00:00, 5915.90probe position/s]Normalizing amplitudes:  72%|███████▏  | 11769/16384 [00:02<00:00, 5731.45probe position/s]Normalizing amplitudes:  75%|███████▌  | 12348/16384 [00:02<00:00, 5602.40probe position/s]Normalizing amplitudes:  79%|███████▉  | 12912/16384 [00:02<00:00, 5533.61probe position/s]Normalizing amplitudes:  82%|████████▏ | 13468/16384 [00:02<00:00, 5468.33probe position/s]Normalizing amplitudes:  86%|████████▋ | 14160/16384 [00:02<00:00, 5880.23probe position/s]Normalizing amplitudes:  90%|█████████ | 14783/16384 [00:02<00:00, 5979.17probe position/s]Normalizing amplitudes:  94%|█████████▍| 15384/16384 [00:02<00:00, 5811.74probe position/s]Normalizing amplitudes:  97%|█████████▋| 15968/16384 [00:02<00:00, 5682.09probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5756.67probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random16_p1_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random16_p1_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.006994 in 33.386 sec
Iter: 2, Total Loss: 0.006551 in 33.455 sec
Iter: 3, Total Loss: 0.00644 in 33.517 sec
Iter: 4, Total Loss: 0.006357 in 33.478 sec
Iter: 5, Total Loss: 0.006298 in 33.477 sec
Iter: 6, Total Loss: 0.006256 in 33.294 sec
Iter: 7, Total Loss: 0.006229 in 32.478 sec
Iter: 8, Total Loss: 0.006203 in 32.377 sec
Iter: 9, Total Loss: 0.006182 in 32.406 sec
Iter: 10, Total Loss: 0.006161 in 32.089 sec
Iter: 11, Total Loss: 0.006141 in 31.537 sec
Iter: 12, Total Loss: 0.006119 in 31.691 sec
Iter: 13, Total Loss: 0.006099 in 31.747 sec
Iter: 14, Total Loss: 0.006075 in 32.743 sec
Iter: 15, Total Loss: 0.006057 in 33.328 sec
Iter: 16, Total Loss: 0.006036 in 33.331 sec
Iter: 17, Total Loss: 0.006017 in 33.381 sec
Iter: 18, Total Loss: 0.006002 in 33.874 sec
Iter: 19, Total Loss: 0.005984 in 33.608 sec
Iter: 20, Total Loss: 0.005968 in 33.629 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 32.941 with std = 0.718 sec ###
### py4DSTEM ptycho solver is finished in 10 min 59.719 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.89 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 16, 3, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 512/16384 [00:00<00:03, 5119.11probe position/s]Normalizing amplitudes:   6%|▋         | 1039/16384 [00:00<00:02, 5205.16probe position/s]Normalizing amplitudes:  10%|▉         | 1610/16384 [00:00<00:02, 5434.08probe position/s]Normalizing amplitudes:  14%|█▍        | 2295/16384 [00:00<00:02, 5991.67probe position/s]Normalizing amplitudes:  18%|█▊        | 2895/16384 [00:00<00:02, 5899.13probe position/s]Normalizing amplitudes:  21%|██▏       | 3486/16384 [00:00<00:02, 5719.99probe position/s]Normalizing amplitudes:  25%|██▍       | 4060/16384 [00:00<00:02, 5525.75probe position/s]Normalizing amplitudes:  28%|██▊       | 4615/16384 [00:00<00:02, 5434.46probe position/s]Normalizing amplitudes:  31%|███▏      | 5160/16384 [00:00<00:02, 5366.84probe position/s]Normalizing amplitudes:  35%|███▍      | 5698/16384 [00:01<00:02, 5342.89probe position/s]Normalizing amplitudes:  38%|███▊      | 6233/16384 [00:01<00:01, 5312.19probe position/s]Normalizing amplitudes:  43%|████▎     | 7001/16384 [00:01<00:01, 6011.87probe position/s]Normalizing amplitudes:  46%|████▋     | 7605/16384 [00:01<00:01, 5990.52probe position/s]Normalizing amplitudes:  50%|█████     | 8206/16384 [00:01<00:01, 5722.85probe position/s]Normalizing amplitudes:  54%|█████▎    | 8782/16384 [00:01<00:01, 5515.03probe position/s]Normalizing amplitudes:  57%|█████▋    | 9337/16384 [00:01<00:01, 5401.57probe position/s]Normalizing amplitudes:  60%|██████    | 9880/16384 [00:01<00:01, 5326.37probe position/s]Normalizing amplitudes:  64%|██████▎   | 10414/16384 [00:01<00:01, 5195.50probe position/s]Normalizing amplitudes:  67%|██████▋   | 10952/16384 [00:01<00:01, 5246.43probe position/s]Normalizing amplitudes:  71%|███████   | 11646/16384 [00:02<00:00, 5733.57probe position/s]Normalizing amplitudes:  75%|███████▍  | 12224/16384 [00:02<00:00, 5746.63probe position/s]Normalizing amplitudes:  78%|███████▊  | 12801/16384 [00:02<00:00, 5534.54probe position/s]Normalizing amplitudes:  82%|████████▏ | 13358/16384 [00:02<00:00, 5438.06probe position/s]Normalizing amplitudes:  85%|████████▍ | 13904/16384 [00:02<00:00, 5401.56probe position/s]Normalizing amplitudes:  88%|████████▊ | 14446/16384 [00:02<00:00, 5396.00probe position/s]Normalizing amplitudes:  91%|█████████▏| 14987/16384 [00:02<00:00, 5307.57probe position/s]Normalizing amplitudes:  95%|█████████▍| 15519/16384 [00:02<00:00, 5230.79probe position/s]Normalizing amplitudes:  98%|█████████▊| 16125/16384 [00:02<00:00, 5468.78probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5517.72probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random16_p3_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random16_p3_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.00763 in 15.712 sec
Iter: 2, Total Loss: 0.00641 in 15.773 sec
Iter: 3, Total Loss: 0.006185 in 15.863 sec
Iter: 4, Total Loss: 0.005972 in 16.088 sec
Iter: 5, Total Loss: 0.00581 in 15.991 sec
Iter: 6, Total Loss: 0.005694 in 16.022 sec
Iter: 7, Total Loss: 0.005603 in 15.994 sec
Iter: 8, Total Loss: 0.005524 in 15.728 sec
Iter: 9, Total Loss: 0.005454 in 15.852 sec
Iter: 10, Total Loss: 0.005392 in 15.877 sec
Iter: 11, Total Loss: 0.005346 in 15.865 sec
Iter: 12, Total Loss: 0.005313 in 16.591 sec
Iter: 13, Total Loss: 0.005289 in 16.078 sec
Iter: 14, Total Loss: 0.005271 in 13.632 sec
Iter: 15, Total Loss: 0.005256 in 14.030 sec
Iter: 16, Total Loss: 0.005242 in 16.886 sec
Iter: 17, Total Loss: 0.00523 in 15.998 sec
Iter: 18, Total Loss: 0.005219 in 16.089 sec
Iter: 19, Total Loss: 0.00521 in 16.061 sec
Iter: 20, Total Loss: 0.005201 in 16.194 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 15.816 with std = 0.717 sec ###
### py4DSTEM ptycho solver is finished in 5 min 17.165 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.90 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 16, 3, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 605/16384 [00:00<00:02, 6048.32probe position/s]Normalizing amplitudes:   8%|▊         | 1275/16384 [00:00<00:02, 6431.13probe position/s]Normalizing amplitudes:  12%|█▏        | 1919/16384 [00:00<00:02, 5866.82probe position/s]Normalizing amplitudes:  15%|█▌        | 2512/16384 [00:00<00:02, 5704.69probe position/s]Normalizing amplitudes:  19%|█▉        | 3086/16384 [00:00<00:02, 5491.99probe position/s]Normalizing amplitudes:  22%|██▏       | 3638/16384 [00:00<00:02, 5397.13probe position/s]Normalizing amplitudes:  26%|██▌       | 4180/16384 [00:00<00:02, 5368.71probe position/s]Normalizing amplitudes:  29%|██▉       | 4718/16384 [00:00<00:02, 5167.53probe position/s]Normalizing amplitudes:  32%|███▏      | 5302/16384 [00:00<00:02, 5364.90probe position/s]Normalizing amplitudes:  37%|███▋      | 5993/16384 [00:01<00:01, 5821.08probe position/s]Normalizing amplitudes:  40%|████      | 6579/16384 [00:01<00:01, 5742.84probe position/s]Normalizing amplitudes:  44%|████▎     | 7156/16384 [00:01<00:01, 5591.82probe position/s]Normalizing amplitudes:  47%|████▋     | 7718/16384 [00:01<00:01, 5498.87probe position/s]Normalizing amplitudes:  50%|█████     | 8270/16384 [00:01<00:01, 5324.11probe position/s]Normalizing amplitudes:  54%|█████▍    | 8814/16384 [00:01<00:01, 5354.81probe position/s]Normalizing amplitudes:  57%|█████▋    | 9361/16384 [00:01<00:01, 5386.56probe position/s]Normalizing amplitudes:  60%|██████    | 9901/16384 [00:01<00:01, 5373.37probe position/s]Normalizing amplitudes:  65%|██████▍   | 10589/16384 [00:01<00:00, 5815.16probe position/s]Normalizing amplitudes:  68%|██████▊   | 11180/16384 [00:01<00:00, 5843.05probe position/s]Normalizing amplitudes:  72%|███████▏  | 11766/16384 [00:02<00:00, 5684.12probe position/s]Normalizing amplitudes:  75%|███████▌  | 12336/16384 [00:02<00:00, 5619.98probe position/s]Normalizing amplitudes:  79%|███████▊  | 12900/16384 [00:02<00:00, 5613.24probe position/s]Normalizing amplitudes:  82%|████████▏ | 13463/16384 [00:02<00:00, 5456.77probe position/s]Normalizing amplitudes:  86%|████████▌ | 14010/16384 [00:02<00:00, 5340.56probe position/s]Normalizing amplitudes:  89%|████████▉ | 14546/16384 [00:02<00:00, 5316.80probe position/s]Normalizing amplitudes:  93%|█████████▎| 15247/16384 [00:02<00:00, 5806.78probe position/s]Normalizing amplitudes:  97%|█████████▋| 15885/16384 [00:02<00:00, 5974.10probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5595.36probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random16_p3_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random16_p3_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.00769 in 43.075 sec
Iter: 2, Total Loss: 0.006148 in 40.985 sec
Iter: 3, Total Loss: 0.005857 in 40.763 sec
Iter: 4, Total Loss: 0.005659 in 40.915 sec
Iter: 5, Total Loss: 0.005526 in 40.946 sec
Iter: 6, Total Loss: 0.005422 in 41.220 sec
Iter: 7, Total Loss: 0.005336 in 40.923 sec
Iter: 8, Total Loss: 0.00527 in 41.286 sec
Iter: 9, Total Loss: 0.005222 in 42.408 sec
Iter: 10, Total Loss: 0.005187 in 42.922 sec
Iter: 11, Total Loss: 0.00516 in 42.960 sec
Iter: 12, Total Loss: 0.005136 in 43.113 sec
Iter: 13, Total Loss: 0.005118 in 42.989 sec
Iter: 14, Total Loss: 0.005102 in 42.610 sec
Iter: 15, Total Loss: 0.005089 in 42.453 sec
Iter: 16, Total Loss: 0.005078 in 42.564 sec
Iter: 17, Total Loss: 0.005067 in 42.089 sec
Iter: 18, Total Loss: 0.005058 in 41.869 sec
Iter: 19, Total Loss: 0.005049 in 41.876 sec
Iter: 20, Total Loss: 0.005042 in 42.874 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 42.042 with std = 0.840 sec ###
### py4DSTEM ptycho solver is finished in 14 min 1.661 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.80 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 16, 3, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 678/16384 [00:00<00:02, 6777.11probe position/s]Normalizing amplitudes:   8%|▊         | 1356/16384 [00:00<00:02, 6331.33probe position/s]Normalizing amplitudes:  12%|█▏        | 1992/16384 [00:00<00:02, 5933.49probe position/s]Normalizing amplitudes:  16%|█▌        | 2589/16384 [00:00<00:02, 5762.38probe position/s]Normalizing amplitudes:  19%|█▉        | 3167/16384 [00:00<00:02, 5585.62probe position/s]Normalizing amplitudes:  23%|██▎       | 3728/16384 [00:00<00:02, 5592.69probe position/s]Normalizing amplitudes:  26%|██▌       | 4288/16384 [00:00<00:02, 5534.78probe position/s]Normalizing amplitudes:  30%|██▉       | 4842/16384 [00:00<00:02, 5515.27probe position/s]Normalizing amplitudes:  34%|███▍      | 5562/16384 [00:00<00:01, 6024.91probe position/s]Normalizing amplitudes:  38%|███▊      | 6167/16384 [00:01<00:01, 5984.23probe position/s]Normalizing amplitudes:  41%|████▏     | 6767/16384 [00:01<00:01, 5816.91probe position/s]Normalizing amplitudes:  45%|████▍     | 7351/16384 [00:01<00:01, 5684.99probe position/s]Normalizing amplitudes:  48%|████▊     | 7921/16384 [00:01<00:01, 5621.10probe position/s]Normalizing amplitudes:  52%|█████▏    | 8484/16384 [00:01<00:01, 5516.33probe position/s]Normalizing amplitudes:  55%|█████▌    | 9037/16384 [00:01<00:01, 5418.76probe position/s]Normalizing amplitudes:  59%|█████▊    | 9593/16384 [00:01<00:01, 5459.32probe position/s]Normalizing amplitudes:  63%|██████▎   | 10301/16384 [00:01<00:01, 5930.74probe position/s]Normalizing amplitudes:  67%|██████▋   | 10896/16384 [00:01<00:00, 5875.24probe position/s]Normalizing amplitudes:  70%|███████   | 11485/16384 [00:01<00:00, 5768.24probe position/s]Normalizing amplitudes:  74%|███████▎  | 12063/16384 [00:02<00:00, 5672.49probe position/s]Normalizing amplitudes:  77%|███████▋  | 12632/16384 [00:02<00:00, 5581.89probe position/s]Normalizing amplitudes:  81%|████████  | 13191/16384 [00:02<00:00, 5567.46probe position/s]Normalizing amplitudes:  84%|████████▍ | 13749/16384 [00:02<00:00, 5517.37probe position/s]Normalizing amplitudes:  87%|████████▋ | 14311/16384 [00:02<00:00, 5546.43probe position/s]Normalizing amplitudes:  91%|█████████▏| 14986/16384 [00:02<00:00, 5900.34probe position/s]Normalizing amplitudes:  96%|█████████▌| 15667/16384 [00:02<00:00, 6167.69probe position/s]Normalizing amplitudes:  99%|█████████▉| 16285/16384 [00:02<00:00, 5869.38probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5742.92probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random16_p3_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random16_p3_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.007882 in 82.996 sec
Iter: 2, Total Loss: 0.005999 in 82.547 sec
Iter: 3, Total Loss: 0.005688 in 82.282 sec
Iter: 4, Total Loss: 0.005526 in 80.048 sec
Iter: 5, Total Loss: 0.005423 in 81.075 sec
Iter: 6, Total Loss: 0.005338 in 83.846 sec
Iter: 7, Total Loss: 0.005267 in 83.717 sec
Iter: 8, Total Loss: 0.005212 in 81.185 sec
Iter: 9, Total Loss: 0.005169 in 79.671 sec
Iter: 10, Total Loss: 0.005136 in 77.938 sec
Iter: 11, Total Loss: 0.005109 in 81.134 sec
Iter: 12, Total Loss: 0.005088 in 80.822 sec
Iter: 13, Total Loss: 0.00507 in 80.512 sec
Iter: 14, Total Loss: 0.005056 in 81.045 sec
Iter: 15, Total Loss: 0.005044 in 80.461 sec
Iter: 16, Total Loss: 0.005033 in 79.784 sec
Iter: 17, Total Loss: 0.005023 in 78.940 sec
Iter: 18, Total Loss: 0.005014 in 78.228 sec
Iter: 19, Total Loss: 0.005005 in 77.695 sec
Iter: 20, Total Loss: 0.004998 in 77.471 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 80.570 with std = 1.861 sec ###
### py4DSTEM ptycho solver is finished in 26 min 52.231 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.85 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 16, 6, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 541/16384 [00:00<00:02, 5406.89probe position/s]Normalizing amplitudes:   7%|▋         | 1082/16384 [00:00<00:02, 5259.55probe position/s]Normalizing amplitudes:  10%|▉         | 1636/16384 [00:00<00:02, 5383.99probe position/s]Normalizing amplitudes:  14%|█▍        | 2258/16384 [00:00<00:02, 5708.35probe position/s]Normalizing amplitudes:  18%|█▊        | 2983/16384 [00:00<00:02, 6260.07probe position/s]Normalizing amplitudes:  22%|██▏       | 3610/16384 [00:00<00:02, 6171.95probe position/s]Normalizing amplitudes:  26%|██▌       | 4228/16384 [00:00<00:02, 5936.81probe position/s]Normalizing amplitudes:  29%|██▉       | 4824/16384 [00:00<00:01, 5864.29probe position/s]Normalizing amplitudes:  33%|███▎      | 5412/16384 [00:00<00:01, 5808.87probe position/s]Normalizing amplitudes:  37%|███▋      | 5994/16384 [00:01<00:01, 5806.89probe position/s]Normalizing amplitudes:  41%|████      | 6668/16384 [00:01<00:01, 6084.35probe position/s]Normalizing amplitudes:  45%|████▍     | 7315/16384 [00:01<00:01, 6197.23probe position/s]Normalizing amplitudes:  48%|████▊     | 7936/16384 [00:01<00:01, 5986.81probe position/s]Normalizing amplitudes:  52%|█████▏    | 8537/16384 [00:01<00:01, 5865.60probe position/s]Normalizing amplitudes:  56%|█████▌    | 9126/16384 [00:01<00:01, 5794.35probe position/s]Normalizing amplitudes:  59%|█████▉    | 9707/16384 [00:01<00:01, 5705.80probe position/s]Normalizing amplitudes:  63%|██████▎   | 10361/16384 [00:01<00:01, 5945.83probe position/s]Normalizing amplitudes:  67%|██████▋   | 11056/16384 [00:01<00:00, 6239.66probe position/s]Normalizing amplitudes:  71%|███████▏  | 11682/16384 [00:01<00:00, 5978.13probe position/s]Normalizing amplitudes:  75%|███████▍  | 12284/16384 [00:02<00:00, 5822.79probe position/s]Normalizing amplitudes:  79%|███████▊  | 12869/16384 [00:02<00:00, 5799.39probe position/s]Normalizing amplitudes:  82%|████████▏ | 13451/16384 [00:02<00:00, 5800.30probe position/s]Normalizing amplitudes:  86%|████████▌ | 14056/16384 [00:02<00:00, 5872.05probe position/s]Normalizing amplitudes:  90%|█████████ | 14766/16384 [00:02<00:00, 6229.63probe position/s]Normalizing amplitudes:  94%|█████████▍| 15391/16384 [00:02<00:00, 6156.05probe position/s]Normalizing amplitudes:  98%|█████████▊| 16008/16384 [00:02<00:00, 5982.41probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5910.14probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random16_p6_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random16_p6_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.009805 in 27.376 sec
Iter: 2, Total Loss: 0.006389 in 28.292 sec
Iter: 3, Total Loss: 0.006143 in 28.219 sec
Iter: 4, Total Loss: 0.005918 in 28.511 sec
Iter: 5, Total Loss: 0.005739 in 28.434 sec
Iter: 6, Total Loss: 0.005603 in 28.143 sec
Iter: 7, Total Loss: 0.005481 in 28.166 sec
Iter: 8, Total Loss: 0.005359 in 27.911 sec
Iter: 9, Total Loss: 0.005246 in 27.828 sec
Iter: 10, Total Loss: 0.005157 in 27.313 sec
Iter: 11, Total Loss: 0.005096 in 27.415 sec
Iter: 12, Total Loss: 0.005051 in 27.514 sec
Iter: 13, Total Loss: 0.005016 in 27.715 sec
Iter: 14, Total Loss: 0.004987 in 27.709 sec
Iter: 15, Total Loss: 0.004963 in 27.513 sec
Iter: 16, Total Loss: 0.004942 in 27.495 sec
Iter: 17, Total Loss: 0.004923 in 28.156 sec
Iter: 18, Total Loss: 0.004906 in 28.180 sec
Iter: 19, Total Loss: 0.004891 in 28.237 sec
Iter: 20, Total Loss: 0.004878 in 28.210 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 27.917 with std = 0.373 sec ###
### py4DSTEM ptycho solver is finished in 9 min 19.098 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.82 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 16, 6, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 699/16384 [00:00<00:02, 6987.49probe position/s]Normalizing amplitudes:   9%|▊         | 1398/16384 [00:00<00:02, 6432.87probe position/s]Normalizing amplitudes:  12%|█▏        | 2045/16384 [00:00<00:02, 5971.82probe position/s]Normalizing amplitudes:  16%|█▌        | 2646/16384 [00:00<00:02, 5747.27probe position/s]Normalizing amplitudes:  20%|█▉        | 3223/16384 [00:00<00:02, 5716.71probe position/s]Normalizing amplitudes:  23%|██▎       | 3796/16384 [00:00<00:02, 5624.61probe position/s]Normalizing amplitudes:  27%|██▋       | 4359/16384 [00:00<00:02, 5444.29probe position/s]Normalizing amplitudes:  30%|███       | 4990/16384 [00:00<00:01, 5703.13probe position/s]Normalizing amplitudes:  35%|███▍      | 5669/16384 [00:00<00:01, 6029.47probe position/s]Normalizing amplitudes:  38%|███▊      | 6275/16384 [00:01<00:01, 5984.85probe position/s]Normalizing amplitudes:  42%|████▏     | 6876/16384 [00:01<00:01, 5841.02probe position/s]Normalizing amplitudes:  46%|████▌     | 7462/16384 [00:01<00:01, 5708.73probe position/s]Normalizing amplitudes:  49%|████▉     | 8035/16384 [00:01<00:01, 5628.13probe position/s]Normalizing amplitudes:  52%|█████▏    | 8599/16384 [00:01<00:01, 5596.79probe position/s]Normalizing amplitudes:  56%|█████▌    | 9160/16384 [00:01<00:01, 5520.59probe position/s]Normalizing amplitudes:  59%|█████▉    | 9713/16384 [00:01<00:01, 5500.29probe position/s]Normalizing amplitudes:  63%|██████▎   | 10401/16384 [00:01<00:01, 5903.56probe position/s]Normalizing amplitudes:  67%|██████▋   | 11006/16384 [00:01<00:00, 5946.17probe position/s]Normalizing amplitudes:  71%|███████   | 11602/16384 [00:02<00:00, 5789.33probe position/s]Normalizing amplitudes:  74%|███████▍  | 12183/16384 [00:02<00:00, 5746.68probe position/s]Normalizing amplitudes:  78%|███████▊  | 12759/16384 [00:02<00:00, 5632.33probe position/s]Normalizing amplitudes:  81%|████████▏ | 13324/16384 [00:02<00:00, 5582.18probe position/s]Normalizing amplitudes:  85%|████████▍ | 13887/16384 [00:02<00:00, 5595.03probe position/s]Normalizing amplitudes:  88%|████████▊ | 14447/16384 [00:02<00:00, 5540.38probe position/s]Normalizing amplitudes:  92%|█████████▏| 15060/16384 [00:02<00:00, 5710.71probe position/s]Normalizing amplitudes:  96%|█████████▌| 15760/16384 [00:02<00:00, 6089.32probe position/s]Normalizing amplitudes: 100%|█████████▉| 16370/16384 [00:02<00:00, 5993.43probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5782.54probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random16_p6_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random16_p6_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.009926 in 78.390 sec
Iter: 2, Total Loss: 0.006108 in 78.448 sec
Iter: 3, Total Loss: 0.005765 in 78.145 sec
Iter: 4, Total Loss: 0.005529 in 78.226 sec
Iter: 5, Total Loss: 0.005347 in 78.995 sec
Iter: 6, Total Loss: 0.005178 in 78.618 sec
Iter: 7, Total Loss: 0.005051 in 76.697 sec
Iter: 8, Total Loss: 0.004973 in 75.219 sec
Iter: 9, Total Loss: 0.004921 in 74.158 sec
Iter: 10, Total Loss: 0.004882 in 76.183 sec
Iter: 11, Total Loss: 0.004852 in 76.182 sec
Iter: 12, Total Loss: 0.004828 in 77.534 sec
Iter: 13, Total Loss: 0.004806 in 76.829 sec
Iter: 14, Total Loss: 0.004788 in 74.938 sec
Iter: 15, Total Loss: 0.004771 in 73.235 sec
Iter: 16, Total Loss: 0.004757 in 79.248 sec
Iter: 17, Total Loss: 0.004743 in 76.596 sec
Iter: 18, Total Loss: 0.004731 in 76.303 sec
Iter: 19, Total Loss: 0.00472 in 75.604 sec
Iter: 20, Total Loss: 0.004709 in 75.584 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 76.757 with std = 1.633 sec ###
### py4DSTEM ptycho solver is finished in 25 min 35.901 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.70 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 16, 6, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 603/16384 [00:00<00:02, 6024.29probe position/s]Normalizing amplitudes:   8%|▊         | 1275/16384 [00:00<00:02, 6431.16probe position/s]Normalizing amplitudes:  12%|█▏        | 1919/16384 [00:00<00:02, 6109.39probe position/s]Normalizing amplitudes:  15%|█▌        | 2532/16384 [00:00<00:02, 5970.41probe position/s]Normalizing amplitudes:  19%|█▉        | 3131/16384 [00:00<00:02, 5829.13probe position/s]Normalizing amplitudes:  23%|██▎       | 3715/16384 [00:00<00:02, 5724.38probe position/s]Normalizing amplitudes:  26%|██▌       | 4288/16384 [00:00<00:02, 5672.78probe position/s]Normalizing amplitudes:  30%|██▉       | 4856/16384 [00:00<00:02, 5610.43probe position/s]Normalizing amplitudes:  34%|███▎      | 5509/16384 [00:00<00:01, 5888.65probe position/s]Normalizing amplitudes:  38%|███▊      | 6146/16384 [00:01<00:01, 6032.25probe position/s]Normalizing amplitudes:  41%|████      | 6751/16384 [00:01<00:01, 5820.12probe position/s]Normalizing amplitudes:  45%|████▍     | 7336/16384 [00:01<00:01, 5796.33probe position/s]Normalizing amplitudes:  48%|████▊     | 7917/16384 [00:01<00:01, 5691.57probe position/s]Normalizing amplitudes:  52%|█████▏    | 8493/16384 [00:01<00:01, 5708.48probe position/s]Normalizing amplitudes:  55%|█████▌    | 9065/16384 [00:01<00:01, 5710.57probe position/s]Normalizing amplitudes:  59%|█████▉    | 9650/16384 [00:01<00:01, 5749.65probe position/s]Normalizing amplitudes:  63%|██████▎   | 10305/16384 [00:01<00:01, 5986.00probe position/s]Normalizing amplitudes:  67%|██████▋   | 10935/16384 [00:01<00:00, 6078.10probe position/s]Normalizing amplitudes:  70%|███████   | 11544/16384 [00:01<00:00, 5859.70probe position/s]Normalizing amplitudes:  74%|███████▍  | 12132/16384 [00:02<00:00, 5814.03probe position/s]Normalizing amplitudes:  78%|███████▊  | 12715/16384 [00:02<00:00, 5736.36probe position/s]Normalizing amplitudes:  81%|████████  | 13290/16384 [00:02<00:00, 5682.66probe position/s]Normalizing amplitudes:  85%|████████▍ | 13859/16384 [00:02<00:00, 5669.12probe position/s]Normalizing amplitudes:  88%|████████▊ | 14442/16384 [00:02<00:00, 5713.43probe position/s]Normalizing amplitudes:  92%|█████████▏| 15105/16384 [00:02<00:00, 5983.43probe position/s]Normalizing amplitudes:  96%|█████████▋| 15792/16384 [00:02<00:00, 6244.12probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5865.70probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random16_p6_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random16_p6_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.01046 in 155.695 sec
Iter: 2, Total Loss: 0.005964 in 152.490 sec
Iter: 3, Total Loss: 0.005608 in 150.630 sec
Iter: 4, Total Loss: 0.005377 in 156.702 sec
Iter: 5, Total Loss: 0.005174 in 153.332 sec
Iter: 6, Total Loss: 0.005011 in 152.992 sec
Iter: 7, Total Loss: 0.004917 in 155.039 sec
Iter: 8, Total Loss: 0.004861 in 154.379 sec
Iter: 9, Total Loss: 0.00482 in 150.120 sec
Iter: 10, Total Loss: 0.004788 in 150.274 sec
Iter: 11, Total Loss: 0.004763 in 149.062 sec
Iter: 12, Total Loss: 0.004742 in 151.928 sec
Iter: 13, Total Loss: 0.004723 in 155.834 sec
Iter: 14, Total Loss: 0.004707 in 151.830 sec
Iter: 15, Total Loss: 0.004693 in 153.867 sec
Iter: 16, Total Loss: 0.00468 in 154.964 sec
Iter: 17, Total Loss: 0.004668 in 155.829 sec
Iter: 18, Total Loss: 0.004657 in 152.613 sec
Iter: 19, Total Loss: 0.004647 in 151.916 sec
Iter: 20, Total Loss: 0.004638 in 148.563 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 152.903 with std = 2.326 sec ###
### py4DSTEM ptycho solver is finished in 50 min 58.941 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.55 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 16, 12, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 533/16384 [00:00<00:02, 5323.01probe position/s]Normalizing amplitudes:   7%|▋         | 1091/16384 [00:00<00:02, 5471.86probe position/s]Normalizing amplitudes:  10%|█         | 1639/16384 [00:00<00:02, 5402.92probe position/s]Normalizing amplitudes:  13%|█▎        | 2180/16384 [00:00<00:02, 5396.79probe position/s]Normalizing amplitudes:  17%|█▋        | 2745/16384 [00:00<00:02, 5485.60probe position/s]Normalizing amplitudes:  21%|██        | 3401/16384 [00:00<00:02, 5847.71probe position/s]Normalizing amplitudes:  24%|██▍       | 3999/16384 [00:00<00:02, 5890.59probe position/s]Normalizing amplitudes:  28%|██▊       | 4589/16384 [00:00<00:02, 5786.25probe position/s]Normalizing amplitudes:  32%|███▏      | 5169/16384 [00:00<00:01, 5650.18probe position/s]Normalizing amplitudes:  35%|███▌      | 5735/16384 [00:01<00:01, 5552.85probe position/s]Normalizing amplitudes:  38%|███▊      | 6291/16384 [00:01<00:01, 5504.43probe position/s]Normalizing amplitudes:  42%|████▏     | 6843/16384 [00:01<00:01, 5506.56probe position/s]Normalizing amplitudes:  45%|████▌     | 7394/16384 [00:01<00:01, 5472.30probe position/s]Normalizing amplitudes:  49%|████▉     | 8088/16384 [00:01<00:01, 5907.20probe position/s]Normalizing amplitudes:  53%|█████▎    | 8747/16384 [00:01<00:01, 6101.87probe position/s]Normalizing amplitudes:  57%|█████▋    | 9359/16384 [00:01<00:01, 5779.21probe position/s]Normalizing amplitudes:  61%|██████    | 9941/16384 [00:01<00:01, 5667.44probe position/s]Normalizing amplitudes:  64%|██████▍   | 10511/16384 [00:01<00:01, 5541.86probe position/s]Normalizing amplitudes:  68%|██████▊   | 11080/16384 [00:01<00:00, 5583.38probe position/s]Normalizing amplitudes:  71%|███████   | 11641/16384 [00:02<00:00, 5509.20probe position/s]Normalizing amplitudes:  74%|███████▍  | 12194/16384 [00:02<00:00, 5452.34probe position/s]Normalizing amplitudes:  78%|███████▊  | 12793/16384 [00:02<00:00, 5606.56probe position/s]Normalizing amplitudes:  82%|████████▏ | 13449/16384 [00:02<00:00, 5885.70probe position/s]Normalizing amplitudes:  86%|████████▌ | 14039/16384 [00:02<00:00, 5744.69probe position/s]Normalizing amplitudes:  89%|████████▉ | 14616/16384 [00:02<00:00, 5615.15probe position/s]Normalizing amplitudes:  93%|█████████▎| 15179/16384 [00:02<00:00, 5583.73probe position/s]Normalizing amplitudes:  96%|█████████▌| 15739/16384 [00:02<00:00, 5572.66probe position/s]Normalizing amplitudes:  99%|█████████▉| 16297/16384 [00:02<00:00, 5564.96probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5625.52probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random16_p12_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random16_p12_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.01515 in 52.771 sec
Iter: 2, Total Loss: 0.00638 in 52.599 sec
Iter: 3, Total Loss: 0.006116 in 53.069 sec
Iter: 4, Total Loss: 0.005871 in 52.829 sec
Iter: 5, Total Loss: 0.005678 in 52.678 sec
Iter: 6, Total Loss: 0.005532 in 52.727 sec
Iter: 7, Total Loss: 0.005392 in 53.218 sec
Iter: 8, Total Loss: 0.005255 in 52.876 sec
Iter: 9, Total Loss: 0.005141 in 53.413 sec
Iter: 10, Total Loss: 0.005058 in 52.678 sec
Iter: 11, Total Loss: 0.004995 in 53.335 sec
Iter: 12, Total Loss: 0.004946 in 52.924 sec
Iter: 13, Total Loss: 0.004904 in 52.881 sec
Iter: 14, Total Loss: 0.004869 in 52.848 sec
Iter: 15, Total Loss: 0.004838 in 51.971 sec
Iter: 16, Total Loss: 0.004808 in 51.489 sec
Iter: 17, Total Loss: 0.00478 in 51.896 sec
Iter: 18, Total Loss: 0.004754 in 53.336 sec
Iter: 19, Total Loss: 0.00473 in 53.346 sec
Iter: 20, Total Loss: 0.004706 in 52.302 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 52.759 with std = 0.502 sec ###
### py4DSTEM ptycho solver is finished in 17 min 36.037 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 936.45 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 16, 12, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 542/16384 [00:00<00:02, 5408.32probe position/s]Normalizing amplitudes:   7%|▋         | 1083/16384 [00:00<00:02, 5330.96probe position/s]Normalizing amplitudes:  10%|▉         | 1617/16384 [00:00<00:02, 5276.68probe position/s]Normalizing amplitudes:  13%|█▎        | 2173/16384 [00:00<00:02, 5385.14probe position/s]Normalizing amplitudes:  17%|█▋        | 2712/16384 [00:00<00:02, 5199.53probe position/s]Normalizing amplitudes:  20%|█▉        | 3234/16384 [00:00<00:02, 5140.22probe position/s]Normalizing amplitudes:  23%|██▎       | 3815/16384 [00:00<00:02, 5352.55probe position/s]Normalizing amplitudes:  28%|██▊       | 4528/16384 [00:00<00:02, 5905.00probe position/s]Normalizing amplitudes:  31%|███▏      | 5121/16384 [00:00<00:01, 5785.30probe position/s]Normalizing amplitudes:  35%|███▍      | 5702/16384 [00:01<00:01, 5609.75probe position/s]Normalizing amplitudes:  38%|███▊      | 6265/16384 [00:01<00:01, 5409.53probe position/s]Normalizing amplitudes:  42%|████▏     | 6809/16384 [00:01<00:01, 5358.48probe position/s]Normalizing amplitudes:  45%|████▍     | 7347/16384 [00:01<00:01, 5294.85probe position/s]Normalizing amplitudes:  48%|████▊     | 7878/16384 [00:01<00:01, 5253.60probe position/s]Normalizing amplitudes:  51%|█████▏    | 8430/16384 [00:01<00:01, 5329.50probe position/s]Normalizing amplitudes:  56%|█████▌    | 9154/16384 [00:01<00:01, 5888.97probe position/s]Normalizing amplitudes:  60%|█████▉    | 9764/16384 [00:01<00:01, 5950.00probe position/s]Normalizing amplitudes:  63%|██████▎   | 10361/16384 [00:01<00:01, 5741.88probe position/s]Normalizing amplitudes:  67%|██████▋   | 10938/16384 [00:01<00:00, 5541.88probe position/s]Normalizing amplitudes:  70%|███████   | 11495/16384 [00:02<00:00, 5545.93probe position/s]Normalizing amplitudes:  74%|███████▎  | 12052/16384 [00:02<00:00, 5387.92probe position/s]Normalizing amplitudes:  77%|███████▋  | 12593/16384 [00:02<00:00, 5354.52probe position/s]Normalizing amplitudes:  80%|████████  | 13131/16384 [00:02<00:00, 5361.57probe position/s]Normalizing amplitudes:  84%|████████▍ | 13772/16384 [00:02<00:00, 5667.44probe position/s]Normalizing amplitudes:  88%|████████▊ | 14448/16384 [00:02<00:00, 5987.75probe position/s]Normalizing amplitudes:  92%|█████████▏| 15049/16384 [00:02<00:00, 5676.12probe position/s]Normalizing amplitudes:  95%|█████████▌| 15621/16384 [00:02<00:00, 5505.88probe position/s]Normalizing amplitudes:  99%|█████████▊| 16176/16384 [00:02<00:00, 5506.01probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5516.44probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random16_p12_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random16_p12_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.01542 in 151.841 sec
Iter: 2, Total Loss: 0.00602 in 153.428 sec
Iter: 3, Total Loss: 0.005681 in 157.008 sec
Iter: 4, Total Loss: 0.005451 in 152.569 sec
Iter: 5, Total Loss: 0.005244 in 151.616 sec
Iter: 6, Total Loss: 0.005062 in 145.273 sec
Iter: 7, Total Loss: 0.004932 in 144.135 sec
Iter: 8, Total Loss: 0.004847 in 148.058 sec
Iter: 9, Total Loss: 0.004786 in 148.383 sec
Iter: 10, Total Loss: 0.004738 in 145.493 sec
Iter: 11, Total Loss: 0.0047 in 152.639 sec
Iter: 12, Total Loss: 0.004667 in 150.417 sec
Iter: 13, Total Loss: 0.004639 in 149.989 sec
Iter: 14, Total Loss: 0.004615 in 152.965 sec
Iter: 15, Total Loss: 0.004592 in 152.529 sec
Iter: 16, Total Loss: 0.004572 in 151.854 sec
Iter: 17, Total Loss: 0.004554 in 149.947 sec
Iter: 18, Total Loss: 0.004538 in 149.219 sec
Iter: 19, Total Loss: 0.004524 in 149.708 sec
Iter: 20, Total Loss: 0.004512 in 145.932 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 150.150 with std = 3.158 sec ###
### py4DSTEM ptycho solver is finished in 50 min 3.822 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 939.14 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (1, 16, 12, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 571/16384 [00:00<00:02, 5709.64probe position/s]Normalizing amplitudes:   7%|▋         | 1142/16384 [00:00<00:02, 5650.74probe position/s]Normalizing amplitudes:  10%|█         | 1708/16384 [00:00<00:02, 5601.10probe position/s]Normalizing amplitudes:  14%|█▍        | 2320/16384 [00:00<00:02, 5803.47probe position/s]Normalizing amplitudes:  19%|█▉        | 3077/16384 [00:00<00:02, 6434.66probe position/s]Normalizing amplitudes:  23%|██▎       | 3721/16384 [00:00<00:01, 6432.81probe position/s]Normalizing amplitudes:  27%|██▋       | 4365/16384 [00:00<00:01, 6186.27probe position/s]Normalizing amplitudes:  30%|███       | 4986/16384 [00:00<00:01, 5941.35probe position/s]Normalizing amplitudes:  34%|███▍      | 5583/16384 [00:00<00:01, 5764.58probe position/s]Normalizing amplitudes:  38%|███▊      | 6162/16384 [00:01<00:01, 5747.11probe position/s]Normalizing amplitudes:  41%|████      | 6750/16384 [00:01<00:01, 5785.15probe position/s]Normalizing amplitudes:  46%|████▌     | 7459/16384 [00:01<00:01, 6168.11probe position/s]Normalizing amplitudes:  50%|█████     | 8243/16384 [00:01<00:01, 6661.63probe position/s]Normalizing amplitudes:  54%|█████▍    | 8912/16384 [00:01<00:01, 6347.94probe position/s]Normalizing amplitudes:  58%|█████▊    | 9552/16384 [00:01<00:01, 6162.96probe position/s]Normalizing amplitudes:  62%|██████▏   | 10172/16384 [00:01<00:01, 6116.76probe position/s]Normalizing amplitudes:  66%|██████▌   | 10787/16384 [00:01<00:00, 6082.81probe position/s]Normalizing amplitudes:  70%|██████▉   | 11397/16384 [00:01<00:00, 5968.38probe position/s]Normalizing amplitudes:  73%|███████▎  | 12023/16384 [00:01<00:00, 6050.64probe position/s]Normalizing amplitudes:  78%|███████▊  | 12790/16384 [00:02<00:00, 6522.05probe position/s]Normalizing amplitudes:  82%|████████▏ | 13445/16384 [00:02<00:00, 6467.71probe position/s]Normalizing amplitudes:  86%|████████▌ | 14094/16384 [00:02<00:00, 6280.76probe position/s]Normalizing amplitudes:  90%|████████▉ | 14725/16384 [00:02<00:00, 6118.29probe position/s]Normalizing amplitudes:  94%|█████████▎| 15339/16384 [00:02<00:00, 6038.95probe position/s]Normalizing amplitudes:  97%|█████████▋| 15945/16384 [00:02<00:00, 5987.42probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6084.90probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random16_p12_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r1/N16384_dp128_flipT100_random16_p12_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.01612 in 296.357 sec
Iter: 2, Total Loss: 0.005837 in 290.199 sec
Iter: 3, Total Loss: 0.005403 in 297.438 sec
Iter: 4, Total Loss: 0.005122 in 295.274 sec
Iter: 5, Total Loss: 0.004926 in 292.239 sec
Iter: 6, Total Loss: 0.004815 in 297.056 sec
Iter: 7, Total Loss: 0.004746 in 290.863 sec
Iter: 8, Total Loss: 0.004696 in 294.239 sec
Iter: 9, Total Loss: 0.004657 in 297.657 sec
Iter: 10, Total Loss: 0.004626 in 296.496 sec
Iter: 11, Total Loss: 0.004599 in 300.047 sec
Iter: 12, Total Loss: 0.004575 in 299.852 sec
Iter: 13, Total Loss: 0.004555 in 299.949 sec
Iter: 14, Total Loss: 0.004538 in 296.091 sec
Iter: 15, Total Loss: 0.004522 in 297.554 sec
Iter: 16, Total Loss: 0.004509 in 301.568 sec
Iter: 17, Total Loss: 0.004497 in 299.764 sec
Iter: 18, Total Loss: 0.004486 in 300.247 sec
Iter: 19, Total Loss: 0.004477 in 296.251 sec
Iter: 20, Total Loss: 0.004469 in 303.444 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 297.129 with std = 3.365 sec ###
### py4DSTEM ptycho solver is finished in 1 hr 39 min 3.581 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.58 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 1024, 1, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 503/16384 [00:00<00:03, 5028.35probe position/s]Normalizing amplitudes:   6%|▋         | 1030/16384 [00:00<00:02, 5163.44probe position/s]Normalizing amplitudes:  10%|▉         | 1561/16384 [00:00<00:02, 5226.45probe position/s]Normalizing amplitudes:  13%|█▎        | 2084/16384 [00:00<00:02, 5166.31probe position/s]Normalizing amplitudes:  16%|█▌        | 2639/16384 [00:00<00:02, 5301.34probe position/s]Normalizing amplitudes:  20%|██        | 3325/16384 [00:00<00:02, 5827.92probe position/s]Normalizing amplitudes:  24%|██▍       | 3909/16384 [00:00<00:02, 5760.54probe position/s]Normalizing amplitudes:  27%|██▋       | 4486/16384 [00:00<00:02, 5574.94probe position/s]Normalizing amplitudes:  31%|███       | 5045/16384 [00:00<00:02, 5421.44probe position/s]Normalizing amplitudes:  34%|███▍      | 5603/16384 [00:01<00:01, 5468.04probe position/s]Normalizing amplitudes:  38%|███▊      | 6153/16384 [00:01<00:01, 5477.13probe position/s]Normalizing amplitudes:  41%|████      | 6702/16384 [00:01<00:01, 5433.26probe position/s]Normalizing amplitudes:  45%|████▌     | 7428/16384 [00:01<00:01, 5974.41probe position/s]Normalizing amplitudes:  50%|████▉     | 8133/16384 [00:01<00:01, 6288.16probe position/s]Normalizing amplitudes:  53%|█████▎    | 8764/16384 [00:01<00:01, 5970.40probe position/s]Normalizing amplitudes:  57%|█████▋    | 9366/16384 [00:01<00:01, 5763.02probe position/s]Normalizing amplitudes:  61%|██████    | 9947/16384 [00:01<00:01, 5590.57probe position/s]Normalizing amplitudes:  64%|██████▍   | 10510/16384 [00:01<00:01, 5442.65probe position/s]Normalizing amplitudes:  68%|██████▊   | 11101/16384 [00:01<00:00, 5573.31probe position/s]Normalizing amplitudes:  72%|███████▏  | 11787/16384 [00:02<00:00, 5941.66probe position/s]Normalizing amplitudes:  76%|███████▌  | 12385/16384 [00:02<00:00, 5749.38probe position/s]Normalizing amplitudes:  79%|███████▉  | 12964/16384 [00:02<00:00, 5530.07probe position/s]Normalizing amplitudes:  83%|████████▎ | 13521/16384 [00:02<00:00, 5433.06probe position/s]Normalizing amplitudes:  86%|████████▌ | 14067/16384 [00:02<00:00, 5394.24probe position/s]Normalizing amplitudes:  89%|████████▉ | 14608/16384 [00:02<00:00, 5299.24probe position/s]Normalizing amplitudes:  93%|█████████▎| 15280/16384 [00:02<00:00, 5705.92probe position/s]Normalizing amplitudes:  97%|█████████▋| 15960/16384 [00:02<00:00, 6023.29probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5625.26probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random1024_p1_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random1024_p1_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.02217 in 0.794 sec
Iter: 2, Total Loss: 0.006516 in 0.730 sec
Iter: 3, Total Loss: 0.006489 in 0.733 sec
Iter: 4, Total Loss: 0.006476 in 0.747 sec
Iter: 5, Total Loss: 0.006468 in 0.740 sec
Iter: 6, Total Loss: 0.006464 in 0.751 sec
Iter: 7, Total Loss: 0.006461 in 0.734 sec
Iter: 8, Total Loss: 0.006458 in 0.744 sec
Iter: 9, Total Loss: 0.006457 in 0.742 sec
Iter: 10, Total Loss: 0.006455 in 0.751 sec
Iter: 11, Total Loss: 0.006453 in 0.742 sec
Iter: 12, Total Loss: 0.006451 in 0.748 sec
Iter: 13, Total Loss: 0.006449 in 0.729 sec
Iter: 14, Total Loss: 0.006447 in 0.742 sec
Iter: 15, Total Loss: 0.006446 in 0.740 sec
Iter: 16, Total Loss: 0.006444 in 0.740 sec
Iter: 17, Total Loss: 0.006443 in 0.738 sec
Iter: 18, Total Loss: 0.006441 in 0.730 sec
Iter: 19, Total Loss: 0.006439 in 0.739 sec
Iter: 20, Total Loss: 0.006437 in 0.744 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 0.743 with std = 0.013 sec ###
### py4DSTEM ptycho solver is finished in 15.700 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.54 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 1024, 1, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 732/16384 [00:00<00:02, 7315.54probe position/s]Normalizing amplitudes:   9%|▉         | 1464/16384 [00:00<00:02, 5705.94probe position/s]Normalizing amplitudes:  13%|█▎        | 2057/16384 [00:00<00:02, 5469.01probe position/s]Normalizing amplitudes:  16%|█▌        | 2615/16384 [00:00<00:02, 5449.95probe position/s]Normalizing amplitudes:  19%|█▉        | 3166/16384 [00:00<00:02, 5415.81probe position/s]Normalizing amplitudes:  23%|██▎       | 3712/16384 [00:00<00:02, 5418.75probe position/s]Normalizing amplitudes:  27%|██▋       | 4396/16384 [00:00<00:02, 5862.01probe position/s]Normalizing amplitudes:  30%|███       | 4986/16384 [00:00<00:01, 5833.06probe position/s]Normalizing amplitudes:  34%|███▍      | 5572/16384 [00:00<00:01, 5614.84probe position/s]Normalizing amplitudes:  37%|███▋      | 6137/16384 [00:01<00:01, 5517.60probe position/s]Normalizing amplitudes:  41%|████      | 6691/16384 [00:01<00:01, 5491.65probe position/s]Normalizing amplitudes:  44%|████▍     | 7242/16384 [00:01<00:01, 5423.32probe position/s]Normalizing amplitudes:  48%|████▊     | 7860/16384 [00:01<00:01, 5643.56probe position/s]Normalizing amplitudes:  52%|█████▏    | 8541/16384 [00:01<00:01, 5987.11probe position/s]Normalizing amplitudes:  56%|█████▌    | 9142/16384 [00:01<00:01, 5658.93probe position/s]Normalizing amplitudes:  59%|█████▉    | 9713/16384 [00:01<00:01, 5492.46probe position/s]Normalizing amplitudes:  63%|██████▎   | 10266/16384 [00:01<00:01, 5381.25probe position/s]Normalizing amplitudes:  66%|██████▌   | 10807/16384 [00:01<00:01, 5275.72probe position/s]Normalizing amplitudes:  69%|██████▉   | 11343/16384 [00:02<00:00, 5298.63probe position/s]Normalizing amplitudes:  73%|███████▎  | 12034/16384 [00:02<00:00, 5762.40probe position/s]Normalizing amplitudes:  77%|███████▋  | 12623/16384 [00:02<00:00, 5798.01probe position/s]Normalizing amplitudes:  81%|████████  | 13205/16384 [00:02<00:00, 5635.25probe position/s]Normalizing amplitudes:  84%|████████▍ | 13771/16384 [00:02<00:00, 5514.72probe position/s]Normalizing amplitudes:  87%|████████▋ | 14325/16384 [00:02<00:00, 5438.33probe position/s]Normalizing amplitudes:  91%|█████████ | 14871/16384 [00:02<00:00, 5359.62probe position/s]Normalizing amplitudes:  94%|█████████▍| 15437/16384 [00:02<00:00, 5446.01probe position/s]Normalizing amplitudes:  99%|█████████▉| 16202/16384 [00:02<00:00, 6088.30probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5646.71probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random1024_p1_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random1024_p1_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.02286 in 1.482 sec
Iter: 2, Total Loss: 0.006517 in 1.442 sec
Iter: 3, Total Loss: 0.006483 in 1.451 sec
Iter: 4, Total Loss: 0.006472 in 1.440 sec
Iter: 5, Total Loss: 0.006465 in 1.439 sec
Iter: 6, Total Loss: 0.006459 in 1.440 sec
Iter: 7, Total Loss: 0.006456 in 1.451 sec
Iter: 8, Total Loss: 0.006451 in 1.445 sec
Iter: 9, Total Loss: 0.006448 in 1.458 sec
Iter: 10, Total Loss: 0.006443 in 1.429 sec
Iter: 11, Total Loss: 0.006439 in 1.442 sec
Iter: 12, Total Loss: 0.006435 in 1.447 sec
Iter: 13, Total Loss: 0.006433 in 1.440 sec
Iter: 14, Total Loss: 0.00643 in 1.443 sec
Iter: 15, Total Loss: 0.006427 in 1.442 sec
Iter: 16, Total Loss: 0.006424 in 1.437 sec
Iter: 17, Total Loss: 0.00642 in 1.442 sec
Iter: 18, Total Loss: 0.006417 in 1.446 sec
Iter: 19, Total Loss: 0.006414 in 1.446 sec
Iter: 20, Total Loss: 0.006411 in 1.443 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 1.445 with std = 0.010 sec ###
### py4DSTEM ptycho solver is finished in 29.789 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.53 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 1024, 1, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 531/16384 [00:00<00:02, 5307.77probe position/s]Normalizing amplitudes:   6%|▋         | 1062/16384 [00:00<00:02, 5305.63probe position/s]Normalizing amplitudes:  10%|▉         | 1593/16384 [00:00<00:02, 5215.74probe position/s]Normalizing amplitudes:  13%|█▎        | 2141/16384 [00:00<00:02, 5316.24probe position/s]Normalizing amplitudes:  17%|█▋        | 2705/16384 [00:00<00:02, 5430.37probe position/s]Normalizing amplitudes:  21%|██        | 3389/16384 [00:00<00:02, 5904.76probe position/s]Normalizing amplitudes:  24%|██▍       | 3980/16384 [00:00<00:02, 5902.69probe position/s]Normalizing amplitudes:  28%|██▊       | 4571/16384 [00:00<00:02, 5704.78probe position/s]Normalizing amplitudes:  31%|███▏      | 5143/16384 [00:00<00:02, 5523.97probe position/s]Normalizing amplitudes:  35%|███▍      | 5698/16384 [00:01<00:01, 5440.94probe position/s]Normalizing amplitudes:  38%|███▊      | 6244/16384 [00:01<00:01, 5388.57probe position/s]Normalizing amplitudes:  42%|████▏     | 6813/16384 [00:01<00:01, 5475.10probe position/s]Normalizing amplitudes:  46%|████▌     | 7565/16384 [00:01<00:01, 6077.82probe position/s]Normalizing amplitudes:  50%|████▉     | 8175/16384 [00:01<00:01, 5976.93probe position/s]Normalizing amplitudes:  54%|█████▎    | 8775/16384 [00:01<00:01, 5728.91probe position/s]Normalizing amplitudes:  57%|█████▋    | 9351/16384 [00:01<00:01, 5603.45probe position/s]Normalizing amplitudes:  61%|██████    | 9914/16384 [00:01<00:01, 5566.53probe position/s]Normalizing amplitudes:  64%|██████▍   | 10473/16384 [00:01<00:01, 5495.16probe position/s]Normalizing amplitudes:  67%|██████▋   | 11024/16384 [00:01<00:00, 5479.05probe position/s]Normalizing amplitudes:  72%|███████▏  | 11728/16384 [00:02<00:00, 5933.24probe position/s]Normalizing amplitudes:  75%|███████▌  | 12324/16384 [00:02<00:00, 5879.54probe position/s]Normalizing amplitudes:  79%|███████▉  | 12914/16384 [00:02<00:00, 5682.51probe position/s]Normalizing amplitudes:  82%|████████▏ | 13485/16384 [00:02<00:00, 5549.39probe position/s]Normalizing amplitudes:  86%|████████▌ | 14042/16384 [00:02<00:00, 5440.71probe position/s]Normalizing amplitudes:  89%|████████▉ | 14588/16384 [00:02<00:00, 5406.82probe position/s]Normalizing amplitudes:  93%|█████████▎| 15208/16384 [00:02<00:00, 5633.85probe position/s]Normalizing amplitudes:  97%|█████████▋| 15884/16384 [00:02<00:00, 5962.08probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5650.83probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random1024_p1_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random1024_p1_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.02408 in 2.489 sec
Iter: 2, Total Loss: 0.006578 in 2.429 sec
Iter: 3, Total Loss: 0.006504 in 2.438 sec
Iter: 4, Total Loss: 0.006489 in 2.428 sec
Iter: 5, Total Loss: 0.006481 in 2.438 sec
Iter: 6, Total Loss: 0.00647 in 2.432 sec
Iter: 7, Total Loss: 0.006466 in 2.420 sec
Iter: 8, Total Loss: 0.006456 in 2.426 sec
Iter: 9, Total Loss: 0.006453 in 2.418 sec
Iter: 10, Total Loss: 0.006447 in 2.429 sec
Iter: 11, Total Loss: 0.006442 in 2.400 sec
Iter: 12, Total Loss: 0.006433 in 2.402 sec
Iter: 13, Total Loss: 0.006431 in 2.399 sec
Iter: 14, Total Loss: 0.006425 in 2.431 sec
Iter: 15, Total Loss: 0.006422 in 2.439 sec
Iter: 16, Total Loss: 0.006418 in 2.464 sec
Iter: 17, Total Loss: 0.006412 in 2.513 sec
Iter: 18, Total Loss: 0.00641 in 2.473 sec
Iter: 19, Total Loss: 0.006406 in 2.459 sec
Iter: 20, Total Loss: 0.006402 in 2.441 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 2.438 with std = 0.028 sec ###
### py4DSTEM ptycho solver is finished in 49.713 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 935.47 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 1024, 3, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 640/16384 [00:00<00:02, 6398.79probe position/s]Normalizing amplitudes:   8%|▊         | 1280/16384 [00:00<00:02, 5623.80probe position/s]Normalizing amplitudes:  11%|█▏        | 1849/16384 [00:00<00:02, 5374.94probe position/s]Normalizing amplitudes:  15%|█▍        | 2390/16384 [00:00<00:02, 5245.60probe position/s]Normalizing amplitudes:  18%|█▊        | 2922/16384 [00:00<00:02, 5269.05probe position/s]Normalizing amplitudes:  22%|██▏       | 3553/16384 [00:00<00:02, 5604.46probe position/s]Normalizing amplitudes:  26%|██▌       | 4250/16384 [00:00<00:02, 6035.24probe position/s]Normalizing amplitudes:  30%|██▉       | 4857/16384 [00:00<00:01, 5859.65probe position/s]Normalizing amplitudes:  33%|███▎      | 5446/16384 [00:00<00:01, 5690.56probe position/s]Normalizing amplitudes:  37%|███▋      | 6018/16384 [00:01<00:01, 5608.12probe position/s]Normalizing amplitudes:  40%|████      | 6581/16384 [00:01<00:01, 5514.92probe position/s]Normalizing amplitudes:  44%|████▎     | 7134/16384 [00:01<00:01, 5495.05probe position/s]Normalizing amplitudes:  48%|████▊     | 7795/16384 [00:01<00:01, 5820.93probe position/s]Normalizing amplitudes:  52%|█████▏    | 8547/16384 [00:01<00:01, 6320.76probe position/s]Normalizing amplitudes:  56%|█████▌    | 9182/16384 [00:01<00:01, 6025.78probe position/s]Normalizing amplitudes:  60%|█████▉    | 9789/16384 [00:01<00:01, 5800.14probe position/s]Normalizing amplitudes:  63%|██████▎   | 10373/16384 [00:01<00:01, 5717.70probe position/s]Normalizing amplitudes:  67%|██████▋   | 10948/16384 [00:01<00:00, 5633.07probe position/s]Normalizing amplitudes:  70%|███████   | 11513/16384 [00:02<00:00, 5560.22probe position/s]Normalizing amplitudes:  74%|███████▍  | 12170/16384 [00:02<00:00, 5847.80probe position/s]Normalizing amplitudes:  79%|███████▉  | 12926/16384 [00:02<00:00, 6344.77probe position/s]Normalizing amplitudes:  83%|████████▎ | 13564/16384 [00:02<00:00, 6087.65probe position/s]Normalizing amplitudes:  87%|████████▋ | 14177/16384 [00:02<00:00, 5770.74probe position/s]Normalizing amplitudes:  90%|█████████ | 14760/16384 [00:02<00:00, 5601.19probe position/s]Normalizing amplitudes:  94%|█████████▎| 15324/16384 [00:02<00:00, 5541.39probe position/s]Normalizing amplitudes:  97%|█████████▋| 15881/16384 [00:02<00:00, 5492.59probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5739.81probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random1024_p3_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random1024_p3_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.07169 in 1.370 sec
Iter: 2, Total Loss: 0.006788 in 1.331 sec
Iter: 3, Total Loss: 0.006587 in 1.343 sec
Iter: 4, Total Loss: 0.006501 in 1.343 sec
Iter: 5, Total Loss: 0.006456 in 1.336 sec
Iter: 6, Total Loss: 0.006429 in 1.328 sec
Iter: 7, Total Loss: 0.00641 in 1.328 sec
Iter: 8, Total Loss: 0.006394 in 1.342 sec
Iter: 9, Total Loss: 0.006382 in 1.339 sec
Iter: 10, Total Loss: 0.00637 in 1.344 sec
Iter: 11, Total Loss: 0.006359 in 1.347 sec
Iter: 12, Total Loss: 0.006348 in 1.349 sec
Iter: 13, Total Loss: 0.006338 in 1.345 sec
Iter: 14, Total Loss: 0.006328 in 1.344 sec
Iter: 15, Total Loss: 0.006317 in 1.332 sec
Iter: 16, Total Loss: 0.006307 in 1.338 sec
Iter: 17, Total Loss: 0.006297 in 1.331 sec
Iter: 18, Total Loss: 0.006287 in 1.336 sec
Iter: 19, Total Loss: 0.006277 in 1.341 sec
Iter: 20, Total Loss: 0.006267 in 1.345 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 1.341 with std = 0.009 sec ###
### py4DSTEM ptycho solver is finished in 27.680 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 940.19 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 1024, 3, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 540/16384 [00:00<00:02, 5399.37probe position/s]Normalizing amplitudes:   8%|▊         | 1262/16384 [00:00<00:02, 6466.40probe position/s]Normalizing amplitudes:  12%|█▏        | 1909/16384 [00:00<00:02, 6268.30probe position/s]Normalizing amplitudes:  15%|█▌        | 2537/16384 [00:00<00:02, 5833.65probe position/s]Normalizing amplitudes:  19%|█▉        | 3125/16384 [00:00<00:02, 5606.93probe position/s]Normalizing amplitudes:  23%|██▎       | 3700/16384 [00:00<00:02, 5650.60probe position/s]Normalizing amplitudes:  26%|██▌       | 4269/16384 [00:00<00:02, 5656.84probe position/s]Normalizing amplitudes:  30%|██▉       | 4837/16384 [00:00<00:02, 5587.28probe position/s]Normalizing amplitudes:  34%|███▍      | 5540/16384 [00:00<00:01, 6021.21probe position/s]Normalizing amplitudes:  38%|███▊      | 6200/16384 [00:01<00:01, 6195.64probe position/s]Normalizing amplitudes:  42%|████▏     | 6822/16384 [00:01<00:01, 5833.36probe position/s]Normalizing amplitudes:  45%|████▌     | 7411/16384 [00:01<00:01, 5653.07probe position/s]Normalizing amplitudes:  49%|████▊     | 7981/16384 [00:01<00:01, 5531.03probe position/s]Normalizing amplitudes:  52%|█████▏    | 8537/16384 [00:01<00:01, 5447.81probe position/s]Normalizing amplitudes:  56%|█████▌    | 9176/16384 [00:01<00:01, 5715.11probe position/s]Normalizing amplitudes:  60%|██████    | 9901/16384 [00:01<00:01, 6158.74probe position/s]Normalizing amplitudes:  64%|██████▍   | 10521/16384 [00:01<00:00, 5881.16probe position/s]Normalizing amplitudes:  68%|██████▊   | 11114/16384 [00:01<00:00, 5705.14probe position/s]Normalizing amplitudes:  71%|███████▏  | 11689/16384 [00:02<00:00, 5559.40probe position/s]Normalizing amplitudes:  75%|███████▍  | 12248/16384 [00:02<00:00, 5458.86probe position/s]Normalizing amplitudes:  78%|███████▊  | 12796/16384 [00:02<00:00, 5432.02probe position/s]Normalizing amplitudes:  82%|████████▏ | 13488/16384 [00:02<00:00, 5857.39probe position/s]Normalizing amplitudes:  86%|████████▋ | 14143/16384 [00:02<00:00, 6053.07probe position/s]Normalizing amplitudes:  90%|█████████ | 14751/16384 [00:02<00:00, 5714.47probe position/s]Normalizing amplitudes:  94%|█████████▎| 15328/16384 [00:02<00:00, 5544.77probe position/s]Normalizing amplitudes:  97%|█████████▋| 15887/16384 [00:02<00:00, 5473.62probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5694.29probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random1024_p3_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random1024_p3_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.06823 in 3.279 sec
Iter: 2, Total Loss: 0.007093 in 3.312 sec
Iter: 3, Total Loss: 0.006654 in 3.436 sec
Iter: 4, Total Loss: 0.006551 in 3.252 sec
Iter: 5, Total Loss: 0.006502 in 3.258 sec
Iter: 6, Total Loss: 0.006467 in 3.247 sec
Iter: 7, Total Loss: 0.006442 in 3.264 sec
Iter: 8, Total Loss: 0.006416 in 3.253 sec
Iter: 9, Total Loss: 0.006397 in 3.231 sec
Iter: 10, Total Loss: 0.006374 in 3.236 sec
Iter: 11, Total Loss: 0.006357 in 3.251 sec
Iter: 12, Total Loss: 0.006337 in 3.233 sec
Iter: 13, Total Loss: 0.006323 in 3.256 sec
Iter: 14, Total Loss: 0.006305 in 3.250 sec
Iter: 15, Total Loss: 0.006292 in 3.264 sec
Iter: 16, Total Loss: 0.006277 in 3.263 sec
Iter: 17, Total Loss: 0.006265 in 3.227 sec
Iter: 18, Total Loss: 0.006251 in 3.215 sec
Iter: 19, Total Loss: 0.006239 in 3.217 sec
Iter: 20, Total Loss: 0.006225 in 3.205 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 3.258 with std = 0.047 sec ###
### py4DSTEM ptycho solver is finished in 1 min 6.017 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.54 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 1024, 3, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 569/16384 [00:00<00:02, 5680.61probe position/s]Normalizing amplitudes:   7%|▋         | 1138/16384 [00:00<00:02, 5644.37probe position/s]Normalizing amplitudes:  10%|█         | 1703/16384 [00:00<00:02, 5566.59probe position/s]Normalizing amplitudes:  14%|█▍        | 2263/16384 [00:00<00:02, 5572.98probe position/s]Normalizing amplitudes:  18%|█▊        | 2881/16384 [00:00<00:02, 5788.40probe position/s]Normalizing amplitudes:  22%|██▏       | 3555/16384 [00:00<00:02, 6108.11probe position/s]Normalizing amplitudes:  25%|██▌       | 4167/16384 [00:00<00:02, 5971.17probe position/s]Normalizing amplitudes:  29%|██▉       | 4765/16384 [00:00<00:01, 5836.30probe position/s]Normalizing amplitudes:  33%|███▎      | 5350/16384 [00:00<00:01, 5712.03probe position/s]Normalizing amplitudes:  36%|███▌      | 5923/16384 [00:01<00:01, 5635.32probe position/s]Normalizing amplitudes:  40%|████      | 6570/16384 [00:01<00:01, 5881.57probe position/s]Normalizing amplitudes:  44%|████▍     | 7267/16384 [00:01<00:01, 6201.30probe position/s]Normalizing amplitudes:  48%|████▊     | 7889/16384 [00:01<00:01, 5951.37probe position/s]Normalizing amplitudes:  52%|█████▏    | 8488/16384 [00:01<00:01, 5871.42probe position/s]Normalizing amplitudes:  55%|█████▌    | 9078/16384 [00:01<00:01, 5819.18probe position/s]Normalizing amplitudes:  59%|█████▉    | 9662/16384 [00:01<00:01, 5772.68probe position/s]Normalizing amplitudes:  63%|██████▎   | 10362/16384 [00:01<00:00, 6128.45probe position/s]Normalizing amplitudes:  67%|██████▋   | 11017/16384 [00:01<00:00, 6250.51probe position/s]Normalizing amplitudes:  71%|███████   | 11644/16384 [00:01<00:00, 5994.53probe position/s]Normalizing amplitudes:  75%|███████▍  | 12247/16384 [00:02<00:00, 5931.10probe position/s]Normalizing amplitudes:  78%|███████▊  | 12843/16384 [00:02<00:00, 5821.54probe position/s]Normalizing amplitudes:  82%|████████▏ | 13427/16384 [00:02<00:00, 5825.73probe position/s]Normalizing amplitudes:  87%|████████▋ | 14201/16384 [00:02<00:00, 6381.74probe position/s]Normalizing amplitudes:  91%|█████████ | 14875/16384 [00:02<00:00, 6485.53probe position/s]Normalizing amplitudes:  95%|█████████▍| 15526/16384 [00:02<00:00, 6226.16probe position/s]Normalizing amplitudes:  99%|█████████▊| 16152/16384 [00:02<00:00, 6049.37probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5951.53probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random1024_p3_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random1024_p3_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.07073 in 6.108 sec
Iter: 2, Total Loss: 0.008107 in 6.199 sec
Iter: 3, Total Loss: 0.006907 in 6.122 sec
Iter: 4, Total Loss: 0.006633 in 6.167 sec
Iter: 5, Total Loss: 0.006502 in 6.143 sec
Iter: 6, Total Loss: 0.006414 in 6.149 sec
Iter: 7, Total Loss: 0.006349 in 6.131 sec
Iter: 8, Total Loss: 0.006298 in 6.171 sec
Iter: 9, Total Loss: 0.006258 in 6.136 sec
Iter: 10, Total Loss: 0.006224 in 6.151 sec
Iter: 11, Total Loss: 0.006195 in 6.124 sec
Iter: 12, Total Loss: 0.00617 in 6.156 sec
Iter: 13, Total Loss: 0.006147 in 6.134 sec
Iter: 14, Total Loss: 0.006127 in 6.128 sec
Iter: 15, Total Loss: 0.006107 in 6.116 sec
Iter: 16, Total Loss: 0.00609 in 6.134 sec
Iter: 17, Total Loss: 0.006073 in 6.081 sec
Iter: 18, Total Loss: 0.006058 in 6.110 sec
Iter: 19, Total Loss: 0.006042 in 6.181 sec
Iter: 20, Total Loss: 0.006029 in 6.129 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 6.138 with std = 0.027 sec ###
### py4DSTEM ptycho solver is finished in 2 min 3.795 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 936.44 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 1024, 6, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 527/16384 [00:00<00:03, 5266.73probe position/s]Normalizing amplitudes:   7%|▋         | 1076/16384 [00:00<00:02, 5390.56probe position/s]Normalizing amplitudes:  10%|▉         | 1631/16384 [00:00<00:02, 5461.15probe position/s]Normalizing amplitudes:  13%|█▎        | 2184/16384 [00:00<00:02, 5486.59probe position/s]Normalizing amplitudes:  18%|█▊        | 2948/16384 [00:00<00:02, 6260.86probe position/s]Normalizing amplitudes:  22%|██▏       | 3575/16384 [00:00<00:02, 6259.14probe position/s]Normalizing amplitudes:  26%|██▌       | 4201/16384 [00:00<00:02, 5917.42probe position/s]Normalizing amplitudes:  29%|██▉       | 4797/16384 [00:00<00:02, 5755.89probe position/s]Normalizing amplitudes:  33%|███▎      | 5376/16384 [00:00<00:01, 5652.04probe position/s]Normalizing amplitudes:  36%|███▋      | 5944/16384 [00:01<00:01, 5515.91probe position/s]Normalizing amplitudes:  40%|███▉      | 6498/16384 [00:01<00:01, 5451.58probe position/s]Normalizing amplitudes:  43%|████▎     | 7125/16384 [00:01<00:01, 5689.03probe position/s]Normalizing amplitudes:  48%|████▊     | 7836/16384 [00:01<00:01, 6104.74probe position/s]Normalizing amplitudes:  52%|█████▏    | 8449/16384 [00:01<00:01, 5905.53probe position/s]Normalizing amplitudes:  55%|█████▌    | 9043/16384 [00:01<00:01, 5732.74probe position/s]Normalizing amplitudes:  59%|█████▊    | 9619/16384 [00:01<00:01, 5548.61probe position/s]Normalizing amplitudes:  62%|██████▏   | 10177/16384 [00:01<00:01, 5539.94probe position/s]Normalizing amplitudes:  66%|██████▌   | 10733/16384 [00:01<00:01, 5504.69probe position/s]Normalizing amplitudes:  69%|██████▉   | 11285/16384 [00:01<00:00, 5486.55probe position/s]Normalizing amplitudes:  73%|███████▎  | 11914/16384 [00:02<00:00, 5720.35probe position/s]Normalizing amplitudes:  77%|███████▋  | 12637/16384 [00:02<00:00, 6162.38probe position/s]Normalizing amplitudes:  81%|████████  | 13255/16384 [00:02<00:00, 5990.26probe position/s]Normalizing amplitudes:  85%|████████▍ | 13857/16384 [00:02<00:00, 5782.84probe position/s]Normalizing amplitudes:  88%|████████▊ | 14438/16384 [00:02<00:00, 5615.97probe position/s]Normalizing amplitudes:  92%|█████████▏| 15002/16384 [00:02<00:00, 5497.48probe position/s]Normalizing amplitudes:  95%|█████████▍| 15554/16384 [00:02<00:00, 5477.19probe position/s]Normalizing amplitudes:  98%|█████████▊| 16103/16384 [00:02<00:00, 5444.59probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5674.88probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random1024_p6_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random1024_p6_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.2038 in 2.380 sec
Iter: 2, Total Loss: 0.006964 in 2.337 sec
Iter: 3, Total Loss: 0.006674 in 2.281 sec
Iter: 4, Total Loss: 0.006551 in 2.277 sec
Iter: 5, Total Loss: 0.006488 in 2.277 sec
Iter: 6, Total Loss: 0.006449 in 2.273 sec
Iter: 7, Total Loss: 0.006421 in 2.271 sec
Iter: 8, Total Loss: 0.0064 in 2.278 sec
Iter: 9, Total Loss: 0.006382 in 2.274 sec
Iter: 10, Total Loss: 0.006365 in 2.265 sec
Iter: 11, Total Loss: 0.006351 in 2.277 sec
Iter: 12, Total Loss: 0.006336 in 2.357 sec
Iter: 13, Total Loss: 0.006322 in 2.255 sec
Iter: 14, Total Loss: 0.006308 in 2.269 sec
Iter: 15, Total Loss: 0.006295 in 2.275 sec
Iter: 16, Total Loss: 0.006281 in 2.290 sec
Iter: 17, Total Loss: 0.006268 in 2.257 sec
Iter: 18, Total Loss: 0.006255 in 2.259 sec
Iter: 19, Total Loss: 0.006241 in 2.251 sec
Iter: 20, Total Loss: 0.006229 in 2.271 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 2.284 with std = 0.033 sec ###
### py4DSTEM ptycho solver is finished in 46.755 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.50 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 1024, 6, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 654/16384 [00:00<00:02, 6531.25probe position/s]Normalizing amplitudes:   8%|▊         | 1345/16384 [00:00<00:02, 6750.61probe position/s]Normalizing amplitudes:  12%|█▏        | 2025/16384 [00:00<00:02, 6769.89probe position/s]Normalizing amplitudes:  16%|█▋        | 2702/16384 [00:00<00:02, 6732.87probe position/s]Normalizing amplitudes:  21%|██        | 3377/16384 [00:00<00:01, 6738.56probe position/s]Normalizing amplitudes:  25%|██▍       | 4066/16384 [00:00<00:01, 6789.30probe position/s]Normalizing amplitudes:  29%|██▉       | 4776/16384 [00:00<00:01, 6889.86probe position/s]Normalizing amplitudes:  33%|███▎      | 5466/16384 [00:00<00:01, 6800.91probe position/s]Normalizing amplitudes:  38%|███▊      | 6156/16384 [00:00<00:01, 6831.34probe position/s]Normalizing amplitudes:  42%|████▏     | 6840/16384 [00:01<00:01, 6826.24probe position/s]Normalizing amplitudes:  46%|████▌     | 7523/16384 [00:01<00:01, 6794.23probe position/s]Normalizing amplitudes:  50%|█████     | 8203/16384 [00:01<00:01, 6772.96probe position/s]Normalizing amplitudes:  54%|█████▍    | 8883/16384 [00:01<00:01, 6780.38probe position/s]Normalizing amplitudes:  58%|█████▊    | 9562/16384 [00:01<00:01, 6713.30probe position/s]Normalizing amplitudes:  63%|██████▎   | 10256/16384 [00:01<00:00, 6779.20probe position/s]Normalizing amplitudes:  67%|██████▋   | 10945/16384 [00:01<00:00, 6810.09probe position/s]Normalizing amplitudes:  71%|███████   | 11627/16384 [00:01<00:00, 6618.90probe position/s]Normalizing amplitudes:  75%|███████▌  | 12291/16384 [00:01<00:00, 6517.78probe position/s]Normalizing amplitudes:  79%|███████▉  | 12944/16384 [00:01<00:00, 6426.94probe position/s]Normalizing amplitudes:  83%|████████▎ | 13620/16384 [00:02<00:00, 6523.73probe position/s]Normalizing amplitudes:  87%|████████▋ | 14274/16384 [00:02<00:00, 6073.58probe position/s]Normalizing amplitudes:  91%|█████████ | 14888/16384 [00:02<00:00, 6002.29probe position/s]Normalizing amplitudes:  95%|█████████▌| 15589/16384 [00:02<00:00, 6286.25probe position/s]Normalizing amplitudes:  99%|█████████▉| 16223/16384 [00:02<00:00, 5973.74probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6507.52probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random1024_p6_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random1024_p6_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.199 in 6.206 sec
Iter: 2, Total Loss: 0.007957 in 5.962 sec
Iter: 3, Total Loss: 0.00705 in 5.932 sec
Iter: 4, Total Loss: 0.006791 in 5.905 sec
Iter: 5, Total Loss: 0.00666 in 5.886 sec
Iter: 6, Total Loss: 0.006572 in 5.897 sec
Iter: 7, Total Loss: 0.006502 in 5.890 sec
Iter: 8, Total Loss: 0.006444 in 5.893 sec
Iter: 9, Total Loss: 0.006395 in 5.972 sec
Iter: 10, Total Loss: 0.006353 in 5.971 sec
Iter: 11, Total Loss: 0.006317 in 6.521 sec
Iter: 12, Total Loss: 0.006284 in 5.899 sec
Iter: 13, Total Loss: 0.006256 in 5.909 sec
Iter: 14, Total Loss: 0.00623 in 5.878 sec
Iter: 15, Total Loss: 0.006206 in 5.914 sec
Iter: 16, Total Loss: 0.006184 in 5.891 sec
Iter: 17, Total Loss: 0.006164 in 5.898 sec
Iter: 18, Total Loss: 0.006145 in 5.882 sec
Iter: 19, Total Loss: 0.006128 in 5.872 sec
Iter: 20, Total Loss: 0.006111 in 5.902 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 5.954 with std = 0.148 sec ###
### py4DSTEM ptycho solver is finished in 2 min 0.529 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.54 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 1024, 6, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 664/16384 [00:00<00:02, 6631.56probe position/s]Normalizing amplitudes:   8%|▊         | 1351/16384 [00:00<00:02, 6767.13probe position/s]Normalizing amplitudes:  12%|█▏        | 2039/16384 [00:00<00:02, 6815.11probe position/s]Normalizing amplitudes:  17%|█▋        | 2721/16384 [00:00<00:02, 6674.71probe position/s]Normalizing amplitudes:  21%|██        | 3407/16384 [00:00<00:01, 6738.38probe position/s]Normalizing amplitudes:  25%|██▍       | 4083/16384 [00:00<00:01, 6739.87probe position/s]Normalizing amplitudes:  29%|██▉       | 4758/16384 [00:00<00:01, 6719.32probe position/s]Normalizing amplitudes:  33%|███▎      | 5431/16384 [00:00<00:01, 6699.38probe position/s]Normalizing amplitudes:  37%|███▋      | 6102/16384 [00:00<00:01, 6666.12probe position/s]Normalizing amplitudes:  41%|████▏     | 6774/16384 [00:01<00:01, 6680.32probe position/s]Normalizing amplitudes:  46%|████▌     | 7464/16384 [00:01<00:01, 6746.61probe position/s]Normalizing amplitudes:  50%|████▉     | 8139/16384 [00:01<00:01, 6641.52probe position/s]Normalizing amplitudes:  54%|█████▎    | 8804/16384 [00:01<00:01, 6625.68probe position/s]Normalizing amplitudes:  58%|█████▊    | 9467/16384 [00:01<00:01, 6566.92probe position/s]Normalizing amplitudes:  62%|██████▏   | 10129/16384 [00:01<00:00, 6582.38probe position/s]Normalizing amplitudes:  66%|██████▌   | 10802/16384 [00:01<00:00, 6623.09probe position/s]Normalizing amplitudes:  70%|███████   | 11469/16384 [00:01<00:00, 6636.35probe position/s]Normalizing amplitudes:  74%|███████▍  | 12138/16384 [00:01<00:00, 6651.66probe position/s]Normalizing amplitudes:  78%|███████▊  | 12848/16384 [00:01<00:00, 6783.36probe position/s]Normalizing amplitudes:  83%|████████▎ | 13540/16384 [00:02<00:00, 6821.07probe position/s]Normalizing amplitudes:  87%|████████▋ | 14223/16384 [00:02<00:00, 6799.58probe position/s]Normalizing amplitudes:  91%|█████████ | 14904/16384 [00:02<00:00, 6769.14probe position/s]Normalizing amplitudes:  95%|█████████▌| 15581/16384 [00:02<00:00, 6650.63probe position/s]Normalizing amplitudes:  99%|█████████▉| 16247/16384 [00:02<00:00, 6644.86probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6686.55probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random1024_p6_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random1024_p6_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.1942 in 11.380 sec
Iter: 2, Total Loss: 0.009716 in 11.358 sec
Iter: 3, Total Loss: 0.007679 in 11.352 sec
Iter: 4, Total Loss: 0.007101 in 11.371 sec
Iter: 5, Total Loss: 0.006821 in 11.350 sec
Iter: 6, Total Loss: 0.006643 in 11.416 sec
Iter: 7, Total Loss: 0.006517 in 11.354 sec
Iter: 8, Total Loss: 0.006421 in 11.527 sec
Iter: 9, Total Loss: 0.006346 in 11.841 sec
Iter: 10, Total Loss: 0.006287 in 11.396 sec
Iter: 11, Total Loss: 0.00624 in 11.413 sec
Iter: 12, Total Loss: 0.006199 in 11.395 sec
Iter: 13, Total Loss: 0.006163 in 11.408 sec
Iter: 14, Total Loss: 0.006132 in 11.424 sec
Iter: 15, Total Loss: 0.006105 in 11.405 sec
Iter: 16, Total Loss: 0.006081 in 11.393 sec
Iter: 17, Total Loss: 0.006059 in 11.407 sec
Iter: 18, Total Loss: 0.006038 in 11.396 sec
Iter: 19, Total Loss: 0.006019 in 11.375 sec
Iter: 20, Total Loss: 0.006001 in 11.383 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 11.417 with std = 0.104 sec ###
### py4DSTEM ptycho solver is finished in 3 min 49.339 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.41 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 1024, 12, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 625/16384 [00:00<00:02, 6248.17probe position/s]Normalizing amplitudes:   8%|▊         | 1272/16384 [00:00<00:02, 6374.28probe position/s]Normalizing amplitudes:  12%|█▏        | 1956/16384 [00:00<00:02, 6583.16probe position/s]Normalizing amplitudes:  16%|█▌        | 2615/16384 [00:00<00:02, 6563.86probe position/s]Normalizing amplitudes:  20%|██        | 3296/16384 [00:00<00:01, 6649.65probe position/s]Normalizing amplitudes:  24%|██▍       | 3979/16384 [00:00<00:01, 6710.55probe position/s]Normalizing amplitudes:  28%|██▊       | 4657/16384 [00:00<00:01, 6730.25probe position/s]Normalizing amplitudes:  33%|███▎      | 5346/16384 [00:00<00:01, 6780.98probe position/s]Normalizing amplitudes:  37%|███▋      | 6025/16384 [00:00<00:01, 6776.02probe position/s]Normalizing amplitudes:  41%|████      | 6703/16384 [00:01<00:01, 6771.47probe position/s]Normalizing amplitudes:  45%|████▌     | 7381/16384 [00:01<00:01, 6757.62probe position/s]Normalizing amplitudes:  49%|████▉     | 8057/16384 [00:01<00:01, 6711.31probe position/s]Normalizing amplitudes:  53%|█████▎    | 8729/16384 [00:01<00:01, 6704.13probe position/s]Normalizing amplitudes:  57%|█████▋    | 9400/16384 [00:01<00:01, 6705.11probe position/s]Normalizing amplitudes:  62%|██████▏   | 10092/16384 [00:01<00:00, 6768.02probe position/s]Normalizing amplitudes:  66%|██████▌   | 10769/16384 [00:01<00:00, 6708.28probe position/s]Normalizing amplitudes:  70%|██████▉   | 11446/16384 [00:01<00:00, 6724.85probe position/s]Normalizing amplitudes:  74%|███████▍  | 12119/16384 [00:01<00:00, 6595.61probe position/s]Normalizing amplitudes:  78%|███████▊  | 12800/16384 [00:01<00:00, 6656.95probe position/s]Normalizing amplitudes:  82%|████████▏ | 13485/16384 [00:02<00:00, 6713.85probe position/s]Normalizing amplitudes:  86%|████████▋ | 14162/16384 [00:02<00:00, 6728.73probe position/s]Normalizing amplitudes:  91%|█████████ | 14836/16384 [00:02<00:00, 6704.00probe position/s]Normalizing amplitudes:  95%|█████████▍| 15507/16384 [00:02<00:00, 6683.33probe position/s]Normalizing amplitudes:  99%|█████████▊| 16176/16384 [00:02<00:00, 6679.76probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6686.66probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random1024_p12_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random1024_p12_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.5359 in 4.064 sec
Iter: 2, Total Loss: 0.007164 in 4.029 sec
Iter: 3, Total Loss: 0.006776 in 4.018 sec
Iter: 4, Total Loss: 0.006613 in 4.017 sec
Iter: 5, Total Loss: 0.006533 in 3.989 sec
Iter: 6, Total Loss: 0.006482 in 4.003 sec
Iter: 7, Total Loss: 0.006448 in 4.003 sec
Iter: 8, Total Loss: 0.006421 in 3.991 sec
Iter: 9, Total Loss: 0.006399 in 3.969 sec
Iter: 10, Total Loss: 0.006378 in 3.986 sec
Iter: 11, Total Loss: 0.00636 in 3.998 sec
Iter: 12, Total Loss: 0.006342 in 4.000 sec
Iter: 13, Total Loss: 0.006325 in 3.997 sec
Iter: 14, Total Loss: 0.006309 in 4.000 sec
Iter: 15, Total Loss: 0.006293 in 4.002 sec
Iter: 16, Total Loss: 0.006277 in 4.020 sec
Iter: 17, Total Loss: 0.006261 in 4.006 sec
Iter: 18, Total Loss: 0.006246 in 3.997 sec
Iter: 19, Total Loss: 0.006232 in 3.985 sec
Iter: 20, Total Loss: 0.006217 in 3.986 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 4.003 with std = 0.020 sec ###
### py4DSTEM ptycho solver is finished in 1 min 20.851 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.38 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 1024, 12, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 691/16384 [00:00<00:02, 6907.55probe position/s]Normalizing amplitudes:   8%|▊         | 1389/16384 [00:00<00:02, 6946.13probe position/s]Normalizing amplitudes:  13%|█▎        | 2098/16384 [00:00<00:02, 7008.93probe position/s]Normalizing amplitudes:  17%|█▋        | 2800/16384 [00:00<00:01, 7012.52probe position/s]Normalizing amplitudes:  21%|██▏       | 3502/16384 [00:00<00:01, 6926.45probe position/s]Normalizing amplitudes:  26%|██▌       | 4197/16384 [00:00<00:01, 6932.18probe position/s]Normalizing amplitudes:  30%|██▉       | 4909/16384 [00:00<00:01, 6990.59probe position/s]Normalizing amplitudes:  34%|███▍      | 5613/16384 [00:00<00:01, 7005.63probe position/s]Normalizing amplitudes:  39%|███▊      | 6314/16384 [00:00<00:01, 6990.32probe position/s]Normalizing amplitudes:  43%|████▎     | 7018/16384 [00:01<00:01, 7004.30probe position/s]Normalizing amplitudes:  47%|████▋     | 7719/16384 [00:01<00:01, 6973.24probe position/s]Normalizing amplitudes:  51%|█████▏    | 8418/16384 [00:01<00:01, 6976.69probe position/s]Normalizing amplitudes:  56%|█████▌    | 9116/16384 [00:01<00:01, 6915.59probe position/s]Normalizing amplitudes:  60%|█████▉    | 9808/16384 [00:01<00:00, 6884.17probe position/s]Normalizing amplitudes:  64%|██████▍   | 10497/16384 [00:01<00:00, 6825.14probe position/s]Normalizing amplitudes:  68%|██████▊   | 11193/16384 [00:01<00:00, 6862.67probe position/s]Normalizing amplitudes:  73%|███████▎  | 11902/16384 [00:01<00:00, 6928.35probe position/s]Normalizing amplitudes:  77%|███████▋  | 12595/16384 [00:01<00:00, 6909.75probe position/s]Normalizing amplitudes:  81%|████████  | 13302/16384 [00:01<00:00, 6956.33probe position/s]Normalizing amplitudes:  86%|████████▌ | 14020/16384 [00:02<00:00, 7018.67probe position/s]Normalizing amplitudes:  90%|████████▉ | 14726/16384 [00:02<00:00, 7029.53probe position/s]Normalizing amplitudes:  94%|█████████▍| 15433/16384 [00:02<00:00, 7039.71probe position/s]Normalizing amplitudes:  98%|█████████▊| 16138/16384 [00:02<00:00, 7029.64probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6967.52probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random1024_p12_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random1024_p12_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
An error occurred for (round, batch, pmode, slice) = (2, 1024, 12, 3): Out of memory allocating 1,610,612,736 bytes (allocated so far: 18,790,481,920 bytes).
### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.79 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 1024, 12, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 658/16384 [00:00<00:02, 6574.55probe position/s]Normalizing amplitudes:   8%|▊         | 1339/16384 [00:00<00:02, 6708.17probe position/s]Normalizing amplitudes:  12%|█▏        | 2042/16384 [00:00<00:02, 6851.76probe position/s]Normalizing amplitudes:  17%|█▋        | 2728/16384 [00:00<00:01, 6854.13probe position/s]Normalizing amplitudes:  21%|██        | 3414/16384 [00:00<00:01, 6807.10probe position/s]Normalizing amplitudes:  25%|██▍       | 4095/16384 [00:00<00:01, 6784.83probe position/s]Normalizing amplitudes:  29%|██▉       | 4774/16384 [00:00<00:01, 6730.83probe position/s]Normalizing amplitudes:  33%|███▎      | 5448/16384 [00:00<00:01, 6728.26probe position/s]Normalizing amplitudes:  37%|███▋      | 6121/16384 [00:00<00:01, 6723.07probe position/s]Normalizing amplitudes:  42%|████▏     | 6814/16384 [00:01<00:01, 6784.65probe position/s]Normalizing amplitudes:  46%|████▌     | 7537/16384 [00:01<00:01, 6917.22probe position/s]Normalizing amplitudes:  50%|█████     | 8229/16384 [00:01<00:01, 6916.74probe position/s]Normalizing amplitudes:  54%|█████▍    | 8921/16384 [00:01<00:01, 6878.22probe position/s]Normalizing amplitudes:  59%|█████▊    | 9615/16384 [00:01<00:00, 6894.89probe position/s]Normalizing amplitudes:  63%|██████▎   | 10305/16384 [00:01<00:00, 6802.00probe position/s]Normalizing amplitudes:  67%|██████▋   | 10998/16384 [00:01<00:00, 6836.71probe position/s]Normalizing amplitudes:  71%|███████▏  | 11684/16384 [00:01<00:00, 6842.98probe position/s]Normalizing amplitudes:  76%|███████▌  | 12376/16384 [00:01<00:00, 6863.86probe position/s]Normalizing amplitudes:  80%|███████▉  | 13078/16384 [00:01<00:00, 6908.20probe position/s]Normalizing amplitudes:  84%|████████▍ | 13802/16384 [00:02<00:00, 7004.48probe position/s]Normalizing amplitudes:  89%|████████▊ | 14503/16384 [00:02<00:00, 6702.51probe position/s]Normalizing amplitudes:  93%|█████████▎| 15177/16384 [00:02<00:00, 6658.32probe position/s]Normalizing amplitudes:  97%|█████████▋| 15865/16384 [00:02<00:00, 6721.61probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6807.97probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random1024_p12_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random1024_p12_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
An error occurred for (round, batch, pmode, slice) = (2, 1024, 12, 6): Out of memory allocating 1,610,612,736 bytes (allocated so far: 18,790,481,920 bytes).
### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 935.74 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 512, 1, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 572/16384 [00:00<00:02, 5713.81probe position/s]Normalizing amplitudes:   7%|▋         | 1144/16384 [00:00<00:03, 4904.81probe position/s]Normalizing amplitudes:  10%|█         | 1667/16384 [00:00<00:02, 5037.23probe position/s]Normalizing amplitudes:  14%|█▍        | 2278/16384 [00:00<00:02, 5437.73probe position/s]Normalizing amplitudes:  17%|█▋        | 2828/16384 [00:00<00:02, 5432.04probe position/s]Normalizing amplitudes:  21%|██        | 3375/16384 [00:00<00:02, 5347.11probe position/s]Normalizing amplitudes:  24%|██▍       | 3925/16384 [00:00<00:02, 5394.23probe position/s]Normalizing amplitudes:  27%|██▋       | 4475/16384 [00:00<00:02, 5422.51probe position/s]Normalizing amplitudes:  31%|███       | 5055/16384 [00:00<00:02, 5537.68probe position/s]Normalizing amplitudes:  34%|███▍      | 5619/16384 [00:01<00:01, 5567.00probe position/s]Normalizing amplitudes:  38%|███▊      | 6183/16384 [00:01<00:01, 5588.16probe position/s]Normalizing amplitudes:  41%|████      | 6743/16384 [00:01<00:01, 5552.48probe position/s]Normalizing amplitudes:  45%|████▍     | 7313/16384 [00:01<00:01, 5594.68probe position/s]Normalizing amplitudes:  48%|████▊     | 7873/16384 [00:01<00:01, 5557.13probe position/s]Normalizing amplitudes:  51%|█████▏    | 8429/16384 [00:01<00:01, 5529.37probe position/s]Normalizing amplitudes:  55%|█████▍    | 8983/16384 [00:01<00:01, 5355.13probe position/s]Normalizing amplitudes:  58%|█████▊    | 9537/16384 [00:01<00:01, 5408.17probe position/s]Normalizing amplitudes:  62%|██████▏   | 10079/16384 [00:01<00:01, 5361.97probe position/s]Normalizing amplitudes:  65%|██████▌   | 10677/16384 [00:01<00:01, 5543.42probe position/s]Normalizing amplitudes:  69%|██████▊   | 11233/16384 [00:02<00:00, 5482.16probe position/s]Normalizing amplitudes:  72%|███████▏  | 11841/16384 [00:02<00:00, 5657.98probe position/s]Normalizing amplitudes:  76%|███████▌  | 12459/16384 [00:02<00:00, 5812.13probe position/s]Normalizing amplitudes:  80%|███████▉  | 13041/16384 [00:02<00:00, 5812.76probe position/s]Normalizing amplitudes:  83%|████████▎ | 13645/16384 [00:02<00:00, 5880.18probe position/s]Normalizing amplitudes:  87%|████████▋ | 14234/16384 [00:02<00:00, 5752.94probe position/s]Normalizing amplitudes:  90%|█████████ | 14811/16384 [00:02<00:00, 5695.78probe position/s]Normalizing amplitudes:  94%|█████████▍| 15405/16384 [00:02<00:00, 5766.73probe position/s]Normalizing amplitudes:  98%|█████████▊| 15984/16384 [00:02<00:00, 5770.79probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5536.03probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random512_p1_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random512_p1_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.01435 in 0.800 sec
Iter: 2, Total Loss: 0.006509 in 0.788 sec
Iter: 3, Total Loss: 0.006485 in 0.765 sec
Iter: 4, Total Loss: 0.006474 in 0.769 sec
Iter: 5, Total Loss: 0.006467 in 0.767 sec
Iter: 6, Total Loss: 0.006463 in 0.760 sec
Iter: 7, Total Loss: 0.006458 in 0.760 sec
Iter: 8, Total Loss: 0.006455 in 0.750 sec
Iter: 9, Total Loss: 0.006451 in 0.773 sec
Iter: 10, Total Loss: 0.006448 in 0.754 sec
Iter: 11, Total Loss: 0.006445 in 0.747 sec
Iter: 12, Total Loss: 0.006442 in 0.749 sec
Iter: 13, Total Loss: 0.006438 in 0.775 sec
Iter: 14, Total Loss: 0.006435 in 0.756 sec
Iter: 15, Total Loss: 0.006431 in 0.754 sec
Iter: 16, Total Loss: 0.006427 in 0.753 sec
Iter: 17, Total Loss: 0.006424 in 0.759 sec
Iter: 18, Total Loss: 0.006421 in 0.781 sec
Iter: 19, Total Loss: 0.006417 in 0.760 sec
Iter: 20, Total Loss: 0.006413 in 0.752 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 0.764 with std = 0.014 sec ###
### py4DSTEM ptycho solver is finished in 16.211 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 936.46 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 512, 1, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 714/16384 [00:00<00:02, 7132.75probe position/s]Normalizing amplitudes:   9%|▊         | 1428/16384 [00:00<00:02, 6742.94probe position/s]Normalizing amplitudes:  13%|█▎        | 2104/16384 [00:00<00:02, 6463.66probe position/s]Normalizing amplitudes:  17%|█▋        | 2752/16384 [00:00<00:02, 6280.94probe position/s]Normalizing amplitudes:  21%|██        | 3392/16384 [00:00<00:02, 6320.54probe position/s]Normalizing amplitudes:  25%|██▍       | 4050/16384 [00:00<00:01, 6405.76probe position/s]Normalizing amplitudes:  29%|██▉       | 4742/16384 [00:00<00:01, 6567.85probe position/s]Normalizing amplitudes:  33%|███▎      | 5449/16384 [00:00<00:01, 6723.73probe position/s]Normalizing amplitudes:  38%|███▊      | 6170/16384 [00:00<00:01, 6872.02probe position/s]Normalizing amplitudes:  42%|████▏     | 6873/16384 [00:01<00:01, 6915.39probe position/s]Normalizing amplitudes:  46%|████▌     | 7566/16384 [00:01<00:01, 6907.29probe position/s]Normalizing amplitudes:  50%|█████     | 8266/16384 [00:01<00:01, 6932.28probe position/s]Normalizing amplitudes:  55%|█████▍    | 8971/16384 [00:01<00:01, 6967.38probe position/s]Normalizing amplitudes:  59%|█████▉    | 9668/16384 [00:01<00:00, 6926.52probe position/s]Normalizing amplitudes:  63%|██████▎   | 10361/16384 [00:01<00:00, 6819.71probe position/s]Normalizing amplitudes:  67%|██████▋   | 11044/16384 [00:01<00:00, 6726.21probe position/s]Normalizing amplitudes:  72%|███████▏  | 11735/16384 [00:01<00:00, 6778.53probe position/s]Normalizing amplitudes:  76%|███████▌  | 12452/16384 [00:01<00:00, 6892.67probe position/s]Normalizing amplitudes:  80%|████████  | 13160/16384 [00:01<00:00, 6947.81probe position/s]Normalizing amplitudes:  85%|████████▍ | 13856/16384 [00:02<00:00, 6813.90probe position/s]Normalizing amplitudes:  89%|████████▉ | 14542/16384 [00:02<00:00, 6826.16probe position/s]Normalizing amplitudes:  93%|█████████▎| 15246/16384 [00:02<00:00, 6886.21probe position/s]Normalizing amplitudes:  97%|█████████▋| 15944/16384 [00:02<00:00, 6911.87probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6792.71probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random512_p1_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random512_p1_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.01473 in 1.553 sec
Iter: 2, Total Loss: 0.006508 in 1.497 sec
Iter: 3, Total Loss: 0.006482 in 1.485 sec
Iter: 4, Total Loss: 0.006473 in 1.475 sec
Iter: 5, Total Loss: 0.006465 in 1.510 sec
Iter: 6, Total Loss: 0.006456 in 1.524 sec
Iter: 7, Total Loss: 0.006451 in 1.670 sec
Iter: 8, Total Loss: 0.006444 in 1.527 sec
Iter: 9, Total Loss: 0.006438 in 1.504 sec
Iter: 10, Total Loss: 0.006434 in 1.556 sec
Iter: 11, Total Loss: 0.006428 in 1.514 sec
Iter: 12, Total Loss: 0.006423 in 1.510 sec
Iter: 13, Total Loss: 0.006417 in 1.511 sec
Iter: 14, Total Loss: 0.006411 in 1.535 sec
Iter: 15, Total Loss: 0.006406 in 1.846 sec
Iter: 16, Total Loss: 0.006401 in 1.654 sec
Iter: 17, Total Loss: 0.006396 in 1.740 sec
Iter: 18, Total Loss: 0.006391 in 1.513 sec
Iter: 19, Total Loss: 0.006386 in 1.514 sec
Iter: 20, Total Loss: 0.006381 in 1.501 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 1.557 with std = 0.094 sec ###
### py4DSTEM ptycho solver is finished in 32.034 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.62 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 512, 1, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 620/16384 [00:00<00:02, 6193.91probe position/s]Normalizing amplitudes:   8%|▊         | 1274/16384 [00:00<00:02, 6395.05probe position/s]Normalizing amplitudes:  12%|█▏        | 1960/16384 [00:00<00:02, 6607.21probe position/s]Normalizing amplitudes:  16%|█▌        | 2621/16384 [00:00<00:02, 6556.20probe position/s]Normalizing amplitudes:  20%|██        | 3299/16384 [00:00<00:01, 6625.54probe position/s]Normalizing amplitudes:  24%|██▍       | 3962/16384 [00:00<00:01, 6567.82probe position/s]Normalizing amplitudes:  29%|██▊       | 4676/16384 [00:00<00:01, 6749.89probe position/s]Normalizing amplitudes:  33%|███▎      | 5376/16384 [00:00<00:01, 6827.83probe position/s]Normalizing amplitudes:  37%|███▋      | 6059/16384 [00:00<00:01, 6687.40probe position/s]Normalizing amplitudes:  41%|████      | 6729/16384 [00:01<00:01, 6603.75probe position/s]Normalizing amplitudes:  45%|████▌     | 7390/16384 [00:01<00:01, 6497.42probe position/s]Normalizing amplitudes:  49%|████▉     | 8070/16384 [00:01<00:01, 6586.16probe position/s]Normalizing amplitudes:  53%|█████▎    | 8762/16384 [00:01<00:01, 6683.43probe position/s]Normalizing amplitudes:  58%|█████▊    | 9457/16384 [00:01<00:01, 6761.05probe position/s]Normalizing amplitudes:  62%|██████▏   | 10139/16384 [00:01<00:00, 6776.83probe position/s]Normalizing amplitudes:  66%|██████▌   | 10838/16384 [00:01<00:00, 6840.44probe position/s]Normalizing amplitudes:  70%|███████   | 11546/16384 [00:01<00:00, 6910.10probe position/s]Normalizing amplitudes:  75%|███████▍  | 12238/16384 [00:01<00:00, 6711.07probe position/s]Normalizing amplitudes:  79%|███████▉  | 12911/16384 [00:01<00:00, 6648.92probe position/s]Normalizing amplitudes:  83%|████████▎ | 13586/16384 [00:02<00:00, 6675.36probe position/s]Normalizing amplitudes:  87%|████████▋ | 14282/16384 [00:02<00:00, 6756.17probe position/s]Normalizing amplitudes:  91%|█████████▏| 14959/16384 [00:02<00:00, 6726.54probe position/s]Normalizing amplitudes:  95%|█████████▌| 15633/16384 [00:02<00:00, 6605.26probe position/s]Normalizing amplitudes: 100%|█████████▉| 16304/16384 [00:02<00:00, 6634.69probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6663.88probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random512_p1_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random512_p1_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.01512 in 2.627 sec
Iter: 2, Total Loss: 0.006533 in 2.601 sec
Iter: 3, Total Loss: 0.006506 in 2.556 sec
Iter: 4, Total Loss: 0.006492 in 2.569 sec
Iter: 5, Total Loss: 0.00648 in 2.572 sec
Iter: 6, Total Loss: 0.006469 in 2.584 sec
Iter: 7, Total Loss: 0.006458 in 2.597 sec
Iter: 8, Total Loss: 0.006452 in 2.592 sec
Iter: 9, Total Loss: 0.006443 in 2.596 sec
Iter: 10, Total Loss: 0.006437 in 2.598 sec
Iter: 11, Total Loss: 0.006429 in 2.594 sec
Iter: 12, Total Loss: 0.006422 in 2.580 sec
Iter: 13, Total Loss: 0.006413 in 2.563 sec
Iter: 14, Total Loss: 0.006407 in 2.631 sec
Iter: 15, Total Loss: 0.006399 in 2.619 sec
Iter: 16, Total Loss: 0.006394 in 2.634 sec
Iter: 17, Total Loss: 0.006386 in 2.576 sec
Iter: 18, Total Loss: 0.006382 in 2.600 sec
Iter: 19, Total Loss: 0.006374 in 2.558 sec
Iter: 20, Total Loss: 0.006365 in 2.555 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 2.590 with std = 0.024 sec ###
### py4DSTEM ptycho solver is finished in 52.653 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.54 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 512, 3, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 679/16384 [00:00<00:02, 6783.55probe position/s]Normalizing amplitudes:   8%|▊         | 1361/16384 [00:00<00:02, 6802.84probe position/s]Normalizing amplitudes:  12%|█▏        | 2044/16384 [00:00<00:02, 6812.95probe position/s]Normalizing amplitudes:  17%|█▋        | 2726/16384 [00:00<00:02, 6799.65probe position/s]Normalizing amplitudes:  21%|██        | 3414/16384 [00:00<00:01, 6826.57probe position/s]Normalizing amplitudes:  25%|██▌       | 4120/16384 [00:00<00:01, 6904.16probe position/s]Normalizing amplitudes:  30%|██▉       | 4835/16384 [00:00<00:01, 6982.71probe position/s]Normalizing amplitudes:  34%|███▍      | 5534/16384 [00:00<00:01, 6965.77probe position/s]Normalizing amplitudes:  38%|███▊      | 6231/16384 [00:00<00:01, 6907.98probe position/s]Normalizing amplitudes:  42%|████▏     | 6922/16384 [00:01<00:01, 6903.29probe position/s]Normalizing amplitudes:  46%|████▋     | 7613/16384 [00:01<00:01, 6898.78probe position/s]Normalizing amplitudes:  51%|█████     | 8308/16384 [00:01<00:01, 6909.85probe position/s]Normalizing amplitudes:  55%|█████▍    | 9003/16384 [00:01<00:01, 6919.43probe position/s]Normalizing amplitudes:  59%|█████▉    | 9695/16384 [00:01<00:00, 6888.51probe position/s]Normalizing amplitudes:  64%|██████▎   | 10409/16384 [00:01<00:00, 6961.50probe position/s]Normalizing amplitudes:  68%|██████▊   | 11122/16384 [00:01<00:00, 7009.66probe position/s]Normalizing amplitudes:  72%|███████▏  | 11824/16384 [00:01<00:00, 6817.26probe position/s]Normalizing amplitudes:  76%|███████▋  | 12507/16384 [00:01<00:00, 6776.11probe position/s]Normalizing amplitudes:  81%|████████  | 13192/16384 [00:01<00:00, 6797.04probe position/s]Normalizing amplitudes:  85%|████████▍ | 13882/16384 [00:02<00:00, 6827.24probe position/s]Normalizing amplitudes:  89%|████████▉ | 14588/16384 [00:02<00:00, 6895.22probe position/s]Normalizing amplitudes:  93%|█████████▎| 15278/16384 [00:02<00:00, 6841.83probe position/s]Normalizing amplitudes:  97%|█████████▋| 15963/16384 [00:02<00:00, 6832.38probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6877.98probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random512_p3_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random512_p3_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.03922 in 1.451 sec
Iter: 2, Total Loss: 0.006604 in 1.374 sec
Iter: 3, Total Loss: 0.006481 in 1.380 sec
Iter: 4, Total Loss: 0.006432 in 1.381 sec
Iter: 5, Total Loss: 0.006407 in 1.392 sec
Iter: 6, Total Loss: 0.006389 in 1.381 sec
Iter: 7, Total Loss: 0.006374 in 1.395 sec
Iter: 8, Total Loss: 0.00636 in 1.389 sec
Iter: 9, Total Loss: 0.006347 in 1.418 sec
Iter: 10, Total Loss: 0.006333 in 1.411 sec
Iter: 11, Total Loss: 0.006319 in 1.390 sec
Iter: 12, Total Loss: 0.006305 in 1.384 sec
Iter: 13, Total Loss: 0.006289 in 1.374 sec
Iter: 14, Total Loss: 0.006275 in 1.383 sec
Iter: 15, Total Loss: 0.006259 in 1.381 sec
Iter: 16, Total Loss: 0.006244 in 1.380 sec
Iter: 17, Total Loss: 0.006228 in 1.386 sec
Iter: 18, Total Loss: 0.006214 in 1.383 sec
Iter: 19, Total Loss: 0.006197 in 1.407 sec
Iter: 20, Total Loss: 0.006183 in 1.394 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 1.392 with std = 0.018 sec ###
### py4DSTEM ptycho solver is finished in 28.819 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.51 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 512, 3, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 710/16384 [00:00<00:02, 7098.40probe position/s]Normalizing amplitudes:   9%|▊         | 1420/16384 [00:00<00:02, 6787.45probe position/s]Normalizing amplitudes:  13%|█▎        | 2100/16384 [00:00<00:02, 6713.48probe position/s]Normalizing amplitudes:  17%|█▋        | 2780/16384 [00:00<00:02, 6741.47probe position/s]Normalizing amplitudes:  21%|██        | 3466/16384 [00:00<00:01, 6782.52probe position/s]Normalizing amplitudes:  25%|██▌       | 4151/16384 [00:00<00:01, 6805.12probe position/s]Normalizing amplitudes:  30%|██▉       | 4848/16384 [00:00<00:01, 6856.70probe position/s]Normalizing amplitudes:  34%|███▍      | 5562/16384 [00:00<00:01, 6946.36probe position/s]Normalizing amplitudes:  38%|███▊      | 6292/16384 [00:00<00:01, 7056.20probe position/s]Normalizing amplitudes:  43%|████▎     | 7001/16384 [00:01<00:01, 7065.55probe position/s]Normalizing amplitudes:  47%|████▋     | 7708/16384 [00:01<00:01, 7014.57probe position/s]Normalizing amplitudes:  51%|█████▏    | 8414/16384 [00:01<00:01, 7026.48probe position/s]Normalizing amplitudes:  56%|█████▌    | 9117/16384 [00:01<00:01, 7012.72probe position/s]Normalizing amplitudes:  60%|█████▉    | 9819/16384 [00:01<00:00, 6997.73probe position/s]Normalizing amplitudes:  64%|██████▍   | 10519/16384 [00:01<00:00, 6918.92probe position/s]Normalizing amplitudes:  68%|██████▊   | 11212/16384 [00:01<00:00, 6902.97probe position/s]Normalizing amplitudes:  73%|███████▎  | 11931/16384 [00:01<00:00, 6987.25probe position/s]Normalizing amplitudes:  77%|███████▋  | 12650/16384 [00:01<00:00, 7045.11probe position/s]Normalizing amplitudes:  82%|████████▏ | 13355/16384 [00:01<00:00, 7019.50probe position/s]Normalizing amplitudes:  86%|████████▌ | 14068/16384 [00:02<00:00, 7051.55probe position/s]Normalizing amplitudes:  90%|█████████ | 14774/16384 [00:02<00:00, 7005.78probe position/s]Normalizing amplitudes:  94%|█████████▍| 15475/16384 [00:02<00:00, 6948.21probe position/s]Normalizing amplitudes:  99%|█████████▊| 16170/16384 [00:02<00:00, 6916.51probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6944.40probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random512_p3_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random512_p3_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.03943 in 3.479 sec
Iter: 2, Total Loss: 0.006707 in 3.398 sec
Iter: 3, Total Loss: 0.00647 in 3.423 sec
Iter: 4, Total Loss: 0.006404 in 3.504 sec
Iter: 5, Total Loss: 0.006363 in 3.475 sec
Iter: 6, Total Loss: 0.006326 in 3.487 sec
Iter: 7, Total Loss: 0.006294 in 3.876 sec
Iter: 8, Total Loss: 0.006263 in 3.635 sec
Iter: 9, Total Loss: 0.006234 in 3.451 sec
Iter: 10, Total Loss: 0.006208 in 3.401 sec
Iter: 11, Total Loss: 0.00618 in 3.436 sec
Iter: 12, Total Loss: 0.006156 in 3.425 sec
Iter: 13, Total Loss: 0.006131 in 3.424 sec
Iter: 14, Total Loss: 0.006108 in 3.421 sec
Iter: 15, Total Loss: 0.006085 in 3.412 sec
Iter: 16, Total Loss: 0.006064 in 3.409 sec
Iter: 17, Total Loss: 0.006042 in 3.407 sec
Iter: 18, Total Loss: 0.006021 in 3.442 sec
Iter: 19, Total Loss: 0.006001 in 3.421 sec
Iter: 20, Total Loss: 0.005981 in 3.481 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 3.470 with std = 0.107 sec ###
### py4DSTEM ptycho solver is finished in 1 min 10.407 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.49 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 512, 3, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 669/16384 [00:00<00:02, 6679.38probe position/s]Normalizing amplitudes:   8%|▊         | 1341/16384 [00:00<00:02, 6699.82probe position/s]Normalizing amplitudes:  12%|█▏        | 2033/16384 [00:00<00:02, 6799.81probe position/s]Normalizing amplitudes:  17%|█▋        | 2729/16384 [00:00<00:01, 6858.13probe position/s]Normalizing amplitudes:  21%|██        | 3415/16384 [00:00<00:01, 6814.90probe position/s]Normalizing amplitudes:  25%|██▌       | 4132/16384 [00:00<00:01, 6931.40probe position/s]Normalizing amplitudes:  29%|██▉       | 4826/16384 [00:00<00:01, 6623.62probe position/s]Normalizing amplitudes:  34%|███▎      | 5492/16384 [00:00<00:01, 6633.07probe position/s]Normalizing amplitudes:  38%|███▊      | 6158/16384 [00:00<00:01, 6623.78probe position/s]Normalizing amplitudes:  42%|████▏     | 6847/16384 [00:01<00:01, 6702.44probe position/s]Normalizing amplitudes:  46%|████▌     | 7531/16384 [00:01<00:01, 6741.19probe position/s]Normalizing amplitudes:  50%|█████     | 8207/16384 [00:01<00:01, 6746.25probe position/s]Normalizing amplitudes:  54%|█████▍    | 8883/16384 [00:01<00:01, 6671.58probe position/s]Normalizing amplitudes:  58%|█████▊    | 9576/16384 [00:01<00:01, 6747.84probe position/s]Normalizing amplitudes:  63%|██████▎   | 10295/16384 [00:01<00:00, 6878.95probe position/s]Normalizing amplitudes:  67%|██████▋   | 11002/16384 [00:01<00:00, 6933.33probe position/s]Normalizing amplitudes:  71%|███████▏  | 11696/16384 [00:01<00:00, 6863.77probe position/s]Normalizing amplitudes:  76%|███████▌  | 12383/16384 [00:01<00:00, 6717.38probe position/s]Normalizing amplitudes:  80%|███████▉  | 13056/16384 [00:01<00:00, 6638.66probe position/s]Normalizing amplitudes:  84%|████████▍ | 13747/16384 [00:02<00:00, 6717.13probe position/s]Normalizing amplitudes:  88%|████████▊ | 14420/16384 [00:02<00:00, 6552.92probe position/s]Normalizing amplitudes:  92%|█████████▏| 15112/16384 [00:02<00:00, 6658.12probe position/s]Normalizing amplitudes:  96%|█████████▋| 15779/16384 [00:02<00:00, 6628.80probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6734.08probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random512_p3_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random512_p3_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.0401 in 6.537 sec
Iter: 2, Total Loss: 0.006951 in 6.423 sec
Iter: 3, Total Loss: 0.006481 in 6.404 sec
Iter: 4, Total Loss: 0.006355 in 6.451 sec
Iter: 5, Total Loss: 0.006278 in 6.629 sec
Iter: 6, Total Loss: 0.006219 in 6.397 sec
Iter: 7, Total Loss: 0.006172 in 6.397 sec
Iter: 8, Total Loss: 0.006131 in 6.492 sec
Iter: 9, Total Loss: 0.006096 in 6.402 sec
Iter: 10, Total Loss: 0.006065 in 6.401 sec
Iter: 11, Total Loss: 0.006036 in 6.404 sec
Iter: 12, Total Loss: 0.006009 in 6.450 sec
Iter: 13, Total Loss: 0.005983 in 6.407 sec
Iter: 14, Total Loss: 0.00596 in 6.390 sec
Iter: 15, Total Loss: 0.005937 in 6.406 sec
Iter: 16, Total Loss: 0.005915 in 6.371 sec
Iter: 17, Total Loss: 0.005896 in 6.400 sec
Iter: 18, Total Loss: 0.005875 in 6.403 sec
Iter: 19, Total Loss: 0.005857 in 6.402 sec
Iter: 20, Total Loss: 0.005838 in 6.386 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 6.428 with std = 0.060 sec ###
### py4DSTEM ptycho solver is finished in 2 min 9.597 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 936.50 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 512, 6, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 716/16384 [00:00<00:02, 7152.69probe position/s]Normalizing amplitudes:   9%|▊         | 1432/16384 [00:00<00:02, 6539.25probe position/s]Normalizing amplitudes:  13%|█▎        | 2090/16384 [00:00<00:02, 5856.09probe position/s]Normalizing amplitudes:  17%|█▋        | 2797/16384 [00:00<00:02, 6287.34probe position/s]Normalizing amplitudes:  21%|██▏       | 3488/16384 [00:00<00:01, 6494.69probe position/s]Normalizing amplitudes:  26%|██▌       | 4198/16384 [00:00<00:01, 6691.07probe position/s]Normalizing amplitudes:  30%|██▉       | 4894/16384 [00:00<00:01, 6772.68probe position/s]Normalizing amplitudes:  34%|███▍      | 5580/16384 [00:00<00:01, 6799.19probe position/s]Normalizing amplitudes:  38%|███▊      | 6265/16384 [00:00<00:01, 6814.68probe position/s]Normalizing amplitudes:  42%|████▏     | 6951/16384 [00:01<00:01, 6827.64probe position/s]Normalizing amplitudes:  47%|████▋     | 7684/16384 [00:01<00:01, 6979.18probe position/s]Normalizing amplitudes:  51%|█████     | 8383/16384 [00:01<00:01, 6969.59probe position/s]Normalizing amplitudes:  55%|█████▌    | 9081/16384 [00:01<00:01, 6926.77probe position/s]Normalizing amplitudes:  60%|█████▉    | 9776/16384 [00:01<00:00, 6931.57probe position/s]Normalizing amplitudes:  64%|██████▍   | 10470/16384 [00:01<00:00, 6882.83probe position/s]Normalizing amplitudes:  68%|██████▊   | 11165/16384 [00:01<00:00, 6900.21probe position/s]Normalizing amplitudes:  73%|███████▎  | 11898/16384 [00:01<00:00, 7027.21probe position/s]Normalizing amplitudes:  77%|███████▋  | 12601/16384 [00:01<00:00, 6895.70probe position/s]Normalizing amplitudes:  81%|████████  | 13293/16384 [00:01<00:00, 6900.68probe position/s]Normalizing amplitudes:  85%|████████▌ | 13984/16384 [00:02<00:00, 6884.27probe position/s]Normalizing amplitudes:  90%|████████▉ | 14686/16384 [00:02<00:00, 6922.18probe position/s]Normalizing amplitudes:  94%|█████████▍| 15379/16384 [00:02<00:00, 6351.50probe position/s]Normalizing amplitudes:  98%|█████████▊| 16083/16384 [00:02<00:00, 6543.81probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6742.72probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random512_p6_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random512_p6_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.1064 in 2.404 sec
Iter: 2, Total Loss: 0.006758 in 2.359 sec
Iter: 3, Total Loss: 0.006538 in 2.367 sec
Iter: 4, Total Loss: 0.006446 in 2.375 sec
Iter: 5, Total Loss: 0.006398 in 2.358 sec
Iter: 6, Total Loss: 0.006364 in 2.351 sec
Iter: 7, Total Loss: 0.006336 in 2.345 sec
Iter: 8, Total Loss: 0.006312 in 2.364 sec
Iter: 9, Total Loss: 0.006288 in 2.366 sec
Iter: 10, Total Loss: 0.006266 in 2.362 sec
Iter: 11, Total Loss: 0.006245 in 2.359 sec
Iter: 12, Total Loss: 0.006223 in 2.365 sec
Iter: 13, Total Loss: 0.006202 in 2.361 sec
Iter: 14, Total Loss: 0.006182 in 2.346 sec
Iter: 15, Total Loss: 0.006161 in 2.339 sec
Iter: 16, Total Loss: 0.006142 in 2.357 sec
Iter: 17, Total Loss: 0.006122 in 2.354 sec
Iter: 18, Total Loss: 0.006103 in 2.389 sec
Iter: 19, Total Loss: 0.006084 in 2.363 sec
Iter: 20, Total Loss: 0.006066 in 2.358 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 2.362 with std = 0.014 sec ###
### py4DSTEM ptycho solver is finished in 48.055 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.43 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 512, 6, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 663/16384 [00:00<00:02, 6625.00probe position/s]Normalizing amplitudes:   8%|▊         | 1338/16384 [00:00<00:02, 6694.96probe position/s]Normalizing amplitudes:  12%|█▏        | 2034/16384 [00:00<00:02, 6813.99probe position/s]Normalizing amplitudes:  17%|█▋        | 2716/16384 [00:00<00:02, 6650.68probe position/s]Normalizing amplitudes:  21%|██        | 3448/16384 [00:00<00:01, 6885.79probe position/s]Normalizing amplitudes:  25%|██▌       | 4139/16384 [00:00<00:01, 6890.66probe position/s]Normalizing amplitudes:  29%|██▉       | 4829/16384 [00:00<00:01, 6829.30probe position/s]Normalizing amplitudes:  34%|███▎      | 5513/16384 [00:00<00:01, 6814.90probe position/s]Normalizing amplitudes:  38%|███▊      | 6199/16384 [00:00<00:01, 6826.20probe position/s]Normalizing amplitudes:  42%|████▏     | 6888/16384 [00:01<00:01, 6843.09probe position/s]Normalizing amplitudes:  46%|████▌     | 7577/16384 [00:01<00:01, 6856.99probe position/s]Normalizing amplitudes:  51%|█████     | 8279/16384 [00:01<00:01, 6904.52probe position/s]Normalizing amplitudes:  55%|█████▍    | 8986/16384 [00:01<00:01, 6954.30probe position/s]Normalizing amplitudes:  59%|█████▉    | 9682/16384 [00:01<00:00, 6939.52probe position/s]Normalizing amplitudes:  63%|██████▎   | 10377/16384 [00:01<00:00, 6890.58probe position/s]Normalizing amplitudes:  68%|██████▊   | 11069/16384 [00:01<00:00, 6897.29probe position/s]Normalizing amplitudes:  72%|███████▏  | 11761/16384 [00:01<00:00, 6901.09probe position/s]Normalizing amplitudes:  76%|███████▌  | 12452/16384 [00:01<00:00, 6838.13probe position/s]Normalizing amplitudes:  80%|████████  | 13136/16384 [00:01<00:00, 6762.68probe position/s]Normalizing amplitudes:  84%|████████▍ | 13817/16384 [00:02<00:00, 6775.85probe position/s]Normalizing amplitudes:  89%|████████▉ | 14548/16384 [00:02<00:00, 6934.28probe position/s]Normalizing amplitudes:  93%|█████████▎| 15242/16384 [00:02<00:00, 6900.53probe position/s]Normalizing amplitudes:  97%|█████████▋| 15933/16384 [00:02<00:00, 6855.82probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6850.62probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random512_p6_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random512_p6_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.1059 in 6.344 sec
Iter: 2, Total Loss: 0.007053 in 6.343 sec
Iter: 3, Total Loss: 0.006593 in 6.443 sec
Iter: 4, Total Loss: 0.006484 in 6.499 sec
Iter: 5, Total Loss: 0.006429 in 6.702 sec
Iter: 6, Total Loss: 0.006386 in 6.303 sec
Iter: 7, Total Loss: 0.006351 in 6.376 sec
Iter: 8, Total Loss: 0.006313 in 6.299 sec
Iter: 9, Total Loss: 0.006283 in 6.283 sec
Iter: 10, Total Loss: 0.006253 in 6.285 sec
Iter: 11, Total Loss: 0.006225 in 6.300 sec
Iter: 12, Total Loss: 0.006199 in 6.325 sec
Iter: 13, Total Loss: 0.006174 in 6.354 sec
Iter: 14, Total Loss: 0.006151 in 6.294 sec
Iter: 15, Total Loss: 0.006126 in 6.521 sec
Iter: 16, Total Loss: 0.006106 in 6.373 sec
Iter: 17, Total Loss: 0.006082 in 6.318 sec
Iter: 18, Total Loss: 0.006063 in 6.341 sec
Iter: 19, Total Loss: 0.006041 in 6.328 sec
Iter: 20, Total Loss: 0.006021 in 6.316 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 6.367 with std = 0.100 sec ###
### py4DSTEM ptycho solver is finished in 2 min 8.425 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.48 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 512, 6, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 684/16384 [00:00<00:02, 6833.77probe position/s]Normalizing amplitudes:   8%|▊         | 1368/16384 [00:00<00:02, 6777.39probe position/s]Normalizing amplitudes:  12%|█▎        | 2048/16384 [00:00<00:02, 6784.79probe position/s]Normalizing amplitudes:  17%|█▋        | 2727/16384 [00:00<00:02, 6785.06probe position/s]Normalizing amplitudes:  21%|██        | 3406/16384 [00:00<00:01, 6776.25probe position/s]Normalizing amplitudes:  25%|██▍       | 4092/16384 [00:00<00:01, 6803.49probe position/s]Normalizing amplitudes:  29%|██▉       | 4774/16384 [00:00<00:01, 6808.14probe position/s]Normalizing amplitudes:  33%|███▎      | 5455/16384 [00:00<00:01, 6755.22probe position/s]Normalizing amplitudes:  37%|███▋      | 6131/16384 [00:00<00:01, 6708.60probe position/s]Normalizing amplitudes:  42%|████▏     | 6811/16384 [00:01<00:01, 6735.37probe position/s]Normalizing amplitudes:  46%|████▌     | 7485/16384 [00:01<00:01, 6734.10probe position/s]Normalizing amplitudes:  50%|████▉     | 8159/16384 [00:01<00:01, 6709.09probe position/s]Normalizing amplitudes:  54%|█████▍    | 8839/16384 [00:01<00:01, 6734.11probe position/s]Normalizing amplitudes:  58%|█████▊    | 9530/16384 [00:01<00:01, 6784.47probe position/s]Normalizing amplitudes:  62%|██████▏   | 10239/16384 [00:01<00:00, 6875.61probe position/s]Normalizing amplitudes:  67%|██████▋   | 10927/16384 [00:01<00:00, 6635.76probe position/s]Normalizing amplitudes:  71%|███████   | 11610/16384 [00:01<00:00, 6690.48probe position/s]Normalizing amplitudes:  75%|███████▍  | 12285/16384 [00:01<00:00, 6707.54probe position/s]Normalizing amplitudes:  79%|███████▉  | 12957/16384 [00:01<00:00, 6599.36probe position/s]Normalizing amplitudes:  83%|████████▎ | 13618/16384 [00:02<00:00, 6587.97probe position/s]Normalizing amplitudes:  87%|████████▋ | 14303/16384 [00:02<00:00, 6663.92probe position/s]Normalizing amplitudes:  92%|█████████▏| 14995/16384 [00:02<00:00, 6737.78probe position/s]Normalizing amplitudes:  96%|█████████▌| 15670/16384 [00:02<00:00, 6629.08probe position/s]Normalizing amplitudes: 100%|█████████▉| 16356/16384 [00:02<00:00, 6695.98probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6720.73probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random512_p6_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random512_p6_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.1062 in 12.191 sec
Iter: 2, Total Loss: 0.007695 in 12.161 sec
Iter: 3, Total Loss: 0.006726 in 12.210 sec
Iter: 4, Total Loss: 0.006471 in 12.184 sec
Iter: 5, Total Loss: 0.006338 in 12.322 sec
Iter: 6, Total Loss: 0.006248 in 12.199 sec
Iter: 7, Total Loss: 0.006181 in 12.283 sec
Iter: 8, Total Loss: 0.006128 in 12.187 sec
Iter: 9, Total Loss: 0.006085 in 12.189 sec
Iter: 10, Total Loss: 0.006048 in 12.177 sec
Iter: 11, Total Loss: 0.006014 in 12.136 sec
Iter: 12, Total Loss: 0.005985 in 12.151 sec
Iter: 13, Total Loss: 0.005957 in 12.168 sec
Iter: 14, Total Loss: 0.005931 in 12.169 sec
Iter: 15, Total Loss: 0.005906 in 12.137 sec
Iter: 16, Total Loss: 0.005883 in 12.146 sec
Iter: 17, Total Loss: 0.005862 in 12.227 sec
Iter: 18, Total Loss: 0.00584 in 12.398 sec
Iter: 19, Total Loss: 0.00582 in 12.171 sec
Iter: 20, Total Loss: 0.005801 in 12.188 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 12.200 with std = 0.064 sec ###
### py4DSTEM ptycho solver is finished in 4 min 4.935 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.46 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 512, 12, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 673/16384 [00:00<00:02, 6719.53probe position/s]Normalizing amplitudes:   8%|▊         | 1362/16384 [00:00<00:02, 6816.12probe position/s]Normalizing amplitudes:  12%|█▏        | 2044/16384 [00:00<00:02, 6797.45probe position/s]Normalizing amplitudes:  17%|█▋        | 2724/16384 [00:00<00:02, 6640.63probe position/s]Normalizing amplitudes:  21%|██        | 3395/16384 [00:00<00:01, 6663.90probe position/s]Normalizing amplitudes:  25%|██▍       | 4062/16384 [00:00<00:01, 6665.12probe position/s]Normalizing amplitudes:  29%|██▉       | 4729/16384 [00:00<00:01, 6659.96probe position/s]Normalizing amplitudes:  33%|███▎      | 5418/16384 [00:00<00:01, 6732.03probe position/s]Normalizing amplitudes:  37%|███▋      | 6092/16384 [00:00<00:01, 6718.32probe position/s]Normalizing amplitudes:  41%|████▏     | 6765/16384 [00:01<00:01, 6721.83probe position/s]Normalizing amplitudes:  45%|████▌     | 7449/16384 [00:01<00:01, 6757.35probe position/s]Normalizing amplitudes:  50%|████▉     | 8125/16384 [00:01<00:01, 6742.97probe position/s]Normalizing amplitudes:  54%|█████▎    | 8800/16384 [00:01<00:01, 6730.78probe position/s]Normalizing amplitudes:  58%|█████▊    | 9477/16384 [00:01<00:01, 6741.07probe position/s]Normalizing amplitudes:  62%|██████▏   | 10161/16384 [00:01<00:00, 6768.32probe position/s]Normalizing amplitudes:  66%|██████▌   | 10838/16384 [00:01<00:00, 6739.76probe position/s]Normalizing amplitudes:  70%|███████   | 11513/16384 [00:01<00:00, 6705.18probe position/s]Normalizing amplitudes:  74%|███████▍  | 12189/16384 [00:01<00:00, 6721.03probe position/s]Normalizing amplitudes:  79%|███████▊  | 12872/16384 [00:01<00:00, 6752.93probe position/s]Normalizing amplitudes:  83%|████████▎ | 13548/16384 [00:02<00:00, 6741.28probe position/s]Normalizing amplitudes:  87%|████████▋ | 14223/16384 [00:02<00:00, 6741.20probe position/s]Normalizing amplitudes:  91%|█████████ | 14919/16384 [00:02<00:00, 6805.11probe position/s]Normalizing amplitudes:  95%|█████████▌| 15600/16384 [00:02<00:00, 6785.09probe position/s]Normalizing amplitudes:  99%|█████████▉| 16279/16384 [00:02<00:00, 6734.42probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6731.53probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random512_p12_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random512_p12_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.275 in 4.317 sec
Iter: 2, Total Loss: 0.006904 in 4.290 sec
Iter: 3, Total Loss: 0.006606 in 4.288 sec
Iter: 4, Total Loss: 0.006472 in 4.290 sec
Iter: 5, Total Loss: 0.006395 in 4.284 sec
Iter: 6, Total Loss: 0.006342 in 4.291 sec
Iter: 7, Total Loss: 0.006299 in 4.277 sec
Iter: 8, Total Loss: 0.006263 in 4.281 sec
Iter: 9, Total Loss: 0.006231 in 4.289 sec
Iter: 10, Total Loss: 0.006201 in 4.291 sec
Iter: 11, Total Loss: 0.006173 in 4.276 sec
Iter: 12, Total Loss: 0.006147 in 4.275 sec
Iter: 13, Total Loss: 0.006122 in 4.274 sec
Iter: 14, Total Loss: 0.006098 in 4.308 sec
Iter: 15, Total Loss: 0.006074 in 4.275 sec
Iter: 16, Total Loss: 0.006052 in 4.364 sec
Iter: 17, Total Loss: 0.00603 in 4.264 sec
Iter: 18, Total Loss: 0.006009 in 4.270 sec
Iter: 19, Total Loss: 0.005987 in 4.292 sec
Iter: 20, Total Loss: 0.005967 in 4.339 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 4.292 with std = 0.024 sec ###
### py4DSTEM ptycho solver is finished in 1 min 27.473 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.44 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 512, 12, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 655/16384 [00:00<00:02, 6544.62probe position/s]Normalizing amplitudes:   8%|▊         | 1310/16384 [00:00<00:02, 6188.70probe position/s]Normalizing amplitudes:  12%|█▏        | 1931/16384 [00:00<00:02, 6098.88probe position/s]Normalizing amplitudes:  16%|█▌        | 2592/16384 [00:00<00:02, 6292.59probe position/s]Normalizing amplitudes:  20%|██        | 3285/16384 [00:00<00:02, 6514.81probe position/s]Normalizing amplitudes:  24%|██▍       | 3989/16384 [00:00<00:01, 6687.13probe position/s]Normalizing amplitudes:  29%|██▊       | 4671/16384 [00:00<00:01, 6728.97probe position/s]Normalizing amplitudes:  33%|███▎      | 5345/16384 [00:00<00:01, 6574.11probe position/s]Normalizing amplitudes:  37%|███▋      | 6019/16384 [00:00<00:01, 6622.17probe position/s]Normalizing amplitudes:  41%|████      | 6684/16384 [00:01<00:01, 6627.91probe position/s]Normalizing amplitudes:  45%|████▍     | 7354/16384 [00:01<00:01, 6648.66probe position/s]Normalizing amplitudes:  49%|████▉     | 8047/16384 [00:01<00:01, 6728.99probe position/s]Normalizing amplitudes:  53%|█████▎    | 8721/16384 [00:01<00:01, 6723.96probe position/s]Normalizing amplitudes:  57%|█████▋    | 9394/16384 [00:01<00:01, 6715.99probe position/s]Normalizing amplitudes:  62%|██████▏   | 10096/16384 [00:01<00:00, 6804.73probe position/s]Normalizing amplitudes:  66%|██████▌   | 10777/16384 [00:01<00:00, 6788.09probe position/s]Normalizing amplitudes:  70%|██████▉   | 11456/16384 [00:01<00:00, 6755.46probe position/s]Normalizing amplitudes:  74%|███████▍  | 12139/16384 [00:01<00:00, 6776.37probe position/s]Normalizing amplitudes:  78%|███████▊  | 12817/16384 [00:01<00:00, 6747.56probe position/s]Normalizing amplitudes:  82%|████████▏ | 13492/16384 [00:02<00:00, 6701.74probe position/s]Normalizing amplitudes:  86%|████████▋ | 14163/16384 [00:02<00:00, 6549.54probe position/s]Normalizing amplitudes:  90%|█████████ | 14819/16384 [00:02<00:00, 6536.49probe position/s]Normalizing amplitudes:  94%|█████████▍| 15474/16384 [00:02<00:00, 6528.04probe position/s]Normalizing amplitudes:  99%|█████████▊| 16158/16384 [00:02<00:00, 6619.97probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6627.85probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random512_p12_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random512_p12_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.2714 in 12.233 sec
Iter: 2, Total Loss: 0.007606 in 12.237 sec
Iter: 3, Total Loss: 0.006823 in 12.344 sec
Iter: 4, Total Loss: 0.00659 in 12.688 sec
Iter: 5, Total Loss: 0.006466 in 13.023 sec
Iter: 6, Total Loss: 0.00638 in 12.280 sec
Iter: 7, Total Loss: 0.006315 in 12.338 sec
Iter: 8, Total Loss: 0.006262 in 12.313 sec
Iter: 9, Total Loss: 0.006216 in 12.277 sec
Iter: 10, Total Loss: 0.006177 in 12.381 sec
Iter: 11, Total Loss: 0.006142 in 12.268 sec
Iter: 12, Total Loss: 0.006109 in 12.322 sec
Iter: 13, Total Loss: 0.00608 in 12.246 sec
Iter: 14, Total Loss: 0.006051 in 12.305 sec
Iter: 15, Total Loss: 0.006025 in 12.240 sec
Iter: 16, Total Loss: 0.005999 in 12.238 sec
Iter: 17, Total Loss: 0.005974 in 12.268 sec
Iter: 18, Total Loss: 0.005952 in 12.294 sec
Iter: 19, Total Loss: 0.005929 in 12.200 sec
Iter: 20, Total Loss: 0.005907 in 12.234 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 12.336 with std = 0.186 sec ###
### py4DSTEM ptycho solver is finished in 4 min 7.835 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.35 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 512, 12, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 701/16384 [00:00<00:02, 7005.41probe position/s]Normalizing amplitudes:   9%|▊         | 1415/16384 [00:00<00:02, 7078.07probe position/s]Normalizing amplitudes:  13%|█▎        | 2123/16384 [00:00<00:02, 6990.75probe position/s]Normalizing amplitudes:  17%|█▋        | 2829/16384 [00:00<00:01, 7016.35probe position/s]Normalizing amplitudes:  22%|██▏       | 3539/16384 [00:00<00:01, 7043.56probe position/s]Normalizing amplitudes:  26%|██▌       | 4248/16384 [00:00<00:01, 7057.42probe position/s]Normalizing amplitudes:  30%|███       | 4957/16384 [00:00<00:01, 7065.75probe position/s]Normalizing amplitudes:  35%|███▍      | 5664/16384 [00:00<00:01, 6911.62probe position/s]Normalizing amplitudes:  39%|███▉      | 6368/16384 [00:00<00:01, 6948.62probe position/s]Normalizing amplitudes:  43%|████▎     | 7069/16384 [00:01<00:01, 6967.21probe position/s]Normalizing amplitudes:  47%|████▋     | 7767/16384 [00:01<00:01, 6964.02probe position/s]Normalizing amplitudes:  52%|█████▏    | 8470/16384 [00:01<00:01, 6983.67probe position/s]Normalizing amplitudes:  56%|█████▌    | 9173/16384 [00:01<00:01, 6997.26probe position/s]Normalizing amplitudes:  60%|██████    | 9873/16384 [00:01<00:00, 6672.35probe position/s]Normalizing amplitudes:  64%|██████▍   | 10554/16384 [00:01<00:00, 6710.78probe position/s]Normalizing amplitudes:  69%|██████▊   | 11228/16384 [00:01<00:00, 6714.31probe position/s]Normalizing amplitudes:  73%|███████▎  | 11919/16384 [00:01<00:00, 6771.85probe position/s]Normalizing amplitudes:  77%|███████▋  | 12641/16384 [00:01<00:00, 6904.68probe position/s]Normalizing amplitudes:  81%|████████▏ | 13350/16384 [00:01<00:00, 6958.34probe position/s]Normalizing amplitudes:  86%|████████▌ | 14047/16384 [00:02<00:00, 6873.39probe position/s]Normalizing amplitudes:  90%|████████▉ | 14736/16384 [00:02<00:00, 6871.21probe position/s]Normalizing amplitudes:  94%|█████████▍| 15427/16384 [00:02<00:00, 6881.17probe position/s]Normalizing amplitudes:  98%|█████████▊| 16119/16384 [00:02<00:00, 6891.30probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6909.78probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random512_p12_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random512_p12_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.2701 in 24.312 sec
Iter: 2, Total Loss: 0.008186 in 23.628 sec
Iter: 3, Total Loss: 0.006961 in 23.685 sec
Iter: 4, Total Loss: 0.006599 in 23.631 sec
Iter: 5, Total Loss: 0.006411 in 23.631 sec
Iter: 6, Total Loss: 0.006289 in 23.875 sec
Iter: 7, Total Loss: 0.006199 in 23.730 sec
Iter: 8, Total Loss: 0.006129 in 23.667 sec
Iter: 9, Total Loss: 0.006073 in 23.726 sec
Iter: 10, Total Loss: 0.006026 in 24.061 sec
Iter: 11, Total Loss: 0.005985 in 23.800 sec
Iter: 12, Total Loss: 0.005949 in 23.740 sec
Iter: 13, Total Loss: 0.005917 in 23.751 sec
Iter: 14, Total Loss: 0.005886 in 23.700 sec
Iter: 15, Total Loss: 0.005859 in 23.672 sec
Iter: 16, Total Loss: 0.005833 in 23.828 sec
Iter: 17, Total Loss: 0.005809 in 23.817 sec
Iter: 18, Total Loss: 0.005785 in 23.989 sec
Iter: 19, Total Loss: 0.005763 in 23.700 sec
Iter: 20, Total Loss: 0.005741 in 23.790 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 23.787 with std = 0.164 sec ###
### py4DSTEM ptycho solver is finished in 7 min 56.746 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 936.12 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 256, 1, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 677/16384 [00:00<00:02, 6764.31probe position/s]Normalizing amplitudes:   8%|▊         | 1367/16384 [00:00<00:02, 6839.23probe position/s]Normalizing amplitudes:  13%|█▎        | 2066/16384 [00:00<00:02, 6905.55probe position/s]Normalizing amplitudes:  17%|█▋        | 2757/16384 [00:00<00:01, 6824.66probe position/s]Normalizing amplitudes:  21%|██        | 3441/16384 [00:00<00:01, 6828.31probe position/s]Normalizing amplitudes:  25%|██▌       | 4124/16384 [00:00<00:01, 6756.82probe position/s]Normalizing amplitudes:  30%|██▉       | 4840/16384 [00:00<00:01, 6885.91probe position/s]Normalizing amplitudes:  34%|███▍      | 5558/16384 [00:00<00:01, 6977.33probe position/s]Normalizing amplitudes:  38%|███▊      | 6256/16384 [00:00<00:01, 6917.24probe position/s]Normalizing amplitudes:  42%|████▏     | 6948/16384 [00:01<00:01, 6893.38probe position/s]Normalizing amplitudes:  47%|████▋     | 7640/16384 [00:01<00:01, 6900.44probe position/s]Normalizing amplitudes:  51%|█████     | 8331/16384 [00:01<00:01, 6901.85probe position/s]Normalizing amplitudes:  55%|█████▌    | 9025/16384 [00:01<00:01, 6910.77probe position/s]Normalizing amplitudes:  59%|█████▉    | 9725/16384 [00:01<00:00, 6935.13probe position/s]Normalizing amplitudes:  64%|██████▎   | 10419/16384 [00:01<00:00, 6905.92probe position/s]Normalizing amplitudes:  68%|██████▊   | 11136/16384 [00:01<00:00, 6984.49probe position/s]Normalizing amplitudes:  72%|███████▏  | 11835/16384 [00:01<00:00, 6884.56probe position/s]Normalizing amplitudes:  77%|███████▋  | 12546/16384 [00:01<00:00, 6949.27probe position/s]Normalizing amplitudes:  81%|████████  | 13242/16384 [00:01<00:00, 6919.95probe position/s]Normalizing amplitudes:  85%|████████▌ | 13940/16384 [00:02<00:00, 6936.06probe position/s]Normalizing amplitudes:  89%|████████▉ | 14636/16384 [00:02<00:00, 6940.99probe position/s]Normalizing amplitudes:  94%|█████████▎| 15331/16384 [00:02<00:00, 6812.11probe position/s]Normalizing amplitudes:  98%|█████████▊| 16013/16384 [00:02<00:00, 6676.06probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6869.12probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random256_p1_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random256_p1_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.01046 in 0.849 sec
Iter: 2, Total Loss: 0.00651 in 0.821 sec
Iter: 3, Total Loss: 0.006487 in 0.852 sec
Iter: 4, Total Loss: 0.006475 in 0.828 sec
Iter: 5, Total Loss: 0.006466 in 0.824 sec
Iter: 6, Total Loss: 0.006459 in 0.828 sec
Iter: 7, Total Loss: 0.006452 in 0.795 sec
Iter: 8, Total Loss: 0.006446 in 0.824 sec
Iter: 9, Total Loss: 0.006439 in 0.818 sec
Iter: 10, Total Loss: 0.006432 in 0.811 sec
Iter: 11, Total Loss: 0.006426 in 0.818 sec
Iter: 12, Total Loss: 0.006418 in 0.843 sec
Iter: 13, Total Loss: 0.006411 in 0.835 sec
Iter: 14, Total Loss: 0.006403 in 0.982 sec
Iter: 15, Total Loss: 0.006396 in 0.836 sec
Iter: 16, Total Loss: 0.006388 in 0.807 sec
Iter: 17, Total Loss: 0.00638 in 0.824 sec
Iter: 18, Total Loss: 0.006373 in 0.823 sec
Iter: 19, Total Loss: 0.006365 in 0.815 sec
Iter: 20, Total Loss: 0.006357 in 0.830 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 0.833 with std = 0.037 sec ###
### py4DSTEM ptycho solver is finished in 17.623 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 937.65 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 256, 1, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 699/16384 [00:00<00:02, 6985.68probe position/s]Normalizing amplitudes:   9%|▊         | 1405/16384 [00:00<00:02, 7029.09probe position/s]Normalizing amplitudes:  13%|█▎        | 2108/16384 [00:00<00:02, 6999.67probe position/s]Normalizing amplitudes:  17%|█▋        | 2808/16384 [00:00<00:01, 6844.82probe position/s]Normalizing amplitudes:  21%|██▏       | 3493/16384 [00:00<00:01, 6787.22probe position/s]Normalizing amplitudes:  26%|██▌       | 4195/16384 [00:00<00:01, 6831.72probe position/s]Normalizing amplitudes:  30%|██▉       | 4879/16384 [00:00<00:01, 6326.73probe position/s]Normalizing amplitudes:  34%|███▎      | 5519/16384 [00:00<00:01, 6207.38probe position/s]Normalizing amplitudes:  38%|███▊      | 6193/16384 [00:00<00:01, 6363.56probe position/s]Normalizing amplitudes:  42%|████▏     | 6884/16384 [00:01<00:01, 6524.16probe position/s]Normalizing amplitudes:  46%|████▌     | 7540/16384 [00:01<00:01, 6452.73probe position/s]Normalizing amplitudes:  50%|█████     | 8221/16384 [00:01<00:01, 6556.26probe position/s]Normalizing amplitudes:  54%|█████▍    | 8879/16384 [00:01<00:01, 6551.90probe position/s]Normalizing amplitudes:  59%|█████▊    | 9592/16384 [00:01<00:01, 6721.44probe position/s]Normalizing amplitudes:  63%|██████▎   | 10312/16384 [00:01<00:00, 6862.51probe position/s]Normalizing amplitudes:  67%|██████▋   | 11000/16384 [00:01<00:01, 5325.06probe position/s]Normalizing amplitudes:  71%|███████▏  | 11690/16384 [00:01<00:00, 5716.26probe position/s]Normalizing amplitudes:  76%|███████▌  | 12374/16384 [00:01<00:00, 6009.53probe position/s]Normalizing amplitudes:  79%|███████▉  | 13011/16384 [00:02<00:00, 5342.65probe position/s]Normalizing amplitudes:  84%|████████▎ | 13697/16384 [00:02<00:00, 5725.63probe position/s]Normalizing amplitudes:  88%|████████▊ | 14416/16384 [00:02<00:00, 6113.99probe position/s]Normalizing amplitudes:  92%|█████████▏| 15115/16384 [00:02<00:00, 6353.57probe position/s]Normalizing amplitudes:  96%|█████████▋| 15772/16384 [00:02<00:00, 4965.94probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6084.91probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random256_p1_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random256_p1_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.01063 in 2.035 sec
Iter: 2, Total Loss: 0.006515 in 1.729 sec
Iter: 3, Total Loss: 0.006496 in 1.711 sec
Iter: 4, Total Loss: 0.006484 in 1.725 sec
Iter: 5, Total Loss: 0.006471 in 1.694 sec
Iter: 6, Total Loss: 0.006462 in 1.716 sec
Iter: 7, Total Loss: 0.006451 in 1.708 sec
Iter: 8, Total Loss: 0.00644 in 1.709 sec
Iter: 9, Total Loss: 0.00643 in 1.770 sec
Iter: 10, Total Loss: 0.00642 in 1.679 sec
Iter: 11, Total Loss: 0.00641 in 1.680 sec
Iter: 12, Total Loss: 0.006401 in 1.683 sec
Iter: 13, Total Loss: 0.00639 in 1.682 sec
Iter: 14, Total Loss: 0.006379 in 1.690 sec
Iter: 15, Total Loss: 0.006372 in 1.695 sec
Iter: 16, Total Loss: 0.006362 in 1.712 sec
Iter: 17, Total Loss: 0.006352 in 1.702 sec
Iter: 18, Total Loss: 0.006342 in 1.702 sec
Iter: 19, Total Loss: 0.006334 in 1.725 sec
Iter: 20, Total Loss: 0.006324 in 1.702 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 1.722 with std = 0.075 sec ###
### py4DSTEM ptycho solver is finished in 35.979 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.43 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 256, 1, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 692/16384 [00:00<00:02, 6913.31probe position/s]Normalizing amplitudes:   8%|▊         | 1384/16384 [00:00<00:02, 6825.60probe position/s]Normalizing amplitudes:  13%|█▎        | 2067/16384 [00:00<00:02, 6803.49probe position/s]Normalizing amplitudes:  17%|█▋        | 2750/16384 [00:00<00:02, 6809.92probe position/s]Normalizing amplitudes:  21%|██        | 3432/16384 [00:00<00:01, 6786.25probe position/s]Normalizing amplitudes:  25%|██▌       | 4139/16384 [00:00<00:01, 6879.81probe position/s]Normalizing amplitudes:  29%|██▉       | 4830/16384 [00:00<00:01, 6888.38probe position/s]Normalizing amplitudes:  34%|███▎      | 5519/16384 [00:00<00:01, 6770.55probe position/s]Normalizing amplitudes:  38%|███▊      | 6209/16384 [00:00<00:01, 6809.19probe position/s]Normalizing amplitudes:  42%|████▏     | 6891/16384 [00:01<00:01, 6784.65probe position/s]Normalizing amplitudes:  46%|████▋     | 7591/16384 [00:01<00:01, 6847.16probe position/s]Normalizing amplitudes:  51%|█████     | 8276/16384 [00:01<00:01, 6785.63probe position/s]Normalizing amplitudes:  55%|█████▍    | 8955/16384 [00:01<00:01, 6759.93probe position/s]Normalizing amplitudes:  59%|█████▉    | 9641/16384 [00:01<00:00, 6786.77probe position/s]Normalizing amplitudes:  63%|██████▎   | 10356/16384 [00:01<00:00, 6889.93probe position/s]Normalizing amplitudes:  67%|██████▋   | 11047/16384 [00:01<00:00, 6891.70probe position/s]Normalizing amplitudes:  72%|███████▏  | 11737/16384 [00:01<00:00, 6829.36probe position/s]Normalizing amplitudes:  76%|███████▌  | 12421/16384 [00:01<00:00, 6751.44probe position/s]Normalizing amplitudes:  80%|███████▉  | 13097/16384 [00:01<00:00, 6717.35probe position/s]Normalizing amplitudes:  84%|████████▍ | 13780/16384 [00:02<00:00, 6749.96probe position/s]Normalizing amplitudes:  88%|████████▊ | 14456/16384 [00:02<00:00, 6684.81probe position/s]Normalizing amplitudes:  92%|█████████▏| 15142/16384 [00:02<00:00, 6734.97probe position/s]Normalizing amplitudes:  97%|█████████▋| 15819/16384 [00:02<00:00, 6744.03probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6809.70probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random256_p1_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random256_p1_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.01081 in 3.055 sec
Iter: 2, Total Loss: 0.006559 in 3.007 sec
Iter: 3, Total Loss: 0.006537 in 2.976 sec
Iter: 4, Total Loss: 0.006516 in 2.977 sec
Iter: 5, Total Loss: 0.006497 in 2.952 sec
Iter: 6, Total Loss: 0.006485 in 2.979 sec
Iter: 7, Total Loss: 0.006469 in 3.070 sec
Iter: 8, Total Loss: 0.006455 in 2.967 sec
Iter: 9, Total Loss: 0.00644 in 2.993 sec
Iter: 10, Total Loss: 0.006427 in 2.986 sec
Iter: 11, Total Loss: 0.006414 in 3.042 sec
Iter: 12, Total Loss: 0.0064 in 2.985 sec
Iter: 13, Total Loss: 0.006389 in 3.000 sec
Iter: 14, Total Loss: 0.006377 in 2.989 sec
Iter: 15, Total Loss: 0.006364 in 2.968 sec
Iter: 16, Total Loss: 0.006352 in 2.980 sec
Iter: 17, Total Loss: 0.006337 in 2.981 sec
Iter: 18, Total Loss: 0.006328 in 3.018 sec
Iter: 19, Total Loss: 0.006316 in 2.976 sec
Iter: 20, Total Loss: 0.006304 in 2.961 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 2.993 with std = 0.030 sec ###
### py4DSTEM ptycho solver is finished in 1 min 0.884 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.30 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 256, 3, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 683/16384 [00:00<00:02, 6816.96probe position/s]Normalizing amplitudes:   8%|▊         | 1377/16384 [00:00<00:02, 6884.40probe position/s]Normalizing amplitudes:  13%|█▎        | 2079/16384 [00:00<00:02, 6942.28probe position/s]Normalizing amplitudes:  17%|█▋        | 2774/16384 [00:00<00:01, 6866.21probe position/s]Normalizing amplitudes:  21%|██        | 3461/16384 [00:00<00:01, 6809.97probe position/s]Normalizing amplitudes:  25%|██▌       | 4143/16384 [00:00<00:01, 6806.86probe position/s]Normalizing amplitudes:  29%|██▉       | 4833/16384 [00:00<00:01, 6836.37probe position/s]Normalizing amplitudes:  34%|███▍      | 5535/16384 [00:00<00:01, 6893.70probe position/s]Normalizing amplitudes:  38%|███▊      | 6225/16384 [00:00<00:01, 6867.97probe position/s]Normalizing amplitudes:  42%|████▏     | 6919/16384 [00:01<00:01, 6887.59probe position/s]Normalizing amplitudes:  46%|████▋     | 7616/16384 [00:01<00:01, 6910.62probe position/s]Normalizing amplitudes:  51%|█████     | 8308/16384 [00:01<00:01, 6896.94probe position/s]Normalizing amplitudes:  55%|█████▌    | 9012/16384 [00:01<00:01, 6939.23probe position/s]Normalizing amplitudes:  59%|█████▉    | 9706/16384 [00:01<00:00, 6936.33probe position/s]Normalizing amplitudes:  63%|██████▎   | 10400/16384 [00:01<00:00, 6926.69probe position/s]Normalizing amplitudes:  68%|██████▊   | 11093/16384 [00:01<00:00, 6885.49probe position/s]Normalizing amplitudes:  72%|███████▏  | 11782/16384 [00:01<00:00, 6865.81probe position/s]Normalizing amplitudes:  76%|███████▌  | 12471/16384 [00:01<00:00, 6872.42probe position/s]Normalizing amplitudes:  80%|████████  | 13169/16384 [00:01<00:00, 6903.71probe position/s]Normalizing amplitudes:  85%|████████▍ | 13860/16384 [00:02<00:00, 6883.69probe position/s]Normalizing amplitudes:  89%|████████▉ | 14549/16384 [00:02<00:00, 6721.05probe position/s]Normalizing amplitudes:  93%|█████████▎| 15222/16384 [00:02<00:00, 6712.79probe position/s]Normalizing amplitudes:  97%|█████████▋| 15894/16384 [00:02<00:00, 6549.76probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6820.72probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random256_p3_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random256_p3_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.02295 in 1.700 sec
Iter: 2, Total Loss: 0.006513 in 1.663 sec
Iter: 3, Total Loss: 0.006429 in 1.652 sec
Iter: 4, Total Loss: 0.006387 in 1.650 sec
Iter: 5, Total Loss: 0.006358 in 1.659 sec
Iter: 6, Total Loss: 0.00633 in 1.648 sec
Iter: 7, Total Loss: 0.006302 in 1.598 sec
Iter: 8, Total Loss: 0.006274 in 1.632 sec
Iter: 9, Total Loss: 0.006245 in 1.656 sec
Iter: 10, Total Loss: 0.006216 in 1.611 sec
Iter: 11, Total Loss: 0.006185 in 1.610 sec
Iter: 12, Total Loss: 0.006157 in 1.604 sec
Iter: 13, Total Loss: 0.006127 in 1.645 sec
Iter: 14, Total Loss: 0.006099 in 1.639 sec
Iter: 15, Total Loss: 0.00607 in 1.665 sec
Iter: 16, Total Loss: 0.006042 in 1.635 sec
Iter: 17, Total Loss: 0.006014 in 1.621 sec
Iter: 18, Total Loss: 0.005987 in 1.647 sec
Iter: 19, Total Loss: 0.005961 in 1.682 sec
Iter: 20, Total Loss: 0.005935 in 1.757 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 1.649 with std = 0.035 sec ###
### py4DSTEM ptycho solver is finished in 34.247 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 935.56 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 256, 3, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 554/16384 [00:00<00:02, 5535.40probe position/s]Normalizing amplitudes:   7%|▋         | 1125/16384 [00:00<00:02, 5633.97probe position/s]Normalizing amplitudes:  10%|█         | 1689/16384 [00:00<00:02, 5536.19probe position/s]Normalizing amplitudes:  14%|█▍        | 2267/16384 [00:00<00:02, 5628.31probe position/s]Normalizing amplitudes:  17%|█▋        | 2831/16384 [00:00<00:02, 5596.44probe position/s]Normalizing amplitudes:  21%|██        | 3461/16384 [00:00<00:02, 5831.29probe position/s]Normalizing amplitudes:  25%|██▍       | 4072/16384 [00:00<00:02, 5918.74probe position/s]Normalizing amplitudes:  28%|██▊       | 4665/16384 [00:00<00:02, 5801.60probe position/s]Normalizing amplitudes:  32%|███▏      | 5246/16384 [00:00<00:02, 5492.15probe position/s]Normalizing amplitudes:  36%|███▌      | 5890/16384 [00:01<00:01, 5769.21probe position/s]Normalizing amplitudes:  40%|████      | 6573/16384 [00:01<00:01, 6081.88probe position/s]Normalizing amplitudes:  44%|████▍     | 7279/16384 [00:01<00:01, 6372.01probe position/s]Normalizing amplitudes:  49%|████▉     | 8002/16384 [00:01<00:01, 6626.23probe position/s]Normalizing amplitudes:  53%|█████▎    | 8692/16384 [00:01<00:01, 6706.27probe position/s]Normalizing amplitudes:  58%|█████▊    | 9422/16384 [00:01<00:01, 6881.73probe position/s]Normalizing amplitudes:  62%|██████▏   | 10112/16384 [00:01<00:00, 6833.39probe position/s]Normalizing amplitudes:  66%|██████▌   | 10812/16384 [00:01<00:00, 6881.84probe position/s]Normalizing amplitudes:  70%|███████   | 11502/16384 [00:01<00:00, 6724.97probe position/s]Normalizing amplitudes:  75%|███████▍  | 12207/16384 [00:01<00:00, 6816.12probe position/s]Normalizing amplitudes:  79%|███████▊  | 12890/16384 [00:02<00:00, 6800.75probe position/s]Normalizing amplitudes:  83%|████████▎ | 13604/16384 [00:02<00:00, 6899.81probe position/s]Normalizing amplitudes:  87%|████████▋ | 14298/16384 [00:02<00:00, 6910.26probe position/s]Normalizing amplitudes:  91%|█████████▏| 14990/16384 [00:02<00:00, 6732.42probe position/s]Normalizing amplitudes:  96%|█████████▌| 15665/16384 [00:02<00:00, 6662.68probe position/s]Normalizing amplitudes: 100%|█████████▉| 16350/16384 [00:02<00:00, 6716.93probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6396.31probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random256_p3_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random256_p3_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.02352 in 4.196 sec
Iter: 2, Total Loss: 0.006511 in 4.160 sec
Iter: 3, Total Loss: 0.006355 in 4.224 sec
Iter: 4, Total Loss: 0.006291 in 4.284 sec
Iter: 5, Total Loss: 0.00624 in 4.248 sec
Iter: 6, Total Loss: 0.006193 in 4.152 sec
Iter: 7, Total Loss: 0.00615 in 4.170 sec
Iter: 8, Total Loss: 0.006111 in 4.145 sec
Iter: 9, Total Loss: 0.006073 in 4.168 sec
Iter: 10, Total Loss: 0.006036 in 4.157 sec
Iter: 11, Total Loss: 0.006001 in 4.126 sec
Iter: 12, Total Loss: 0.005966 in 4.189 sec
Iter: 13, Total Loss: 0.005934 in 4.141 sec
Iter: 14, Total Loss: 0.005902 in 4.197 sec
Iter: 15, Total Loss: 0.00587 in 4.152 sec
Iter: 16, Total Loss: 0.00584 in 4.152 sec
Iter: 17, Total Loss: 0.005811 in 4.211 sec
Iter: 18, Total Loss: 0.005783 in 4.219 sec
Iter: 19, Total Loss: 0.005756 in 4.214 sec
Iter: 20, Total Loss: 0.00573 in 4.231 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 4.187 with std = 0.040 sec ###
### py4DSTEM ptycho solver is finished in 1 min 24.795 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 935.45 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 256, 3, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 680/16384 [00:00<00:02, 6795.99probe position/s]Normalizing amplitudes:   8%|▊         | 1360/16384 [00:00<00:02, 6797.26probe position/s]Normalizing amplitudes:  13%|█▎        | 2072/16384 [00:00<00:02, 6940.89probe position/s]Normalizing amplitudes:  17%|█▋        | 2793/16384 [00:00<00:01, 7046.64probe position/s]Normalizing amplitudes:  21%|██▏       | 3498/16384 [00:00<00:01, 6993.57probe position/s]Normalizing amplitudes:  26%|██▌       | 4213/16384 [00:00<00:01, 7043.20probe position/s]Normalizing amplitudes:  30%|███       | 4918/16384 [00:00<00:01, 6970.79probe position/s]Normalizing amplitudes:  34%|███▍      | 5616/16384 [00:00<00:01, 6966.44probe position/s]Normalizing amplitudes:  39%|███▊      | 6313/16384 [00:00<00:01, 6921.31probe position/s]Normalizing amplitudes:  43%|████▎     | 7015/16384 [00:01<00:01, 6950.65probe position/s]Normalizing amplitudes:  47%|████▋     | 7733/16384 [00:01<00:01, 7017.92probe position/s]Normalizing amplitudes:  51%|█████▏    | 8435/16384 [00:01<00:01, 7016.79probe position/s]Normalizing amplitudes:  56%|█████▌    | 9140/16384 [00:01<00:01, 7024.54probe position/s]Normalizing amplitudes:  60%|██████    | 9843/16384 [00:01<00:00, 6924.48probe position/s]Normalizing amplitudes:  64%|██████▍   | 10538/16384 [00:01<00:00, 6930.60probe position/s]Normalizing amplitudes:  69%|██████▊   | 11241/16384 [00:01<00:00, 6959.65probe position/s]Normalizing amplitudes:  73%|███████▎  | 11938/16384 [00:01<00:00, 6959.20probe position/s]Normalizing amplitudes:  77%|███████▋  | 12635/16384 [00:01<00:00, 6941.46probe position/s]Normalizing amplitudes:  81%|████████▏ | 13335/16384 [00:01<00:00, 6958.45probe position/s]Normalizing amplitudes:  86%|████████▌ | 14039/16384 [00:02<00:00, 6982.72probe position/s]Normalizing amplitudes:  90%|████████▉ | 14738/16384 [00:02<00:00, 6867.90probe position/s]Normalizing amplitudes:  94%|█████████▍| 15434/16384 [00:02<00:00, 6893.05probe position/s]Normalizing amplitudes:  98%|█████████▊| 16124/16384 [00:02<00:00, 6775.66probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6926.59probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random256_p3_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random256_p3_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.02464 in 7.987 sec
Iter: 2, Total Loss: 0.006583 in 7.937 sec
Iter: 3, Total Loss: 0.006321 in 8.077 sec
Iter: 4, Total Loss: 0.006231 in 7.956 sec
Iter: 5, Total Loss: 0.006169 in 7.995 sec
Iter: 6, Total Loss: 0.006118 in 7.923 sec
Iter: 7, Total Loss: 0.006071 in 7.896 sec
Iter: 8, Total Loss: 0.00603 in 7.960 sec
Iter: 9, Total Loss: 0.005991 in 7.925 sec
Iter: 10, Total Loss: 0.005954 in 7.884 sec
Iter: 11, Total Loss: 0.005919 in 7.926 sec
Iter: 12, Total Loss: 0.005886 in 8.073 sec
Iter: 13, Total Loss: 0.005852 in 7.887 sec
Iter: 14, Total Loss: 0.005821 in 7.927 sec
Iter: 15, Total Loss: 0.005791 in 7.967 sec
Iter: 16, Total Loss: 0.005763 in 7.888 sec
Iter: 17, Total Loss: 0.005733 in 7.900 sec
Iter: 18, Total Loss: 0.005707 in 7.845 sec
Iter: 19, Total Loss: 0.005681 in 7.897 sec
Iter: 20, Total Loss: 0.005656 in 8.007 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 7.943 with std = 0.060 sec ###
### py4DSTEM ptycho solver is finished in 2 min 40.292 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 936.11 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 256, 6, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 648/16384 [00:00<00:02, 6469.72probe position/s]Normalizing amplitudes:   8%|▊         | 1323/16384 [00:00<00:02, 6630.66probe position/s]Normalizing amplitudes:  12%|█▏        | 1991/16384 [00:00<00:02, 6650.30probe position/s]Normalizing amplitudes:  16%|█▋        | 2674/16384 [00:00<00:02, 6718.11probe position/s]Normalizing amplitudes:  20%|██        | 3352/16384 [00:00<00:01, 6736.29probe position/s]Normalizing amplitudes:  25%|██▍       | 4026/16384 [00:00<00:01, 6650.40probe position/s]Normalizing amplitudes:  29%|██▉       | 4736/16384 [00:00<00:01, 6794.92probe position/s]Normalizing amplitudes:  33%|███▎      | 5416/16384 [00:00<00:01, 6716.68probe position/s]Normalizing amplitudes:  37%|███▋      | 6088/16384 [00:00<00:01, 6687.12probe position/s]Normalizing amplitudes:  41%|████      | 6757/16384 [00:01<00:01, 6679.04probe position/s]Normalizing amplitudes:  45%|████▌     | 7430/16384 [00:01<00:01, 6693.48probe position/s]Normalizing amplitudes:  50%|████▉     | 8113/16384 [00:01<00:01, 6734.51probe position/s]Normalizing amplitudes:  54%|█████▎    | 8792/16384 [00:01<00:01, 6751.04probe position/s]Normalizing amplitudes:  58%|█████▊    | 9483/16384 [00:01<00:01, 6796.84probe position/s]Normalizing amplitudes:  62%|██████▏   | 10163/16384 [00:01<00:00, 6721.95probe position/s]Normalizing amplitudes:  66%|██████▌   | 10836/16384 [00:01<00:00, 6656.04probe position/s]Normalizing amplitudes:  70%|███████   | 11502/16384 [00:01<00:00, 6647.60probe position/s]Normalizing amplitudes:  74%|███████▍  | 12171/16384 [00:01<00:00, 6659.63probe position/s]Normalizing amplitudes:  78%|███████▊  | 12838/16384 [00:01<00:00, 6590.78probe position/s]Normalizing amplitudes:  82%|████████▏ | 13498/16384 [00:02<00:00, 6574.70probe position/s]Normalizing amplitudes:  87%|████████▋ | 14204/16384 [00:02<00:00, 6716.29probe position/s]Normalizing amplitudes:  91%|█████████ | 14876/16384 [00:02<00:00, 6711.41probe position/s]Normalizing amplitudes:  95%|█████████▍| 15554/16384 [00:02<00:00, 6729.04probe position/s]Normalizing amplitudes:  99%|█████████▉| 16237/16384 [00:02<00:00, 6757.06probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6702.80probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random256_p6_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random256_p6_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.05746 in 2.900 sec
Iter: 2, Total Loss: 0.006626 in 2.840 sec
Iter: 3, Total Loss: 0.006467 in 2.825 sec
Iter: 4, Total Loss: 0.006408 in 2.815 sec
Iter: 5, Total Loss: 0.006374 in 2.828 sec
Iter: 6, Total Loss: 0.006345 in 2.900 sec
Iter: 7, Total Loss: 0.006317 in 2.824 sec
Iter: 8, Total Loss: 0.006289 in 2.846 sec
Iter: 9, Total Loss: 0.006261 in 2.840 sec
Iter: 10, Total Loss: 0.006233 in 2.841 sec
Iter: 11, Total Loss: 0.006203 in 2.829 sec
Iter: 12, Total Loss: 0.006176 in 2.840 sec
Iter: 13, Total Loss: 0.006147 in 2.820 sec
Iter: 14, Total Loss: 0.00612 in 2.836 sec
Iter: 15, Total Loss: 0.006091 in 2.824 sec
Iter: 16, Total Loss: 0.006064 in 2.829 sec
Iter: 17, Total Loss: 0.006036 in 2.862 sec
Iter: 18, Total Loss: 0.00601 in 2.873 sec
Iter: 19, Total Loss: 0.005983 in 2.878 sec
Iter: 20, Total Loss: 0.005957 in 2.823 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 2.844 with std = 0.025 sec ###
### py4DSTEM ptycho solver is finished in 57.763 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.38 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 256, 6, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 711/16384 [00:00<00:02, 7104.81probe position/s]Normalizing amplitudes:   9%|▊         | 1422/16384 [00:00<00:02, 7000.50probe position/s]Normalizing amplitudes:  13%|█▎        | 2123/16384 [00:00<00:02, 6896.45probe position/s]Normalizing amplitudes:  17%|█▋        | 2826/16384 [00:00<00:01, 6944.87probe position/s]Normalizing amplitudes:  21%|██▏       | 3521/16384 [00:00<00:01, 6911.80probe position/s]Normalizing amplitudes:  26%|██▌       | 4227/16384 [00:00<00:01, 6958.24probe position/s]Normalizing amplitudes:  30%|███       | 4923/16384 [00:00<00:01, 6946.26probe position/s]Normalizing amplitudes:  34%|███▍      | 5628/16384 [00:00<00:01, 6976.44probe position/s]Normalizing amplitudes:  39%|███▉      | 6361/16384 [00:00<00:01, 7084.16probe position/s]Normalizing amplitudes:  43%|████▎     | 7070/16384 [00:01<00:01, 6992.99probe position/s]Normalizing amplitudes:  47%|████▋     | 7770/16384 [00:01<00:01, 6975.46probe position/s]Normalizing amplitudes:  52%|█████▏    | 8468/16384 [00:01<00:01, 6928.44probe position/s]Normalizing amplitudes:  56%|█████▌    | 9163/16384 [00:01<00:01, 6932.63probe position/s]Normalizing amplitudes:  60%|██████    | 9865/16384 [00:01<00:00, 6954.08probe position/s]Normalizing amplitudes:  64%|██████▍   | 10561/16384 [00:01<00:00, 6865.73probe position/s]Normalizing amplitudes:  69%|██████▊   | 11257/16384 [00:01<00:00, 6892.16probe position/s]Normalizing amplitudes:  73%|███████▎  | 11953/16384 [00:01<00:00, 6911.71probe position/s]Normalizing amplitudes:  77%|███████▋  | 12645/16384 [00:01<00:00, 6891.38probe position/s]Normalizing amplitudes:  81%|████████▏ | 13335/16384 [00:01<00:00, 6673.16probe position/s]Normalizing amplitudes:  85%|████████▌ | 14004/16384 [00:02<00:00, 6634.06probe position/s]Normalizing amplitudes:  90%|████████▉ | 14669/16384 [00:02<00:00, 6588.98probe position/s]Normalizing amplitudes:  94%|█████████▎| 15331/16384 [00:02<00:00, 6595.66probe position/s]Normalizing amplitudes:  98%|█████████▊| 16011/16384 [00:02<00:00, 6655.72probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6843.21probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random256_p6_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random256_p6_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.05808 in 7.843 sec
Iter: 2, Total Loss: 0.006751 in 7.813 sec
Iter: 3, Total Loss: 0.006409 in 7.955 sec
Iter: 4, Total Loss: 0.0063 in 7.794 sec
Iter: 5, Total Loss: 0.00623 in 7.784 sec
Iter: 6, Total Loss: 0.006172 in 7.841 sec
Iter: 7, Total Loss: 0.00612 in 7.797 sec
Iter: 8, Total Loss: 0.006074 in 7.782 sec
Iter: 9, Total Loss: 0.00603 in 7.841 sec
Iter: 10, Total Loss: 0.005988 in 7.844 sec
Iter: 11, Total Loss: 0.005948 in 8.144 sec
Iter: 12, Total Loss: 0.005909 in 7.765 sec
Iter: 13, Total Loss: 0.00587 in 7.776 sec
Iter: 14, Total Loss: 0.005833 in 7.796 sec
Iter: 15, Total Loss: 0.005798 in 7.778 sec
Iter: 16, Total Loss: 0.005763 in 7.788 sec
Iter: 17, Total Loss: 0.00573 in 7.801 sec
Iter: 18, Total Loss: 0.005698 in 7.771 sec
Iter: 19, Total Loss: 0.005667 in 7.868 sec
Iter: 20, Total Loss: 0.005637 in 7.917 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 7.835 with std = 0.086 sec ###
### py4DSTEM ptycho solver is finished in 2 min 37.920 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.32 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 256, 6, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 649/16384 [00:00<00:02, 6488.12probe position/s]Normalizing amplitudes:   8%|▊         | 1311/16384 [00:00<00:02, 6559.78probe position/s]Normalizing amplitudes:  12%|█▏        | 1990/16384 [00:00<00:02, 6661.13probe position/s]Normalizing amplitudes:  16%|█▌        | 2657/16384 [00:00<00:02, 6658.61probe position/s]Normalizing amplitudes:  20%|██        | 3323/16384 [00:00<00:01, 6598.13probe position/s]Normalizing amplitudes:  24%|██▍       | 3986/16384 [00:00<00:01, 6607.97probe position/s]Normalizing amplitudes:  28%|██▊       | 4647/16384 [00:00<00:01, 6579.41probe position/s]Normalizing amplitudes:  32%|███▏      | 5305/16384 [00:00<00:01, 6465.67probe position/s]Normalizing amplitudes:  36%|███▋      | 5953/16384 [00:00<00:01, 6469.97probe position/s]Normalizing amplitudes:  40%|████      | 6601/16384 [00:01<00:01, 6374.15probe position/s]Normalizing amplitudes:  44%|████▍     | 7249/16384 [00:01<00:01, 6404.78probe position/s]Normalizing amplitudes:  48%|████▊     | 7929/16384 [00:01<00:01, 6522.36probe position/s]Normalizing amplitudes:  52%|█████▏    | 8590/16384 [00:01<00:01, 6546.93probe position/s]Normalizing amplitudes:  56%|█████▋    | 9245/16384 [00:01<00:01, 6532.91probe position/s]Normalizing amplitudes:  60%|██████    | 9899/16384 [00:01<00:00, 6518.02probe position/s]Normalizing amplitudes:  64%|██████▍   | 10565/16384 [00:01<00:00, 6560.17probe position/s]Normalizing amplitudes:  68%|██████▊   | 11222/16384 [00:01<00:00, 6557.58probe position/s]Normalizing amplitudes:  73%|███████▎  | 11896/16384 [00:01<00:00, 6611.94probe position/s]Normalizing amplitudes:  77%|███████▋  | 12558/16384 [00:01<00:00, 6604.63probe position/s]Normalizing amplitudes:  81%|████████  | 13242/16384 [00:02<00:00, 6674.14probe position/s]Normalizing amplitudes:  85%|████████▍ | 13910/16384 [00:02<00:00, 6597.31probe position/s]Normalizing amplitudes:  89%|████████▉ | 14573/16384 [00:02<00:00, 6605.48probe position/s]Normalizing amplitudes:  93%|█████████▎| 15234/16384 [00:02<00:00, 6576.23probe position/s]Normalizing amplitudes:  97%|█████████▋| 15898/16384 [00:02<00:00, 6594.16probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6559.31probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random256_p6_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random256_p6_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.06036 in 15.445 sec
Iter: 2, Total Loss: 0.007126 in 15.437 sec
Iter: 3, Total Loss: 0.006453 in 15.034 sec
Iter: 4, Total Loss: 0.006291 in 15.049 sec
Iter: 5, Total Loss: 0.006201 in 15.205 sec
Iter: 6, Total Loss: 0.006135 in 15.064 sec
Iter: 7, Total Loss: 0.00608 in 15.223 sec
Iter: 8, Total Loss: 0.00603 in 15.261 sec
Iter: 9, Total Loss: 0.005985 in 15.117 sec
Iter: 10, Total Loss: 0.005943 in 14.968 sec
Iter: 11, Total Loss: 0.005903 in 15.031 sec
Iter: 12, Total Loss: 0.005866 in 14.997 sec
Iter: 13, Total Loss: 0.00583 in 15.053 sec
Iter: 14, Total Loss: 0.005796 in 15.089 sec
Iter: 15, Total Loss: 0.005762 in 15.084 sec
Iter: 16, Total Loss: 0.005729 in 15.055 sec
Iter: 17, Total Loss: 0.005699 in 15.164 sec
Iter: 18, Total Loss: 0.005668 in 15.119 sec
Iter: 19, Total Loss: 0.005639 in 15.392 sec
Iter: 20, Total Loss: 0.00561 in 14.967 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 15.138 with std = 0.143 sec ###
### py4DSTEM ptycho solver is finished in 5 min 3.771 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 936.12 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 256, 12, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 647/16384 [00:00<00:02, 6462.18probe position/s]Normalizing amplitudes:   8%|▊         | 1294/16384 [00:00<00:02, 6448.58probe position/s]Normalizing amplitudes:  12%|█▏        | 1988/16384 [00:00<00:02, 6668.86probe position/s]Normalizing amplitudes:  16%|█▋        | 2699/16384 [00:00<00:02, 6841.27probe position/s]Normalizing amplitudes:  21%|██        | 3403/16384 [00:00<00:01, 6911.92probe position/s]Normalizing amplitudes:  25%|██▍       | 4095/16384 [00:00<00:01, 6800.97probe position/s]Normalizing amplitudes:  29%|██▉       | 4776/16384 [00:00<00:01, 6800.01probe position/s]Normalizing amplitudes:  33%|███▎      | 5457/16384 [00:00<00:01, 6778.45probe position/s]Normalizing amplitudes:  38%|███▊      | 6154/16384 [00:00<00:01, 6835.93probe position/s]Normalizing amplitudes:  42%|████▏     | 6850/16384 [00:01<00:01, 6871.71probe position/s]Normalizing amplitudes:  46%|████▌     | 7538/16384 [00:01<00:01, 6866.22probe position/s]Normalizing amplitudes:  50%|█████     | 8247/16384 [00:01<00:01, 6932.27probe position/s]Normalizing amplitudes:  55%|█████▍    | 8941/16384 [00:01<00:01, 6905.03probe position/s]Normalizing amplitudes:  59%|█████▉    | 9632/16384 [00:01<00:00, 6828.70probe position/s]Normalizing amplitudes:  63%|██████▎   | 10335/16384 [00:01<00:00, 6888.03probe position/s]Normalizing amplitudes:  67%|██████▋   | 11025/16384 [00:01<00:00, 6827.76probe position/s]Normalizing amplitudes:  71%|███████▏  | 11709/16384 [00:01<00:00, 6828.69probe position/s]Normalizing amplitudes:  76%|███████▌  | 12393/16384 [00:01<00:00, 6731.70probe position/s]Normalizing amplitudes:  80%|███████▉  | 13082/16384 [00:01<00:00, 6778.13probe position/s]Normalizing amplitudes:  84%|████████▍ | 13784/16384 [00:02<00:00, 6848.09probe position/s]Normalizing amplitudes:  88%|████████▊ | 14470/16384 [00:02<00:00, 6838.42probe position/s]Normalizing amplitudes:  93%|█████████▎| 15165/16384 [00:02<00:00, 6871.16probe position/s]Normalizing amplitudes:  97%|█████████▋| 15853/16384 [00:02<00:00, 6804.93probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6818.17probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random256_p12_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random256_p12_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.143 in 5.281 sec
Iter: 2, Total Loss: 0.006683 in 5.354 sec
Iter: 3, Total Loss: 0.006463 in 5.225 sec
Iter: 4, Total Loss: 0.006367 in 5.418 sec
Iter: 5, Total Loss: 0.006305 in 5.613 sec
Iter: 6, Total Loss: 0.006255 in 5.439 sec
Iter: 7, Total Loss: 0.006211 in 5.468 sec
Iter: 8, Total Loss: 0.00617 in 5.385 sec
Iter: 9, Total Loss: 0.00613 in 5.496 sec
Iter: 10, Total Loss: 0.006092 in 5.381 sec
Iter: 11, Total Loss: 0.006054 in 5.391 sec
Iter: 12, Total Loss: 0.006016 in 5.329 sec
Iter: 13, Total Loss: 0.005981 in 5.268 sec
Iter: 14, Total Loss: 0.005945 in 5.252 sec
Iter: 15, Total Loss: 0.00591 in 5.265 sec
Iter: 16, Total Loss: 0.005877 in 5.224 sec
Iter: 17, Total Loss: 0.005844 in 5.225 sec
Iter: 18, Total Loss: 0.005812 in 5.280 sec
Iter: 19, Total Loss: 0.00578 in 5.264 sec
Iter: 20, Total Loss: 0.005749 in 5.456 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 5.351 with std = 0.105 sec ###
### py4DSTEM ptycho solver is finished in 1 min 48.299 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 937.42 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 256, 12, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 687/16384 [00:00<00:02, 6862.99probe position/s]Normalizing amplitudes:   8%|▊         | 1374/16384 [00:00<00:02, 6738.90probe position/s]Normalizing amplitudes:  13%|█▎        | 2051/16384 [00:00<00:02, 6749.56probe position/s]Normalizing amplitudes:  17%|█▋        | 2727/16384 [00:00<00:02, 6599.40probe position/s]Normalizing amplitudes:  21%|██        | 3388/16384 [00:00<00:01, 6501.52probe position/s]Normalizing amplitudes:  25%|██▍       | 4069/16384 [00:00<00:01, 6600.24probe position/s]Normalizing amplitudes:  29%|██▉       | 4762/16384 [00:00<00:01, 6705.70probe position/s]Normalizing amplitudes:  33%|███▎      | 5434/16384 [00:00<00:02, 5116.97probe position/s]Normalizing amplitudes:  37%|███▋      | 6125/16384 [00:01<00:01, 5573.31probe position/s]Normalizing amplitudes:  42%|████▏     | 6817/16384 [00:01<00:01, 5931.49probe position/s]Normalizing amplitudes:  45%|████▌     | 7449/16384 [00:01<00:01, 5998.50probe position/s]Normalizing amplitudes:  49%|████▉     | 8076/16384 [00:01<00:01, 5371.64probe position/s]Normalizing amplitudes:  54%|█████▎    | 8785/16384 [00:01<00:01, 5821.62probe position/s]Normalizing amplitudes:  58%|█████▊    | 9502/16384 [00:01<00:01, 6187.54probe position/s]Normalizing amplitudes:  62%|██████▏   | 10193/16384 [00:01<00:00, 6388.81probe position/s]Normalizing amplitudes:  66%|██████▌   | 10850/16384 [00:01<00:01, 4961.33probe position/s]Normalizing amplitudes:  70%|███████   | 11510/16384 [00:01<00:00, 5353.33probe position/s]Normalizing amplitudes:  74%|███████▍  | 12167/16384 [00:02<00:00, 5661.90probe position/s]Normalizing amplitudes:  78%|███████▊  | 12823/16384 [00:02<00:00, 5900.27probe position/s]Normalizing amplitudes:  82%|████████▏ | 13446/16384 [00:02<00:00, 5235.53probe position/s]Normalizing amplitudes:  86%|████████▋ | 14156/16384 [00:02<00:00, 5711.58probe position/s]Normalizing amplitudes:  91%|█████████ | 14867/16384 [00:02<00:00, 6084.50probe position/s]Normalizing amplitudes:  95%|█████████▍| 15557/16384 [00:02<00:00, 6307.46probe position/s]Normalizing amplitudes:  99%|█████████▉| 16240/16384 [00:02<00:00, 6453.34probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5974.34probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random256_p12_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random256_p12_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.1419 in 15.227 sec
Iter: 2, Total Loss: 0.006986 in 15.335 sec
Iter: 3, Total Loss: 0.006472 in 15.091 sec
Iter: 4, Total Loss: 0.006313 in 15.135 sec
Iter: 5, Total Loss: 0.006221 in 15.140 sec
Iter: 6, Total Loss: 0.006152 in 15.056 sec
Iter: 7, Total Loss: 0.006094 in 15.114 sec
Iter: 8, Total Loss: 0.006042 in 15.211 sec
Iter: 9, Total Loss: 0.005993 in 15.996 sec
Iter: 10, Total Loss: 0.005947 in 15.144 sec
Iter: 11, Total Loss: 0.005904 in 15.271 sec
Iter: 12, Total Loss: 0.005861 in 14.971 sec
Iter: 13, Total Loss: 0.00582 in 14.896 sec
Iter: 14, Total Loss: 0.005781 in 14.924 sec
Iter: 15, Total Loss: 0.005743 in 15.083 sec
Iter: 16, Total Loss: 0.005707 in 14.975 sec
Iter: 17, Total Loss: 0.005672 in 15.090 sec
Iter: 18, Total Loss: 0.005639 in 14.896 sec
Iter: 19, Total Loss: 0.005607 in 15.007 sec
Iter: 20, Total Loss: 0.005576 in 15.047 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 15.130 with std = 0.231 sec ###
### py4DSTEM ptycho solver is finished in 5 min 3.804 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.36 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 256, 12, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 656/16384 [00:00<00:02, 6553.23probe position/s]Normalizing amplitudes:   8%|▊         | 1345/16384 [00:00<00:02, 6750.63probe position/s]Normalizing amplitudes:  12%|█▏        | 2021/16384 [00:00<00:02, 6719.54probe position/s]Normalizing amplitudes:  16%|█▋        | 2693/16384 [00:00<00:02, 6709.12probe position/s]Normalizing amplitudes:  21%|██        | 3373/16384 [00:00<00:01, 6738.97probe position/s]Normalizing amplitudes:  25%|██▍       | 4047/16384 [00:00<00:01, 6710.56probe position/s]Normalizing amplitudes:  29%|██▉       | 4719/16384 [00:00<00:01, 6687.03probe position/s]Normalizing amplitudes:  33%|███▎      | 5392/16384 [00:00<00:01, 6698.79probe position/s]Normalizing amplitudes:  37%|███▋      | 6071/16384 [00:00<00:01, 6725.50probe position/s]Normalizing amplitudes:  41%|████      | 6744/16384 [00:01<00:01, 6724.31probe position/s]Normalizing amplitudes:  45%|████▌     | 7425/16384 [00:01<00:01, 6746.69probe position/s]Normalizing amplitudes:  50%|████▉     | 8125/16384 [00:01<00:01, 6821.90probe position/s]Normalizing amplitudes:  54%|█████▍    | 8808/16384 [00:01<00:01, 6758.68probe position/s]Normalizing amplitudes:  58%|█████▊    | 9485/16384 [00:01<00:01, 6676.77probe position/s]Normalizing amplitudes:  62%|██████▏   | 10153/16384 [00:01<00:00, 6673.46probe position/s]Normalizing amplitudes:  66%|██████▌   | 10846/16384 [00:01<00:00, 6748.10probe position/s]Normalizing amplitudes:  70%|███████   | 11522/16384 [00:01<00:00, 6728.14probe position/s]Normalizing amplitudes:  74%|███████▍  | 12203/16384 [00:01<00:00, 6752.40probe position/s]Normalizing amplitudes:  79%|███████▊  | 12898/16384 [00:01<00:00, 6808.47probe position/s]Normalizing amplitudes:  83%|████████▎ | 13579/16384 [00:02<00:00, 6734.84probe position/s]Normalizing amplitudes:  87%|████████▋ | 14253/16384 [00:02<00:00, 6682.71probe position/s]Normalizing amplitudes:  91%|█████████ | 14926/16384 [00:02<00:00, 6695.60probe position/s]Normalizing amplitudes:  95%|█████████▌| 15611/16384 [00:02<00:00, 6740.34probe position/s]Normalizing amplitudes:  99%|█████████▉| 16288/16384 [00:02<00:00, 6747.33probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6729.33probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random256_p12_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random256_p12_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.1443 in 29.471 sec
Iter: 2, Total Loss: 0.007745 in 30.108 sec
Iter: 3, Total Loss: 0.006589 in 29.860 sec
Iter: 4, Total Loss: 0.006312 in 29.558 sec
Iter: 5, Total Loss: 0.006177 in 29.523 sec
Iter: 6, Total Loss: 0.006086 in 29.421 sec
Iter: 7, Total Loss: 0.006014 in 30.421 sec
Iter: 8, Total Loss: 0.00595 in 29.893 sec
Iter: 9, Total Loss: 0.005895 in 29.269 sec
Iter: 10, Total Loss: 0.005845 in 29.435 sec
Iter: 11, Total Loss: 0.005796 in 29.527 sec
Iter: 12, Total Loss: 0.005751 in 29.595 sec
Iter: 13, Total Loss: 0.005707 in 29.355 sec
Iter: 14, Total Loss: 0.005667 in 29.508 sec
Iter: 15, Total Loss: 0.005628 in 29.418 sec
Iter: 16, Total Loss: 0.005591 in 29.975 sec
Iter: 17, Total Loss: 0.005556 in 29.628 sec
Iter: 18, Total Loss: 0.005522 in 29.551 sec
Iter: 19, Total Loss: 0.005488 in 29.690 sec
Iter: 20, Total Loss: 0.005457 in 29.567 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 29.639 with std = 0.275 sec ###
### py4DSTEM ptycho solver is finished in 9 min 53.851 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.84 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 128, 1, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 687/16384 [00:00<00:02, 6861.84probe position/s]Normalizing amplitudes:   8%|▊         | 1374/16384 [00:00<00:02, 6776.61probe position/s]Normalizing amplitudes:  13%|█▎        | 2052/16384 [00:00<00:02, 6754.37probe position/s]Normalizing amplitudes:  17%|█▋        | 2754/16384 [00:00<00:01, 6856.79probe position/s]Normalizing amplitudes:  21%|██        | 3462/16384 [00:00<00:01, 6933.70probe position/s]Normalizing amplitudes:  25%|██▌       | 4164/16384 [00:00<00:01, 6961.37probe position/s]Normalizing amplitudes:  30%|██▉       | 4861/16384 [00:00<00:01, 6918.54probe position/s]Normalizing amplitudes:  34%|███▍      | 5553/16384 [00:00<00:01, 6862.56probe position/s]Normalizing amplitudes:  38%|███▊      | 6240/16384 [00:00<00:01, 6812.73probe position/s]Normalizing amplitudes:  42%|████▏     | 6922/16384 [00:01<00:01, 6758.92probe position/s]Normalizing amplitudes:  46%|████▋     | 7608/16384 [00:01<00:01, 6784.95probe position/s]Normalizing amplitudes:  51%|█████     | 8311/16384 [00:01<00:01, 6856.31probe position/s]Normalizing amplitudes:  55%|█████▍    | 9008/16384 [00:01<00:01, 6889.80probe position/s]Normalizing amplitudes:  59%|█████▉    | 9698/16384 [00:01<00:00, 6891.92probe position/s]Normalizing amplitudes:  63%|██████▎   | 10388/16384 [00:01<00:00, 6812.09probe position/s]Normalizing amplitudes:  68%|██████▊   | 11070/16384 [00:01<00:00, 6791.94probe position/s]Normalizing amplitudes:  72%|███████▏  | 11754/16384 [00:01<00:00, 6805.98probe position/s]Normalizing amplitudes:  76%|███████▌  | 12435/16384 [00:01<00:00, 6793.57probe position/s]Normalizing amplitudes:  80%|████████  | 13115/16384 [00:01<00:00, 6783.36probe position/s]Normalizing amplitudes:  84%|████████▍ | 13794/16384 [00:02<00:00, 6760.44probe position/s]Normalizing amplitudes:  88%|████████▊ | 14471/16384 [00:02<00:00, 6727.24probe position/s]Normalizing amplitudes:  92%|█████████▏| 15144/16384 [00:02<00:00, 6671.29probe position/s]Normalizing amplitudes:  97%|█████████▋| 15837/16384 [00:02<00:00, 6747.82probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6803.25probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random128_p1_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random128_p1_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.008506 in 1.214 sec
Iter: 2, Total Loss: 0.006513 in 1.251 sec
Iter: 3, Total Loss: 0.006489 in 1.099 sec
Iter: 4, Total Loss: 0.006473 in 1.051 sec
Iter: 5, Total Loss: 0.006459 in 1.156 sec
Iter: 6, Total Loss: 0.006446 in 1.048 sec
Iter: 7, Total Loss: 0.006431 in 1.110 sec
Iter: 8, Total Loss: 0.006417 in 1.069 sec
Iter: 9, Total Loss: 0.006402 in 1.048 sec
Iter: 10, Total Loss: 0.006388 in 1.028 sec
Iter: 11, Total Loss: 0.006373 in 1.031 sec
Iter: 12, Total Loss: 0.006358 in 1.040 sec
Iter: 13, Total Loss: 0.006342 in 1.055 sec
Iter: 14, Total Loss: 0.006328 in 1.071 sec
Iter: 15, Total Loss: 0.006312 in 1.078 sec
Iter: 16, Total Loss: 0.006298 in 1.109 sec
Iter: 17, Total Loss: 0.006284 in 1.066 sec
Iter: 18, Total Loss: 0.006271 in 1.066 sec
Iter: 19, Total Loss: 0.006258 in 1.063 sec
Iter: 20, Total Loss: 0.006245 in 1.064 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 1.086 with std = 0.057 sec ###
### py4DSTEM ptycho solver is finished in 22.634 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 936.42 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 128, 1, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 690/16384 [00:00<00:02, 6892.58probe position/s]Normalizing amplitudes:   8%|▊         | 1380/16384 [00:00<00:02, 6814.76probe position/s]Normalizing amplitudes:  13%|█▎        | 2075/16384 [00:00<00:02, 6873.79probe position/s]Normalizing amplitudes:  17%|█▋        | 2763/16384 [00:00<00:01, 6867.78probe position/s]Normalizing amplitudes:  21%|██        | 3458/16384 [00:00<00:01, 6894.53probe position/s]Normalizing amplitudes:  25%|██▌       | 4148/16384 [00:00<00:01, 6846.34probe position/s]Normalizing amplitudes:  29%|██▉       | 4833/16384 [00:00<00:01, 6802.64probe position/s]Normalizing amplitudes:  34%|███▎      | 5526/16384 [00:00<00:01, 6842.13probe position/s]Normalizing amplitudes:  38%|███▊      | 6211/16384 [00:00<00:01, 6444.75probe position/s]Normalizing amplitudes:  42%|████▏     | 6860/16384 [00:01<00:01, 6327.56probe position/s]Normalizing amplitudes:  46%|████▌     | 7500/16384 [00:01<00:01, 6346.72probe position/s]Normalizing amplitudes:  50%|████▉     | 8178/16384 [00:01<00:01, 6471.92probe position/s]Normalizing amplitudes:  54%|█████▍    | 8847/16384 [00:01<00:01, 6534.88probe position/s]Normalizing amplitudes:  58%|█████▊    | 9527/16384 [00:01<00:01, 6612.57probe position/s]Normalizing amplitudes:  62%|██████▏   | 10217/16384 [00:01<00:00, 6697.14probe position/s]Normalizing amplitudes:  66%|██████▋   | 10888/16384 [00:01<00:00, 5998.18probe position/s]Normalizing amplitudes:  71%|███████   | 11600/16384 [00:01<00:00, 6307.94probe position/s]Normalizing amplitudes:  75%|███████▍  | 12285/16384 [00:01<00:00, 6460.54probe position/s]Normalizing amplitudes:  79%|███████▉  | 12958/16384 [00:01<00:00, 6537.42probe position/s]Normalizing amplitudes:  83%|████████▎ | 13620/16384 [00:02<00:00, 6560.48probe position/s]Normalizing amplitudes:  87%|████████▋ | 14285/16384 [00:02<00:00, 6585.55probe position/s]Normalizing amplitudes:  91%|█████████▏| 14969/16384 [00:02<00:00, 6658.65probe position/s]Normalizing amplitudes:  96%|█████████▌| 15681/16384 [00:02<00:00, 6794.29probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6627.07probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random128_p1_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random128_p1_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.008608 in 2.432 sec
Iter: 2, Total Loss: 0.006517 in 2.377 sec
Iter: 3, Total Loss: 0.006494 in 2.424 sec
Iter: 4, Total Loss: 0.006472 in 2.429 sec
Iter: 5, Total Loss: 0.006453 in 2.385 sec
Iter: 6, Total Loss: 0.006432 in 2.366 sec
Iter: 7, Total Loss: 0.006414 in 2.344 sec
Iter: 8, Total Loss: 0.006396 in 2.374 sec
Iter: 9, Total Loss: 0.006376 in 2.388 sec
Iter: 10, Total Loss: 0.006358 in 2.360 sec
Iter: 11, Total Loss: 0.00634 in 2.389 sec
Iter: 12, Total Loss: 0.006323 in 2.433 sec
Iter: 13, Total Loss: 0.006306 in 2.422 sec
Iter: 14, Total Loss: 0.006291 in 2.412 sec
Iter: 15, Total Loss: 0.006275 in 2.385 sec
Iter: 16, Total Loss: 0.006259 in 2.422 sec
Iter: 17, Total Loss: 0.006244 in 2.401 sec
Iter: 18, Total Loss: 0.006231 in 2.410 sec
Iter: 19, Total Loss: 0.006218 in 2.372 sec
Iter: 20, Total Loss: 0.006205 in 2.440 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 2.398 with std = 0.027 sec ###
### py4DSTEM ptycho solver is finished in 53.053 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 935.41 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 128, 1, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 663/16384 [00:00<00:02, 6623.53probe position/s]Normalizing amplitudes:   8%|▊         | 1326/16384 [00:00<00:02, 5992.90probe position/s]Normalizing amplitudes:  12%|█▏        | 1930/16384 [00:00<00:02, 5801.31probe position/s]Normalizing amplitudes:  15%|█▌        | 2513/16384 [00:00<00:02, 5753.26probe position/s]Normalizing amplitudes:  19%|█▉        | 3090/16384 [00:00<00:02, 5736.07probe position/s]Normalizing amplitudes:  23%|██▎       | 3722/16384 [00:00<00:02, 5926.51probe position/s]Normalizing amplitudes:  27%|██▋       | 4411/16384 [00:00<00:01, 6232.72probe position/s]Normalizing amplitudes:  31%|███       | 5036/16384 [00:00<00:01, 6185.32probe position/s]Normalizing amplitudes:  35%|███▍      | 5661/16384 [00:00<00:01, 6205.04probe position/s]Normalizing amplitudes:  39%|███▉      | 6359/16384 [00:01<00:01, 6439.95probe position/s]Normalizing amplitudes:  43%|████▎     | 7066/16384 [00:01<00:01, 6628.52probe position/s]Normalizing amplitudes:  47%|████▋     | 7770/16384 [00:01<00:01, 6750.74probe position/s]Normalizing amplitudes:  52%|█████▏    | 8448/16384 [00:01<00:01, 6757.43probe position/s]Normalizing amplitudes:  56%|█████▌    | 9152/16384 [00:01<00:01, 6840.87probe position/s]Normalizing amplitudes:  60%|██████    | 9837/16384 [00:01<00:00, 6653.40probe position/s]Normalizing amplitudes:  64%|██████▍   | 10504/16384 [00:01<00:00, 6599.43probe position/s]Normalizing amplitudes:  68%|██████▊   | 11204/16384 [00:01<00:00, 6715.26probe position/s]Normalizing amplitudes:  73%|███████▎  | 11919/16384 [00:01<00:00, 6841.48probe position/s]Normalizing amplitudes:  77%|███████▋  | 12620/16384 [00:01<00:00, 6890.02probe position/s]Normalizing amplitudes:  81%|████████▏ | 13312/16384 [00:02<00:00, 6897.45probe position/s]Normalizing amplitudes:  85%|████████▌ | 14003/16384 [00:02<00:00, 6882.09probe position/s]Normalizing amplitudes:  90%|████████▉ | 14692/16384 [00:02<00:00, 6691.52probe position/s]Normalizing amplitudes:  94%|█████████▍| 15377/16384 [00:02<00:00, 6736.33probe position/s]Normalizing amplitudes:  98%|█████████▊| 16070/16384 [00:02<00:00, 6790.38probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6545.26probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random128_p1_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random128_p1_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.008767 in 4.521 sec
Iter: 2, Total Loss: 0.006562 in 4.417 sec
Iter: 3, Total Loss: 0.006526 in 4.438 sec
Iter: 4, Total Loss: 0.006496 in 4.437 sec
Iter: 5, Total Loss: 0.006472 in 4.361 sec
Iter: 6, Total Loss: 0.006446 in 4.382 sec
Iter: 7, Total Loss: 0.006421 in 4.336 sec
Iter: 8, Total Loss: 0.0064 in 4.370 sec
Iter: 9, Total Loss: 0.006376 in 4.328 sec
Iter: 10, Total Loss: 0.006356 in 4.414 sec
Iter: 11, Total Loss: 0.006336 in 4.398 sec
Iter: 12, Total Loss: 0.006315 in 4.411 sec
Iter: 13, Total Loss: 0.006296 in 4.384 sec
Iter: 14, Total Loss: 0.006277 in 4.368 sec
Iter: 15, Total Loss: 0.006259 in 4.631 sec
Iter: 16, Total Loss: 0.006242 in 4.462 sec
Iter: 17, Total Loss: 0.006224 in 4.381 sec
Iter: 18, Total Loss: 0.006206 in 4.350 sec
Iter: 19, Total Loss: 0.00619 in 4.317 sec
Iter: 20, Total Loss: 0.006174 in 4.364 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 4.403 with std = 0.071 sec ###
### py4DSTEM ptycho solver is finished in 1 min 29.171 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.16 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 128, 3, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 625/16384 [00:00<00:02, 6243.16probe position/s]Normalizing amplitudes:   8%|▊         | 1265/16384 [00:00<00:02, 6331.32probe position/s]Normalizing amplitudes:  12%|█▏        | 1916/16384 [00:00<00:02, 6410.43probe position/s]Normalizing amplitudes:  16%|█▌        | 2590/16384 [00:00<00:02, 6540.38probe position/s]Normalizing amplitudes:  20%|█▉        | 3261/16384 [00:00<00:01, 6598.09probe position/s]Normalizing amplitudes:  24%|██▍       | 3952/16384 [00:00<00:01, 6701.93probe position/s]Normalizing amplitudes:  28%|██▊       | 4627/16384 [00:00<00:01, 6716.24probe position/s]Normalizing amplitudes:  32%|███▏      | 5299/16384 [00:00<00:01, 6664.03probe position/s]Normalizing amplitudes:  37%|███▋      | 5981/16384 [00:00<00:01, 6710.66probe position/s]Normalizing amplitudes:  41%|████      | 6653/16384 [00:01<00:01, 6619.77probe position/s]Normalizing amplitudes:  45%|████▍     | 7316/16384 [00:01<00:01, 6575.45probe position/s]Normalizing amplitudes:  49%|████▊     | 7983/16384 [00:01<00:01, 6602.29probe position/s]Normalizing amplitudes:  53%|█████▎    | 8644/16384 [00:01<00:01, 6581.76probe position/s]Normalizing amplitudes:  57%|█████▋    | 9308/16384 [00:01<00:01, 6597.69probe position/s]Normalizing amplitudes:  61%|██████    | 10005/16384 [00:01<00:00, 6707.14probe position/s]Normalizing amplitudes:  65%|██████▌   | 10676/16384 [00:01<00:00, 6699.72probe position/s]Normalizing amplitudes:  69%|██████▉   | 11347/16384 [00:01<00:00, 6567.46probe position/s]Normalizing amplitudes:  73%|███████▎  | 12005/16384 [00:01<00:00, 6514.41probe position/s]Normalizing amplitudes:  77%|███████▋  | 12670/16384 [00:01<00:00, 6553.31probe position/s]Normalizing amplitudes:  81%|████████▏ | 13339/16384 [00:02<00:00, 6590.70probe position/s]Normalizing amplitudes:  86%|████████▌ | 14016/16384 [00:02<00:00, 6643.46probe position/s]Normalizing amplitudes:  90%|████████▉ | 14699/16384 [00:02<00:00, 6698.46probe position/s]Normalizing amplitudes:  94%|█████████▍| 15378/16384 [00:02<00:00, 6725.04probe position/s]Normalizing amplitudes:  98%|█████████▊| 16051/16384 [00:02<00:00, 6725.30probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6627.49probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random128_p3_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random128_p3_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.01481 in 2.341 sec
Iter: 2, Total Loss: 0.006463 in 2.330 sec
Iter: 3, Total Loss: 0.00638 in 2.289 sec
Iter: 4, Total Loss: 0.006321 in 2.294 sec
Iter: 5, Total Loss: 0.006269 in 2.294 sec
Iter: 6, Total Loss: 0.00622 in 2.257 sec
Iter: 7, Total Loss: 0.006172 in 2.271 sec
Iter: 8, Total Loss: 0.006127 in 2.304 sec
Iter: 9, Total Loss: 0.00608 in 2.313 sec
Iter: 10, Total Loss: 0.006037 in 2.299 sec
Iter: 11, Total Loss: 0.005994 in 2.260 sec
Iter: 12, Total Loss: 0.005954 in 2.239 sec
Iter: 13, Total Loss: 0.005915 in 2.219 sec
Iter: 14, Total Loss: 0.005878 in 2.224 sec
Iter: 15, Total Loss: 0.005842 in 2.275 sec
Iter: 16, Total Loss: 0.005807 in 2.288 sec
Iter: 17, Total Loss: 0.005775 in 2.284 sec
Iter: 18, Total Loss: 0.005744 in 2.260 sec
Iter: 19, Total Loss: 0.005714 in 2.252 sec
Iter: 20, Total Loss: 0.005685 in 2.234 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 2.276 with std = 0.033 sec ###
### py4DSTEM ptycho solver is finished in 46.561 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.15 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 128, 3, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 654/16384 [00:00<00:02, 6536.38probe position/s]Normalizing amplitudes:   8%|▊         | 1331/16384 [00:00<00:02, 6670.89probe position/s]Normalizing amplitudes:  12%|█▏        | 1999/16384 [00:00<00:02, 6644.98probe position/s]Normalizing amplitudes:  16%|█▋        | 2677/16384 [00:00<00:02, 6694.57probe position/s]Normalizing amplitudes:  21%|██        | 3367/16384 [00:00<00:01, 6765.90probe position/s]Normalizing amplitudes:  25%|██▍       | 4074/16384 [00:00<00:01, 6866.59probe position/s]Normalizing amplitudes:  29%|██▉       | 4761/16384 [00:00<00:01, 6848.22probe position/s]Normalizing amplitudes:  33%|███▎      | 5446/16384 [00:00<00:01, 6834.27probe position/s]Normalizing amplitudes:  37%|███▋      | 6130/16384 [00:00<00:01, 6823.27probe position/s]Normalizing amplitudes:  42%|████▏     | 6813/16384 [00:01<00:01, 6814.27probe position/s]Normalizing amplitudes:  46%|████▌     | 7495/16384 [00:01<00:01, 6596.65probe position/s]Normalizing amplitudes:  50%|████▉     | 8157/16384 [00:01<00:01, 6471.30probe position/s]Normalizing amplitudes:  54%|█████▎    | 8806/16384 [00:01<00:01, 6429.24probe position/s]Normalizing amplitudes:  58%|█████▊    | 9504/16384 [00:01<00:01, 6589.07probe position/s]Normalizing amplitudes:  62%|██████▏   | 10164/16384 [00:01<00:00, 6506.51probe position/s]Normalizing amplitudes:  66%|██████▌   | 10831/16384 [00:01<00:00, 6552.74probe position/s]Normalizing amplitudes:  70%|███████   | 11510/16384 [00:01<00:00, 6622.20probe position/s]Normalizing amplitudes:  74%|███████▍  | 12173/16384 [00:01<00:00, 6445.15probe position/s]Normalizing amplitudes:  78%|███████▊  | 12853/16384 [00:01<00:00, 6547.54probe position/s]Normalizing amplitudes:  83%|████████▎ | 13526/16384 [00:02<00:00, 6599.37probe position/s]Normalizing amplitudes:  87%|████████▋ | 14204/16384 [00:02<00:00, 6652.50probe position/s]Normalizing amplitudes:  91%|█████████ | 14895/16384 [00:02<00:00, 6726.87probe position/s]Normalizing amplitudes:  95%|█████████▌| 15591/16384 [00:02<00:00, 6794.39probe position/s]Normalizing amplitudes:  99%|█████████▉| 16271/16384 [00:02<00:00, 6475.83probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6627.51probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random128_p3_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random128_p3_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.01528 in 5.997 sec
Iter: 2, Total Loss: 0.006418 in 6.024 sec
Iter: 3, Total Loss: 0.006285 in 5.968 sec
Iter: 4, Total Loss: 0.006204 in 6.014 sec
Iter: 5, Total Loss: 0.006133 in 5.956 sec
Iter: 6, Total Loss: 0.006065 in 5.978 sec
Iter: 7, Total Loss: 0.006002 in 5.908 sec
Iter: 8, Total Loss: 0.005942 in 6.426 sec
Iter: 9, Total Loss: 0.005886 in 5.989 sec
Iter: 10, Total Loss: 0.005832 in 5.940 sec
Iter: 11, Total Loss: 0.005782 in 5.887 sec
Iter: 12, Total Loss: 0.005737 in 5.928 sec
Iter: 13, Total Loss: 0.005693 in 5.884 sec
Iter: 14, Total Loss: 0.005654 in 5.837 sec
Iter: 15, Total Loss: 0.005617 in 5.862 sec
Iter: 16, Total Loss: 0.005584 in 5.953 sec
Iter: 17, Total Loss: 0.005553 in 6.017 sec
Iter: 18, Total Loss: 0.005525 in 5.969 sec
Iter: 19, Total Loss: 0.0055 in 6.283 sec
Iter: 20, Total Loss: 0.005477 in 6.166 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 5.999 with std = 0.139 sec ###
### py4DSTEM ptycho solver is finished in 2 min 1.348 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 936.42 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 128, 3, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 647/16384 [00:00<00:02, 6465.72probe position/s]Normalizing amplitudes:   8%|▊         | 1294/16384 [00:00<00:02, 6325.74probe position/s]Normalizing amplitudes:  12%|█▏        | 1927/16384 [00:00<00:02, 6188.10probe position/s]Normalizing amplitudes:  16%|█▌        | 2557/16384 [00:00<00:02, 6228.67probe position/s]Normalizing amplitudes:  20%|█▉        | 3235/16384 [00:00<00:02, 6423.59probe position/s]Normalizing amplitudes:  24%|██▍       | 3914/16384 [00:00<00:01, 6544.46probe position/s]Normalizing amplitudes:  28%|██▊       | 4569/16384 [00:00<00:01, 6545.85probe position/s]Normalizing amplitudes:  32%|███▏      | 5249/16384 [00:00<00:01, 6624.51probe position/s]Normalizing amplitudes:  36%|███▋      | 5971/16384 [00:00<00:01, 6809.39probe position/s]Normalizing amplitudes:  41%|████      | 6653/16384 [00:01<00:01, 6725.64probe position/s]Normalizing amplitudes:  45%|████▍     | 7326/16384 [00:01<00:01, 6725.97probe position/s]Normalizing amplitudes:  49%|████▉     | 8015/16384 [00:01<00:01, 6774.26probe position/s]Normalizing amplitudes:  53%|█████▎    | 8703/16384 [00:01<00:01, 6804.72probe position/s]Normalizing amplitudes:  57%|█████▋    | 9405/16384 [00:01<00:01, 6867.33probe position/s]Normalizing amplitudes:  62%|██████▏   | 10092/16384 [00:01<00:00, 6826.34probe position/s]Normalizing amplitudes:  66%|██████▌   | 10775/16384 [00:01<00:00, 6795.06probe position/s]Normalizing amplitudes:  70%|███████   | 11478/16384 [00:01<00:00, 6862.13probe position/s]Normalizing amplitudes:  74%|███████▍  | 12203/16384 [00:01<00:00, 6974.23probe position/s]Normalizing amplitudes:  79%|███████▊  | 12901/16384 [00:01<00:00, 6896.87probe position/s]Normalizing amplitudes:  83%|████████▎ | 13594/16384 [00:02<00:00, 6906.18probe position/s]Normalizing amplitudes:  87%|████████▋ | 14285/16384 [00:02<00:00, 6895.72probe position/s]Normalizing amplitudes:  91%|█████████▏| 14975/16384 [00:02<00:00, 6887.98probe position/s]Normalizing amplitudes:  96%|█████████▌| 15669/16384 [00:02<00:00, 6901.19probe position/s]Normalizing amplitudes: 100%|█████████▉| 16371/16384 [00:02<00:00, 6933.25probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6755.18probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random128_p3_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random128_p3_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.01596 in 11.561 sec
Iter: 2, Total Loss: 0.0064 in 11.495 sec
Iter: 3, Total Loss: 0.006264 in 11.559 sec
Iter: 4, Total Loss: 0.006181 in 11.526 sec
Iter: 5, Total Loss: 0.006104 in 11.519 sec
Iter: 6, Total Loss: 0.006031 in 11.613 sec
Iter: 7, Total Loss: 0.005961 in 11.505 sec
Iter: 8, Total Loss: 0.005895 in 11.513 sec
Iter: 9, Total Loss: 0.005831 in 11.545 sec
Iter: 10, Total Loss: 0.005771 in 11.475 sec
Iter: 11, Total Loss: 0.005715 in 11.652 sec
Iter: 12, Total Loss: 0.005662 in 11.507 sec
Iter: 13, Total Loss: 0.005613 in 11.541 sec
Iter: 14, Total Loss: 0.005569 in 11.452 sec
Iter: 15, Total Loss: 0.005528 in 11.599 sec
Iter: 16, Total Loss: 0.005492 in 11.699 sec
Iter: 17, Total Loss: 0.005458 in 11.511 sec
Iter: 18, Total Loss: 0.005428 in 11.712 sec
Iter: 19, Total Loss: 0.005401 in 12.875 sec
Iter: 20, Total Loss: 0.005376 in 11.570 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 11.621 with std = 0.296 sec ###
### py4DSTEM ptycho solver is finished in 3 min 53.897 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 936.25 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 128, 6, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 703/16384 [00:00<00:02, 7020.77probe position/s]Normalizing amplitudes:   9%|▊         | 1406/16384 [00:00<00:02, 6808.74probe position/s]Normalizing amplitudes:  13%|█▎        | 2098/16384 [00:00<00:02, 6858.42probe position/s]Normalizing amplitudes:  17%|█▋        | 2809/16384 [00:00<00:01, 6954.58probe position/s]Normalizing amplitudes:  21%|██▏       | 3518/16384 [00:00<00:01, 6999.45probe position/s]Normalizing amplitudes:  26%|██▌       | 4219/16384 [00:00<00:01, 6962.03probe position/s]Normalizing amplitudes:  30%|███       | 4917/16384 [00:00<00:01, 6966.81probe position/s]Normalizing amplitudes:  34%|███▍      | 5614/16384 [00:00<00:01, 6903.78probe position/s]Normalizing amplitudes:  38%|███▊      | 6305/16384 [00:00<00:01, 6872.74probe position/s]Normalizing amplitudes:  43%|████▎     | 6993/16384 [00:01<00:01, 6676.69probe position/s]Normalizing amplitudes:  47%|████▋     | 7694/16384 [00:01<00:01, 6774.30probe position/s]Normalizing amplitudes:  51%|█████     | 8396/16384 [00:01<00:01, 6845.88probe position/s]Normalizing amplitudes:  56%|█████▌    | 9117/16384 [00:01<00:01, 6954.52probe position/s]Normalizing amplitudes:  60%|█████▉    | 9830/16384 [00:01<00:00, 7006.87probe position/s]Normalizing amplitudes:  64%|██████▍   | 10532/16384 [00:01<00:00, 6933.93probe position/s]Normalizing amplitudes:  69%|██████▊   | 11226/16384 [00:01<00:00, 6858.19probe position/s]Normalizing amplitudes:  73%|███████▎  | 11935/16384 [00:01<00:00, 6925.00probe position/s]Normalizing amplitudes:  77%|███████▋  | 12644/16384 [00:01<00:00, 6972.12probe position/s]Normalizing amplitudes:  81%|████████▏ | 13348/16384 [00:01<00:00, 6987.93probe position/s]Normalizing amplitudes:  86%|████████▌ | 14048/16384 [00:02<00:00, 6955.30probe position/s]Normalizing amplitudes:  90%|████████▉ | 14744/16384 [00:02<00:00, 6890.60probe position/s]Normalizing amplitudes:  94%|█████████▍| 15453/16384 [00:02<00:00, 6947.51probe position/s]Normalizing amplitudes:  99%|█████████▊| 16158/16384 [00:02<00:00, 6977.37probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6919.36probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random128_p6_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random128_p6_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.03172 in 4.161 sec
Iter: 2, Total Loss: 0.006511 in 4.246 sec
Iter: 3, Total Loss: 0.006385 in 4.133 sec
Iter: 4, Total Loss: 0.006308 in 4.074 sec
Iter: 5, Total Loss: 0.006242 in 4.058 sec
Iter: 6, Total Loss: 0.006182 in 4.172 sec
Iter: 7, Total Loss: 0.006122 in 4.133 sec
Iter: 8, Total Loss: 0.006065 in 4.092 sec
Iter: 9, Total Loss: 0.006007 in 4.070 sec
Iter: 10, Total Loss: 0.00595 in 4.140 sec
Iter: 11, Total Loss: 0.005895 in 4.118 sec
Iter: 12, Total Loss: 0.005843 in 4.089 sec
Iter: 13, Total Loss: 0.005793 in 4.144 sec
Iter: 14, Total Loss: 0.005746 in 4.083 sec
Iter: 15, Total Loss: 0.005702 in 4.096 sec
Iter: 16, Total Loss: 0.00566 in 4.102 sec
Iter: 17, Total Loss: 0.005622 in 4.104 sec
Iter: 18, Total Loss: 0.005586 in 4.153 sec
Iter: 19, Total Loss: 0.005553 in 4.113 sec
Iter: 20, Total Loss: 0.005522 in 4.094 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 4.119 with std = 0.042 sec ###
### py4DSTEM ptycho solver is finished in 1 min 23.334 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 933.94 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 128, 6, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 695/16384 [00:00<00:02, 6945.40probe position/s]Normalizing amplitudes:   8%|▊         | 1390/16384 [00:00<00:02, 6737.15probe position/s]Normalizing amplitudes:  13%|█▎        | 2065/16384 [00:00<00:02, 6674.07probe position/s]Normalizing amplitudes:  17%|█▋        | 2749/16384 [00:00<00:02, 6736.18probe position/s]Normalizing amplitudes:  21%|██        | 3433/16384 [00:00<00:01, 6769.95probe position/s]Normalizing amplitudes:  25%|██▌       | 4111/16384 [00:00<00:01, 6715.83probe position/s]Normalizing amplitudes:  29%|██▉       | 4788/16384 [00:00<00:01, 6731.75probe position/s]Normalizing amplitudes:  33%|███▎      | 5462/16384 [00:00<00:01, 6724.63probe position/s]Normalizing amplitudes:  38%|███▊      | 6161/16384 [00:00<00:01, 6804.62probe position/s]Normalizing amplitudes:  42%|████▏     | 6842/16384 [00:01<00:01, 6680.13probe position/s]Normalizing amplitudes:  46%|████▌     | 7511/16384 [00:01<00:01, 6529.57probe position/s]Normalizing amplitudes:  50%|█████     | 8194/16384 [00:01<00:01, 6617.79probe position/s]Normalizing amplitudes:  54%|█████▍    | 8858/16384 [00:01<00:01, 6622.52probe position/s]Normalizing amplitudes:  58%|█████▊    | 9532/16384 [00:01<00:01, 6656.27probe position/s]Normalizing amplitudes:  62%|██████▏   | 10199/16384 [00:01<00:00, 6639.28probe position/s]Normalizing amplitudes:  66%|██████▋   | 10880/16384 [00:01<00:00, 6689.04probe position/s]Normalizing amplitudes:  71%|███████   | 11578/16384 [00:01<00:00, 6775.35probe position/s]Normalizing amplitudes:  75%|███████▍  | 12260/16384 [00:01<00:00, 6786.58probe position/s]Normalizing amplitudes:  79%|███████▉  | 12940/16384 [00:01<00:00, 6788.76probe position/s]Normalizing amplitudes:  83%|████████▎ | 13619/16384 [00:02<00:00, 6588.52probe position/s]Normalizing amplitudes:  87%|████████▋ | 14286/16384 [00:02<00:00, 6610.14probe position/s]Normalizing amplitudes:  91%|█████████▏| 14972/16384 [00:02<00:00, 6682.54probe position/s]Normalizing amplitudes:  96%|█████████▌| 15657/16384 [00:02<00:00, 6731.95probe position/s]Normalizing amplitudes: 100%|█████████▉| 16331/16384 [00:02<00:00, 6725.71probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6699.20probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random128_p6_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random128_p6_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.03321 in 11.891 sec
Iter: 2, Total Loss: 0.006608 in 11.880 sec
Iter: 3, Total Loss: 0.006274 in 11.731 sec
Iter: 4, Total Loss: 0.006147 in 11.540 sec
Iter: 5, Total Loss: 0.006055 in 11.545 sec
Iter: 6, Total Loss: 0.005972 in 11.417 sec
Iter: 7, Total Loss: 0.005894 in 11.532 sec
Iter: 8, Total Loss: 0.005819 in 11.561 sec
Iter: 9, Total Loss: 0.005749 in 11.440 sec
Iter: 10, Total Loss: 0.005682 in 11.625 sec
Iter: 11, Total Loss: 0.00562 in 11.303 sec
Iter: 12, Total Loss: 0.005562 in 11.886 sec
Iter: 13, Total Loss: 0.005508 in 11.452 sec
Iter: 14, Total Loss: 0.005459 in 11.522 sec
Iter: 15, Total Loss: 0.005413 in 11.493 sec
Iter: 16, Total Loss: 0.005371 in 11.459 sec
Iter: 17, Total Loss: 0.005333 in 11.587 sec
Iter: 18, Total Loss: 0.005298 in 11.477 sec
Iter: 19, Total Loss: 0.005265 in 11.632 sec
Iter: 20, Total Loss: 0.005235 in 11.709 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 11.584 with std = 0.159 sec ###
### py4DSTEM ptycho solver is finished in 3 min 52.798 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.18 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 128, 6, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 668/16384 [00:00<00:02, 6679.21probe position/s]Normalizing amplitudes:   8%|▊         | 1337/16384 [00:00<00:02, 6682.66probe position/s]Normalizing amplitudes:  12%|█▏        | 2006/16384 [00:00<00:02, 6580.52probe position/s]Normalizing amplitudes:  16%|█▋        | 2666/16384 [00:00<00:02, 6586.09probe position/s]Normalizing amplitudes:  20%|██        | 3351/16384 [00:00<00:01, 6678.84probe position/s]Normalizing amplitudes:  25%|██▍       | 4020/16384 [00:00<00:01, 6652.00probe position/s]Normalizing amplitudes:  29%|██▊       | 4688/16384 [00:00<00:01, 6660.19probe position/s]Normalizing amplitudes:  33%|███▎      | 5355/16384 [00:00<00:01, 6643.93probe position/s]Normalizing amplitudes:  37%|███▋      | 6025/16384 [00:00<00:01, 6658.00probe position/s]Normalizing amplitudes:  41%|████      | 6730/16384 [00:01<00:01, 6778.12probe position/s]Normalizing amplitudes:  45%|████▌     | 7408/16384 [00:01<00:01, 6600.65probe position/s]Normalizing amplitudes:  49%|████▉     | 8070/16384 [00:01<00:01, 6574.55probe position/s]Normalizing amplitudes:  53%|█████▎    | 8729/16384 [00:01<00:01, 6502.27probe position/s]Normalizing amplitudes:  57%|█████▋    | 9391/16384 [00:01<00:01, 6535.64probe position/s]Normalizing amplitudes:  61%|██████▏   | 10060/16384 [00:01<00:00, 6580.85probe position/s]Normalizing amplitudes:  66%|██████▌   | 10736/16384 [00:01<00:00, 6633.30probe position/s]Normalizing amplitudes:  70%|██████▉   | 11412/16384 [00:01<00:00, 6669.96probe position/s]Normalizing amplitudes:  74%|███████▍  | 12090/16384 [00:01<00:00, 6701.79probe position/s]Normalizing amplitudes:  78%|███████▊  | 12780/16384 [00:01<00:00, 6760.05probe position/s]Normalizing amplitudes:  82%|████████▏ | 13457/16384 [00:02<00:00, 6520.92probe position/s]Normalizing amplitudes:  86%|████████▌ | 14127/16384 [00:02<00:00, 6571.32probe position/s]Normalizing amplitudes:  90%|█████████ | 14794/16384 [00:02<00:00, 6598.04probe position/s]Normalizing amplitudes:  94%|█████████▍| 15472/16384 [00:02<00:00, 6651.38probe position/s]Normalizing amplitudes:  99%|█████████▊| 16142/16384 [00:02<00:00, 6664.13probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6634.59probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random128_p6_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random128_p6_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.03428 in 22.640 sec
Iter: 2, Total Loss: 0.006594 in 22.357 sec
Iter: 3, Total Loss: 0.006195 in 22.557 sec
Iter: 4, Total Loss: 0.006057 in 22.283 sec
Iter: 5, Total Loss: 0.005956 in 24.267 sec
Iter: 6, Total Loss: 0.005866 in 22.209 sec
Iter: 7, Total Loss: 0.005785 in 22.295 sec
Iter: 8, Total Loss: 0.005711 in 22.296 sec
Iter: 9, Total Loss: 0.005644 in 22.480 sec
Iter: 10, Total Loss: 0.005582 in 22.467 sec
Iter: 11, Total Loss: 0.005525 in 22.227 sec
Iter: 12, Total Loss: 0.005474 in 22.182 sec
Iter: 13, Total Loss: 0.005427 in 22.635 sec
Iter: 14, Total Loss: 0.005384 in 22.282 sec
Iter: 15, Total Loss: 0.005345 in 22.318 sec
Iter: 16, Total Loss: 0.005309 in 22.494 sec
Iter: 17, Total Loss: 0.005275 in 22.194 sec
Iter: 18, Total Loss: 0.005244 in 22.348 sec
Iter: 19, Total Loss: 0.005216 in 21.894 sec
Iter: 20, Total Loss: 0.005188 in 22.585 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 22.451 with std = 0.453 sec ###
### py4DSTEM ptycho solver is finished in 7 min 30.231 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.14 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 128, 12, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 649/16384 [00:00<00:02, 6487.84probe position/s]Normalizing amplitudes:   8%|▊         | 1312/16384 [00:00<00:02, 6568.93probe position/s]Normalizing amplitudes:  12%|█▏        | 1989/16384 [00:00<00:02, 6660.33probe position/s]Normalizing amplitudes:  16%|█▋        | 2663/16384 [00:00<00:02, 6690.29probe position/s]Normalizing amplitudes:  20%|██        | 3348/16384 [00:00<00:01, 6745.63probe position/s]Normalizing amplitudes:  25%|██▍       | 4023/16384 [00:00<00:01, 6634.09probe position/s]Normalizing amplitudes:  29%|██▊       | 4704/16384 [00:00<00:01, 6689.77probe position/s]Normalizing amplitudes:  33%|███▎      | 5381/16384 [00:00<00:01, 6713.54probe position/s]Normalizing amplitudes:  37%|███▋      | 6055/16384 [00:00<00:01, 6721.21probe position/s]Normalizing amplitudes:  41%|████      | 6728/16384 [00:01<00:01, 6650.28probe position/s]Normalizing amplitudes:  45%|████▌     | 7410/16384 [00:01<00:01, 6699.50probe position/s]Normalizing amplitudes:  50%|████▉     | 8127/16384 [00:01<00:01, 6840.21probe position/s]Normalizing amplitudes:  54%|█████▍    | 8825/16384 [00:01<00:01, 6880.61probe position/s]Normalizing amplitudes:  58%|█████▊    | 9514/16384 [00:01<00:01, 6840.58probe position/s]Normalizing amplitudes:  62%|██████▏   | 10199/16384 [00:01<00:00, 6782.79probe position/s]Normalizing amplitudes:  66%|██████▋   | 10883/16384 [00:01<00:00, 6797.37probe position/s]Normalizing amplitudes:  71%|███████   | 11563/16384 [00:01<00:00, 6789.30probe position/s]Normalizing amplitudes:  75%|███████▍  | 12257/16384 [00:01<00:00, 6831.03probe position/s]Normalizing amplitudes:  79%|███████▉  | 12941/16384 [00:01<00:00, 6789.11probe position/s]Normalizing amplitudes:  83%|████████▎ | 13633/16384 [00:02<00:00, 6827.41probe position/s]Normalizing amplitudes:  87%|████████▋ | 14316/16384 [00:02<00:00, 6742.09probe position/s]Normalizing amplitudes:  92%|█████████▏| 15020/16384 [00:02<00:00, 6828.82probe position/s]Normalizing amplitudes:  96%|█████████▌| 15714/16384 [00:02<00:00, 6860.45probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6769.13probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random128_p12_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random128_p12_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.07479 in 7.920 sec
Iter: 2, Total Loss: 0.006561 in 7.863 sec
Iter: 3, Total Loss: 0.006401 in 7.855 sec
Iter: 4, Total Loss: 0.006317 in 7.852 sec
Iter: 5, Total Loss: 0.006251 in 7.943 sec
Iter: 6, Total Loss: 0.006193 in 7.869 sec
Iter: 7, Total Loss: 0.006137 in 7.870 sec
Iter: 8, Total Loss: 0.006084 in 7.845 sec
Iter: 9, Total Loss: 0.00603 in 7.836 sec
Iter: 10, Total Loss: 0.005979 in 7.998 sec
Iter: 11, Total Loss: 0.005927 in 7.744 sec
Iter: 12, Total Loss: 0.005877 in 7.735 sec
Iter: 13, Total Loss: 0.005828 in 7.697 sec
Iter: 14, Total Loss: 0.005781 in 7.696 sec
Iter: 15, Total Loss: 0.005734 in 7.859 sec
Iter: 16, Total Loss: 0.00569 in 7.670 sec
Iter: 17, Total Loss: 0.005648 in 7.686 sec
Iter: 18, Total Loss: 0.005608 in 7.865 sec
Iter: 19, Total Loss: 0.005569 in 7.625 sec
Iter: 20, Total Loss: 0.005533 in 7.638 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 7.803 with std = 0.105 sec ###
### py4DSTEM ptycho solver is finished in 2 min 37.050 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.11 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 128, 12, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 668/16384 [00:00<00:02, 6672.59probe position/s]Normalizing amplitudes:   8%|▊         | 1344/16384 [00:00<00:02, 6719.88probe position/s]Normalizing amplitudes:  12%|█▏        | 2020/16384 [00:00<00:02, 6735.66probe position/s]Normalizing amplitudes:  17%|█▋        | 2708/16384 [00:00<00:02, 6789.05probe position/s]Normalizing amplitudes:  21%|██        | 3411/16384 [00:00<00:01, 6872.89probe position/s]Normalizing amplitudes:  25%|██▌       | 4114/16384 [00:00<00:01, 6924.36probe position/s]Normalizing amplitudes:  29%|██▉       | 4807/16384 [00:00<00:01, 6868.65probe position/s]Normalizing amplitudes:  34%|███▎      | 5494/16384 [00:00<00:01, 6621.92probe position/s]Normalizing amplitudes:  38%|███▊      | 6158/16384 [00:00<00:01, 6391.48probe position/s]Normalizing amplitudes:  42%|████▏     | 6835/16384 [00:01<00:01, 6502.78probe position/s]Normalizing amplitudes:  46%|████▌     | 7505/16384 [00:01<00:01, 6561.04probe position/s]Normalizing amplitudes:  50%|█████     | 8209/16384 [00:01<00:01, 6702.45probe position/s]Normalizing amplitudes:  54%|█████▍    | 8924/16384 [00:01<00:01, 6833.96probe position/s]Normalizing amplitudes:  59%|█████▊    | 9614/16384 [00:01<00:00, 6853.16probe position/s]Normalizing amplitudes:  63%|██████▎   | 10307/16384 [00:01<00:00, 6875.43probe position/s]Normalizing amplitudes:  67%|██████▋   | 10996/16384 [00:01<00:00, 6846.89probe position/s]Normalizing amplitudes:  71%|███████▏  | 11697/16384 [00:01<00:00, 6893.23probe position/s]Normalizing amplitudes:  76%|███████▌  | 12387/16384 [00:01<00:00, 6863.45probe position/s]Normalizing amplitudes:  80%|███████▉  | 13089/16384 [00:01<00:00, 6908.35probe position/s]Normalizing amplitudes:  84%|████████▍ | 13817/16384 [00:02<00:00, 7018.38probe position/s]Normalizing amplitudes:  89%|████████▊ | 14520/16384 [00:02<00:00, 7012.13probe position/s]Normalizing amplitudes:  93%|█████████▎| 15222/16384 [00:02<00:00, 6988.64probe position/s]Normalizing amplitudes:  97%|█████████▋| 15921/16384 [00:02<00:00, 6901.16probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6818.45probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random128_p12_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random128_p12_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.07505 in 22.644 sec
Iter: 2, Total Loss: 0.006584 in 22.364 sec
Iter: 3, Total Loss: 0.006254 in 22.278 sec
Iter: 4, Total Loss: 0.006115 in 22.401 sec
Iter: 5, Total Loss: 0.006007 in 22.709 sec
Iter: 6, Total Loss: 0.00591 in 22.373 sec
Iter: 7, Total Loss: 0.005818 in 22.468 sec
Iter: 8, Total Loss: 0.005733 in 22.479 sec
Iter: 9, Total Loss: 0.005657 in 22.486 sec
Iter: 10, Total Loss: 0.005586 in 22.607 sec
Iter: 11, Total Loss: 0.005523 in 22.488 sec
Iter: 12, Total Loss: 0.005466 in 22.287 sec
Iter: 13, Total Loss: 0.005413 in 22.754 sec
Iter: 14, Total Loss: 0.005366 in 22.524 sec
Iter: 15, Total Loss: 0.005321 in 22.537 sec
Iter: 16, Total Loss: 0.00528 in 22.708 sec
Iter: 17, Total Loss: 0.005241 in 23.378 sec
Iter: 18, Total Loss: 0.005203 in 23.042 sec
Iter: 19, Total Loss: 0.005168 in 22.696 sec
Iter: 20, Total Loss: 0.005135 in 22.868 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 22.604 with std = 0.259 sec ###
### py4DSTEM ptycho solver is finished in 7 min 33.334 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.05 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 128, 12, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 682/16384 [00:00<00:02, 6816.30probe position/s]Normalizing amplitudes:   8%|▊         | 1364/16384 [00:00<00:02, 6789.82probe position/s]Normalizing amplitudes:  13%|█▎        | 2050/16384 [00:00<00:02, 6820.34probe position/s]Normalizing amplitudes:  17%|█▋        | 2733/16384 [00:00<00:02, 6771.83probe position/s]Normalizing amplitudes:  21%|██        | 3411/16384 [00:00<00:01, 6757.16probe position/s]Normalizing amplitudes:  25%|██▌       | 4100/16384 [00:00<00:01, 6799.26probe position/s]Normalizing amplitudes:  29%|██▉       | 4793/16384 [00:00<00:01, 6837.99probe position/s]Normalizing amplitudes:  33%|███▎      | 5477/16384 [00:00<00:01, 6825.64probe position/s]Normalizing amplitudes:  38%|███▊      | 6160/16384 [00:00<00:01, 6717.26probe position/s]Normalizing amplitudes:  42%|████▏     | 6848/16384 [00:01<00:01, 6764.03probe position/s]Normalizing amplitudes:  46%|████▌     | 7525/16384 [00:01<00:01, 6752.13probe position/s]Normalizing amplitudes:  50%|█████     | 8209/16384 [00:01<00:01, 6776.63probe position/s]Normalizing amplitudes:  54%|█████▍    | 8887/16384 [00:01<00:01, 6765.59probe position/s]Normalizing amplitudes:  58%|█████▊    | 9569/16384 [00:01<00:01, 6779.46probe position/s]Normalizing amplitudes:  63%|██████▎   | 10261/16384 [00:01<00:00, 6820.02probe position/s]Normalizing amplitudes:  67%|██████▋   | 10944/16384 [00:01<00:00, 6715.32probe position/s]Normalizing amplitudes:  71%|███████   | 11619/16384 [00:01<00:00, 6724.45probe position/s]Normalizing amplitudes:  75%|███████▌  | 12304/16384 [00:01<00:00, 6761.46probe position/s]Normalizing amplitudes:  79%|███████▉  | 12992/16384 [00:01<00:00, 6794.68probe position/s]Normalizing amplitudes:  83%|████████▎ | 13676/16384 [00:02<00:00, 6806.78probe position/s]Normalizing amplitudes:  88%|████████▊ | 14357/16384 [00:02<00:00, 6803.85probe position/s]Normalizing amplitudes:  92%|█████████▏| 15047/16384 [00:02<00:00, 6832.51probe position/s]Normalizing amplitudes:  96%|█████████▌| 15756/16384 [00:02<00:00, 6906.80probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6809.06probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random128_p12_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random128_p12_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.07723 in 44.311 sec
Iter: 2, Total Loss: 0.006769 in 44.205 sec
Iter: 3, Total Loss: 0.006223 in 44.065 sec
Iter: 4, Total Loss: 0.00606 in 44.354 sec
Iter: 5, Total Loss: 0.005945 in 44.137 sec
Iter: 6, Total Loss: 0.005846 in 44.379 sec
Iter: 7, Total Loss: 0.005757 in 45.121 sec
Iter: 8, Total Loss: 0.005674 in 44.394 sec
Iter: 9, Total Loss: 0.005599 in 43.931 sec
Iter: 10, Total Loss: 0.005529 in 44.470 sec
Iter: 11, Total Loss: 0.005467 in 44.618 sec
Iter: 12, Total Loss: 0.00541 in 44.663 sec
Iter: 13, Total Loss: 0.005359 in 44.524 sec
Iter: 14, Total Loss: 0.005313 in 44.416 sec
Iter: 15, Total Loss: 0.005271 in 44.184 sec
Iter: 16, Total Loss: 0.005232 in 44.610 sec
Iter: 17, Total Loss: 0.005197 in 43.979 sec
Iter: 18, Total Loss: 0.005163 in 44.066 sec
Iter: 19, Total Loss: 0.005132 in 44.171 sec
Iter: 20, Total Loss: 0.005103 in 44.498 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 44.355 with std = 0.274 sec ###
### py4DSTEM ptycho solver is finished in 14 min 48.310 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 935.92 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 64, 1, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 687/16384 [00:00<00:02, 6864.18probe position/s]Normalizing amplitudes:   8%|▊         | 1374/16384 [00:00<00:02, 6740.02probe position/s]Normalizing amplitudes:  13%|█▎        | 2049/16384 [00:00<00:02, 6692.09probe position/s]Normalizing amplitudes:  17%|█▋        | 2719/16384 [00:00<00:02, 6679.99probe position/s]Normalizing amplitudes:  21%|██        | 3388/16384 [00:00<00:01, 6678.63probe position/s]Normalizing amplitudes:  25%|██▍       | 4056/16384 [00:00<00:01, 6677.75probe position/s]Normalizing amplitudes:  29%|██▉       | 4730/16384 [00:00<00:01, 6697.48probe position/s]Normalizing amplitudes:  33%|███▎      | 5406/16384 [00:00<00:01, 6716.62probe position/s]Normalizing amplitudes:  37%|███▋      | 6078/16384 [00:00<00:01, 6704.00probe position/s]Normalizing amplitudes:  41%|████▏     | 6763/16384 [00:01<00:01, 6747.46probe position/s]Normalizing amplitudes:  46%|████▌     | 7468/16384 [00:01<00:01, 6839.49probe position/s]Normalizing amplitudes:  50%|████▉     | 8169/16384 [00:01<00:01, 6890.50probe position/s]Normalizing amplitudes:  54%|█████▍    | 8859/16384 [00:01<00:01, 6841.44probe position/s]Normalizing amplitudes:  58%|█████▊    | 9544/16384 [00:01<00:01, 6832.01probe position/s]Normalizing amplitudes:  62%|██████▏   | 10229/16384 [00:01<00:00, 6836.30probe position/s]Normalizing amplitudes:  67%|██████▋   | 10913/16384 [00:01<00:00, 6786.19probe position/s]Normalizing amplitudes:  71%|███████   | 11592/16384 [00:01<00:00, 6771.26probe position/s]Normalizing amplitudes:  75%|███████▍  | 12270/16384 [00:01<00:00, 6758.72probe position/s]Normalizing amplitudes:  79%|███████▉  | 12972/16384 [00:01<00:00, 6832.17probe position/s]Normalizing amplitudes:  83%|████████▎ | 13658/16384 [00:02<00:00, 6840.31probe position/s]Normalizing amplitudes:  88%|████████▊ | 14343/16384 [00:02<00:00, 6818.66probe position/s]Normalizing amplitudes:  92%|█████████▏| 15030/16384 [00:02<00:00, 6833.71probe position/s]Normalizing amplitudes:  96%|█████████▌| 15714/16384 [00:02<00:00, 6791.09probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6775.40probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random64_p1_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random64_p1_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.007547 in 1.791 sec
Iter: 2, Total Loss: 0.006521 in 1.702 sec
Iter: 3, Total Loss: 0.006489 in 1.729 sec
Iter: 4, Total Loss: 0.006463 in 1.717 sec
Iter: 5, Total Loss: 0.006435 in 1.722 sec
Iter: 6, Total Loss: 0.006407 in 1.743 sec
Iter: 7, Total Loss: 0.006378 in 1.721 sec
Iter: 8, Total Loss: 0.006349 in 1.735 sec
Iter: 9, Total Loss: 0.006321 in 1.764 sec
Iter: 10, Total Loss: 0.006295 in 1.742 sec
Iter: 11, Total Loss: 0.00627 in 1.747 sec
Iter: 12, Total Loss: 0.006247 in 1.727 sec
Iter: 13, Total Loss: 0.006225 in 1.731 sec
Iter: 14, Total Loss: 0.006207 in 1.730 sec
Iter: 15, Total Loss: 0.00619 in 1.723 sec
Iter: 16, Total Loss: 0.006173 in 1.720 sec
Iter: 17, Total Loss: 0.006159 in 1.730 sec
Iter: 18, Total Loss: 0.006146 in 1.748 sec
Iter: 19, Total Loss: 0.006134 in 1.736 sec
Iter: 20, Total Loss: 0.006125 in 1.743 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 1.735 with std = 0.018 sec ###
### py4DSTEM ptycho solver is finished in 35.705 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.03 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 64, 1, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 687/16384 [00:00<00:02, 6859.54probe position/s]Normalizing amplitudes:   8%|▊         | 1392/16384 [00:00<00:02, 6966.67probe position/s]Normalizing amplitudes:  13%|█▎        | 2089/16384 [00:00<00:02, 6809.84probe position/s]Normalizing amplitudes:  17%|█▋        | 2771/16384 [00:00<00:02, 6738.95probe position/s]Normalizing amplitudes:  21%|██        | 3447/16384 [00:00<00:01, 6743.23probe position/s]Normalizing amplitudes:  25%|██▌       | 4122/16384 [00:00<00:01, 6681.68probe position/s]Normalizing amplitudes:  29%|██▉       | 4814/16384 [00:00<00:01, 6755.98probe position/s]Normalizing amplitudes:  34%|███▎      | 5499/16384 [00:00<00:01, 6783.39probe position/s]Normalizing amplitudes:  38%|███▊      | 6178/16384 [00:00<00:01, 6744.33probe position/s]Normalizing amplitudes:  42%|████▏     | 6853/16384 [00:01<00:01, 6722.04probe position/s]Normalizing amplitudes:  46%|████▌     | 7550/16384 [00:01<00:01, 6796.94probe position/s]Normalizing amplitudes:  50%|█████     | 8242/16384 [00:01<00:01, 6832.77probe position/s]Normalizing amplitudes:  54%|█████▍    | 8927/16384 [00:01<00:01, 6835.68probe position/s]Normalizing amplitudes:  59%|█████▉    | 9627/16384 [00:01<00:00, 6884.60probe position/s]Normalizing amplitudes:  63%|██████▎   | 10316/16384 [00:01<00:00, 6873.31probe position/s]Normalizing amplitudes:  67%|██████▋   | 11004/16384 [00:01<00:00, 6812.55probe position/s]Normalizing amplitudes:  71%|███████▏  | 11686/16384 [00:01<00:00, 6749.12probe position/s]Normalizing amplitudes:  76%|███████▌  | 12370/16384 [00:01<00:00, 6775.87probe position/s]Normalizing amplitudes:  80%|███████▉  | 13052/16384 [00:01<00:00, 6787.93probe position/s]Normalizing amplitudes:  84%|████████▍ | 13743/16384 [00:02<00:00, 6821.93probe position/s]Normalizing amplitudes:  88%|████████▊ | 14435/16384 [00:02<00:00, 6850.86probe position/s]Normalizing amplitudes:  92%|█████████▏| 15121/16384 [00:02<00:00, 6840.76probe position/s]Normalizing amplitudes:  96%|█████████▋| 15808/16384 [00:02<00:00, 6847.33probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6800.79probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random64_p1_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random64_p1_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.007612 in 4.088 sec
Iter: 2, Total Loss: 0.006525 in 4.090 sec
Iter: 3, Total Loss: 0.006484 in 4.039 sec
Iter: 4, Total Loss: 0.006445 in 4.002 sec
Iter: 5, Total Loss: 0.00641 in 4.058 sec
Iter: 6, Total Loss: 0.006375 in 4.044 sec
Iter: 7, Total Loss: 0.006341 in 4.035 sec
Iter: 8, Total Loss: 0.006311 in 4.006 sec
Iter: 9, Total Loss: 0.006283 in 3.964 sec
Iter: 10, Total Loss: 0.006258 in 3.988 sec
Iter: 11, Total Loss: 0.006233 in 4.008 sec
Iter: 12, Total Loss: 0.006209 in 4.012 sec
Iter: 13, Total Loss: 0.006188 in 4.168 sec
Iter: 14, Total Loss: 0.00617 in 4.020 sec
Iter: 15, Total Loss: 0.006151 in 4.005 sec
Iter: 16, Total Loss: 0.006137 in 4.032 sec
Iter: 17, Total Loss: 0.006123 in 4.283 sec
Iter: 18, Total Loss: 0.006107 in 3.919 sec
Iter: 19, Total Loss: 0.006096 in 3.977 sec
Iter: 20, Total Loss: 0.006085 in 3.957 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 4.035 with std = 0.078 sec ###
### py4DSTEM ptycho solver is finished in 1 min 21.781 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.01 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 64, 1, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 690/16384 [00:00<00:02, 6888.12probe position/s]Normalizing amplitudes:   8%|▊         | 1379/16384 [00:00<00:02, 6857.59probe position/s]Normalizing amplitudes:  13%|█▎        | 2089/16384 [00:00<00:02, 6964.41probe position/s]Normalizing amplitudes:  17%|█▋        | 2809/16384 [00:00<00:01, 7054.86probe position/s]Normalizing amplitudes:  22%|██▏       | 3523/16384 [00:00<00:01, 7083.06probe position/s]Normalizing amplitudes:  26%|██▌       | 4232/16384 [00:00<00:01, 7077.46probe position/s]Normalizing amplitudes:  30%|███       | 4940/16384 [00:00<00:01, 7000.15probe position/s]Normalizing amplitudes:  34%|███▍      | 5641/16384 [00:00<00:01, 6985.31probe position/s]Normalizing amplitudes:  39%|███▊      | 6340/16384 [00:00<00:01, 6985.39probe position/s]Normalizing amplitudes:  43%|████▎     | 7039/16384 [00:01<00:01, 6910.27probe position/s]Normalizing amplitudes:  47%|████▋     | 7731/16384 [00:01<00:01, 6848.27probe position/s]Normalizing amplitudes:  52%|█████▏    | 8440/16384 [00:01<00:01, 6918.13probe position/s]Normalizing amplitudes:  56%|█████▌    | 9157/16384 [00:01<00:01, 6991.37probe position/s]Normalizing amplitudes:  60%|██████    | 9858/16384 [00:01<00:00, 6995.46probe position/s]Normalizing amplitudes:  64%|██████▍   | 10558/16384 [00:01<00:00, 6959.82probe position/s]Normalizing amplitudes:  69%|██████▊   | 11255/16384 [00:01<00:00, 6926.10probe position/s]Normalizing amplitudes:  73%|███████▎  | 11948/16384 [00:01<00:00, 6906.95probe position/s]Normalizing amplitudes:  77%|███████▋  | 12649/16384 [00:01<00:00, 6937.11probe position/s]Normalizing amplitudes:  82%|████████▏ | 13361/16384 [00:01<00:00, 6989.33probe position/s]Normalizing amplitudes:  86%|████████▌ | 14061/16384 [00:02<00:00, 6960.30probe position/s]Normalizing amplitudes:  90%|█████████ | 14776/16384 [00:02<00:00, 7014.13probe position/s]Normalizing amplitudes:  94%|█████████▍| 15478/16384 [00:02<00:00, 6958.55probe position/s]Normalizing amplitudes:  99%|█████████▊| 16174/16384 [00:02<00:00, 6938.95probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6960.06probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random64_p1_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random64_p1_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.007732 in 7.389 sec
Iter: 2, Total Loss: 0.006579 in 7.351 sec
Iter: 3, Total Loss: 0.006521 in 7.558 sec
Iter: 4, Total Loss: 0.006473 in 7.516 sec
Iter: 5, Total Loss: 0.006429 in 7.517 sec
Iter: 6, Total Loss: 0.006391 in 7.518 sec
Iter: 7, Total Loss: 0.006354 in 8.011 sec
Iter: 8, Total Loss: 0.006323 in 7.616 sec
Iter: 9, Total Loss: 0.00629 in 7.786 sec
Iter: 10, Total Loss: 0.006258 in 7.526 sec
Iter: 11, Total Loss: 0.006231 in 7.530 sec
Iter: 12, Total Loss: 0.006205 in 7.707 sec
Iter: 13, Total Loss: 0.006183 in 7.710 sec
Iter: 14, Total Loss: 0.006158 in 7.423 sec
Iter: 15, Total Loss: 0.006136 in 7.556 sec
Iter: 16, Total Loss: 0.006119 in 7.558 sec
Iter: 17, Total Loss: 0.006101 in 8.260 sec
Iter: 18, Total Loss: 0.006077 in 7.522 sec
Iter: 19, Total Loss: 0.00606 in 7.447 sec
Iter: 20, Total Loss: 0.006046 in 7.416 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 7.596 with std = 0.212 sec ###
### py4DSTEM ptycho solver is finished in 2 min 33.192 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.17 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 64, 3, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 656/16384 [00:00<00:02, 6556.50probe position/s]Normalizing amplitudes:   8%|▊         | 1328/16384 [00:00<00:02, 6648.04probe position/s]Normalizing amplitudes:  12%|█▏        | 2018/16384 [00:00<00:02, 6761.85probe position/s]Normalizing amplitudes:  17%|█▋        | 2712/16384 [00:00<00:02, 6830.25probe position/s]Normalizing amplitudes:  21%|██        | 3396/16384 [00:00<00:01, 6794.81probe position/s]Normalizing amplitudes:  25%|██▍       | 4076/16384 [00:00<00:01, 6771.70probe position/s]Normalizing amplitudes:  29%|██▉       | 4757/16384 [00:00<00:01, 6782.11probe position/s]Normalizing amplitudes:  33%|███▎      | 5436/16384 [00:00<00:01, 6772.24probe position/s]Normalizing amplitudes:  37%|███▋      | 6121/16384 [00:00<00:01, 6793.59probe position/s]Normalizing amplitudes:  42%|████▏     | 6801/16384 [00:01<00:01, 6792.15probe position/s]Normalizing amplitudes:  46%|████▌     | 7507/16384 [00:01<00:01, 6870.89probe position/s]Normalizing amplitudes:  50%|█████     | 8206/16384 [00:01<00:01, 6905.28probe position/s]Normalizing amplitudes:  54%|█████▍    | 8897/16384 [00:01<00:01, 6855.19probe position/s]Normalizing amplitudes:  58%|█████▊    | 9583/16384 [00:01<00:00, 6841.55probe position/s]Normalizing amplitudes:  63%|██████▎   | 10276/16384 [00:01<00:00, 6866.74probe position/s]Normalizing amplitudes:  67%|██████▋   | 10967/16384 [00:01<00:00, 6879.45probe position/s]Normalizing amplitudes:  71%|███████   | 11655/16384 [00:01<00:00, 6781.74probe position/s]Normalizing amplitudes:  75%|███████▌  | 12334/16384 [00:01<00:00, 6720.32probe position/s]Normalizing amplitudes:  80%|███████▉  | 13026/16384 [00:01<00:00, 6778.61probe position/s]Normalizing amplitudes:  84%|████████▎ | 13716/16384 [00:02<00:00, 6813.57probe position/s]Normalizing amplitudes:  88%|████████▊ | 14398/16384 [00:02<00:00, 6789.42probe position/s]Normalizing amplitudes:  92%|█████████▏| 15079/16384 [00:02<00:00, 6793.08probe position/s]Normalizing amplitudes:  96%|█████████▋| 15782/16384 [00:02<00:00, 6861.31probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6806.56probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random64_p3_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random64_p3_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.01086 in 3.676 sec
Iter: 2, Total Loss: 0.006462 in 3.643 sec
Iter: 3, Total Loss: 0.006379 in 3.671 sec
Iter: 4, Total Loss: 0.006307 in 3.681 sec
Iter: 5, Total Loss: 0.006232 in 3.666 sec
Iter: 6, Total Loss: 0.006157 in 3.645 sec
Iter: 7, Total Loss: 0.006086 in 3.675 sec
Iter: 8, Total Loss: 0.00602 in 3.658 sec
Iter: 9, Total Loss: 0.005957 in 3.646 sec
Iter: 10, Total Loss: 0.0059 in 3.670 sec
Iter: 11, Total Loss: 0.005846 in 3.711 sec
Iter: 12, Total Loss: 0.005796 in 3.719 sec
Iter: 13, Total Loss: 0.005749 in 3.707 sec
Iter: 14, Total Loss: 0.005704 in 3.709 sec
Iter: 15, Total Loss: 0.005663 in 3.753 sec
Iter: 16, Total Loss: 0.005625 in 3.691 sec
Iter: 17, Total Loss: 0.005589 in 3.730 sec
Iter: 18, Total Loss: 0.005557 in 3.745 sec
Iter: 19, Total Loss: 0.005529 in 3.723 sec
Iter: 20, Total Loss: 0.005504 in 3.734 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 3.693 with std = 0.033 sec ###
### py4DSTEM ptycho solver is finished in 1 min 14.898 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.01 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 64, 3, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 647/16384 [00:00<00:02, 6467.92probe position/s]Normalizing amplitudes:   8%|▊         | 1327/16384 [00:00<00:02, 6659.08probe position/s]Normalizing amplitudes:  12%|█▏        | 2013/16384 [00:00<00:02, 6746.91probe position/s]Normalizing amplitudes:  16%|█▋        | 2688/16384 [00:00<00:02, 6726.61probe position/s]Normalizing amplitudes:  21%|██        | 3361/16384 [00:00<00:01, 6719.18probe position/s]Normalizing amplitudes:  25%|██▍       | 4070/16384 [00:00<00:01, 6842.90probe position/s]Normalizing amplitudes:  29%|██▉       | 4755/16384 [00:00<00:01, 6824.30probe position/s]Normalizing amplitudes:  33%|███▎      | 5460/16384 [00:00<00:01, 6895.81probe position/s]Normalizing amplitudes:  38%|███▊      | 6150/16384 [00:00<00:01, 6842.98probe position/s]Normalizing amplitudes:  42%|████▏     | 6835/16384 [00:01<00:01, 6807.86probe position/s]Normalizing amplitudes:  46%|████▌     | 7516/16384 [00:01<00:01, 6788.89probe position/s]Normalizing amplitudes:  50%|█████     | 8195/16384 [00:01<00:01, 6762.36probe position/s]Normalizing amplitudes:  54%|█████▍    | 8872/16384 [00:01<00:01, 6734.75probe position/s]Normalizing amplitudes:  58%|█████▊    | 9563/16384 [00:01<00:01, 6784.59probe position/s]Normalizing amplitudes:  63%|██████▎   | 10242/16384 [00:01<00:00, 6769.83probe position/s]Normalizing amplitudes:  67%|██████▋   | 10932/16384 [00:01<00:00, 6808.40probe position/s]Normalizing amplitudes:  71%|███████   | 11621/16384 [00:01<00:00, 6831.34probe position/s]Normalizing amplitudes:  75%|███████▌  | 12305/16384 [00:01<00:00, 6808.81probe position/s]Normalizing amplitudes:  79%|███████▉  | 12986/16384 [00:01<00:00, 6739.62probe position/s]Normalizing amplitudes:  83%|████████▎ | 13661/16384 [00:02<00:00, 6734.75probe position/s]Normalizing amplitudes:  88%|████████▊ | 14343/16384 [00:02<00:00, 6758.72probe position/s]Normalizing amplitudes:  92%|█████████▏| 15032/16384 [00:02<00:00, 6797.52probe position/s]Normalizing amplitudes:  96%|█████████▌| 15712/16384 [00:02<00:00, 6785.36probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6787.12probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random64_p3_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random64_p3_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.01094 in 10.169 sec
Iter: 2, Total Loss: 0.006331 in 10.141 sec
Iter: 3, Total Loss: 0.006199 in 10.165 sec
Iter: 4, Total Loss: 0.006086 in 10.008 sec
Iter: 5, Total Loss: 0.00598 in 10.069 sec
Iter: 6, Total Loss: 0.005881 in 10.462 sec
Iter: 7, Total Loss: 0.005792 in 10.070 sec
Iter: 8, Total Loss: 0.005712 in 10.219 sec
Iter: 9, Total Loss: 0.005644 in 9.906 sec
Iter: 10, Total Loss: 0.005586 in 9.985 sec
Iter: 11, Total Loss: 0.005537 in 10.088 sec
Iter: 12, Total Loss: 0.005494 in 9.819 sec
Iter: 13, Total Loss: 0.005458 in 10.044 sec
Iter: 14, Total Loss: 0.005426 in 10.001 sec
Iter: 15, Total Loss: 0.005398 in 9.904 sec
Iter: 16, Total Loss: 0.005375 in 10.046 sec
Iter: 17, Total Loss: 0.005353 in 10.223 sec
Iter: 18, Total Loss: 0.005333 in 10.200 sec
Iter: 19, Total Loss: 0.005315 in 10.083 sec
Iter: 20, Total Loss: 0.005298 in 9.992 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 10.080 with std = 0.138 sec ###
### py4DSTEM ptycho solver is finished in 3 min 22.936 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.09 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 64, 3, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 668/16384 [00:00<00:02, 6672.77probe position/s]Normalizing amplitudes:   8%|▊         | 1336/16384 [00:00<00:02, 6589.00probe position/s]Normalizing amplitudes:  12%|█▏        | 1995/16384 [00:00<00:02, 6576.72probe position/s]Normalizing amplitudes:  16%|█▋        | 2668/16384 [00:00<00:02, 6634.04probe position/s]Normalizing amplitudes:  21%|██        | 3363/16384 [00:00<00:01, 6744.55probe position/s]Normalizing amplitudes:  25%|██▍       | 4038/16384 [00:00<00:01, 6599.02probe position/s]Normalizing amplitudes:  29%|██▊       | 4699/16384 [00:00<00:01, 6551.53probe position/s]Normalizing amplitudes:  33%|███▎      | 5383/16384 [00:00<00:01, 6640.54probe position/s]Normalizing amplitudes:  37%|███▋      | 6048/16384 [00:00<00:01, 6464.84probe position/s]Normalizing amplitudes:  41%|████      | 6717/16384 [00:01<00:01, 6531.79probe position/s]Normalizing amplitudes:  45%|████▌     | 7380/16384 [00:01<00:01, 6559.40probe position/s]Normalizing amplitudes:  49%|████▉     | 8054/16384 [00:01<00:01, 6611.49probe position/s]Normalizing amplitudes:  53%|█████▎    | 8727/16384 [00:01<00:01, 6645.34probe position/s]Normalizing amplitudes:  57%|█████▋    | 9392/16384 [00:01<00:01, 6606.32probe position/s]Normalizing amplitudes:  61%|██████▏   | 10070/16384 [00:01<00:00, 6656.68probe position/s]Normalizing amplitudes:  66%|██████▌   | 10738/16384 [00:01<00:00, 6662.66probe position/s]Normalizing amplitudes:  70%|██████▉   | 11405/16384 [00:01<00:00, 6627.82probe position/s]Normalizing amplitudes:  74%|███████▎  | 12074/16384 [00:01<00:00, 6645.11probe position/s]Normalizing amplitudes:  78%|███████▊  | 12739/16384 [00:01<00:00, 6491.79probe position/s]Normalizing amplitudes:  82%|████████▏ | 13389/16384 [00:02<00:00, 6158.83probe position/s]Normalizing amplitudes:  86%|████████▌ | 14053/16384 [00:02<00:00, 6295.89probe position/s]Normalizing amplitudes:  90%|████████▉ | 14735/16384 [00:02<00:00, 6447.48probe position/s]Normalizing amplitudes:  94%|█████████▍| 15388/16384 [00:02<00:00, 6471.08probe position/s]Normalizing amplitudes:  98%|█████████▊| 16087/16384 [00:02<00:00, 6622.53probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6557.54probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random64_p3_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random64_p3_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.01163 in 19.784 sec
Iter: 2, Total Loss: 0.006315 in 19.511 sec
Iter: 3, Total Loss: 0.006166 in 19.396 sec
Iter: 4, Total Loss: 0.006042 in 19.299 sec
Iter: 5, Total Loss: 0.005924 in 19.087 sec
Iter: 6, Total Loss: 0.005821 in 19.158 sec
Iter: 7, Total Loss: 0.00573 in 19.262 sec
Iter: 8, Total Loss: 0.00565 in 19.141 sec
Iter: 9, Total Loss: 0.005581 in 19.300 sec
Iter: 10, Total Loss: 0.005522 in 19.287 sec
Iter: 11, Total Loss: 0.005473 in 19.609 sec
Iter: 12, Total Loss: 0.00543 in 19.427 sec
Iter: 13, Total Loss: 0.005394 in 19.447 sec
Iter: 14, Total Loss: 0.005361 in 19.437 sec
Iter: 15, Total Loss: 0.005333 in 19.246 sec
Iter: 16, Total Loss: 0.005305 in 19.190 sec
Iter: 17, Total Loss: 0.00528 in 19.238 sec
Iter: 18, Total Loss: 0.005256 in 19.584 sec
Iter: 19, Total Loss: 0.005233 in 19.807 sec
Iter: 20, Total Loss: 0.005209 in 19.493 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 19.385 with std = 0.197 sec ###
### py4DSTEM ptycho solver is finished in 6 min 28.909 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.04 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 64, 6, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 665/16384 [00:00<00:02, 6640.19probe position/s]Normalizing amplitudes:   8%|▊         | 1358/16384 [00:00<00:02, 6810.25probe position/s]Normalizing amplitudes:  13%|█▎        | 2051/16384 [00:00<00:02, 6863.76probe position/s]Normalizing amplitudes:  17%|█▋        | 2738/16384 [00:00<00:02, 6821.04probe position/s]Normalizing amplitudes:  21%|██        | 3421/16384 [00:00<00:01, 6758.69probe position/s]Normalizing amplitudes:  25%|██▌       | 4097/16384 [00:00<00:01, 6746.69probe position/s]Normalizing amplitudes:  29%|██▉       | 4772/16384 [00:00<00:01, 6720.39probe position/s]Normalizing amplitudes:  33%|███▎      | 5445/16384 [00:00<00:01, 6679.66probe position/s]Normalizing amplitudes:  37%|███▋      | 6122/16384 [00:00<00:01, 6707.02probe position/s]Normalizing amplitudes:  42%|████▏     | 6828/16384 [00:01<00:01, 6813.57probe position/s]Normalizing amplitudes:  46%|████▌     | 7552/16384 [00:01<00:01, 6943.26probe position/s]Normalizing amplitudes:  50%|█████     | 8247/16384 [00:01<00:01, 6877.04probe position/s]Normalizing amplitudes:  55%|█████▍    | 8935/16384 [00:01<00:01, 6836.64probe position/s]Normalizing amplitudes:  59%|█████▊    | 9619/16384 [00:01<00:00, 6798.08probe position/s]Normalizing amplitudes:  63%|██████▎   | 10300/16384 [00:01<00:00, 6801.50probe position/s]Normalizing amplitudes:  67%|██████▋   | 10981/16384 [00:01<00:00, 6767.03probe position/s]Normalizing amplitudes:  71%|███████   | 11664/16384 [00:01<00:00, 6783.61probe position/s]Normalizing amplitudes:  75%|███████▌  | 12357/16384 [00:01<00:00, 6826.52probe position/s]Normalizing amplitudes:  80%|███████▉  | 13065/16384 [00:01<00:00, 6901.90probe position/s]Normalizing amplitudes:  84%|████████▍ | 13756/16384 [00:02<00:00, 6897.82probe position/s]Normalizing amplitudes:  88%|████████▊ | 14446/16384 [00:02<00:00, 6870.90probe position/s]Normalizing amplitudes:  92%|█████████▏| 15134/16384 [00:02<00:00, 6838.28probe position/s]Normalizing amplitudes:  97%|█████████▋| 15820/16384 [00:02<00:00, 6842.55probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6812.29probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random64_p6_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random64_p6_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.01931 in 6.914 sec
Iter: 2, Total Loss: 0.006439 in 6.897 sec
Iter: 3, Total Loss: 0.006324 in 6.913 sec
Iter: 4, Total Loss: 0.006229 in 6.844 sec
Iter: 5, Total Loss: 0.006136 in 6.824 sec
Iter: 6, Total Loss: 0.006043 in 6.786 sec
Iter: 7, Total Loss: 0.005952 in 6.809 sec
Iter: 8, Total Loss: 0.005865 in 6.767 sec
Iter: 9, Total Loss: 0.005783 in 6.765 sec
Iter: 10, Total Loss: 0.005707 in 6.795 sec
Iter: 11, Total Loss: 0.005638 in 6.812 sec
Iter: 12, Total Loss: 0.005576 in 6.800 sec
Iter: 13, Total Loss: 0.00552 in 6.784 sec
Iter: 14, Total Loss: 0.005469 in 6.784 sec
Iter: 15, Total Loss: 0.005423 in 6.796 sec
Iter: 16, Total Loss: 0.005381 in 6.859 sec
Iter: 17, Total Loss: 0.005342 in 6.839 sec
Iter: 18, Total Loss: 0.005306 in 6.734 sec
Iter: 19, Total Loss: 0.005271 in 6.918 sec
Iter: 20, Total Loss: 0.005238 in 6.771 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 6.821 with std = 0.053 sec ###
### py4DSTEM ptycho solver is finished in 2 min 17.720 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.00 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 64, 6, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 704/16384 [00:00<00:02, 7037.02probe position/s]Normalizing amplitudes:   9%|▊         | 1408/16384 [00:00<00:02, 6977.91probe position/s]Normalizing amplitudes:  13%|█▎        | 2106/16384 [00:00<00:02, 6894.24probe position/s]Normalizing amplitudes:  17%|█▋        | 2796/16384 [00:00<00:01, 6819.63probe position/s]Normalizing amplitudes:  21%|██        | 3479/16384 [00:00<00:01, 6812.48probe position/s]Normalizing amplitudes:  25%|██▌       | 4166/16384 [00:00<00:01, 6829.57probe position/s]Normalizing amplitudes:  30%|██▉       | 4863/16384 [00:00<00:01, 6872.26probe position/s]Normalizing amplitudes:  34%|███▍      | 5551/16384 [00:00<00:01, 6852.55probe position/s]Normalizing amplitudes:  38%|███▊      | 6237/16384 [00:00<00:01, 6727.39probe position/s]Normalizing amplitudes:  42%|████▏     | 6911/16384 [00:01<00:01, 6537.03probe position/s]Normalizing amplitudes:  46%|████▌     | 7566/16384 [00:01<00:01, 6501.43probe position/s]Normalizing amplitudes:  50%|█████     | 8256/16384 [00:01<00:01, 6619.36probe position/s]Normalizing amplitudes:  55%|█████▍    | 8939/16384 [00:01<00:01, 6678.71probe position/s]Normalizing amplitudes:  59%|█████▉    | 9626/16384 [00:01<00:01, 6733.22probe position/s]Normalizing amplitudes:  63%|██████▎   | 10325/16384 [00:01<00:00, 6809.58probe position/s]Normalizing amplitudes:  67%|██████▋   | 11007/16384 [00:01<00:00, 6757.88probe position/s]Normalizing amplitudes:  71%|███████▏  | 11705/16384 [00:01<00:00, 6822.40probe position/s]Normalizing amplitudes:  76%|███████▌  | 12388/16384 [00:01<00:00, 6820.29probe position/s]Normalizing amplitudes:  80%|███████▉  | 13072/16384 [00:01<00:00, 6824.31probe position/s]Normalizing amplitudes:  84%|████████▍ | 13768/16384 [00:02<00:00, 6863.75probe position/s]Normalizing amplitudes:  88%|████████▊ | 14455/16384 [00:02<00:00, 6837.27probe position/s]Normalizing amplitudes:  92%|█████████▏| 15139/16384 [00:02<00:00, 6795.49probe position/s]Normalizing amplitudes:  97%|█████████▋| 15831/16384 [00:02<00:00, 6830.10probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6779.70probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random64_p6_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random64_p6_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.01992 in 19.109 sec
Iter: 2, Total Loss: 0.006365 in 19.249 sec
Iter: 3, Total Loss: 0.006137 in 19.778 sec
Iter: 4, Total Loss: 0.005986 in 19.516 sec
Iter: 5, Total Loss: 0.005855 in 19.349 sec
Iter: 6, Total Loss: 0.005739 in 19.355 sec
Iter: 7, Total Loss: 0.005638 in 19.597 sec
Iter: 8, Total Loss: 0.005551 in 19.726 sec
Iter: 9, Total Loss: 0.005477 in 19.534 sec
Iter: 10, Total Loss: 0.005412 in 19.711 sec
Iter: 11, Total Loss: 0.005353 in 19.630 sec
Iter: 12, Total Loss: 0.0053 in 19.849 sec
Iter: 13, Total Loss: 0.00525 in 19.523 sec
Iter: 14, Total Loss: 0.005201 in 19.578 sec
Iter: 15, Total Loss: 0.005155 in 19.401 sec
Iter: 16, Total Loss: 0.005109 in 19.837 sec
Iter: 17, Total Loss: 0.005063 in 18.906 sec
Iter: 18, Total Loss: 0.005018 in 19.010 sec
Iter: 19, Total Loss: 0.004974 in 18.974 sec
Iter: 20, Total Loss: 0.004934 in 19.293 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 19.446 with std = 0.280 sec ###
### py4DSTEM ptycho solver is finished in 6 min 31.058 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 933.97 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 64, 6, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 647/16384 [00:00<00:02, 6464.37probe position/s]Normalizing amplitudes:   8%|▊         | 1294/16384 [00:00<00:02, 6440.55probe position/s]Normalizing amplitudes:  12%|█▏        | 1964/16384 [00:00<00:02, 6556.87probe position/s]Normalizing amplitudes:  16%|█▋        | 2663/16384 [00:00<00:02, 6725.41probe position/s]Normalizing amplitudes:  20%|██        | 3352/16384 [00:00<00:01, 6781.63probe position/s]Normalizing amplitudes:  25%|██▍       | 4031/16384 [00:00<00:01, 6643.13probe position/s]Normalizing amplitudes:  29%|██▊       | 4698/16384 [00:00<00:01, 6650.62probe position/s]Normalizing amplitudes:  33%|███▎      | 5364/16384 [00:00<00:01, 6649.77probe position/s]Normalizing amplitudes:  37%|███▋      | 6030/16384 [00:00<00:01, 6610.70probe position/s]Normalizing amplitudes:  41%|████      | 6694/16384 [00:01<00:01, 6616.13probe position/s]Normalizing amplitudes:  45%|████▍     | 7360/16384 [00:01<00:01, 6629.36probe position/s]Normalizing amplitudes:  49%|████▉     | 8065/16384 [00:01<00:01, 6754.82probe position/s]Normalizing amplitudes:  53%|█████▎    | 8741/16384 [00:01<00:01, 6599.35probe position/s]Normalizing amplitudes:  57%|█████▋    | 9413/16384 [00:01<00:01, 6633.54probe position/s]Normalizing amplitudes:  62%|██████▏   | 10077/16384 [00:01<00:00, 6599.14probe position/s]Normalizing amplitudes:  66%|██████▌   | 10738/16384 [00:01<00:00, 6602.13probe position/s]Normalizing amplitudes:  70%|██████▉   | 11399/16384 [00:01<00:00, 6516.12probe position/s]Normalizing amplitudes:  74%|███████▎  | 12052/16384 [00:01<00:00, 6333.71probe position/s]Normalizing amplitudes:  77%|███████▋  | 12687/16384 [00:01<00:00, 6311.85probe position/s]Normalizing amplitudes:  81%|████████▏ | 13319/16384 [00:02<00:00, 6299.80probe position/s]Normalizing amplitudes:  85%|████████▌ | 13991/16384 [00:02<00:00, 6423.30probe position/s]Normalizing amplitudes:  89%|████████▉ | 14637/16384 [00:02<00:00, 6432.93probe position/s]Normalizing amplitudes:  93%|█████████▎| 15281/16384 [00:02<00:00, 6415.90probe position/s]Normalizing amplitudes:  97%|█████████▋| 15936/16384 [00:02<00:00, 6453.37probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6532.16probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random64_p6_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random64_p6_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.02196 in 37.639 sec
Iter: 2, Total Loss: 0.006448 in 37.641 sec
Iter: 3, Total Loss: 0.006057 in 37.581 sec
Iter: 4, Total Loss: 0.005888 in 38.031 sec
Iter: 5, Total Loss: 0.005748 in 38.179 sec
Iter: 6, Total Loss: 0.00563 in 37.603 sec
Iter: 7, Total Loss: 0.005527 in 37.881 sec
Iter: 8, Total Loss: 0.005438 in 37.718 sec
Iter: 9, Total Loss: 0.005362 in 37.521 sec
Iter: 10, Total Loss: 0.005297 in 37.638 sec
Iter: 11, Total Loss: 0.005238 in 37.844 sec
Iter: 12, Total Loss: 0.005187 in 37.645 sec
Iter: 13, Total Loss: 0.00514 in 38.117 sec
Iter: 14, Total Loss: 0.005097 in 37.619 sec
Iter: 15, Total Loss: 0.005056 in 37.472 sec
Iter: 16, Total Loss: 0.005017 in 38.129 sec
Iter: 17, Total Loss: 0.00498 in 38.397 sec
Iter: 18, Total Loss: 0.004944 in 37.414 sec
Iter: 19, Total Loss: 0.00491 in 38.453 sec
Iter: 20, Total Loss: 0.004878 in 38.200 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 37.836 with std = 0.308 sec ###
### py4DSTEM ptycho solver is finished in 12 min 38.008 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 932.52 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 64, 12, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 655/16384 [00:00<00:02, 6547.01probe position/s]Normalizing amplitudes:   8%|▊         | 1316/16384 [00:00<00:02, 6579.71probe position/s]Normalizing amplitudes:  12%|█▏        | 1982/16384 [00:00<00:02, 6613.96probe position/s]Normalizing amplitudes:  16%|█▌        | 2660/16384 [00:00<00:02, 6678.53probe position/s]Normalizing amplitudes:  20%|██        | 3344/16384 [00:00<00:01, 6734.42probe position/s]Normalizing amplitudes:  25%|██▍       | 4028/16384 [00:00<00:01, 6768.19probe position/s]Normalizing amplitudes:  29%|██▊       | 4705/16384 [00:00<00:01, 6745.17probe position/s]Normalizing amplitudes:  33%|███▎      | 5380/16384 [00:00<00:01, 6721.78probe position/s]Normalizing amplitudes:  37%|███▋      | 6053/16384 [00:00<00:01, 6639.95probe position/s]Normalizing amplitudes:  41%|████      | 6718/16384 [00:01<00:01, 6620.08probe position/s]Normalizing amplitudes:  45%|████▌     | 7389/16384 [00:01<00:01, 6644.49probe position/s]Normalizing amplitudes:  49%|████▉     | 8082/16384 [00:01<00:01, 6730.03probe position/s]Normalizing amplitudes:  54%|█████▎    | 8769/16384 [00:01<00:01, 6771.38probe position/s]Normalizing amplitudes:  58%|█████▊    | 9447/16384 [00:01<00:01, 6576.33probe position/s]Normalizing amplitudes:  62%|██████▏   | 10106/16384 [00:01<00:00, 6371.67probe position/s]Normalizing amplitudes:  66%|██████▌   | 10750/16384 [00:01<00:00, 6391.40probe position/s]Normalizing amplitudes:  70%|██████▉   | 11405/16384 [00:01<00:00, 6436.65probe position/s]Normalizing amplitudes:  74%|███████▎  | 12050/16384 [00:01<00:00, 6438.82probe position/s]Normalizing amplitudes:  78%|███████▊  | 12744/16384 [00:01<00:00, 6587.14probe position/s]Normalizing amplitudes:  82%|████████▏ | 13436/16384 [00:02<00:00, 6684.62probe position/s]Normalizing amplitudes:  86%|████████▌ | 14106/16384 [00:02<00:00, 6497.29probe position/s]Normalizing amplitudes:  90%|█████████ | 14758/16384 [00:02<00:00, 6349.52probe position/s]Normalizing amplitudes:  94%|█████████▍| 15407/16384 [00:02<00:00, 6387.72probe position/s]Normalizing amplitudes:  98%|█████████▊| 16071/16384 [00:02<00:00, 6461.49probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6566.65probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random64_p12_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random64_p12_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.04072 in 13.981 sec
Iter: 2, Total Loss: 0.006466 in 13.184 sec
Iter: 3, Total Loss: 0.006301 in 13.129 sec
Iter: 4, Total Loss: 0.006184 in 13.061 sec
Iter: 5, Total Loss: 0.006078 in 13.160 sec
Iter: 6, Total Loss: 0.005975 in 13.225 sec
Iter: 7, Total Loss: 0.005877 in 13.535 sec
Iter: 8, Total Loss: 0.005786 in 13.692 sec
Iter: 9, Total Loss: 0.005702 in 13.032 sec
Iter: 10, Total Loss: 0.005629 in 13.103 sec
Iter: 11, Total Loss: 0.005563 in 13.475 sec
Iter: 12, Total Loss: 0.005504 in 13.071 sec
Iter: 13, Total Loss: 0.00545 in 13.200 sec
Iter: 14, Total Loss: 0.0054 in 12.936 sec
Iter: 15, Total Loss: 0.005355 in 13.044 sec
Iter: 16, Total Loss: 0.005312 in 13.135 sec
Iter: 17, Total Loss: 0.005269 in 13.005 sec
Iter: 18, Total Loss: 0.005227 in 12.964 sec
Iter: 19, Total Loss: 0.005185 in 13.001 sec
Iter: 20, Total Loss: 0.005142 in 12.838 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 13.189 with std = 0.272 sec ###
### py4DSTEM ptycho solver is finished in 4 min 24.876 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 935.14 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 64, 12, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 667/16384 [00:00<00:02, 6663.57probe position/s]Normalizing amplitudes:   8%|▊         | 1334/16384 [00:00<00:02, 6402.80probe position/s]Normalizing amplitudes:  12%|█▏        | 1975/16384 [00:00<00:02, 6313.60probe position/s]Normalizing amplitudes:  16%|█▌        | 2644/16384 [00:00<00:02, 6457.14probe position/s]Normalizing amplitudes:  20%|██        | 3291/16384 [00:00<00:02, 6332.41probe position/s]Normalizing amplitudes:  24%|██▍       | 3961/16384 [00:00<00:01, 6451.77probe position/s]Normalizing amplitudes:  28%|██▊       | 4631/16384 [00:00<00:01, 6530.03probe position/s]Normalizing amplitudes:  32%|███▏      | 5316/16384 [00:00<00:01, 6628.99probe position/s]Normalizing amplitudes:  37%|███▋      | 5996/16384 [00:00<00:01, 6681.78probe position/s]Normalizing amplitudes:  41%|████      | 6673/16384 [00:01<00:01, 6708.30probe position/s]Normalizing amplitudes:  45%|████▍     | 7364/16384 [00:01<00:01, 6769.33probe position/s]Normalizing amplitudes:  49%|████▉     | 8067/16384 [00:01<00:01, 6847.25probe position/s]Normalizing amplitudes:  54%|█████▎    | 8783/16384 [00:01<00:01, 6940.11probe position/s]Normalizing amplitudes:  58%|█████▊    | 9478/16384 [00:01<00:00, 6925.13probe position/s]Normalizing amplitudes:  62%|██████▏   | 10171/16384 [00:01<00:00, 6823.78probe position/s]Normalizing amplitudes:  66%|██████▌   | 10854/16384 [00:01<00:00, 6766.76probe position/s]Normalizing amplitudes:  70%|███████   | 11531/16384 [00:01<00:00, 6757.24probe position/s]Normalizing amplitudes:  75%|███████▍  | 12212/16384 [00:01<00:00, 6772.45probe position/s]Normalizing amplitudes:  79%|███████▉  | 12905/16384 [00:01<00:00, 6819.18probe position/s]Normalizing amplitudes:  83%|████████▎ | 13611/16384 [00:02<00:00, 6888.41probe position/s]Normalizing amplitudes:  87%|████████▋ | 14308/16384 [00:02<00:00, 6912.50probe position/s]Normalizing amplitudes:  92%|█████████▏| 15013/16384 [00:02<00:00, 6951.14probe position/s]Normalizing amplitudes:  96%|█████████▌| 15709/16384 [00:02<00:00, 6908.24probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6747.85probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random64_p12_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random64_p12_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.04194 in 38.095 sec
Iter: 2, Total Loss: 0.006463 in 37.845 sec
Iter: 3, Total Loss: 0.006148 in 38.017 sec
Iter: 4, Total Loss: 0.005987 in 37.927 sec
Iter: 5, Total Loss: 0.005849 in 37.648 sec
Iter: 6, Total Loss: 0.005726 in 37.983 sec
Iter: 7, Total Loss: 0.005617 in 38.199 sec
Iter: 8, Total Loss: 0.005523 in 38.092 sec
Iter: 9, Total Loss: 0.00544 in 38.018 sec
Iter: 10, Total Loss: 0.005368 in 37.489 sec
Iter: 11, Total Loss: 0.005305 in 37.462 sec
Iter: 12, Total Loss: 0.005249 in 37.836 sec
Iter: 13, Total Loss: 0.005197 in 39.712 sec
Iter: 14, Total Loss: 0.005147 in 37.924 sec
Iter: 15, Total Loss: 0.0051 in 37.601 sec
Iter: 16, Total Loss: 0.005053 in 37.757 sec
Iter: 17, Total Loss: 0.005006 in 38.270 sec
Iter: 18, Total Loss: 0.00496 in 38.794 sec
Iter: 19, Total Loss: 0.004917 in 37.672 sec
Iter: 20, Total Loss: 0.004876 in 37.680 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 38.001 with std = 0.493 sec ###
### py4DSTEM ptycho solver is finished in 12 min 41.890 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.08 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 64, 12, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 672/16384 [00:00<00:02, 6709.94probe position/s]Normalizing amplitudes:   8%|▊         | 1349/16384 [00:00<00:02, 6743.73probe position/s]Normalizing amplitudes:  12%|█▏        | 2024/16384 [00:00<00:02, 6717.92probe position/s]Normalizing amplitudes:  16%|█▋        | 2696/16384 [00:00<00:02, 6699.89probe position/s]Normalizing amplitudes:  21%|██        | 3366/16384 [00:00<00:01, 6679.61probe position/s]Normalizing amplitudes:  25%|██▍       | 4038/16384 [00:00<00:01, 6689.72probe position/s]Normalizing amplitudes:  29%|██▊       | 4707/16384 [00:00<00:01, 6670.34probe position/s]Normalizing amplitudes:  33%|███▎      | 5405/16384 [00:00<00:01, 6767.96probe position/s]Normalizing amplitudes:  37%|███▋      | 6082/16384 [00:00<00:01, 6748.32probe position/s]Normalizing amplitudes:  41%|████      | 6757/16384 [00:01<00:01, 6748.68probe position/s]Normalizing amplitudes:  45%|████▌     | 7432/16384 [00:01<00:01, 6732.34probe position/s]Normalizing amplitudes:  49%|████▉     | 8106/16384 [00:01<00:01, 6680.76probe position/s]Normalizing amplitudes:  54%|█████▎    | 8776/16384 [00:01<00:01, 6685.13probe position/s]Normalizing amplitudes:  58%|█████▊    | 9452/16384 [00:01<00:01, 6705.41probe position/s]Normalizing amplitudes:  62%|██████▏   | 10123/16384 [00:01<00:00, 6638.07probe position/s]Normalizing amplitudes:  66%|██████▌   | 10809/16384 [00:01<00:00, 6702.27probe position/s]Normalizing amplitudes:  70%|███████   | 11480/16384 [00:01<00:00, 6670.41probe position/s]Normalizing amplitudes:  74%|███████▍  | 12148/16384 [00:01<00:00, 6671.89probe position/s]Normalizing amplitudes:  78%|███████▊  | 12816/16384 [00:01<00:00, 6605.73probe position/s]Normalizing amplitudes:  82%|████████▏ | 13492/16384 [00:02<00:00, 6651.15probe position/s]Normalizing amplitudes:  86%|████████▋ | 14159/16384 [00:02<00:00, 6654.74probe position/s]Normalizing amplitudes:  90%|█████████ | 14825/16384 [00:02<00:00, 6578.01probe position/s]Normalizing amplitudes:  95%|█████████▍| 15487/16384 [00:02<00:00, 6589.04probe position/s]Normalizing amplitudes:  99%|█████████▊| 16171/16384 [00:02<00:00, 6661.25probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6681.10probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random64_p12_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random64_p12_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.04352 in 74.905 sec
Iter: 2, Total Loss: 0.00666 in 75.518 sec
Iter: 3, Total Loss: 0.005932 in 75.866 sec
Iter: 4, Total Loss: 0.005677 in 75.116 sec
Iter: 5, Total Loss: 0.005505 in 75.521 sec
Iter: 6, Total Loss: 0.005373 in 73.794 sec
Iter: 7, Total Loss: 0.005269 in 72.058 sec
Iter: 8, Total Loss: 0.005186 in 72.120 sec
Iter: 9, Total Loss: 0.005114 in 72.040 sec
Iter: 10, Total Loss: 0.005047 in 75.085 sec
Iter: 11, Total Loss: 0.004984 in 75.228 sec
Iter: 12, Total Loss: 0.004923 in 74.637 sec
Iter: 13, Total Loss: 0.004865 in 73.592 sec
Iter: 14, Total Loss: 0.004812 in 74.616 sec
Iter: 15, Total Loss: 0.004765 in 74.253 sec
Iter: 16, Total Loss: 0.004725 in 75.438 sec
Iter: 17, Total Loss: 0.004691 in 74.755 sec
Iter: 18, Total Loss: 0.004663 in 74.951 sec
Iter: 19, Total Loss: 0.004639 in 74.178 sec
Iter: 20, Total Loss: 0.004619 in 73.867 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 74.377 with std = 1.136 sec ###
### py4DSTEM ptycho solver is finished in 24 min 49.733 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.12 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 32, 1, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 693/16384 [00:00<00:02, 6925.20probe position/s]Normalizing amplitudes:   8%|▊         | 1386/16384 [00:00<00:02, 6762.71probe position/s]Normalizing amplitudes:  13%|█▎        | 2063/16384 [00:00<00:02, 6351.91probe position/s]Normalizing amplitudes:  17%|█▋        | 2749/16384 [00:00<00:02, 6540.98probe position/s]Normalizing amplitudes:  21%|██        | 3416/16384 [00:00<00:01, 6584.99probe position/s]Normalizing amplitudes:  25%|██▍       | 4081/16384 [00:00<00:01, 6603.66probe position/s]Normalizing amplitudes:  29%|██▉       | 4753/16384 [00:00<00:01, 6640.30probe position/s]Normalizing amplitudes:  33%|███▎      | 5427/16384 [00:00<00:01, 6668.73probe position/s]Normalizing amplitudes:  37%|███▋      | 6124/16384 [00:00<00:01, 6761.18probe position/s]Normalizing amplitudes:  42%|████▏     | 6813/16384 [00:01<00:01, 6798.34probe position/s]Normalizing amplitudes:  46%|████▌     | 7494/16384 [00:01<00:01, 6747.83probe position/s]Normalizing amplitudes:  50%|████▉     | 8170/16384 [00:01<00:01, 6702.48probe position/s]Normalizing amplitudes:  54%|█████▍    | 8847/16384 [00:01<00:01, 6720.69probe position/s]Normalizing amplitudes:  58%|█████▊    | 9520/16384 [00:01<00:01, 6678.24probe position/s]Normalizing amplitudes:  62%|██████▏   | 10188/16384 [00:01<00:00, 6670.93probe position/s]Normalizing amplitudes:  66%|██████▋   | 10865/16384 [00:01<00:00, 6698.59probe position/s]Normalizing amplitudes:  70%|███████   | 11540/16384 [00:01<00:00, 6713.74probe position/s]Normalizing amplitudes:  75%|███████▍  | 12233/16384 [00:01<00:00, 6776.88probe position/s]Normalizing amplitudes:  79%|███████▉  | 12921/16384 [00:01<00:00, 6807.11probe position/s]Normalizing amplitudes:  83%|████████▎ | 13605/16384 [00:02<00:00, 6815.82probe position/s]Normalizing amplitudes:  87%|████████▋ | 14287/16384 [00:02<00:00, 6780.03probe position/s]Normalizing amplitudes:  91%|█████████▏| 14966/16384 [00:02<00:00, 6752.19probe position/s]Normalizing amplitudes:  96%|█████████▌| 15647/16384 [00:02<00:00, 6766.83probe position/s]Normalizing amplitudes: 100%|█████████▉| 16324/16384 [00:02<00:00, 6717.83probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6708.62probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random32_p1_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random32_p1_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.00708 in 3.419 sec
Iter: 2, Total Loss: 0.006532 in 3.391 sec
Iter: 3, Total Loss: 0.00648 in 3.377 sec
Iter: 4, Total Loss: 0.006426 in 3.364 sec
Iter: 5, Total Loss: 0.006372 in 3.375 sec
Iter: 6, Total Loss: 0.006324 in 3.362 sec
Iter: 7, Total Loss: 0.006279 in 3.377 sec
Iter: 8, Total Loss: 0.006241 in 3.396 sec
Iter: 9, Total Loss: 0.006208 in 3.348 sec
Iter: 10, Total Loss: 0.006181 in 3.379 sec
Iter: 11, Total Loss: 0.00616 in 3.344 sec
Iter: 12, Total Loss: 0.006142 in 3.333 sec
Iter: 13, Total Loss: 0.006128 in 3.422 sec
Iter: 14, Total Loss: 0.006117 in 3.343 sec
Iter: 15, Total Loss: 0.006107 in 3.449 sec
Iter: 16, Total Loss: 0.006098 in 3.311 sec
Iter: 17, Total Loss: 0.006091 in 3.326 sec
Iter: 18, Total Loss: 0.006087 in 3.666 sec
Iter: 19, Total Loss: 0.006081 in 3.645 sec
Iter: 20, Total Loss: 0.006077 in 3.323 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 3.397 with std = 0.093 sec ###
### py4DSTEM ptycho solver is finished in 1 min 9.042 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.24 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 32, 1, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 694/16384 [00:00<00:02, 6931.03probe position/s]Normalizing amplitudes:   8%|▊         | 1389/16384 [00:00<00:02, 6934.41probe position/s]Normalizing amplitudes:  13%|█▎        | 2083/16384 [00:00<00:02, 6921.76probe position/s]Normalizing amplitudes:  17%|█▋        | 2776/16384 [00:00<00:01, 6858.04probe position/s]Normalizing amplitudes:  21%|██        | 3462/16384 [00:00<00:01, 6801.98probe position/s]Normalizing amplitudes:  25%|██▌       | 4143/16384 [00:00<00:01, 6750.35probe position/s]Normalizing amplitudes:  29%|██▉       | 4819/16384 [00:00<00:01, 6727.46probe position/s]Normalizing amplitudes:  34%|███▎      | 5493/16384 [00:00<00:01, 6729.18probe position/s]Normalizing amplitudes:  38%|███▊      | 6195/16384 [00:00<00:01, 6816.65probe position/s]Normalizing amplitudes:  42%|████▏     | 6914/16384 [00:01<00:01, 6930.31probe position/s]Normalizing amplitudes:  46%|████▋     | 7609/16384 [00:01<00:01, 6935.48probe position/s]Normalizing amplitudes:  51%|█████     | 8303/16384 [00:01<00:01, 6894.86probe position/s]Normalizing amplitudes:  55%|█████▍    | 8993/16384 [00:01<00:01, 6824.75probe position/s]Normalizing amplitudes:  59%|█████▉    | 9676/16384 [00:01<00:00, 6782.66probe position/s]Normalizing amplitudes:  63%|██████▎   | 10355/16384 [00:01<00:00, 6766.56probe position/s]Normalizing amplitudes:  67%|██████▋   | 11041/16384 [00:01<00:00, 6793.13probe position/s]Normalizing amplitudes:  72%|███████▏  | 11730/16384 [00:01<00:00, 6819.62probe position/s]Normalizing amplitudes:  76%|███████▌  | 12435/16384 [00:01<00:00, 6886.29probe position/s]Normalizing amplitudes:  80%|████████  | 13126/16384 [00:01<00:00, 6891.85probe position/s]Normalizing amplitudes:  84%|████████▍ | 13816/16384 [00:02<00:00, 6831.39probe position/s]Normalizing amplitudes:  89%|████████▊ | 14500/16384 [00:02<00:00, 6810.49probe position/s]Normalizing amplitudes:  93%|█████████▎| 15182/16384 [00:02<00:00, 6782.25probe position/s]Normalizing amplitudes:  97%|█████████▋| 15868/16384 [00:02<00:00, 6805.02probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6833.13probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random32_p1_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random32_p1_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.007134 in 7.918 sec
Iter: 2, Total Loss: 0.006525 in 7.910 sec
Iter: 3, Total Loss: 0.006453 in 7.886 sec
Iter: 4, Total Loss: 0.006387 in 7.930 sec
Iter: 5, Total Loss: 0.006333 in 7.939 sec
Iter: 6, Total Loss: 0.006284 in 7.803 sec
Iter: 7, Total Loss: 0.006241 in 7.840 sec
Iter: 8, Total Loss: 0.006207 in 7.862 sec
Iter: 9, Total Loss: 0.006175 in 7.842 sec
Iter: 10, Total Loss: 0.006153 in 7.949 sec
Iter: 11, Total Loss: 0.006132 in 7.769 sec
Iter: 12, Total Loss: 0.006115 in 7.766 sec
Iter: 13, Total Loss: 0.006101 in 7.819 sec
Iter: 14, Total Loss: 0.00609 in 7.795 sec
Iter: 15, Total Loss: 0.006078 in 7.772 sec
Iter: 16, Total Loss: 0.006068 in 7.880 sec
Iter: 17, Total Loss: 0.006061 in 7.817 sec
Iter: 18, Total Loss: 0.006053 in 7.872 sec
Iter: 19, Total Loss: 0.006048 in 7.863 sec
Iter: 20, Total Loss: 0.006042 in 7.988 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 7.861 with std = 0.063 sec ###
### py4DSTEM ptycho solver is finished in 2 min 38.352 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.11 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 32, 1, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 664/16384 [00:00<00:02, 6633.47probe position/s]Normalizing amplitudes:   8%|▊         | 1337/16384 [00:00<00:02, 6687.18probe position/s]Normalizing amplitudes:  12%|█▏        | 2016/16384 [00:00<00:02, 6732.16probe position/s]Normalizing amplitudes:  16%|█▋        | 2690/16384 [00:00<00:02, 6725.73probe position/s]Normalizing amplitudes:  21%|██        | 3363/16384 [00:00<00:01, 6665.08probe position/s]Normalizing amplitudes:  25%|██▍       | 4040/16384 [00:00<00:01, 6697.70probe position/s]Normalizing amplitudes:  29%|██▉       | 4736/16384 [00:00<00:01, 6782.59probe position/s]Normalizing amplitudes:  33%|███▎      | 5450/16384 [00:00<00:01, 6893.99probe position/s]Normalizing amplitudes:  37%|███▋      | 6140/16384 [00:00<00:01, 6730.40probe position/s]Normalizing amplitudes:  42%|████▏     | 6814/16384 [00:01<00:01, 6597.49probe position/s]Normalizing amplitudes:  46%|████▌     | 7475/16384 [00:01<00:01, 6556.99probe position/s]Normalizing amplitudes:  50%|████▉     | 8153/16384 [00:01<00:01, 6620.27probe position/s]Normalizing amplitudes:  54%|█████▍    | 8839/16384 [00:01<00:01, 6691.61probe position/s]Normalizing amplitudes:  58%|█████▊    | 9521/16384 [00:01<00:01, 6729.52probe position/s]Normalizing amplitudes:  62%|██████▏   | 10210/16384 [00:01<00:00, 6775.32probe position/s]Normalizing amplitudes:  66%|██████▋   | 10888/16384 [00:01<00:00, 6754.47probe position/s]Normalizing amplitudes:  71%|███████   | 11564/16384 [00:01<00:00, 6712.97probe position/s]Normalizing amplitudes:  75%|███████▍  | 12238/16384 [00:01<00:00, 6717.60probe position/s]Normalizing amplitudes:  79%|███████▉  | 12918/16384 [00:01<00:00, 6740.09probe position/s]Normalizing amplitudes:  83%|████████▎ | 13598/16384 [00:02<00:00, 6754.95probe position/s]Normalizing amplitudes:  87%|████████▋ | 14277/16384 [00:02<00:00, 6764.13probe position/s]Normalizing amplitudes:  91%|█████████▏| 14969/16384 [00:02<00:00, 6809.81probe position/s]Normalizing amplitudes:  96%|█████████▌| 15667/16384 [00:02<00:00, 6859.56probe position/s]Normalizing amplitudes: 100%|█████████▉| 16366/16384 [00:02<00:00, 6897.75probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6749.18probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random32_p1_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random32_p1_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.007259 in 14.634 sec
Iter: 2, Total Loss: 0.006574 in 14.452 sec
Iter: 3, Total Loss: 0.006485 in 14.445 sec
Iter: 4, Total Loss: 0.006415 in 14.704 sec
Iter: 5, Total Loss: 0.006358 in 14.481 sec
Iter: 6, Total Loss: 0.006305 in 14.296 sec
Iter: 7, Total Loss: 0.006263 in 14.274 sec
Iter: 8, Total Loss: 0.006225 in 14.318 sec
Iter: 9, Total Loss: 0.006194 in 14.299 sec
Iter: 10, Total Loss: 0.006164 in 14.187 sec
Iter: 11, Total Loss: 0.006142 in 14.247 sec
Iter: 12, Total Loss: 0.006118 in 14.448 sec
Iter: 13, Total Loss: 0.006099 in 14.625 sec
Iter: 14, Total Loss: 0.006078 in 14.779 sec
Iter: 15, Total Loss: 0.006058 in 14.707 sec
Iter: 16, Total Loss: 0.00604 in 14.666 sec
Iter: 17, Total Loss: 0.006021 in 14.605 sec
Iter: 18, Total Loss: 0.006005 in 14.651 sec
Iter: 19, Total Loss: 0.005988 in 14.780 sec
Iter: 20, Total Loss: 0.005973 in 14.781 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 14.519 with std = 0.193 sec ###
### py4DSTEM ptycho solver is finished in 4 min 53.327 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.07 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 32, 3, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 674/16384 [00:00<00:02, 6734.77probe position/s]Normalizing amplitudes:   8%|▊         | 1348/16384 [00:00<00:02, 6526.15probe position/s]Normalizing amplitudes:  12%|█▏        | 2003/16384 [00:00<00:02, 6533.53probe position/s]Normalizing amplitudes:  16%|█▋        | 2685/16384 [00:00<00:02, 6644.74probe position/s]Normalizing amplitudes:  20%|██        | 3350/16384 [00:00<00:01, 6524.62probe position/s]Normalizing amplitudes:  24%|██▍       | 4003/16384 [00:00<00:01, 6329.02probe position/s]Normalizing amplitudes:  29%|██▊       | 4682/16384 [00:00<00:01, 6474.33probe position/s]Normalizing amplitudes:  33%|███▎      | 5362/16384 [00:00<00:01, 6573.55probe position/s]Normalizing amplitudes:  37%|███▋      | 6039/16384 [00:00<00:01, 6632.57probe position/s]Normalizing amplitudes:  41%|████      | 6717/16384 [00:01<00:01, 6676.89probe position/s]Normalizing amplitudes:  45%|████▌     | 7405/16384 [00:01<00:01, 6735.30probe position/s]Normalizing amplitudes:  49%|████▉     | 8091/16384 [00:01<00:01, 6772.20probe position/s]Normalizing amplitudes:  54%|█████▎    | 8805/16384 [00:01<00:01, 6881.15probe position/s]Normalizing amplitudes:  58%|█████▊    | 9497/16384 [00:01<00:00, 6890.05probe position/s]Normalizing amplitudes:  62%|██████▏   | 10187/16384 [00:01<00:00, 6814.58probe position/s]Normalizing amplitudes:  66%|██████▋   | 10869/16384 [00:01<00:00, 6780.49probe position/s]Normalizing amplitudes:  70%|███████   | 11548/16384 [00:01<00:00, 6723.52probe position/s]Normalizing amplitudes:  75%|███████▍  | 12221/16384 [00:01<00:00, 6708.54probe position/s]Normalizing amplitudes:  79%|███████▊  | 12892/16384 [00:01<00:00, 6671.51probe position/s]Normalizing amplitudes:  83%|████████▎ | 13597/16384 [00:02<00:00, 6782.25probe position/s]Normalizing amplitudes:  87%|████████▋ | 14286/16384 [00:02<00:00, 6813.32probe position/s]Normalizing amplitudes:  91%|█████████▏| 14968/16384 [00:02<00:00, 6788.26probe position/s]Normalizing amplitudes:  96%|█████████▌| 15656/16384 [00:02<00:00, 6815.07probe position/s]Normalizing amplitudes: 100%|█████████▉| 16338/16384 [00:02<00:00, 6811.51probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6711.43probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random32_p3_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random32_p3_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.008631 in 7.238 sec
Iter: 2, Total Loss: 0.006422 in 7.015 sec
Iter: 3, Total Loss: 0.006292 in 6.982 sec
Iter: 4, Total Loss: 0.006152 in 6.990 sec
Iter: 5, Total Loss: 0.006016 in 6.911 sec
Iter: 6, Total Loss: 0.005899 in 6.968 sec
Iter: 7, Total Loss: 0.005799 in 6.978 sec
Iter: 8, Total Loss: 0.00572 in 6.927 sec
Iter: 9, Total Loss: 0.005653 in 6.915 sec
Iter: 10, Total Loss: 0.005595 in 6.846 sec
Iter: 11, Total Loss: 0.005544 in 6.932 sec
Iter: 12, Total Loss: 0.005499 in 6.946 sec
Iter: 13, Total Loss: 0.005459 in 6.743 sec
Iter: 14, Total Loss: 0.005422 in 6.740 sec
Iter: 15, Total Loss: 0.005387 in 6.781 sec
Iter: 16, Total Loss: 0.005355 in 6.789 sec
Iter: 17, Total Loss: 0.005326 in 6.928 sec
Iter: 18, Total Loss: 0.005301 in 6.881 sec
Iter: 19, Total Loss: 0.005281 in 6.890 sec
Iter: 20, Total Loss: 0.005264 in 6.941 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 6.917 with std = 0.108 sec ###
### py4DSTEM ptycho solver is finished in 2 min 19.865 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.15 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 32, 3, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 677/16384 [00:00<00:02, 6761.78probe position/s]Normalizing amplitudes:   8%|▊         | 1354/16384 [00:00<00:02, 6696.26probe position/s]Normalizing amplitudes:  13%|█▎        | 2051/16384 [00:00<00:02, 6817.33probe position/s]Normalizing amplitudes:  17%|█▋        | 2733/16384 [00:00<00:02, 6790.41probe position/s]Normalizing amplitudes:  21%|██        | 3413/16384 [00:00<00:01, 6791.80probe position/s]Normalizing amplitudes:  25%|██▍       | 4093/16384 [00:00<00:01, 6747.91probe position/s]Normalizing amplitudes:  29%|██▉       | 4768/16384 [00:00<00:01, 6705.23probe position/s]Normalizing amplitudes:  33%|███▎      | 5451/16384 [00:00<00:01, 6743.28probe position/s]Normalizing amplitudes:  37%|███▋      | 6142/16384 [00:00<00:01, 6793.62probe position/s]Normalizing amplitudes:  42%|████▏     | 6822/16384 [00:01<00:01, 6742.44probe position/s]Normalizing amplitudes:  46%|████▌     | 7500/16384 [00:01<00:01, 6753.31probe position/s]Normalizing amplitudes:  50%|█████     | 8208/16384 [00:01<00:01, 6850.53probe position/s]Normalizing amplitudes:  54%|█████▍    | 8894/16384 [00:01<00:01, 6727.20probe position/s]Normalizing amplitudes:  58%|█████▊    | 9574/16384 [00:01<00:01, 6747.34probe position/s]Normalizing amplitudes:  63%|██████▎   | 10250/16384 [00:01<00:00, 6692.21probe position/s]Normalizing amplitudes:  67%|██████▋   | 10920/16384 [00:01<00:00, 6568.99probe position/s]Normalizing amplitudes:  71%|███████   | 11593/16384 [00:01<00:00, 6615.92probe position/s]Normalizing amplitudes:  75%|███████▍  | 12274/16384 [00:01<00:00, 6671.96probe position/s]Normalizing amplitudes:  79%|███████▉  | 12954/16384 [00:01<00:00, 6708.45probe position/s]Normalizing amplitudes:  83%|████████▎ | 13635/16384 [00:02<00:00, 6738.07probe position/s]Normalizing amplitudes:  88%|████████▊ | 14349/16384 [00:02<00:00, 6857.82probe position/s]Normalizing amplitudes:  92%|█████████▏| 15036/16384 [00:02<00:00, 6841.66probe position/s]Normalizing amplitudes:  96%|█████████▌| 15733/16384 [00:02<00:00, 6879.06probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6763.18probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random32_p3_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random32_p3_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.008752 in 18.858 sec
Iter: 2, Total Loss: 0.006259 in 18.790 sec
Iter: 3, Total Loss: 0.006053 in 19.153 sec
Iter: 4, Total Loss: 0.00588 in 19.366 sec
Iter: 5, Total Loss: 0.005736 in 19.195 sec
Iter: 6, Total Loss: 0.005621 in 19.137 sec
Iter: 7, Total Loss: 0.00553 in 19.054 sec
Iter: 8, Total Loss: 0.005455 in 18.954 sec
Iter: 9, Total Loss: 0.005392 in 19.023 sec
Iter: 10, Total Loss: 0.005337 in 18.772 sec
Iter: 11, Total Loss: 0.005287 in 18.784 sec
Iter: 12, Total Loss: 0.005242 in 19.038 sec
Iter: 13, Total Loss: 0.005203 in 19.298 sec
Iter: 14, Total Loss: 0.005171 in 18.732 sec
Iter: 15, Total Loss: 0.005144 in 18.793 sec
Iter: 16, Total Loss: 0.005123 in 18.742 sec
Iter: 17, Total Loss: 0.005104 in 18.719 sec
Iter: 18, Total Loss: 0.005088 in 18.825 sec
Iter: 19, Total Loss: 0.005074 in 18.782 sec
Iter: 20, Total Loss: 0.005061 in 18.819 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 18.942 with std = 0.197 sec ###
### py4DSTEM ptycho solver is finished in 6 min 20.369 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.06 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 32, 3, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 644/16384 [00:00<00:02, 6434.64probe position/s]Normalizing amplitudes:   8%|▊         | 1288/16384 [00:00<00:02, 6348.08probe position/s]Normalizing amplitudes:  12%|█▏        | 1923/16384 [00:00<00:02, 6246.77probe position/s]Normalizing amplitudes:  16%|█▌        | 2593/16384 [00:00<00:02, 6418.94probe position/s]Normalizing amplitudes:  20%|█▉        | 3271/16384 [00:00<00:02, 6547.02probe position/s]Normalizing amplitudes:  24%|██▍       | 3948/16384 [00:00<00:01, 6621.47probe position/s]Normalizing amplitudes:  28%|██▊       | 4629/16384 [00:00<00:01, 6680.90probe position/s]Normalizing amplitudes:  32%|███▏      | 5298/16384 [00:00<00:01, 6432.99probe position/s]Normalizing amplitudes:  36%|███▋      | 5944/16384 [00:00<00:01, 6297.09probe position/s]Normalizing amplitudes:  40%|████      | 6618/16384 [00:01<00:01, 6427.69probe position/s]Normalizing amplitudes:  44%|████▍     | 7263/16384 [00:01<00:01, 6428.23probe position/s]Normalizing amplitudes:  48%|████▊     | 7939/16384 [00:01<00:01, 6525.36probe position/s]Normalizing amplitudes:  52%|█████▏    | 8593/16384 [00:01<00:01, 6338.83probe position/s]Normalizing amplitudes:  57%|█████▋    | 9281/16384 [00:01<00:01, 6496.35probe position/s]Normalizing amplitudes:  61%|██████    | 9979/16384 [00:01<00:00, 6635.61probe position/s]Normalizing amplitudes:  65%|██████▌   | 10659/16384 [00:01<00:00, 6682.37probe position/s]Normalizing amplitudes:  69%|██████▉   | 11329/16384 [00:01<00:00, 6684.74probe position/s]Normalizing amplitudes:  73%|███████▎  | 11999/16384 [00:01<00:00, 6647.86probe position/s]Normalizing amplitudes:  77%|███████▋  | 12678/16384 [00:01<00:00, 6687.26probe position/s]Normalizing amplitudes:  81%|████████▏ | 13348/16384 [00:02<00:00, 6641.43probe position/s]Normalizing amplitudes:  86%|████████▌ | 14043/16384 [00:02<00:00, 6733.03probe position/s]Normalizing amplitudes:  90%|████████▉ | 14717/16384 [00:02<00:00, 6705.61probe position/s]Normalizing amplitudes:  94%|█████████▍| 15395/16384 [00:02<00:00, 6727.64probe position/s]Normalizing amplitudes:  98%|█████████▊| 16094/16384 [00:02<00:00, 6805.29probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6589.25probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random32_p3_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random32_p3_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.00928 in 36.565 sec
Iter: 2, Total Loss: 0.006155 in 36.692 sec
Iter: 3, Total Loss: 0.005894 in 37.189 sec
Iter: 4, Total Loss: 0.005708 in 36.900 sec
Iter: 5, Total Loss: 0.005577 in 36.837 sec
Iter: 6, Total Loss: 0.005488 in 36.601 sec
Iter: 7, Total Loss: 0.005424 in 36.920 sec
Iter: 8, Total Loss: 0.005373 in 35.883 sec
Iter: 9, Total Loss: 0.00533 in 36.839 sec
Iter: 10, Total Loss: 0.005292 in 36.267 sec
Iter: 11, Total Loss: 0.005256 in 36.350 sec
Iter: 12, Total Loss: 0.005221 in 36.371 sec
Iter: 13, Total Loss: 0.005189 in 36.512 sec
Iter: 14, Total Loss: 0.005159 in 36.543 sec
Iter: 15, Total Loss: 0.005131 in 36.530 sec
Iter: 16, Total Loss: 0.005106 in 36.972 sec
Iter: 17, Total Loss: 0.005083 in 36.807 sec
Iter: 18, Total Loss: 0.005063 in 36.691 sec
Iter: 19, Total Loss: 0.005045 in 36.607 sec
Iter: 20, Total Loss: 0.005029 in 37.252 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 36.666 with std = 0.312 sec ###
### py4DSTEM ptycho solver is finished in 12 min 14.587 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.10 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 32, 6, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 664/16384 [00:00<00:02, 6633.03probe position/s]Normalizing amplitudes:   8%|▊         | 1353/16384 [00:00<00:02, 6783.84probe position/s]Normalizing amplitudes:  12%|█▏        | 2032/16384 [00:00<00:02, 6561.53probe position/s]Normalizing amplitudes:  17%|█▋        | 2704/16384 [00:00<00:02, 6621.29probe position/s]Normalizing amplitudes:  21%|██        | 3388/16384 [00:00<00:01, 6696.15probe position/s]Normalizing amplitudes:  25%|██▍       | 4059/16384 [00:00<00:01, 6683.69probe position/s]Normalizing amplitudes:  29%|██▉       | 4728/16384 [00:00<00:01, 6554.91probe position/s]Normalizing amplitudes:  33%|███▎      | 5392/16384 [00:00<00:01, 6580.61probe position/s]Normalizing amplitudes:  37%|███▋      | 6066/16384 [00:00<00:01, 6628.82probe position/s]Normalizing amplitudes:  41%|████      | 6745/16384 [00:01<00:01, 6676.49probe position/s]Normalizing amplitudes:  45%|████▌     | 7428/16384 [00:01<00:01, 6718.57probe position/s]Normalizing amplitudes:  49%|████▉     | 8101/16384 [00:01<00:01, 6606.58probe position/s]Normalizing amplitudes:  53%|█████▎    | 8763/16384 [00:01<00:01, 6595.61probe position/s]Normalizing amplitudes:  58%|█████▊    | 9423/16384 [00:01<00:01, 6556.49probe position/s]Normalizing amplitudes:  62%|██████▏   | 10079/16384 [00:01<00:01, 5647.27probe position/s]Normalizing amplitudes:  66%|██████▌   | 10742/16384 [00:01<00:00, 5910.27probe position/s]Normalizing amplitudes:  70%|██████▉   | 11419/16384 [00:01<00:00, 6146.97probe position/s]Normalizing amplitudes:  74%|███████▍  | 12118/16384 [00:01<00:00, 6385.13probe position/s]Normalizing amplitudes:  78%|███████▊  | 12795/16384 [00:01<00:00, 6494.41probe position/s]Normalizing amplitudes:  82%|████████▏ | 13454/16384 [00:02<00:00, 6499.90probe position/s]Normalizing amplitudes:  86%|████████▌ | 14131/16384 [00:02<00:00, 6576.77probe position/s]Normalizing amplitudes:  90%|█████████ | 14794/16384 [00:02<00:00, 6583.89probe position/s]Normalizing amplitudes:  94%|█████████▍| 15456/16384 [00:02<00:00, 6505.23probe position/s]Normalizing amplitudes:  98%|█████████▊| 16120/16384 [00:02<00:00, 6542.35probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6487.53probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random32_p6_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random32_p6_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.01297 in 12.644 sec
Iter: 2, Total Loss: 0.006405 in 12.573 sec
Iter: 3, Total Loss: 0.006245 in 12.475 sec
Iter: 4, Total Loss: 0.006093 in 12.529 sec
Iter: 5, Total Loss: 0.005946 in 12.867 sec
Iter: 6, Total Loss: 0.00581 in 12.861 sec
Iter: 7, Total Loss: 0.005695 in 12.925 sec
Iter: 8, Total Loss: 0.005592 in 12.863 sec
Iter: 9, Total Loss: 0.005502 in 12.830 sec
Iter: 10, Total Loss: 0.005421 in 12.447 sec
Iter: 11, Total Loss: 0.005345 in 12.689 sec
Iter: 12, Total Loss: 0.00527 in 12.714 sec
Iter: 13, Total Loss: 0.0052 in 12.693 sec
Iter: 14, Total Loss: 0.005137 in 12.556 sec
Iter: 15, Total Loss: 0.005087 in 12.638 sec
Iter: 16, Total Loss: 0.005047 in 12.682 sec
Iter: 17, Total Loss: 0.005015 in 12.760 sec
Iter: 18, Total Loss: 0.004989 in 12.769 sec
Iter: 19, Total Loss: 0.004968 in 12.836 sec
Iter: 20, Total Loss: 0.00495 in 12.623 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 12.699 with std = 0.136 sec ###
### py4DSTEM ptycho solver is finished in 4 min 15.386 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.01 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 32, 6, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 661/16384 [00:00<00:02, 6604.81probe position/s]Normalizing amplitudes:   8%|▊         | 1322/16384 [00:00<00:02, 6606.41probe position/s]Normalizing amplitudes:  12%|█▏        | 1998/16384 [00:00<00:02, 6673.87probe position/s]Normalizing amplitudes:  16%|█▋        | 2666/16384 [00:00<00:02, 6592.17probe position/s]Normalizing amplitudes:  20%|██        | 3326/16384 [00:00<00:01, 6561.95probe position/s]Normalizing amplitudes:  24%|██▍       | 3996/16384 [00:00<00:01, 6608.27probe position/s]Normalizing amplitudes:  29%|██▊       | 4670/16384 [00:00<00:01, 6650.48probe position/s]Normalizing amplitudes:  33%|███▎      | 5339/16384 [00:00<00:01, 6662.31probe position/s]Normalizing amplitudes:  37%|███▋      | 6016/16384 [00:00<00:01, 6694.70probe position/s]Normalizing amplitudes:  41%|████      | 6686/16384 [00:01<00:01, 6681.91probe position/s]Normalizing amplitudes:  45%|████▍     | 7355/16384 [00:01<00:01, 6368.14probe position/s]Normalizing amplitudes:  49%|████▉     | 7995/16384 [00:01<00:01, 6269.07probe position/s]Normalizing amplitudes:  53%|█████▎    | 8636/16384 [00:01<00:01, 6309.01probe position/s]Normalizing amplitudes:  57%|█████▋    | 9319/16384 [00:01<00:01, 6460.32probe position/s]Normalizing amplitudes:  61%|██████    | 9994/16384 [00:01<00:00, 6545.73probe position/s]Normalizing amplitudes:  65%|██████▌   | 10671/16384 [00:01<00:00, 6610.45probe position/s]Normalizing amplitudes:  69%|██████▉   | 11333/16384 [00:01<00:00, 6608.14probe position/s]Normalizing amplitudes:  73%|███████▎  | 12001/16384 [00:01<00:00, 6628.95probe position/s]Normalizing amplitudes:  77%|███████▋  | 12688/16384 [00:01<00:00, 6698.62probe position/s]Normalizing amplitudes:  82%|████████▏ | 13388/16384 [00:02<00:00, 6787.55probe position/s]Normalizing amplitudes:  86%|████████▌ | 14077/16384 [00:02<00:00, 6817.38probe position/s]Normalizing amplitudes:  90%|█████████ | 14762/16384 [00:02<00:00, 6825.73probe position/s]Normalizing amplitudes:  94%|█████████▍| 15445/16384 [00:02<00:00, 6762.08probe position/s]Normalizing amplitudes:  98%|█████████▊| 16122/16384 [00:02<00:00, 6733.11probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6614.32probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random32_p6_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random32_p6_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.01325 in 35.845 sec
Iter: 2, Total Loss: 0.006189 in 35.612 sec
Iter: 3, Total Loss: 0.005907 in 36.195 sec
Iter: 4, Total Loss: 0.005694 in 35.618 sec
Iter: 5, Total Loss: 0.005536 in 36.442 sec
Iter: 6, Total Loss: 0.005406 in 35.690 sec
Iter: 7, Total Loss: 0.005292 in 35.842 sec
Iter: 8, Total Loss: 0.00519 in 35.164 sec
Iter: 9, Total Loss: 0.005098 in 35.739 sec
Iter: 10, Total Loss: 0.005018 in 35.796 sec
Iter: 11, Total Loss: 0.004952 in 35.073 sec
Iter: 12, Total Loss: 0.004899 in 35.896 sec
Iter: 13, Total Loss: 0.004858 in 35.508 sec
Iter: 14, Total Loss: 0.004824 in 35.638 sec
Iter: 15, Total Loss: 0.004797 in 35.466 sec
Iter: 16, Total Loss: 0.004775 in 36.449 sec
Iter: 17, Total Loss: 0.004756 in 36.263 sec
Iter: 18, Total Loss: 0.00474 in 36.092 sec
Iter: 19, Total Loss: 0.004725 in 35.592 sec
Iter: 20, Total Loss: 0.004713 in 35.672 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 35.780 with std = 0.360 sec ###
### py4DSTEM ptycho solver is finished in 11 min 57.033 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 933.98 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 32, 6, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 672/16384 [00:00<00:02, 6717.36probe position/s]Normalizing amplitudes:   8%|▊         | 1350/16384 [00:00<00:02, 6750.32probe position/s]Normalizing amplitudes:  12%|█▏        | 2026/16384 [00:00<00:02, 6711.54probe position/s]Normalizing amplitudes:  16%|█▋        | 2698/16384 [00:00<00:02, 6640.27probe position/s]Normalizing amplitudes:  21%|██        | 3363/16384 [00:00<00:01, 6622.48probe position/s]Normalizing amplitudes:  25%|██▍       | 4026/16384 [00:00<00:01, 6567.92probe position/s]Normalizing amplitudes:  29%|██▊       | 4688/16384 [00:00<00:01, 6581.66probe position/s]Normalizing amplitudes:  33%|███▎      | 5355/16384 [00:00<00:01, 6609.37probe position/s]Normalizing amplitudes:  37%|███▋      | 6025/16384 [00:00<00:01, 6635.98probe position/s]Normalizing amplitudes:  41%|████      | 6704/16384 [00:01<00:01, 6681.41probe position/s]Normalizing amplitudes:  45%|████▌     | 7373/16384 [00:01<00:01, 6667.44probe position/s]Normalizing amplitudes:  49%|████▉     | 8046/16384 [00:01<00:01, 6685.99probe position/s]Normalizing amplitudes:  53%|█████▎    | 8715/16384 [00:01<00:01, 6630.36probe position/s]Normalizing amplitudes:  57%|█████▋    | 9379/16384 [00:01<00:01, 6616.37probe position/s]Normalizing amplitudes:  61%|██████▏   | 10041/16384 [00:01<00:00, 6589.06probe position/s]Normalizing amplitudes:  65%|██████▌   | 10703/16384 [00:01<00:00, 6596.58probe position/s]Normalizing amplitudes:  69%|██████▉   | 11368/16384 [00:01<00:00, 6609.40probe position/s]Normalizing amplitudes:  73%|███████▎  | 12042/16384 [00:01<00:00, 6648.07probe position/s]Normalizing amplitudes:  78%|███████▊  | 12739/16384 [00:01<00:00, 6743.22probe position/s]Normalizing amplitudes:  82%|████████▏ | 13420/16384 [00:02<00:00, 6762.10probe position/s]Normalizing amplitudes:  86%|████████▌ | 14102/16384 [00:02<00:00, 6778.01probe position/s]Normalizing amplitudes:  90%|█████████ | 14780/16384 [00:02<00:00, 6751.74probe position/s]Normalizing amplitudes:  94%|█████████▍| 15456/16384 [00:02<00:00, 6715.32probe position/s]Normalizing amplitudes:  98%|█████████▊| 16128/16384 [00:02<00:00, 6674.64probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6660.20probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random32_p6_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random32_p6_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.01429 in 70.135 sec
Iter: 2, Total Loss: 0.006082 in 70.107 sec
Iter: 3, Total Loss: 0.005703 in 70.254 sec
Iter: 4, Total Loss: 0.005484 in 70.007 sec
Iter: 5, Total Loss: 0.005332 in 71.085 sec
Iter: 6, Total Loss: 0.005215 in 69.978 sec
Iter: 7, Total Loss: 0.005113 in 70.396 sec
Iter: 8, Total Loss: 0.005021 in 70.518 sec
Iter: 9, Total Loss: 0.004941 in 70.154 sec
Iter: 10, Total Loss: 0.004879 in 69.871 sec
Iter: 11, Total Loss: 0.004833 in 70.339 sec
Iter: 12, Total Loss: 0.004799 in 70.360 sec
Iter: 13, Total Loss: 0.004773 in 70.516 sec
Iter: 14, Total Loss: 0.004751 in 69.505 sec
Iter: 15, Total Loss: 0.004732 in 69.227 sec
Iter: 16, Total Loss: 0.004716 in 69.414 sec
Iter: 17, Total Loss: 0.004702 in 70.410 sec
Iter: 18, Total Loss: 0.00469 in 70.432 sec
Iter: 19, Total Loss: 0.004679 in 70.023 sec
Iter: 20, Total Loss: 0.004668 in 70.098 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 70.142 with std = 0.412 sec ###
### py4DSTEM ptycho solver is finished in 23 min 24.101 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 931.80 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 32, 12, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 664/16384 [00:00<00:02, 6638.84probe position/s]Normalizing amplitudes:   8%|▊         | 1328/16384 [00:00<00:02, 6517.22probe position/s]Normalizing amplitudes:  12%|█▏        | 2030/16384 [00:00<00:02, 6740.56probe position/s]Normalizing amplitudes:  17%|█▋        | 2715/16384 [00:00<00:02, 6780.18probe position/s]Normalizing amplitudes:  21%|██        | 3395/16384 [00:00<00:01, 6784.23probe position/s]Normalizing amplitudes:  25%|██▍       | 4074/16384 [00:00<00:01, 6771.98probe position/s]Normalizing amplitudes:  29%|██▉       | 4757/16384 [00:00<00:01, 6789.75probe position/s]Normalizing amplitudes:  33%|███▎      | 5438/16384 [00:00<00:01, 6795.00probe position/s]Normalizing amplitudes:  37%|███▋      | 6119/16384 [00:00<00:01, 6798.93probe position/s]Normalizing amplitudes:  42%|████▏     | 6814/16384 [00:01<00:01, 6842.90probe position/s]Normalizing amplitudes:  46%|████▌     | 7499/16384 [00:01<00:01, 6803.20probe position/s]Normalizing amplitudes:  50%|████▉     | 8184/16384 [00:01<00:01, 6814.20probe position/s]Normalizing amplitudes:  54%|█████▍    | 8870/16384 [00:01<00:01, 6824.03probe position/s]Normalizing amplitudes:  58%|█████▊    | 9553/16384 [00:01<00:01, 6748.96probe position/s]Normalizing amplitudes:  62%|██████▏   | 10229/16384 [00:01<00:00, 6671.70probe position/s]Normalizing amplitudes:  67%|██████▋   | 10897/16384 [00:01<00:00, 6635.23probe position/s]Normalizing amplitudes:  71%|███████   | 11596/16384 [00:01<00:00, 6737.83probe position/s]Normalizing amplitudes:  75%|███████▍  | 12284/16384 [00:01<00:00, 6777.93probe position/s]Normalizing amplitudes:  79%|███████▉  | 12963/16384 [00:01<00:00, 6646.77probe position/s]Normalizing amplitudes:  83%|████████▎ | 13638/16384 [00:02<00:00, 6675.09probe position/s]Normalizing amplitudes:  87%|████████▋ | 14313/16384 [00:02<00:00, 6695.74probe position/s]Normalizing amplitudes:  91%|█████████▏| 14983/16384 [00:02<00:00, 6656.85probe position/s]Normalizing amplitudes:  96%|█████████▌| 15660/16384 [00:02<00:00, 6689.55probe position/s]Normalizing amplitudes: 100%|█████████▉| 16334/16384 [00:02<00:00, 6703.10probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6730.34probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random32_p12_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random32_p12_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.02387 in 24.283 sec
Iter: 2, Total Loss: 0.006378 in 24.153 sec
Iter: 3, Total Loss: 0.006179 in 24.414 sec
Iter: 4, Total Loss: 0.005999 in 24.284 sec
Iter: 5, Total Loss: 0.005843 in 24.752 sec
Iter: 6, Total Loss: 0.005716 in 24.015 sec
Iter: 7, Total Loss: 0.005606 in 23.782 sec
Iter: 8, Total Loss: 0.005503 in 23.950 sec
Iter: 9, Total Loss: 0.005406 in 24.042 sec
Iter: 10, Total Loss: 0.005312 in 24.130 sec
Iter: 11, Total Loss: 0.005221 in 24.379 sec
Iter: 12, Total Loss: 0.005136 in 23.955 sec
Iter: 13, Total Loss: 0.005063 in 23.845 sec
Iter: 14, Total Loss: 0.005003 in 25.530 sec
Iter: 15, Total Loss: 0.004954 in 26.400 sec
Iter: 16, Total Loss: 0.004913 in 26.446 sec
Iter: 17, Total Loss: 0.004879 in 25.634 sec
Iter: 18, Total Loss: 0.00485 in 25.508 sec
Iter: 19, Total Loss: 0.004824 in 25.898 sec
Iter: 20, Total Loss: 0.004802 in 25.426 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 24.741 with std = 0.861 sec ###
### py4DSTEM ptycho solver is finished in 8 min 16.304 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 907.56 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 32, 12, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 561/16384 [00:00<00:02, 5601.11probe position/s]Normalizing amplitudes:   7%|▋         | 1128/16384 [00:00<00:02, 5638.79probe position/s]Normalizing amplitudes:  11%|█         | 1764/16384 [00:00<00:02, 5964.83probe position/s]Normalizing amplitudes:  15%|█▍        | 2387/16384 [00:00<00:02, 6066.06probe position/s]Normalizing amplitudes:  18%|█▊        | 3015/16384 [00:00<00:02, 6142.25probe position/s]Normalizing amplitudes:  22%|██▏       | 3630/16384 [00:00<00:02, 6048.57probe position/s]Normalizing amplitudes:  26%|██▌       | 4236/16384 [00:00<00:02, 6049.00probe position/s]Normalizing amplitudes:  30%|██▉       | 4842/16384 [00:00<00:01, 5928.43probe position/s]Normalizing amplitudes:  33%|███▎      | 5436/16384 [00:00<00:01, 5784.17probe position/s]Normalizing amplitudes:  37%|███▋      | 6088/16384 [00:01<00:01, 6001.92probe position/s]Normalizing amplitudes:  41%|████      | 6690/16384 [00:01<00:01, 5876.05probe position/s]Normalizing amplitudes:  45%|████▍     | 7318/16384 [00:01<00:01, 5994.37probe position/s]Normalizing amplitudes:  48%|████▊     | 7940/16384 [00:01<00:01, 6058.45probe position/s]Normalizing amplitudes:  52%|█████▏    | 8550/16384 [00:01<00:01, 6069.81probe position/s]Normalizing amplitudes:  56%|█████▌    | 9158/16384 [00:01<00:01, 6003.00probe position/s]Normalizing amplitudes:  60%|█████▉    | 9759/16384 [00:01<00:01, 5836.71probe position/s]Normalizing amplitudes:  63%|██████▎   | 10344/16384 [00:01<00:01, 5838.02probe position/s]Normalizing amplitudes:  67%|██████▋   | 10934/16384 [00:01<00:00, 5850.46probe position/s]Normalizing amplitudes:  70%|███████   | 11520/16384 [00:01<00:00, 5759.13probe position/s]Normalizing amplitudes:  74%|███████▍  | 12151/16384 [00:02<00:00, 5919.84probe position/s]Normalizing amplitudes:  78%|███████▊  | 12767/16384 [00:02<00:00, 5990.22probe position/s]Normalizing amplitudes:  82%|████████▏ | 13397/16384 [00:02<00:00, 6081.19probe position/s]Normalizing amplitudes:  85%|████████▌ | 14006/16384 [00:02<00:00, 6056.34probe position/s]Normalizing amplitudes:  89%|████████▉ | 14613/16384 [00:02<00:00, 5999.96probe position/s]Normalizing amplitudes:  93%|█████████▎| 15230/16384 [00:02<00:00, 6047.92probe position/s]Normalizing amplitudes:  97%|█████████▋| 15836/16384 [00:02<00:00, 5921.77probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5939.74probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random32_p12_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random32_p12_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.02431 in 73.088 sec
Iter: 2, Total Loss: 0.006198 in 74.237 sec
Iter: 3, Total Loss: 0.005869 in 71.603 sec
Iter: 4, Total Loss: 0.005641 in 70.047 sec
Iter: 5, Total Loss: 0.005476 in 69.587 sec
Iter: 6, Total Loss: 0.005347 in 71.228 sec
Iter: 7, Total Loss: 0.005229 in 70.534 sec
Iter: 8, Total Loss: 0.005118 in 69.529 sec
Iter: 9, Total Loss: 0.005012 in 69.494 sec
Iter: 10, Total Loss: 0.004922 in 69.455 sec
Iter: 11, Total Loss: 0.004852 in 70.624 sec
Iter: 12, Total Loss: 0.004798 in 75.245 sec
Iter: 13, Total Loss: 0.004757 in 74.431 sec
Iter: 14, Total Loss: 0.004723 in 76.048 sec
Iter: 15, Total Loss: 0.004696 in 75.855 sec
Iter: 16, Total Loss: 0.004672 in 73.267 sec
Iter: 17, Total Loss: 0.00465 in 69.413 sec
Iter: 18, Total Loss: 0.004631 in 72.196 sec
Iter: 19, Total Loss: 0.004614 in 75.316 sec
Iter: 20, Total Loss: 0.004597 in 75.105 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 72.315 with std = 2.389 sec ###
### py4DSTEM ptycho solver is finished in 24 min 7.823 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 906.38 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 32, 12, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 605/16384 [00:00<00:02, 6046.27probe position/s]Normalizing amplitudes:   7%|▋         | 1216/16384 [00:00<00:02, 6080.41probe position/s]Normalizing amplitudes:  11%|█         | 1834/16384 [00:00<00:02, 6125.65probe position/s]Normalizing amplitudes:  15%|█▍        | 2447/16384 [00:00<00:02, 6103.01probe position/s]Normalizing amplitudes:  19%|█▊        | 3058/16384 [00:00<00:02, 6101.72probe position/s]Normalizing amplitudes:  22%|██▏       | 3673/16384 [00:00<00:02, 6116.46probe position/s]Normalizing amplitudes:  26%|██▌       | 4285/16384 [00:00<00:01, 6049.97probe position/s]Normalizing amplitudes:  30%|██▉       | 4891/16384 [00:00<00:01, 5917.94probe position/s]Normalizing amplitudes:  33%|███▎      | 5484/16384 [00:00<00:01, 5868.51probe position/s]Normalizing amplitudes:  37%|███▋      | 6110/16384 [00:01<00:01, 5984.91probe position/s]Normalizing amplitudes:  41%|████      | 6710/16384 [00:01<00:01, 5968.00probe position/s]Normalizing amplitudes:  45%|████▍     | 7308/16384 [00:01<00:01, 5952.30probe position/s]Normalizing amplitudes:  48%|████▊     | 7913/16384 [00:01<00:01, 5980.67probe position/s]Normalizing amplitudes:  52%|█████▏    | 8517/16384 [00:01<00:01, 5997.03probe position/s]Normalizing amplitudes:  56%|█████▌    | 9126/16384 [00:01<00:01, 6022.64probe position/s]Normalizing amplitudes:  59%|█████▉    | 9729/16384 [00:01<00:01, 5954.50probe position/s]Normalizing amplitudes:  63%|██████▎   | 10352/16384 [00:01<00:00, 6034.24probe position/s]Normalizing amplitudes:  67%|██████▋   | 10956/16384 [00:01<00:00, 6022.33probe position/s]Normalizing amplitudes:  71%|███████   | 11562/16384 [00:01<00:00, 6031.61probe position/s]Normalizing amplitudes:  74%|███████▍  | 12179/16384 [00:02<00:00, 6070.49probe position/s]Normalizing amplitudes:  78%|███████▊  | 12787/16384 [00:02<00:00, 6071.13probe position/s]Normalizing amplitudes:  82%|████████▏ | 13395/16384 [00:02<00:00, 6048.83probe position/s]Normalizing amplitudes:  85%|████████▌ | 14000/16384 [00:02<00:00, 6016.14probe position/s]Normalizing amplitudes:  89%|████████▉ | 14602/16384 [00:02<00:00, 5736.12probe position/s]Normalizing amplitudes:  93%|█████████▎| 15263/16384 [00:02<00:00, 5985.85probe position/s]Normalizing amplitudes:  97%|█████████▋| 15895/16384 [00:02<00:00, 6082.15probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6018.84probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random32_p12_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random32_p12_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.02507 in 150.359 sec
Iter: 2, Total Loss: 0.00597 in 147.896 sec
Iter: 3, Total Loss: 0.00555 in 151.237 sec
Iter: 4, Total Loss: 0.005321 in 150.459 sec
Iter: 5, Total Loss: 0.005157 in 143.804 sec
Iter: 6, Total Loss: 0.005021 in 148.789 sec
Iter: 7, Total Loss: 0.004904 in 150.042 sec
Iter: 8, Total Loss: 0.004811 in 141.831 sec
Iter: 9, Total Loss: 0.004745 in 151.000 sec
Iter: 10, Total Loss: 0.004696 in 149.727 sec
Iter: 11, Total Loss: 0.004658 in 143.749 sec
Iter: 12, Total Loss: 0.004629 in 147.310 sec
Iter: 13, Total Loss: 0.004603 in 149.803 sec
Iter: 14, Total Loss: 0.004583 in 147.420 sec
Iter: 15, Total Loss: 0.004565 in 144.506 sec
Iter: 16, Total Loss: 0.004549 in 149.036 sec
Iter: 17, Total Loss: 0.004535 in 147.559 sec
Iter: 18, Total Loss: 0.004523 in 152.872 sec
Iter: 19, Total Loss: 0.004512 in 158.005 sec
Iter: 20, Total Loss: 0.004502 in 154.507 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 148.996 with std = 3.718 sec ###
### py4DSTEM ptycho solver is finished in 49 min 41.411 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 921.19 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 16, 1, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 689/16384 [00:00<00:02, 6889.17probe position/s]Normalizing amplitudes:   8%|▊         | 1378/16384 [00:00<00:02, 6359.09probe position/s]Normalizing amplitudes:  12%|█▏        | 2017/16384 [00:00<00:02, 5865.49probe position/s]Normalizing amplitudes:  16%|█▋        | 2671/16384 [00:00<00:02, 6111.34probe position/s]Normalizing amplitudes:  20%|██        | 3344/16384 [00:00<00:02, 6322.93probe position/s]Normalizing amplitudes:  24%|██▍       | 3981/16384 [00:00<00:01, 6328.39probe position/s]Normalizing amplitudes:  28%|██▊       | 4617/16384 [00:00<00:01, 6287.38probe position/s]Normalizing amplitudes:  32%|███▏      | 5264/16384 [00:00<00:01, 6341.45probe position/s]Normalizing amplitudes:  36%|███▌      | 5900/16384 [00:00<00:01, 5365.76probe position/s]Normalizing amplitudes:  40%|███▉      | 6536/16384 [00:01<00:01, 5633.16probe position/s]Normalizing amplitudes:  44%|████▍     | 7192/16384 [00:01<00:01, 5890.33probe position/s]Normalizing amplitudes:  48%|████▊     | 7868/16384 [00:01<00:01, 6138.06probe position/s]Normalizing amplitudes:  52%|█████▏    | 8496/16384 [00:01<00:01, 6063.01probe position/s]Normalizing amplitudes:  56%|█████▌    | 9112/16384 [00:01<00:01, 5148.76probe position/s]Normalizing amplitudes:  59%|█████▉    | 9724/16384 [00:01<00:01, 5399.44probe position/s]Normalizing amplitudes:  63%|██████▎   | 10361/16384 [00:01<00:01, 5657.40probe position/s]Normalizing amplitudes:  67%|██████▋   | 10947/16384 [00:01<00:00, 5601.84probe position/s]Normalizing amplitudes:  71%|███████   | 11597/16384 [00:01<00:00, 5853.36probe position/s]Normalizing amplitudes:  75%|███████▍  | 12218/16384 [00:02<00:00, 5955.25probe position/s]Normalizing amplitudes:  78%|███████▊  | 12823/16384 [00:02<00:00, 5846.06probe position/s]Normalizing amplitudes:  82%|████████▏ | 13414/16384 [00:02<00:00, 5655.23probe position/s]Normalizing amplitudes:  86%|████████▌ | 14012/16384 [00:02<00:00, 5744.02probe position/s]Normalizing amplitudes:  90%|████████▉ | 14688/16384 [00:02<00:00, 6036.58probe position/s]Normalizing amplitudes:  94%|█████████▍| 15400/16384 [00:02<00:00, 6351.24probe position/s]Normalizing amplitudes:  98%|█████████▊| 16095/16384 [00:02<00:00, 6526.01probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5982.84probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random16_p1_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random16_p1_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.006893 in 7.287 sec
Iter: 2, Total Loss: 0.00656 in 7.704 sec
Iter: 3, Total Loss: 0.006467 in 6.957 sec
Iter: 4, Total Loss: 0.006374 in 6.882 sec
Iter: 5, Total Loss: 0.006299 in 6.995 sec
Iter: 6, Total Loss: 0.006242 in 7.399 sec
Iter: 7, Total Loss: 0.006201 in 7.884 sec
Iter: 8, Total Loss: 0.006178 in 6.863 sec
Iter: 9, Total Loss: 0.006159 in 7.039 sec
Iter: 10, Total Loss: 0.006148 in 8.392 sec
Iter: 11, Total Loss: 0.006141 in 7.481 sec
Iter: 12, Total Loss: 0.006133 in 7.174 sec
Iter: 13, Total Loss: 0.006126 in 7.618 sec
Iter: 14, Total Loss: 0.006123 in 7.519 sec
Iter: 15, Total Loss: 0.00612 in 7.418 sec
Iter: 16, Total Loss: 0.006118 in 7.595 sec
Iter: 17, Total Loss: 0.006113 in 7.795 sec
Iter: 18, Total Loss: 0.00611 in 6.997 sec
Iter: 19, Total Loss: 0.006109 in 7.307 sec
Iter: 20, Total Loss: 0.006106 in 7.124 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 7.372 with std = 0.382 sec ###
### py4DSTEM ptycho solver is finished in 2 min 28.979 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 907.52 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 16, 1, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 599/16384 [00:00<00:02, 5986.87probe position/s]Normalizing amplitudes:   7%|▋         | 1201/16384 [00:00<00:02, 6005.77probe position/s]Normalizing amplitudes:  11%|█         | 1802/16384 [00:00<00:02, 5925.61probe position/s]Normalizing amplitudes:  15%|█▍        | 2401/16384 [00:00<00:02, 5948.36probe position/s]Normalizing amplitudes:  18%|█▊        | 3006/16384 [00:00<00:02, 5982.29probe position/s]Normalizing amplitudes:  22%|██▏       | 3626/16384 [00:00<00:02, 6050.36probe position/s]Normalizing amplitudes:  26%|██▌       | 4232/16384 [00:00<00:02, 5937.84probe position/s]Normalizing amplitudes:  30%|██▉       | 4841/16384 [00:00<00:01, 5985.42probe position/s]Normalizing amplitudes:  33%|███▎      | 5452/16384 [00:00<00:01, 6021.87probe position/s]Normalizing amplitudes:  37%|███▋      | 6055/16384 [00:01<00:01, 6000.73probe position/s]Normalizing amplitudes:  41%|████      | 6672/16384 [00:01<00:01, 6052.00probe position/s]Normalizing amplitudes:  44%|████▍     | 7278/16384 [00:01<00:01, 5975.52probe position/s]Normalizing amplitudes:  48%|████▊     | 7892/16384 [00:01<00:01, 6021.99probe position/s]Normalizing amplitudes:  52%|█████▏    | 8499/16384 [00:01<00:01, 6032.27probe position/s]Normalizing amplitudes:  56%|█████▌    | 9103/16384 [00:01<00:01, 6031.74probe position/s]Normalizing amplitudes:  59%|█████▉    | 9708/16384 [00:01<00:01, 6036.30probe position/s]Normalizing amplitudes:  63%|██████▎   | 10312/16384 [00:01<00:01, 5540.95probe position/s]Normalizing amplitudes:  67%|██████▋   | 10922/16384 [00:01<00:00, 5697.18probe position/s]Normalizing amplitudes:  70%|███████   | 11500/16384 [00:01<00:00, 5720.58probe position/s]Normalizing amplitudes:  74%|███████▎  | 12077/16384 [00:02<00:00, 5673.36probe position/s]Normalizing amplitudes:  77%|███████▋  | 12648/16384 [00:02<00:00, 5681.57probe position/s]Normalizing amplitudes:  81%|████████  | 13264/16384 [00:02<00:00, 5821.03probe position/s]Normalizing amplitudes:  85%|████████▍ | 13849/16384 [00:02<00:00, 5800.59probe position/s]Normalizing amplitudes:  88%|████████▊ | 14431/16384 [00:02<00:00, 5683.72probe position/s]Normalizing amplitudes:  92%|█████████▏| 15030/16384 [00:02<00:00, 5771.24probe position/s]Normalizing amplitudes:  95%|█████████▌| 15632/16384 [00:02<00:00, 5843.50probe position/s]Normalizing amplitudes:  99%|█████████▉| 16218/16384 [00:02<00:00, 5828.76probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5878.49probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random16_p1_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random16_p1_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.006922 in 17.121 sec
Iter: 2, Total Loss: 0.006519 in 17.438 sec
Iter: 3, Total Loss: 0.00641 in 17.365 sec
Iter: 4, Total Loss: 0.00632 in 17.069 sec
Iter: 5, Total Loss: 0.006259 in 17.391 sec
Iter: 6, Total Loss: 0.006213 in 17.830 sec
Iter: 7, Total Loss: 0.006185 in 18.006 sec
Iter: 8, Total Loss: 0.006164 in 17.805 sec
Iter: 9, Total Loss: 0.006145 in 17.660 sec
Iter: 10, Total Loss: 0.006132 in 17.431 sec
Iter: 11, Total Loss: 0.006121 in 17.463 sec
Iter: 12, Total Loss: 0.006111 in 17.431 sec
Iter: 13, Total Loss: 0.006103 in 17.209 sec
Iter: 14, Total Loss: 0.006096 in 17.317 sec
Iter: 15, Total Loss: 0.006091 in 16.332 sec
Iter: 16, Total Loss: 0.006087 in 16.707 sec
Iter: 17, Total Loss: 0.006081 in 15.732 sec
Iter: 18, Total Loss: 0.006072 in 16.189 sec
Iter: 19, Total Loss: 0.006069 in 15.493 sec
Iter: 20, Total Loss: 0.006063 in 16.555 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 17.077 with std = 0.677 sec ###
### py4DSTEM ptycho solver is finished in 5 min 42.863 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 920.55 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 16, 1, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   1%|          | 198/16384 [00:00<00:08, 1978.61probe position/s]Normalizing amplitudes:   3%|▎         | 475/16384 [00:00<00:06, 2404.06probe position/s]Normalizing amplitudes:   5%|▍         | 760/16384 [00:00<00:06, 2559.87probe position/s]Normalizing amplitudes:   6%|▌         | 1016/16384 [00:00<00:06, 2360.59probe position/s]Normalizing amplitudes:  10%|▉         | 1597/16384 [00:00<00:04, 3526.53probe position/s]Normalizing amplitudes:  13%|█▎        | 2168/16384 [00:00<00:03, 4237.93probe position/s]Normalizing amplitudes:  17%|█▋        | 2739/16384 [00:00<00:02, 4704.06probe position/s]Normalizing amplitudes:  20%|██        | 3319/16384 [00:00<00:02, 5045.46probe position/s]Normalizing amplitudes:  23%|██▎       | 3830/16384 [00:00<00:02, 4643.51probe position/s]Normalizing amplitudes:  27%|██▋       | 4495/16384 [00:01<00:02, 5218.84probe position/s]Normalizing amplitudes:  32%|███▏      | 5248/16384 [00:01<00:01, 5889.77probe position/s]Normalizing amplitudes:  36%|███▌      | 5848/16384 [00:01<00:01, 5369.12probe position/s]Normalizing amplitudes:  40%|███▉      | 6515/16384 [00:01<00:01, 5727.18probe position/s]Normalizing amplitudes:  44%|████▍     | 7186/16384 [00:01<00:01, 6004.20probe position/s]Normalizing amplitudes:  48%|████▊     | 7919/16384 [00:01<00:01, 6384.19probe position/s]Normalizing amplitudes:  53%|█████▎    | 8620/16384 [00:01<00:01, 6555.88probe position/s]Normalizing amplitudes:  57%|█████▋    | 9284/16384 [00:01<00:01, 5779.29probe position/s]Normalizing amplitudes:  60%|██████    | 9884/16384 [00:02<00:01, 4831.99probe position/s]Normalizing amplitudes:  64%|██████▍   | 10470/16384 [00:02<00:01, 5078.36probe position/s]Normalizing amplitudes:  68%|██████▊   | 11142/16384 [00:02<00:00, 5497.58probe position/s]Normalizing amplitudes:  73%|███████▎  | 11886/16384 [00:02<00:00, 6016.95probe position/s]Normalizing amplitudes:  77%|███████▋  | 12672/16384 [00:02<00:00, 6525.26probe position/s]Normalizing amplitudes:  82%|████████▏ | 13411/16384 [00:02<00:00, 6769.88probe position/s]Normalizing amplitudes:  86%|████████▌ | 14106/16384 [00:02<00:00, 6380.73probe position/s]Normalizing amplitudes:  90%|█████████ | 14761/16384 [00:02<00:00, 5850.90probe position/s]Normalizing amplitudes:  94%|█████████▍| 15365/16384 [00:02<00:00, 5807.27probe position/s]Normalizing amplitudes:  97%|█████████▋| 15964/16384 [00:02<00:00, 5855.12probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:03<00:00, 5392.75probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random16_p1_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random16_p1_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.00699 in 34.862 sec
Iter: 2, Total Loss: 0.006558 in 32.086 sec
Iter: 3, Total Loss: 0.006439 in 32.280 sec
Iter: 4, Total Loss: 0.006357 in 33.858 sec
Iter: 5, Total Loss: 0.006293 in 32.703 sec
Iter: 6, Total Loss: 0.006255 in 32.229 sec
Iter: 7, Total Loss: 0.006223 in 33.670 sec
Iter: 8, Total Loss: 0.006204 in 32.780 sec
Iter: 9, Total Loss: 0.006177 in 33.035 sec
Iter: 10, Total Loss: 0.006155 in 32.516 sec
Iter: 11, Total Loss: 0.006132 in 31.665 sec
Iter: 12, Total Loss: 0.006111 in 32.848 sec
Iter: 13, Total Loss: 0.006092 in 31.197 sec
Iter: 14, Total Loss: 0.006069 in 30.224 sec
Iter: 15, Total Loss: 0.006051 in 33.133 sec
Iter: 16, Total Loss: 0.006031 in 33.854 sec
Iter: 17, Total Loss: 0.006013 in 33.814 sec
Iter: 18, Total Loss: 0.005995 in 32.235 sec
Iter: 19, Total Loss: 0.00598 in 32.713 sec
Iter: 20, Total Loss: 0.005966 in 32.311 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 32.701 with std = 1.012 sec ###
### py4DSTEM ptycho solver is finished in 10 min 55.657 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 905.84 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 16, 3, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 542/16384 [00:00<00:02, 5417.73probe position/s]Normalizing amplitudes:   7%|▋         | 1084/16384 [00:00<00:02, 5406.95probe position/s]Normalizing amplitudes:  10%|█         | 1693/16384 [00:00<00:02, 5712.66probe position/s]Normalizing amplitudes:  14%|█▍        | 2319/16384 [00:00<00:02, 5927.78probe position/s]Normalizing amplitudes:  18%|█▊        | 2920/16384 [00:00<00:02, 5954.80probe position/s]Normalizing amplitudes:  22%|██▏       | 3542/16384 [00:00<00:02, 6042.29probe position/s]Normalizing amplitudes:  25%|██▌       | 4147/16384 [00:00<00:02, 5604.84probe position/s]Normalizing amplitudes:  29%|██▉       | 4714/16384 [00:00<00:02, 5598.60probe position/s]Normalizing amplitudes:  32%|███▏      | 5283/16384 [00:00<00:01, 5625.40probe position/s]Normalizing amplitudes:  36%|███▌      | 5849/16384 [00:01<00:01, 5605.67probe position/s]Normalizing amplitudes:  40%|███▉      | 6487/16384 [00:01<00:01, 5837.19probe position/s]Normalizing amplitudes:  43%|████▎     | 7073/16384 [00:01<00:01, 5832.12probe position/s]Normalizing amplitudes:  47%|████▋     | 7658/16384 [00:01<00:01, 5661.65probe position/s]Normalizing amplitudes:  50%|█████     | 8236/16384 [00:01<00:01, 5695.46probe position/s]Normalizing amplitudes:  54%|█████▍    | 8807/16384 [00:01<00:01, 5651.09probe position/s]Normalizing amplitudes:  57%|█████▋    | 9407/16384 [00:01<00:01, 5752.98probe position/s]Normalizing amplitudes:  61%|██████    | 9984/16384 [00:01<00:01, 5733.88probe position/s]Normalizing amplitudes:  65%|██████▍   | 10599/16384 [00:01<00:00, 5854.43probe position/s]Normalizing amplitudes:  68%|██████▊   | 11221/16384 [00:01<00:00, 5961.90probe position/s]Normalizing amplitudes:  72%|███████▏  | 11818/16384 [00:02<00:00, 5906.33probe position/s]Normalizing amplitudes:  76%|███████▌  | 12410/16384 [00:02<00:00, 5704.74probe position/s]Normalizing amplitudes:  79%|███████▉  | 12983/16384 [00:02<00:00, 5654.03probe position/s]Normalizing amplitudes:  83%|████████▎ | 13550/16384 [00:02<00:00, 5647.19probe position/s]Normalizing amplitudes:  86%|████████▋ | 14134/16384 [00:02<00:00, 5702.31probe position/s]Normalizing amplitudes:  90%|████████▉ | 14738/16384 [00:02<00:00, 5801.57probe position/s]Normalizing amplitudes:  94%|█████████▍| 15371/16384 [00:02<00:00, 5957.23probe position/s]Normalizing amplitudes:  98%|█████████▊| 16010/16384 [00:02<00:00, 6083.47probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5811.30probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random16_p3_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random16_p3_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.007654 in 16.119 sec
Iter: 2, Total Loss: 0.006416 in 15.650 sec
Iter: 3, Total Loss: 0.0062 in 15.258 sec
Iter: 4, Total Loss: 0.005989 in 15.379 sec
Iter: 5, Total Loss: 0.005816 in 15.847 sec
Iter: 6, Total Loss: 0.005696 in 15.674 sec
Iter: 7, Total Loss: 0.005606 in 15.574 sec
Iter: 8, Total Loss: 0.005529 in 16.288 sec
Iter: 9, Total Loss: 0.00546 in 15.783 sec
Iter: 10, Total Loss: 0.005402 in 15.625 sec
Iter: 11, Total Loss: 0.00536 in 15.174 sec
Iter: 12, Total Loss: 0.005329 in 14.778 sec
Iter: 13, Total Loss: 0.005308 in 14.315 sec
Iter: 14, Total Loss: 0.005292 in 13.960 sec
Iter: 15, Total Loss: 0.00528 in 14.373 sec
Iter: 16, Total Loss: 0.00527 in 14.045 sec
Iter: 17, Total Loss: 0.005262 in 14.256 sec
Iter: 18, Total Loss: 0.005256 in 15.569 sec
Iter: 19, Total Loss: 0.005249 in 16.104 sec
Iter: 20, Total Loss: 0.005245 in 15.662 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 15.272 with std = 0.709 sec ###
### py4DSTEM ptycho solver is finished in 5 min 6.956 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 912.79 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 16, 3, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 655/16384 [00:00<00:02, 6541.82probe position/s]Normalizing amplitudes:   8%|▊         | 1310/16384 [00:00<00:02, 6036.68probe position/s]Normalizing amplitudes:  12%|█▏        | 1945/16384 [00:00<00:02, 6171.98probe position/s]Normalizing amplitudes:  16%|█▌        | 2581/16384 [00:00<00:02, 6241.93probe position/s]Normalizing amplitudes:  20%|█▉        | 3207/16384 [00:00<00:02, 5953.94probe position/s]Normalizing amplitudes:  23%|██▎       | 3806/16384 [00:00<00:02, 5831.13probe position/s]Normalizing amplitudes:  27%|██▋       | 4391/16384 [00:00<00:02, 5670.58probe position/s]Normalizing amplitudes:  30%|███       | 4963/16384 [00:00<00:02, 5683.99probe position/s]Normalizing amplitudes:  34%|███▍      | 5533/16384 [00:00<00:01, 5594.24probe position/s]Normalizing amplitudes:  37%|███▋      | 6095/16384 [00:01<00:01, 5599.36probe position/s]Normalizing amplitudes:  41%|████      | 6656/16384 [00:01<00:01, 5579.82probe position/s]Normalizing amplitudes:  44%|████▍     | 7215/16384 [00:01<00:01, 4963.57probe position/s]Normalizing amplitudes:  47%|████▋     | 7724/16384 [00:01<00:01, 4903.35probe position/s]Normalizing amplitudes:  51%|█████     | 8281/16384 [00:01<00:01, 5087.30probe position/s]Normalizing amplitudes:  54%|█████▍    | 8842/16384 [00:01<00:01, 5234.47probe position/s]Normalizing amplitudes:  57%|█████▋    | 9378/16384 [00:01<00:01, 5269.92probe position/s]Normalizing amplitudes:  60%|██████    | 9910/16384 [00:01<00:01, 5112.30probe position/s]Normalizing amplitudes:  64%|██████▎   | 10431/16384 [00:01<00:01, 5140.05probe position/s]Normalizing amplitudes:  67%|██████▋   | 10974/16384 [00:02<00:01, 5222.73probe position/s]Normalizing amplitudes:  71%|███████   | 11567/16384 [00:02<00:00, 5427.63probe position/s]Normalizing amplitudes:  74%|███████▍  | 12124/16384 [00:02<00:00, 5465.90probe position/s]Normalizing amplitudes:  78%|███████▊  | 12699/16384 [00:02<00:00, 5549.05probe position/s]Normalizing amplitudes:  81%|████████  | 13263/16384 [00:02<00:00, 5571.31probe position/s]Normalizing amplitudes:  85%|████████▍ | 13847/16384 [00:02<00:00, 5651.15probe position/s]Normalizing amplitudes:  88%|████████▊ | 14469/16384 [00:02<00:00, 5820.42probe position/s]Normalizing amplitudes:  92%|█████████▏| 15082/16384 [00:02<00:00, 5909.70probe position/s]Normalizing amplitudes:  96%|█████████▌| 15692/16384 [00:02<00:00, 5963.66probe position/s]Normalizing amplitudes: 100%|█████████▉| 16328/16384 [00:02<00:00, 6080.47probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5602.33probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random16_p3_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random16_p3_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.007669 in 43.052 sec
Iter: 2, Total Loss: 0.006127 in 42.549 sec
Iter: 3, Total Loss: 0.005831 in 43.659 sec
Iter: 4, Total Loss: 0.005647 in 37.760 sec
Iter: 5, Total Loss: 0.005525 in 37.492 sec
Iter: 6, Total Loss: 0.00543 in 37.485 sec
Iter: 7, Total Loss: 0.005349 in 37.270 sec
Iter: 8, Total Loss: 0.005285 in 38.443 sec
Iter: 9, Total Loss: 0.005238 in 40.812 sec
Iter: 10, Total Loss: 0.005202 in 38.256 sec
Iter: 11, Total Loss: 0.005174 in 37.185 sec
Iter: 12, Total Loss: 0.00515 in 37.753 sec
Iter: 13, Total Loss: 0.005129 in 37.716 sec
Iter: 14, Total Loss: 0.005111 in 37.128 sec
Iter: 15, Total Loss: 0.005096 in 37.043 sec
Iter: 16, Total Loss: 0.005083 in 37.490 sec
Iter: 17, Total Loss: 0.005072 in 36.289 sec
Iter: 18, Total Loss: 0.005062 in 40.163 sec
Iter: 19, Total Loss: 0.005053 in 37.232 sec
Iter: 20, Total Loss: 0.005045 in 37.523 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 38.615 with std = 2.135 sec ###
### py4DSTEM ptycho solver is finished in 12 min 53.637 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 897.87 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 16, 3, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 701/16384 [00:00<00:02, 7006.47probe position/s]Normalizing amplitudes:   9%|▊         | 1402/16384 [00:00<00:02, 6677.16probe position/s]Normalizing amplitudes:  13%|█▎        | 2071/16384 [00:00<00:02, 6453.95probe position/s]Normalizing amplitudes:  17%|█▋        | 2758/16384 [00:00<00:02, 6608.40probe position/s]Normalizing amplitudes:  21%|██        | 3464/16384 [00:00<00:01, 6765.02probe position/s]Normalizing amplitudes:  26%|██▌       | 4184/16384 [00:00<00:01, 6908.98probe position/s]Normalizing amplitudes:  30%|██▉       | 4876/16384 [00:00<00:01, 6823.10probe position/s]Normalizing amplitudes:  34%|███▍      | 5560/16384 [00:00<00:01, 6767.75probe position/s]Normalizing amplitudes:  38%|███▊      | 6238/16384 [00:00<00:01, 6392.82probe position/s]Normalizing amplitudes:  42%|████▏     | 6928/16384 [00:01<00:01, 6540.91probe position/s]Normalizing amplitudes:  46%|████▋     | 7593/16384 [00:01<00:01, 6571.42probe position/s]Normalizing amplitudes:  51%|█████     | 8298/16384 [00:01<00:01, 6712.35probe position/s]Normalizing amplitudes:  55%|█████▍    | 8985/16384 [00:01<00:01, 6758.72probe position/s]Normalizing amplitudes:  59%|█████▉    | 9699/16384 [00:01<00:00, 6870.31probe position/s]Normalizing amplitudes:  64%|██████▎   | 10440/16384 [00:01<00:00, 7029.32probe position/s]Normalizing amplitudes:  68%|██████▊   | 11144/16384 [00:01<00:00, 6807.51probe position/s]Normalizing amplitudes:  72%|███████▏  | 11827/16384 [00:01<00:00, 6598.48probe position/s]Normalizing amplitudes:  76%|███████▌  | 12490/16384 [00:01<00:00, 6559.65probe position/s]Normalizing amplitudes:  80%|████████  | 13173/16384 [00:01<00:00, 6636.76probe position/s]Normalizing amplitudes:  85%|████████▍ | 13882/16384 [00:02<00:00, 6768.45probe position/s]Normalizing amplitudes:  89%|████████▉ | 14566/16384 [00:02<00:00, 6789.03probe position/s]Normalizing amplitudes:  93%|█████████▎| 15265/16384 [00:02<00:00, 6847.86probe position/s]Normalizing amplitudes:  97%|█████████▋| 15951/16384 [00:02<00:00, 6838.28probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6738.60probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random16_p3_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random16_p3_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.007901 in 74.267 sec
Iter: 2, Total Loss: 0.006002 in 72.097 sec
Iter: 3, Total Loss: 0.005715 in 71.589 sec
Iter: 4, Total Loss: 0.005558 in 72.771 sec
Iter: 5, Total Loss: 0.005458 in 71.786 sec
Iter: 6, Total Loss: 0.005378 in 70.666 sec
Iter: 7, Total Loss: 0.005304 in 70.917 sec
Iter: 8, Total Loss: 0.005238 in 73.204 sec
Iter: 9, Total Loss: 0.005187 in 72.107 sec
Iter: 10, Total Loss: 0.005147 in 72.579 sec
Iter: 11, Total Loss: 0.005114 in 73.014 sec
Iter: 12, Total Loss: 0.005087 in 72.037 sec
Iter: 13, Total Loss: 0.005064 in 72.752 sec
Iter: 14, Total Loss: 0.005044 in 71.427 sec
Iter: 15, Total Loss: 0.005027 in 71.692 sec
Iter: 16, Total Loss: 0.005011 in 71.648 sec
Iter: 17, Total Loss: 0.004997 in 71.915 sec
Iter: 18, Total Loss: 0.004983 in 70.842 sec
Iter: 19, Total Loss: 0.004971 in 73.422 sec
Iter: 20, Total Loss: 0.004959 in 71.842 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 72.129 with std = 0.892 sec ###
### py4DSTEM ptycho solver is finished in 24 min 3.938 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 927.60 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 16, 6, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 685/16384 [00:00<00:02, 6845.63probe position/s]Normalizing amplitudes:   9%|▊         | 1405/16384 [00:00<00:02, 7051.81probe position/s]Normalizing amplitudes:  13%|█▎        | 2111/16384 [00:00<00:02, 6707.86probe position/s]Normalizing amplitudes:  17%|█▋        | 2784/16384 [00:00<00:02, 6651.11probe position/s]Normalizing amplitudes:  21%|██        | 3476/16384 [00:00<00:01, 6745.29probe position/s]Normalizing amplitudes:  25%|██▌       | 4152/16384 [00:00<00:01, 6675.94probe position/s]Normalizing amplitudes:  30%|██▉       | 4851/16384 [00:00<00:01, 6774.02probe position/s]Normalizing amplitudes:  34%|███▍      | 5530/16384 [00:00<00:01, 6605.19probe position/s]Normalizing amplitudes:  38%|███▊      | 6192/16384 [00:00<00:01, 6535.41probe position/s]Normalizing amplitudes:  42%|████▏     | 6886/16384 [00:01<00:01, 6654.77probe position/s]Normalizing amplitudes:  47%|████▋     | 7657/16384 [00:01<00:01, 6971.05probe position/s]Normalizing amplitudes:  51%|█████     | 8366/16384 [00:01<00:01, 7006.37probe position/s]Normalizing amplitudes:  55%|█████▌    | 9081/16384 [00:01<00:01, 7047.70probe position/s]Normalizing amplitudes:  60%|█████▉    | 9787/16384 [00:01<00:00, 7045.60probe position/s]Normalizing amplitudes:  64%|██████▍   | 10493/16384 [00:01<00:00, 7028.04probe position/s]Normalizing amplitudes:  68%|██████▊   | 11197/16384 [00:01<00:00, 6931.46probe position/s]Normalizing amplitudes:  73%|███████▎  | 11896/16384 [00:01<00:00, 6947.45probe position/s]Normalizing amplitudes:  77%|███████▋  | 12592/16384 [00:01<00:00, 6923.74probe position/s]Normalizing amplitudes:  81%|████████▏ | 13313/16384 [00:01<00:00, 7008.00probe position/s]Normalizing amplitudes:  86%|████████▌ | 14015/16384 [00:02<00:00, 6987.19probe position/s]Normalizing amplitudes:  90%|████████▉ | 14714/16384 [00:02<00:00, 6683.44probe position/s]Normalizing amplitudes:  94%|█████████▍| 15414/16384 [00:02<00:00, 6774.97probe position/s]Normalizing amplitudes:  98%|█████████▊| 16102/16384 [00:02<00:00, 6804.80probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6846.85probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random16_p6_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random16_p6_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.00981 in 24.809 sec
Iter: 2, Total Loss: 0.006402 in 24.483 sec
Iter: 3, Total Loss: 0.006172 in 24.396 sec
Iter: 4, Total Loss: 0.005952 in 24.314 sec
Iter: 5, Total Loss: 0.005768 in 24.382 sec
Iter: 6, Total Loss: 0.005626 in 24.302 sec
Iter: 7, Total Loss: 0.005504 in 25.440 sec
Iter: 8, Total Loss: 0.005384 in 25.034 sec
Iter: 9, Total Loss: 0.005274 in 24.638 sec
Iter: 10, Total Loss: 0.005189 in 26.483 sec
Iter: 11, Total Loss: 0.005122 in 26.060 sec
Iter: 12, Total Loss: 0.005069 in 29.306 sec
Iter: 13, Total Loss: 0.00503 in 26.750 sec
Iter: 14, Total Loss: 0.004999 in 26.714 sec
Iter: 15, Total Loss: 0.004973 in 26.418 sec
Iter: 16, Total Loss: 0.004951 in 26.594 sec
Iter: 17, Total Loss: 0.004931 in 27.173 sec
Iter: 18, Total Loss: 0.004914 in 27.064 sec
Iter: 19, Total Loss: 0.004899 in 26.887 sec
Iter: 20, Total Loss: 0.004885 in 26.868 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 25.906 with std = 1.311 sec ###
### py4DSTEM ptycho solver is finished in 8 min 39.735 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 908.01 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 16, 6, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 628/16384 [00:00<00:02, 6279.77probe position/s]Normalizing amplitudes:   8%|▊         | 1256/16384 [00:00<00:02, 6035.74probe position/s]Normalizing amplitudes:  11%|█▏        | 1874/16384 [00:00<00:02, 6096.81probe position/s]Normalizing amplitudes:  15%|█▌        | 2485/16384 [00:00<00:02, 5957.60probe position/s]Normalizing amplitudes:  19%|█▉        | 3112/16384 [00:00<00:02, 6067.38probe position/s]Normalizing amplitudes:  23%|██▎       | 3728/16384 [00:00<00:02, 6097.65probe position/s]Normalizing amplitudes:  26%|██▋       | 4341/16384 [00:00<00:01, 6107.56probe position/s]Normalizing amplitudes:  30%|███       | 4954/16384 [00:00<00:01, 6114.18probe position/s]Normalizing amplitudes:  34%|███▍      | 5566/16384 [00:00<00:01, 6113.81probe position/s]Normalizing amplitudes:  38%|███▊      | 6179/16384 [00:01<00:01, 6117.28probe position/s]Normalizing amplitudes:  41%|████▏     | 6791/16384 [00:01<00:01, 6091.90probe position/s]Normalizing amplitudes:  45%|████▌     | 7401/16384 [00:01<00:01, 6088.55probe position/s]Normalizing amplitudes:  49%|████▉     | 8010/16384 [00:01<00:01, 6035.18probe position/s]Normalizing amplitudes:  53%|█████▎    | 8615/16384 [00:01<00:01, 6037.86probe position/s]Normalizing amplitudes:  56%|█████▋    | 9219/16384 [00:01<00:01, 6005.13probe position/s]Normalizing amplitudes:  60%|█████▉    | 9828/16384 [00:01<00:01, 6029.62probe position/s]Normalizing amplitudes:  64%|██████▎   | 10438/16384 [00:01<00:00, 6047.69probe position/s]Normalizing amplitudes:  67%|██████▋   | 11043/16384 [00:01<00:00, 5789.83probe position/s]Normalizing amplitudes:  71%|███████   | 11625/16384 [00:01<00:00, 5512.88probe position/s]Normalizing amplitudes:  74%|███████▍  | 12181/16384 [00:02<00:00, 5486.97probe position/s]Normalizing amplitudes:  78%|███████▊  | 12831/16384 [00:02<00:00, 5775.16probe position/s]Normalizing amplitudes:  82%|████████▏ | 13453/16384 [00:02<00:00, 5902.50probe position/s]Normalizing amplitudes:  86%|████████▌ | 14061/16384 [00:02<00:00, 5953.54probe position/s]Normalizing amplitudes:  90%|████████▉ | 14675/16384 [00:02<00:00, 6007.55probe position/s]Normalizing amplitudes:  93%|█████████▎| 15297/16384 [00:02<00:00, 6069.88probe position/s]Normalizing amplitudes:  97%|█████████▋| 15917/16384 [00:02<00:00, 6107.52probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5996.82probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random16_p6_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random16_p6_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.01 in 77.423 sec
Iter: 2, Total Loss: 0.006147 in 77.711 sec
Iter: 3, Total Loss: 0.005827 in 77.078 sec
Iter: 4, Total Loss: 0.005601 in 74.658 sec
Iter: 5, Total Loss: 0.005433 in 75.499 sec
Iter: 6, Total Loss: 0.005269 in 74.996 sec
Iter: 7, Total Loss: 0.005116 in 75.791 sec
Iter: 8, Total Loss: 0.005009 in 75.282 sec
Iter: 9, Total Loss: 0.004943 in 74.441 sec
Iter: 10, Total Loss: 0.004898 in 76.703 sec
Iter: 11, Total Loss: 0.004863 in 75.644 sec
Iter: 12, Total Loss: 0.004835 in 82.812 sec
Iter: 13, Total Loss: 0.004812 in 80.029 sec
Iter: 14, Total Loss: 0.004791 in 77.592 sec
Iter: 15, Total Loss: 0.004772 in 80.212 sec
Iter: 16, Total Loss: 0.004755 in 78.022 sec
Iter: 17, Total Loss: 0.00474 in 76.768 sec
Iter: 18, Total Loss: 0.004726 in 78.160 sec
Iter: 19, Total Loss: 0.004712 in 79.186 sec
Iter: 20, Total Loss: 0.0047 in 76.533 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 77.227 with std = 2.066 sec ###
### py4DSTEM ptycho solver is finished in 25 min 46.066 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 907.98 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 16, 6, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 548/16384 [00:00<00:02, 5472.53probe position/s]Normalizing amplitudes:   7%|▋         | 1145/16384 [00:00<00:02, 5761.78probe position/s]Normalizing amplitudes:  11%|█         | 1722/16384 [00:00<00:02, 5202.31probe position/s]Normalizing amplitudes:  14%|█▍        | 2314/16384 [00:00<00:02, 5466.87probe position/s]Normalizing amplitudes:  18%|█▊        | 2876/16384 [00:00<00:02, 5518.50probe position/s]Normalizing amplitudes:  21%|██        | 3476/16384 [00:00<00:02, 5671.15probe position/s]Normalizing amplitudes:  25%|██▍       | 4046/16384 [00:00<00:02, 5618.14probe position/s]Normalizing amplitudes:  28%|██▊       | 4626/16384 [00:00<00:02, 5673.67probe position/s]Normalizing amplitudes:  32%|███▏      | 5249/16384 [00:00<00:01, 5842.54probe position/s]Normalizing amplitudes:  36%|███▌      | 5835/16384 [00:01<00:01, 5841.73probe position/s]Normalizing amplitudes:  39%|███▉      | 6420/16384 [00:01<00:01, 5822.37probe position/s]Normalizing amplitudes:  43%|████▎     | 7003/16384 [00:01<00:01, 5589.34probe position/s]Normalizing amplitudes:  46%|████▌     | 7565/16384 [00:01<00:01, 5501.55probe position/s]Normalizing amplitudes:  50%|████▉     | 8117/16384 [00:01<00:01, 5415.27probe position/s]Normalizing amplitudes:  53%|█████▎    | 8741/16384 [00:01<00:01, 5653.47probe position/s]Normalizing amplitudes:  57%|█████▋    | 9347/16384 [00:01<00:01, 5771.94probe position/s]Normalizing amplitudes:  61%|██████    | 9926/16384 [00:01<00:01, 5461.12probe position/s]Normalizing amplitudes:  64%|██████▍   | 10540/16384 [00:01<00:01, 5653.09probe position/s]Normalizing amplitudes:  68%|██████▊   | 11149/16384 [00:01<00:00, 5768.66probe position/s]Normalizing amplitudes:  72%|███████▏  | 11736/16384 [00:02<00:00, 5797.55probe position/s]Normalizing amplitudes:  75%|███████▌  | 12351/16384 [00:02<00:00, 5898.38probe position/s]Normalizing amplitudes:  79%|███████▉  | 12990/16384 [00:02<00:00, 6043.38probe position/s]Normalizing amplitudes:  83%|████████▎ | 13596/16384 [00:02<00:00, 6017.01probe position/s]Normalizing amplitudes:  87%|████████▋ | 14202/16384 [00:02<00:00, 6028.01probe position/s]Normalizing amplitudes:  90%|█████████ | 14806/16384 [00:02<00:00, 5895.32probe position/s]Normalizing amplitudes:  94%|█████████▍| 15397/16384 [00:02<00:00, 5891.51probe position/s]Normalizing amplitudes:  98%|█████████▊| 15988/16384 [00:02<00:00, 5893.92probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5737.21probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random16_p6_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random16_p6_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.0104 in 156.364 sec
Iter: 2, Total Loss: 0.005845 in 145.059 sec
Iter: 3, Total Loss: 0.005499 in 152.782 sec
Iter: 4, Total Loss: 0.005257 in 155.592 sec
Iter: 5, Total Loss: 0.005072 in 155.925 sec
Iter: 6, Total Loss: 0.004948 in 150.677 sec
Iter: 7, Total Loss: 0.004867 in 150.324 sec
Iter: 8, Total Loss: 0.004813 in 146.294 sec
Iter: 9, Total Loss: 0.004775 in 144.635 sec
Iter: 10, Total Loss: 0.004746 in 149.401 sec
Iter: 11, Total Loss: 0.004723 in 149.766 sec
Iter: 12, Total Loss: 0.004704 in 150.029 sec
Iter: 13, Total Loss: 0.004688 in 151.698 sec
Iter: 14, Total Loss: 0.004674 in 151.278 sec
Iter: 15, Total Loss: 0.004663 in 150.421 sec
Iter: 16, Total Loss: 0.004652 in 146.348 sec
Iter: 17, Total Loss: 0.004643 in 158.018 sec
Iter: 18, Total Loss: 0.004634 in 150.594 sec
Iter: 19, Total Loss: 0.004626 in 150.509 sec
Iter: 20, Total Loss: 0.00462 in 151.289 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 150.850 with std = 3.554 sec ###
### py4DSTEM ptycho solver is finished in 50 min 18.814 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 908.05 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 16, 12, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 574/16384 [00:00<00:02, 5731.78probe position/s]Normalizing amplitudes:   7%|▋         | 1163/16384 [00:00<00:02, 5823.63probe position/s]Normalizing amplitudes:  11%|█         | 1775/16384 [00:00<00:02, 5955.61probe position/s]Normalizing amplitudes:  15%|█▍        | 2378/16384 [00:00<00:02, 5982.33probe position/s]Normalizing amplitudes:  18%|█▊        | 2977/16384 [00:00<00:02, 5916.59probe position/s]Normalizing amplitudes:  22%|██▏       | 3569/16384 [00:00<00:02, 5869.63probe position/s]Normalizing amplitudes:  25%|██▌       | 4157/16384 [00:00<00:02, 5796.58probe position/s]Normalizing amplitudes:  29%|██▉       | 4737/16384 [00:00<00:02, 5673.60probe position/s]Normalizing amplitudes:  33%|███▎      | 5351/16384 [00:00<00:01, 5815.15probe position/s]Normalizing amplitudes:  36%|███▋      | 5969/16384 [00:01<00:01, 5924.99probe position/s]Normalizing amplitudes:  40%|████      | 6582/16384 [00:01<00:01, 5986.80probe position/s]Normalizing amplitudes:  44%|████▍     | 7182/16384 [00:01<00:01, 5716.78probe position/s]Normalizing amplitudes:  47%|████▋     | 7757/16384 [00:01<00:01, 5592.02probe position/s]Normalizing amplitudes:  51%|█████▏    | 8424/16384 [00:01<00:01, 5900.69probe position/s]Normalizing amplitudes:  55%|█████▌    | 9017/16384 [00:01<00:01, 5858.34probe position/s]Normalizing amplitudes:  59%|█████▊    | 9611/16384 [00:01<00:01, 5878.78probe position/s]Normalizing amplitudes:  62%|██████▏   | 10229/16384 [00:01<00:01, 5966.50probe position/s]Normalizing amplitudes:  66%|██████▌   | 10827/16384 [00:01<00:00, 5925.94probe position/s]Normalizing amplitudes:  70%|██████▉   | 11421/16384 [00:01<00:00, 5820.49probe position/s]Normalizing amplitudes:  73%|███████▎  | 12032/16384 [00:02<00:00, 5904.68probe position/s]Normalizing amplitudes:  77%|███████▋  | 12673/16384 [00:02<00:00, 6051.33probe position/s]Normalizing amplitudes:  81%|████████  | 13279/16384 [00:02<00:00, 5984.95probe position/s]Normalizing amplitudes:  85%|████████▍ | 13879/16384 [00:02<00:00, 5973.64probe position/s]Normalizing amplitudes:  89%|████████▊ | 14532/16384 [00:02<00:00, 6136.61probe position/s]Normalizing amplitudes:  93%|█████████▎| 15165/16384 [00:02<00:00, 6192.35probe position/s]Normalizing amplitudes:  96%|█████████▋| 15785/16384 [00:02<00:00, 5918.45probe position/s]Normalizing amplitudes: 100%|█████████▉| 16380/16384 [00:02<00:00, 5314.94probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5818.90probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random16_p12_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random16_p12_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.0152 in 50.514 sec
Iter: 2, Total Loss: 0.006373 in 50.951 sec
Iter: 3, Total Loss: 0.006107 in 49.892 sec
Iter: 4, Total Loss: 0.005868 in 52.238 sec
Iter: 5, Total Loss: 0.005687 in 50.961 sec
Iter: 6, Total Loss: 0.005546 in 50.074 sec
Iter: 7, Total Loss: 0.005416 in 50.971 sec
Iter: 8, Total Loss: 0.005285 in 50.263 sec
Iter: 9, Total Loss: 0.005171 in 52.077 sec
Iter: 10, Total Loss: 0.005086 in 51.860 sec
Iter: 11, Total Loss: 0.005021 in 50.945 sec
Iter: 12, Total Loss: 0.00497 in 50.352 sec
Iter: 13, Total Loss: 0.004927 in 50.212 sec
Iter: 14, Total Loss: 0.00489 in 50.729 sec
Iter: 15, Total Loss: 0.004857 in 51.696 sec
Iter: 16, Total Loss: 0.004827 in 51.225 sec
Iter: 17, Total Loss: 0.004799 in 49.559 sec
Iter: 18, Total Loss: 0.004774 in 48.922 sec
Iter: 19, Total Loss: 0.004749 in 50.305 sec
Iter: 20, Total Loss: 0.004726 in 52.118 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 50.793 with std = 0.872 sec ###
### py4DSTEM ptycho solver is finished in 16 min 57.844 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 910.45 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 16, 12, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 612/16384 [00:00<00:02, 6111.37probe position/s]Normalizing amplitudes:   7%|▋         | 1228/16384 [00:00<00:02, 6136.29probe position/s]Normalizing amplitudes:  11%|█▏        | 1853/16384 [00:00<00:02, 6187.66probe position/s]Normalizing amplitudes:  15%|█▌        | 2472/16384 [00:00<00:02, 6145.86probe position/s]Normalizing amplitudes:  19%|█▉        | 3087/16384 [00:00<00:02, 6081.47probe position/s]Normalizing amplitudes:  23%|██▎       | 3696/16384 [00:00<00:02, 5955.64probe position/s]Normalizing amplitudes:  26%|██▌       | 4293/16384 [00:00<00:02, 5753.74probe position/s]Normalizing amplitudes:  30%|██▉       | 4894/16384 [00:00<00:01, 5830.54probe position/s]Normalizing amplitudes:  34%|███▎      | 5507/16384 [00:00<00:01, 5920.47probe position/s]Normalizing amplitudes:  37%|███▋      | 6101/16384 [00:01<00:01, 5839.83probe position/s]Normalizing amplitudes:  41%|████      | 6686/16384 [00:01<00:01, 5794.49probe position/s]Normalizing amplitudes:  44%|████▍     | 7283/16384 [00:01<00:01, 5845.68probe position/s]Normalizing amplitudes:  48%|████▊     | 7881/16384 [00:01<00:01, 5883.55probe position/s]Normalizing amplitudes:  52%|█████▏    | 8470/16384 [00:01<00:01, 5885.05probe position/s]Normalizing amplitudes:  55%|█████▌    | 9059/16384 [00:01<00:01, 5880.52probe position/s]Normalizing amplitudes:  59%|█████▉    | 9648/16384 [00:01<00:01, 5811.44probe position/s]Normalizing amplitudes:  63%|██████▎   | 10299/16384 [00:01<00:01, 6016.93probe position/s]Normalizing amplitudes:  67%|██████▋   | 10912/16384 [00:01<00:00, 6049.73probe position/s]Normalizing amplitudes:  70%|███████   | 11518/16384 [00:01<00:00, 5978.60probe position/s]Normalizing amplitudes:  74%|███████▍  | 12117/16384 [00:02<00:00, 5911.77probe position/s]Normalizing amplitudes:  78%|███████▊  | 12737/16384 [00:02<00:00, 5996.11probe position/s]Normalizing amplitudes:  81%|████████▏ | 13338/16384 [00:02<00:00, 5998.06probe position/s]Normalizing amplitudes:  85%|████████▌ | 13939/16384 [00:02<00:00, 5971.10probe position/s]Normalizing amplitudes:  89%|████████▊ | 14537/16384 [00:02<00:00, 5898.97probe position/s]Normalizing amplitudes:  92%|█████████▏| 15135/16384 [00:02<00:00, 5922.11probe position/s]Normalizing amplitudes:  96%|█████████▌| 15728/16384 [00:02<00:00, 5902.65probe position/s]Normalizing amplitudes: 100%|█████████▉| 16319/16384 [00:02<00:00, 5854.63probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5919.41probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random16_p12_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random16_p12_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.01544 in 146.512 sec
Iter: 2, Total Loss: 0.006093 in 144.078 sec
Iter: 3, Total Loss: 0.005709 in 148.485 sec
Iter: 4, Total Loss: 0.00546 in 153.017 sec
Iter: 5, Total Loss: 0.00526 in 145.973 sec
Iter: 6, Total Loss: 0.00508 in 146.748 sec
Iter: 7, Total Loss: 0.004954 in 144.755 sec
Iter: 8, Total Loss: 0.00487 in 147.041 sec
Iter: 9, Total Loss: 0.004808 in 143.712 sec
Iter: 10, Total Loss: 0.00476 in 147.898 sec
Iter: 11, Total Loss: 0.004721 in 147.394 sec
Iter: 12, Total Loss: 0.004688 in 148.926 sec
Iter: 13, Total Loss: 0.004659 in 146.256 sec
Iter: 14, Total Loss: 0.004634 in 144.482 sec
Iter: 15, Total Loss: 0.004611 in 148.440 sec
Iter: 16, Total Loss: 0.00459 in 138.983 sec
Iter: 17, Total Loss: 0.004572 in 146.128 sec
Iter: 18, Total Loss: 0.004555 in 150.999 sec
Iter: 19, Total Loss: 0.00454 in 142.739 sec
Iter: 20, Total Loss: 0.004527 in 147.945 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 146.526 with std = 2.944 sec ###
### py4DSTEM ptycho solver is finished in 48 min 52.092 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 909.30 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (2, 16, 12, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 601/16384 [00:00<00:02, 6002.69probe position/s]Normalizing amplitudes:   7%|▋         | 1202/16384 [00:00<00:02, 5811.76probe position/s]Normalizing amplitudes:  11%|█         | 1825/16384 [00:00<00:02, 5996.54probe position/s]Normalizing amplitudes:  15%|█▍        | 2426/16384 [00:00<00:02, 5925.05probe position/s]Normalizing amplitudes:  18%|█▊        | 3019/16384 [00:00<00:02, 5895.30probe position/s]Normalizing amplitudes:  22%|██▏       | 3659/16384 [00:00<00:02, 6061.99probe position/s]Normalizing amplitudes:  26%|██▌       | 4266/16384 [00:00<00:02, 6033.84probe position/s]Normalizing amplitudes:  30%|██▉       | 4884/16384 [00:00<00:01, 6078.81probe position/s]Normalizing amplitudes:  34%|███▎      | 5493/16384 [00:00<00:01, 6030.34probe position/s]Normalizing amplitudes:  37%|███▋      | 6101/16384 [00:01<00:01, 6044.68probe position/s]Normalizing amplitudes:  41%|████      | 6706/16384 [00:01<00:01, 6012.88probe position/s]Normalizing amplitudes:  45%|████▍     | 7308/16384 [00:01<00:01, 5941.22probe position/s]Normalizing amplitudes:  48%|████▊     | 7909/16384 [00:01<00:01, 5961.19probe position/s]Normalizing amplitudes:  52%|█████▏    | 8506/16384 [00:01<00:01, 5902.02probe position/s]Normalizing amplitudes:  56%|█████▌    | 9097/16384 [00:01<00:01, 5651.65probe position/s]Normalizing amplitudes:  59%|█████▉    | 9720/16384 [00:01<00:01, 5815.91probe position/s]Normalizing amplitudes:  63%|██████▎   | 10308/16384 [00:01<00:01, 5834.48probe position/s]Normalizing amplitudes:  66%|██████▋   | 10894/16384 [00:01<00:00, 5804.50probe position/s]Normalizing amplitudes:  70%|███████   | 11510/16384 [00:01<00:00, 5905.15probe position/s]Normalizing amplitudes:  74%|███████▍  | 12110/16384 [00:02<00:00, 5932.13probe position/s]Normalizing amplitudes:  78%|███████▊  | 12704/16384 [00:02<00:00, 5920.20probe position/s]Normalizing amplitudes:  81%|████████▏ | 13313/16384 [00:02<00:00, 5969.73probe position/s]Normalizing amplitudes:  85%|████████▍ | 13911/16384 [00:02<00:00, 5759.03probe position/s]Normalizing amplitudes:  89%|████████▉ | 14542/16384 [00:02<00:00, 5917.47probe position/s]Normalizing amplitudes:  93%|█████████▎| 15161/16384 [00:02<00:00, 5997.33probe position/s]Normalizing amplitudes:  96%|█████████▌| 15766/16384 [00:02<00:00, 6011.52probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5944.65probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random16_p12_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r2/N16384_dp128_flipT100_random16_p12_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.01574 in 291.167 sec
Iter: 2, Total Loss: 0.005761 in 282.360 sec
Iter: 3, Total Loss: 0.005336 in 276.140 sec
Iter: 4, Total Loss: 0.005064 in 285.615 sec
Iter: 5, Total Loss: 0.004882 in 282.759 sec
Iter: 6, Total Loss: 0.004777 in 279.679 sec
Iter: 7, Total Loss: 0.00471 in 287.239 sec
Iter: 8, Total Loss: 0.004663 in 279.874 sec
Iter: 9, Total Loss: 0.004626 in 286.024 sec
Iter: 10, Total Loss: 0.004596 in 283.368 sec
Iter: 11, Total Loss: 0.004571 in 281.553 sec
Iter: 12, Total Loss: 0.004549 in 292.029 sec
Iter: 13, Total Loss: 0.00453 in 279.762 sec
Iter: 14, Total Loss: 0.004514 in 287.045 sec
Iter: 15, Total Loss: 0.0045 in 281.646 sec
Iter: 16, Total Loss: 0.004488 in 281.894 sec
Iter: 17, Total Loss: 0.004478 in 284.597 sec
Iter: 18, Total Loss: 0.004469 in 285.566 sec
Iter: 19, Total Loss: 0.004461 in 289.087 sec
Iter: 20, Total Loss: 0.004454 in 291.368 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 284.439 with std = 4.228 sec ###
### py4DSTEM ptycho solver is finished in 1 hr 34 min 50.418 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 912.29 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 1024, 1, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 603/16384 [00:00<00:02, 6027.35probe position/s]Normalizing amplitudes:   7%|▋         | 1206/16384 [00:00<00:02, 5695.98probe position/s]Normalizing amplitudes:  11%|█         | 1823/16384 [00:00<00:02, 5905.02probe position/s]Normalizing amplitudes:  15%|█▍        | 2444/16384 [00:00<00:02, 6021.43probe position/s]Normalizing amplitudes:  19%|█▊        | 3048/16384 [00:00<00:02, 5897.57probe position/s]Normalizing amplitudes:  23%|██▎       | 3692/16384 [00:00<00:02, 6076.17probe position/s]Normalizing amplitudes:  26%|██▋       | 4301/16384 [00:00<00:01, 6066.87probe position/s]Normalizing amplitudes:  30%|███       | 4947/16384 [00:00<00:01, 6190.03probe position/s]Normalizing amplitudes:  34%|███▍      | 5579/16384 [00:00<00:01, 6228.27probe position/s]Normalizing amplitudes:  38%|███▊      | 6203/16384 [00:01<00:01, 6209.34probe position/s]Normalizing amplitudes:  42%|████▏     | 6838/16384 [00:01<00:01, 6250.66probe position/s]Normalizing amplitudes:  46%|████▌     | 7464/16384 [00:01<00:01, 6244.77probe position/s]Normalizing amplitudes:  49%|████▉     | 8093/16384 [00:01<00:01, 6256.61probe position/s]Normalizing amplitudes:  53%|█████▎    | 8719/16384 [00:01<00:01, 6240.33probe position/s]Normalizing amplitudes:  57%|█████▋    | 9344/16384 [00:01<00:01, 6210.81probe position/s]Normalizing amplitudes:  61%|██████    | 10006/16384 [00:01<00:01, 6331.37probe position/s]Normalizing amplitudes:  65%|██████▌   | 10652/16384 [00:01<00:00, 6368.93probe position/s]Normalizing amplitudes:  69%|██████▉   | 11290/16384 [00:01<00:00, 6293.10probe position/s]Normalizing amplitudes:  73%|███████▎  | 11920/16384 [00:01<00:00, 6204.68probe position/s]Normalizing amplitudes:  77%|███████▋  | 12547/16384 [00:02<00:00, 6222.81probe position/s]Normalizing amplitudes:  80%|████████  | 13171/16384 [00:02<00:00, 6225.56probe position/s]Normalizing amplitudes:  84%|████████▍ | 13795/16384 [00:02<00:00, 6228.96probe position/s]Normalizing amplitudes:  88%|████████▊ | 14431/16384 [00:02<00:00, 6266.43probe position/s]Normalizing amplitudes:  92%|█████████▏| 15070/16384 [00:02<00:00, 6302.24probe position/s]Normalizing amplitudes:  96%|█████████▌| 15723/16384 [00:02<00:00, 6367.61probe position/s]Normalizing amplitudes: 100%|█████████▉| 16360/16384 [00:02<00:00, 6158.46probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6184.36probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random1024_p1_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random1024_p1_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.02223 in 0.788 sec
Iter: 2, Total Loss: 0.006517 in 0.758 sec
Iter: 3, Total Loss: 0.006489 in 0.768 sec
Iter: 4, Total Loss: 0.006476 in 0.759 sec
Iter: 5, Total Loss: 0.006468 in 0.745 sec
Iter: 6, Total Loss: 0.006464 in 0.742 sec
Iter: 7, Total Loss: 0.006461 in 0.757 sec
Iter: 8, Total Loss: 0.006458 in 0.775 sec
Iter: 9, Total Loss: 0.006456 in 0.746 sec
Iter: 10, Total Loss: 0.006454 in 0.752 sec
Iter: 11, Total Loss: 0.006453 in 0.759 sec
Iter: 12, Total Loss: 0.006451 in 0.742 sec
Iter: 13, Total Loss: 0.006449 in 0.745 sec
Iter: 14, Total Loss: 0.006447 in 0.769 sec
Iter: 15, Total Loss: 0.006445 in 0.766 sec
Iter: 16, Total Loss: 0.006444 in 0.732 sec
Iter: 17, Total Loss: 0.006442 in 0.726 sec
Iter: 18, Total Loss: 0.006441 in 0.768 sec
Iter: 19, Total Loss: 0.006439 in 0.750 sec
Iter: 20, Total Loss: 0.006437 in 0.748 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 0.755 with std = 0.015 sec ###
### py4DSTEM ptycho solver is finished in 16.529 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 912.29 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 1024, 1, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 602/16384 [00:00<00:02, 6013.01probe position/s]Normalizing amplitudes:   7%|▋         | 1207/16384 [00:00<00:02, 6031.91probe position/s]Normalizing amplitudes:  11%|█         | 1811/16384 [00:00<00:02, 6000.82probe position/s]Normalizing amplitudes:  15%|█▍        | 2422/16384 [00:00<00:02, 6042.41probe position/s]Normalizing amplitudes:  18%|█▊        | 3028/16384 [00:00<00:02, 6047.78probe position/s]Normalizing amplitudes:  22%|██▏       | 3633/16384 [00:00<00:02, 5973.71probe position/s]Normalizing amplitudes:  26%|██▋       | 4321/16384 [00:00<00:01, 6266.66probe position/s]Normalizing amplitudes:  30%|███       | 4949/16384 [00:00<00:01, 6093.64probe position/s]Normalizing amplitudes:  34%|███▍      | 5560/16384 [00:00<00:01, 5866.57probe position/s]Normalizing amplitudes:  38%|███▊      | 6149/16384 [00:01<00:01, 5840.34probe position/s]Normalizing amplitudes:  41%|████      | 6735/16384 [00:01<00:01, 5776.24probe position/s]Normalizing amplitudes:  45%|████▍     | 7314/16384 [00:01<00:01, 5710.23probe position/s]Normalizing amplitudes:  48%|████▊     | 7916/16384 [00:01<00:01, 5800.84probe position/s]Normalizing amplitudes:  52%|█████▏    | 8560/16384 [00:01<00:01, 5986.41probe position/s]Normalizing amplitudes:  56%|█████▌    | 9160/16384 [00:01<00:01, 5914.34probe position/s]Normalizing amplitudes:  60%|█████▉    | 9753/16384 [00:01<00:01, 5798.84probe position/s]Normalizing amplitudes:  63%|██████▎   | 10334/16384 [00:01<00:01, 5735.86probe position/s]Normalizing amplitudes:  67%|██████▋   | 10947/16384 [00:01<00:00, 5848.85probe position/s]Normalizing amplitudes:  70%|███████   | 11533/16384 [00:01<00:00, 5843.17probe position/s]Normalizing amplitudes:  74%|███████▍  | 12139/16384 [00:02<00:00, 5907.21probe position/s]Normalizing amplitudes:  78%|███████▊  | 12777/16384 [00:02<00:00, 6045.71probe position/s]Normalizing amplitudes:  82%|████████▏ | 13383/16384 [00:02<00:00, 5896.95probe position/s]Normalizing amplitudes:  85%|████████▌ | 13974/16384 [00:02<00:00, 5665.68probe position/s]Normalizing amplitudes:  89%|████████▉ | 14543/16384 [00:02<00:00, 5646.63probe position/s]Normalizing amplitudes:  92%|█████████▏| 15110/16384 [00:02<00:00, 5249.40probe position/s]Normalizing amplitudes:  95%|█████████▌| 15641/16384 [00:02<00:00, 4867.37probe position/s]Normalizing amplitudes:  99%|█████████▉| 16265/16384 [00:02<00:00, 5233.25probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5744.33probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random1024_p1_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random1024_p1_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.02292 in 1.523 sec
Iter: 2, Total Loss: 0.006521 in 1.434 sec
Iter: 3, Total Loss: 0.006483 in 1.451 sec
Iter: 4, Total Loss: 0.006472 in 1.437 sec
Iter: 5, Total Loss: 0.006465 in 1.412 sec
Iter: 6, Total Loss: 0.00646 in 1.436 sec
Iter: 7, Total Loss: 0.006454 in 1.409 sec
Iter: 8, Total Loss: 0.006451 in 1.418 sec
Iter: 9, Total Loss: 0.006446 in 1.436 sec
Iter: 10, Total Loss: 0.006444 in 1.426 sec
Iter: 11, Total Loss: 0.006438 in 1.454 sec
Iter: 12, Total Loss: 0.006437 in 1.427 sec
Iter: 13, Total Loss: 0.006433 in 1.440 sec
Iter: 14, Total Loss: 0.006429 in 1.447 sec
Iter: 15, Total Loss: 0.006427 in 1.443 sec
Iter: 16, Total Loss: 0.006424 in 1.412 sec
Iter: 17, Total Loss: 0.00642 in 1.410 sec
Iter: 18, Total Loss: 0.006418 in 1.417 sec
Iter: 19, Total Loss: 0.006414 in 1.404 sec
Iter: 20, Total Loss: 0.006411 in 1.425 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 1.433 with std = 0.025 sec ###
### py4DSTEM ptycho solver is finished in 30.062 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 917.05 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 1024, 1, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 657/16384 [00:00<00:02, 6567.16probe position/s]Normalizing amplitudes:   8%|▊         | 1314/16384 [00:00<00:02, 6474.88probe position/s]Normalizing amplitudes:  12%|█▏        | 1962/16384 [00:00<00:02, 6446.90probe position/s]Normalizing amplitudes:  16%|█▌        | 2607/16384 [00:00<00:02, 6387.06probe position/s]Normalizing amplitudes:  20%|██        | 3279/16384 [00:00<00:02, 6503.88probe position/s]Normalizing amplitudes:  24%|██▍       | 3930/16384 [00:00<00:01, 6263.77probe position/s]Normalizing amplitudes:  28%|██▊       | 4587/16384 [00:00<00:01, 6358.46probe position/s]Normalizing amplitudes:  32%|███▏      | 5279/16384 [00:00<00:01, 6531.01probe position/s]Normalizing amplitudes:  36%|███▌      | 5934/16384 [00:00<00:01, 6495.88probe position/s]Normalizing amplitudes:  40%|████      | 6585/16384 [00:01<00:01, 6492.77probe position/s]Normalizing amplitudes:  44%|████▍     | 7235/16384 [00:01<00:01, 6467.13probe position/s]Normalizing amplitudes:  48%|████▊     | 7883/16384 [00:01<00:01, 6227.19probe position/s]Normalizing amplitudes:  52%|█████▏    | 8533/16384 [00:01<00:01, 6305.13probe position/s]Normalizing amplitudes:  56%|█████▌    | 9180/16384 [00:01<00:01, 6353.49probe position/s]Normalizing amplitudes:  60%|██████    | 9836/16384 [00:01<00:01, 6413.05probe position/s]Normalizing amplitudes:  64%|██████▍   | 10519/16384 [00:01<00:00, 6534.26probe position/s]Normalizing amplitudes:  68%|██████▊   | 11174/16384 [00:01<00:00, 6517.02probe position/s]Normalizing amplitudes:  72%|███████▏  | 11827/16384 [00:01<00:00, 6356.99probe position/s]Normalizing amplitudes:  76%|███████▌  | 12464/16384 [00:01<00:00, 6323.98probe position/s]Normalizing amplitudes:  80%|████████  | 13143/16384 [00:02<00:00, 6460.73probe position/s]Normalizing amplitudes:  84%|████████▍ | 13816/16384 [00:02<00:00, 6538.59probe position/s]Normalizing amplitudes:  88%|████████▊ | 14471/16384 [00:02<00:00, 6511.12probe position/s]Normalizing amplitudes:  92%|█████████▏| 15126/16384 [00:02<00:00, 6521.44probe position/s]Normalizing amplitudes:  96%|█████████▋| 15779/16384 [00:02<00:00, 6243.36probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6408.94probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random1024_p1_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random1024_p1_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.02387 in 2.463 sec
Iter: 2, Total Loss: 0.006566 in 2.472 sec
Iter: 3, Total Loss: 0.006503 in 2.437 sec
Iter: 4, Total Loss: 0.00649 in 2.388 sec
Iter: 5, Total Loss: 0.00648 in 2.452 sec
Iter: 6, Total Loss: 0.00647 in 2.395 sec
Iter: 7, Total Loss: 0.006463 in 2.416 sec
Iter: 8, Total Loss: 0.006457 in 2.422 sec
Iter: 9, Total Loss: 0.006452 in 2.385 sec
Iter: 10, Total Loss: 0.006445 in 2.374 sec
Iter: 11, Total Loss: 0.006441 in 2.383 sec
Iter: 12, Total Loss: 0.006434 in 2.445 sec
Iter: 13, Total Loss: 0.00643 in 2.420 sec
Iter: 14, Total Loss: 0.006426 in 2.420 sec
Iter: 15, Total Loss: 0.006422 in 2.463 sec
Iter: 16, Total Loss: 0.006417 in 2.487 sec
Iter: 17, Total Loss: 0.006413 in 2.459 sec
Iter: 18, Total Loss: 0.00641 in 2.424 sec
Iter: 19, Total Loss: 0.006404 in 2.430 sec
Iter: 20, Total Loss: 0.0064 in 2.377 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 2.426 with std = 0.033 sec ###
### py4DSTEM ptycho solver is finished in 50.904 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 924.09 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 1024, 3, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 655/16384 [00:00<00:02, 6541.51probe position/s]Normalizing amplitudes:   8%|▊         | 1356/16384 [00:00<00:02, 6811.14probe position/s]Normalizing amplitudes:  13%|█▎        | 2067/16384 [00:00<00:02, 6944.31probe position/s]Normalizing amplitudes:  17%|█▋        | 2762/16384 [00:00<00:02, 6672.29probe position/s]Normalizing amplitudes:  21%|██        | 3431/16384 [00:00<00:01, 6628.20probe position/s]Normalizing amplitudes:  25%|██▍       | 4095/16384 [00:00<00:01, 6260.33probe position/s]Normalizing amplitudes:  29%|██▉       | 4725/16384 [00:00<00:01, 6131.47probe position/s]Normalizing amplitudes:  33%|███▎      | 5341/16384 [00:00<00:01, 6128.02probe position/s]Normalizing amplitudes:  37%|███▋      | 6031/16384 [00:00<00:01, 6359.12probe position/s]Normalizing amplitudes:  41%|████      | 6747/16384 [00:01<00:01, 6597.60probe position/s]Normalizing amplitudes:  46%|████▌     | 7459/16384 [00:01<00:01, 6750.22probe position/s]Normalizing amplitudes:  50%|████▉     | 8136/16384 [00:01<00:01, 6686.26probe position/s]Normalizing amplitudes:  54%|█████▍    | 8816/16384 [00:01<00:01, 6719.65probe position/s]Normalizing amplitudes:  58%|█████▊    | 9489/16384 [00:01<00:01, 6206.09probe position/s]Normalizing amplitudes:  62%|██████▏   | 10118/16384 [00:01<00:01, 6020.68probe position/s]Normalizing amplitudes:  66%|██████▌   | 10791/16384 [00:01<00:00, 6218.64probe position/s]Normalizing amplitudes:  70%|███████   | 11487/16384 [00:01<00:00, 6429.42probe position/s]Normalizing amplitudes:  74%|███████▍  | 12135/16384 [00:01<00:00, 6334.56probe position/s]Normalizing amplitudes:  78%|███████▊  | 12788/16384 [00:01<00:00, 6388.92probe position/s]Normalizing amplitudes:  82%|████████▏ | 13474/16384 [00:02<00:00, 6524.65probe position/s]Normalizing amplitudes:  86%|████████▋ | 14148/16384 [00:02<00:00, 6584.72probe position/s]Normalizing amplitudes:  90%|█████████ | 14827/16384 [00:02<00:00, 6643.92probe position/s]Normalizing amplitudes:  95%|█████████▍| 15503/16384 [00:02<00:00, 6676.04probe position/s]Normalizing amplitudes:  99%|█████████▉| 16197/16384 [00:02<00:00, 6753.53probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6510.86probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random1024_p3_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random1024_p3_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.07286 in 1.353 sec
Iter: 2, Total Loss: 0.00671 in 1.340 sec
Iter: 3, Total Loss: 0.006546 in 1.322 sec
Iter: 4, Total Loss: 0.006472 in 1.315 sec
Iter: 5, Total Loss: 0.006431 in 1.315 sec
Iter: 6, Total Loss: 0.006403 in 1.334 sec
Iter: 7, Total Loss: 0.006384 in 1.306 sec
Iter: 8, Total Loss: 0.006368 in 1.310 sec
Iter: 9, Total Loss: 0.006354 in 1.330 sec
Iter: 10, Total Loss: 0.006341 in 1.326 sec
Iter: 11, Total Loss: 0.006329 in 1.427 sec
Iter: 12, Total Loss: 0.006318 in 1.399 sec
Iter: 13, Total Loss: 0.006307 in 1.304 sec
Iter: 14, Total Loss: 0.006297 in 1.360 sec
Iter: 15, Total Loss: 0.006286 in 1.305 sec
Iter: 16, Total Loss: 0.006275 in 1.304 sec
Iter: 17, Total Loss: 0.006265 in 1.310 sec
Iter: 18, Total Loss: 0.006255 in 1.311 sec
Iter: 19, Total Loss: 0.006245 in 1.305 sec
Iter: 20, Total Loss: 0.006236 in 1.289 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 1.328 with std = 0.033 sec ###
### py4DSTEM ptycho solver is finished in 28.081 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 920.75 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 1024, 3, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 699/16384 [00:00<00:02, 6983.80probe position/s]Normalizing amplitudes:   9%|▊         | 1415/16384 [00:00<00:02, 7086.43probe position/s]Normalizing amplitudes:  13%|█▎        | 2157/16384 [00:00<00:01, 7235.13probe position/s]Normalizing amplitudes:  18%|█▊        | 2886/16384 [00:00<00:01, 7252.49probe position/s]Normalizing amplitudes:  22%|██▏       | 3612/16384 [00:00<00:01, 7201.34probe position/s]Normalizing amplitudes:  26%|██▋       | 4333/16384 [00:00<00:01, 7164.22probe position/s]Normalizing amplitudes:  31%|███       | 5050/16384 [00:00<00:01, 7073.40probe position/s]Normalizing amplitudes:  35%|███▌      | 5763/16384 [00:00<00:01, 7089.31probe position/s]Normalizing amplitudes:  40%|███▉      | 6493/16384 [00:00<00:01, 7152.84probe position/s]Normalizing amplitudes:  44%|████▍     | 7209/16384 [00:01<00:01, 7127.82probe position/s]Normalizing amplitudes:  48%|████▊     | 7922/16384 [00:01<00:01, 7030.45probe position/s]Normalizing amplitudes:  53%|█████▎    | 8626/16384 [00:01<00:01, 7000.30probe position/s]Normalizing amplitudes:  57%|█████▋    | 9327/16384 [00:01<00:01, 6898.60probe position/s]Normalizing amplitudes:  61%|██████    | 10019/16384 [00:01<00:00, 6904.65probe position/s]Normalizing amplitudes:  66%|██████▌   | 10740/16384 [00:01<00:00, 6993.35probe position/s]Normalizing amplitudes:  70%|██████▉   | 11450/16384 [00:01<00:00, 7024.34probe position/s]Normalizing amplitudes:  74%|███████▍  | 12153/16384 [00:01<00:00, 6424.75probe position/s]Normalizing amplitudes:  78%|███████▊  | 12843/16384 [00:01<00:00, 6556.35probe position/s]Normalizing amplitudes:  83%|████████▎ | 13543/16384 [00:01<00:00, 6681.54probe position/s]Normalizing amplitudes:  87%|████████▋ | 14247/16384 [00:02<00:00, 6783.55probe position/s]Normalizing amplitudes:  91%|█████████▏| 14960/16384 [00:02<00:00, 6884.08probe position/s]Normalizing amplitudes:  96%|█████████▌| 15656/16384 [00:02<00:00, 6904.30probe position/s]Normalizing amplitudes: 100%|█████████▉| 16359/16384 [00:02<00:00, 6940.92probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6952.89probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random1024_p3_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random1024_p3_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.06819 in 3.389 sec
Iter: 2, Total Loss: 0.00706 in 3.252 sec
Iter: 3, Total Loss: 0.006641 in 3.248 sec
Iter: 4, Total Loss: 0.006542 in 3.192 sec
Iter: 5, Total Loss: 0.006496 in 3.200 sec
Iter: 6, Total Loss: 0.006462 in 3.188 sec
Iter: 7, Total Loss: 0.006437 in 3.361 sec
Iter: 8, Total Loss: 0.00641 in 3.285 sec
Iter: 9, Total Loss: 0.006391 in 3.286 sec
Iter: 10, Total Loss: 0.006368 in 3.279 sec
Iter: 11, Total Loss: 0.006352 in 3.250 sec
Iter: 12, Total Loss: 0.006333 in 3.216 sec
Iter: 13, Total Loss: 0.006319 in 3.223 sec
Iter: 14, Total Loss: 0.006303 in 3.223 sec
Iter: 15, Total Loss: 0.00629 in 3.227 sec
Iter: 16, Total Loss: 0.006275 in 3.219 sec
Iter: 17, Total Loss: 0.006262 in 3.248 sec
Iter: 18, Total Loss: 0.006249 in 3.262 sec
Iter: 19, Total Loss: 0.006237 in 3.246 sec
Iter: 20, Total Loss: 0.006225 in 3.247 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 3.252 with std = 0.049 sec ###
### py4DSTEM ptycho solver is finished in 1 min 6.672 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 912.74 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 1024, 3, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 605/16384 [00:00<00:02, 6047.41probe position/s]Normalizing amplitudes:   8%|▊         | 1274/16384 [00:00<00:02, 6422.74probe position/s]Normalizing amplitudes:  12%|█▏        | 1940/16384 [00:00<00:02, 6530.87probe position/s]Normalizing amplitudes:  16%|█▌        | 2594/16384 [00:00<00:02, 6237.54probe position/s]Normalizing amplitudes:  20%|█▉        | 3220/16384 [00:00<00:02, 6146.17probe position/s]Normalizing amplitudes:  23%|██▎       | 3836/16384 [00:00<00:02, 6018.73probe position/s]Normalizing amplitudes:  27%|██▋       | 4451/16384 [00:00<00:01, 6058.82probe position/s]Normalizing amplitudes:  31%|███       | 5058/16384 [00:00<00:01, 5913.39probe position/s]Normalizing amplitudes:  34%|███▍      | 5651/16384 [00:00<00:01, 5899.62probe position/s]Normalizing amplitudes:  38%|███▊      | 6291/16384 [00:01<00:01, 6049.90probe position/s]Normalizing amplitudes:  42%|████▏     | 6898/16384 [00:01<00:01, 6052.32probe position/s]Normalizing amplitudes:  46%|████▌     | 7548/16384 [00:01<00:01, 6186.27probe position/s]Normalizing amplitudes:  50%|████▉     | 8168/16384 [00:01<00:01, 6172.11probe position/s]Normalizing amplitudes:  54%|█████▎    | 8786/16384 [00:01<00:01, 6103.15probe position/s]Normalizing amplitudes:  57%|█████▋    | 9414/16384 [00:01<00:01, 6154.61probe position/s]Normalizing amplitudes:  61%|██████    | 10032/16384 [00:01<00:01, 6160.51probe position/s]Normalizing amplitudes:  65%|██████▍   | 10649/16384 [00:01<00:00, 6076.63probe position/s]Normalizing amplitudes:  69%|██████▉   | 11289/16384 [00:01<00:00, 6171.47probe position/s]Normalizing amplitudes:  73%|███████▎  | 11908/16384 [00:01<00:00, 6175.75probe position/s]Normalizing amplitudes:  77%|███████▋  | 12571/16384 [00:02<00:00, 6309.06probe position/s]Normalizing amplitudes:  81%|████████  | 13256/16384 [00:02<00:00, 6469.23probe position/s]Normalizing amplitudes:  85%|████████▍ | 13904/16384 [00:02<00:00, 6342.11probe position/s]Normalizing amplitudes:  89%|████████▊ | 14539/16384 [00:02<00:00, 6321.49probe position/s]Normalizing amplitudes:  93%|█████████▎| 15172/16384 [00:02<00:00, 6296.25probe position/s]Normalizing amplitudes:  96%|█████████▋| 15802/16384 [00:02<00:00, 6256.55probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6169.05probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random1024_p3_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random1024_p3_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.07145 in 6.109 sec
Iter: 2, Total Loss: 0.008135 in 6.077 sec
Iter: 3, Total Loss: 0.006937 in 6.033 sec
Iter: 4, Total Loss: 0.00665 in 6.055 sec
Iter: 5, Total Loss: 0.006514 in 6.043 sec
Iter: 6, Total Loss: 0.006421 in 6.039 sec
Iter: 7, Total Loss: 0.006353 in 6.052 sec
Iter: 8, Total Loss: 0.006301 in 6.040 sec
Iter: 9, Total Loss: 0.006258 in 6.068 sec
Iter: 10, Total Loss: 0.006222 in 6.049 sec
Iter: 11, Total Loss: 0.006193 in 6.044 sec
Iter: 12, Total Loss: 0.006166 in 6.053 sec
Iter: 13, Total Loss: 0.006142 in 6.062 sec
Iter: 14, Total Loss: 0.006122 in 6.060 sec
Iter: 15, Total Loss: 0.006102 in 6.042 sec
Iter: 16, Total Loss: 0.006084 in 6.078 sec
Iter: 17, Total Loss: 0.006067 in 6.036 sec
Iter: 18, Total Loss: 0.006052 in 6.072 sec
Iter: 19, Total Loss: 0.006037 in 6.061 sec
Iter: 20, Total Loss: 0.006022 in 6.040 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 6.056 with std = 0.018 sec ###
### py4DSTEM ptycho solver is finished in 2 min 3.098 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 912.04 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 1024, 6, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 626/16384 [00:00<00:02, 6255.92probe position/s]Normalizing amplitudes:   8%|▊         | 1255/16384 [00:00<00:02, 6274.23probe position/s]Normalizing amplitudes:  11%|█▏        | 1883/16384 [00:00<00:02, 6175.49probe position/s]Normalizing amplitudes:  15%|█▌        | 2501/16384 [00:00<00:02, 5359.51probe position/s]Normalizing amplitudes:  19%|█▊        | 3051/16384 [00:00<00:02, 4857.72probe position/s]Normalizing amplitudes:  22%|██▏       | 3556/16384 [00:00<00:02, 4913.43probe position/s]Normalizing amplitudes:  25%|██▌       | 4101/16384 [00:00<00:02, 5072.49probe position/s]Normalizing amplitudes:  28%|██▊       | 4643/16384 [00:00<00:02, 5174.02probe position/s]Normalizing amplitudes:  32%|███▏      | 5296/16384 [00:00<00:01, 5576.06probe position/s]Normalizing amplitudes:  36%|███▌      | 5921/16384 [00:01<00:01, 5774.58probe position/s]Normalizing amplitudes:  40%|███▉      | 6518/16384 [00:01<00:01, 5830.12probe position/s]Normalizing amplitudes:  44%|████▎     | 7138/16384 [00:01<00:01, 5939.71probe position/s]Normalizing amplitudes:  47%|████▋     | 7739/16384 [00:01<00:01, 5958.16probe position/s]Normalizing amplitudes:  51%|█████     | 8371/16384 [00:01<00:01, 6066.05probe position/s]Normalizing amplitudes:  55%|█████▍    | 8979/16384 [00:01<00:01, 5953.50probe position/s]Normalizing amplitudes:  58%|█████▊    | 9576/16384 [00:01<00:01, 5768.10probe position/s]Normalizing amplitudes:  62%|██████▏   | 10155/16384 [00:01<00:01, 5659.95probe position/s]Normalizing amplitudes:  66%|██████▌   | 10828/16384 [00:01<00:00, 5967.54probe position/s]Normalizing amplitudes:  70%|██████▉   | 11428/16384 [00:02<00:00, 5955.06probe position/s]Normalizing amplitudes:  73%|███████▎  | 12026/16384 [00:02<00:00, 5858.13probe position/s]Normalizing amplitudes:  77%|███████▋  | 12614/16384 [00:02<00:00, 5804.35probe position/s]Normalizing amplitudes:  81%|████████  | 13198/16384 [00:02<00:00, 5811.64probe position/s]Normalizing amplitudes:  84%|████████▍ | 13780/16384 [00:02<00:00, 5807.99probe position/s]Normalizing amplitudes:  88%|████████▊ | 14438/16384 [00:02<00:00, 6035.00probe position/s]Normalizing amplitudes:  92%|█████████▏| 15043/16384 [00:02<00:00, 5966.42probe position/s]Normalizing amplitudes:  96%|█████████▌| 15660/16384 [00:02<00:00, 6024.21probe position/s]Normalizing amplitudes: 100%|█████████▉| 16329/16384 [00:02<00:00, 6219.58probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5794.06probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random1024_p6_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random1024_p6_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.2054 in 2.310 sec
Iter: 2, Total Loss: 0.006962 in 2.259 sec
Iter: 3, Total Loss: 0.006674 in 2.271 sec
Iter: 4, Total Loss: 0.006548 in 2.261 sec
Iter: 5, Total Loss: 0.006478 in 2.296 sec
Iter: 6, Total Loss: 0.006432 in 2.291 sec
Iter: 7, Total Loss: 0.006398 in 2.287 sec
Iter: 8, Total Loss: 0.00637 in 2.309 sec
Iter: 9, Total Loss: 0.006347 in 2.243 sec
Iter: 10, Total Loss: 0.006326 in 2.267 sec
Iter: 11, Total Loss: 0.006306 in 2.274 sec
Iter: 12, Total Loss: 0.006287 in 2.273 sec
Iter: 13, Total Loss: 0.00627 in 2.286 sec
Iter: 14, Total Loss: 0.006254 in 2.307 sec
Iter: 15, Total Loss: 0.006238 in 2.282 sec
Iter: 16, Total Loss: 0.006222 in 2.320 sec
Iter: 17, Total Loss: 0.006207 in 2.279 sec
Iter: 18, Total Loss: 0.006193 in 2.387 sec
Iter: 19, Total Loss: 0.00618 in 2.390 sec
Iter: 20, Total Loss: 0.006166 in 2.283 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 2.294 with std = 0.037 sec ###
### py4DSTEM ptycho solver is finished in 47.732 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 915.95 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 1024, 6, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 588/16384 [00:00<00:02, 5877.75probe position/s]Normalizing amplitudes:   8%|▊         | 1232/16384 [00:00<00:02, 6202.85probe position/s]Normalizing amplitudes:  11%|█▏        | 1853/16384 [00:00<00:02, 5964.78probe position/s]Normalizing amplitudes:  15%|█▍        | 2451/16384 [00:00<00:02, 5768.07probe position/s]Normalizing amplitudes:  19%|█▊        | 3059/16384 [00:00<00:02, 5874.31probe position/s]Normalizing amplitudes:  22%|██▏       | 3681/16384 [00:00<00:02, 5987.21probe position/s]Normalizing amplitudes:  26%|██▌       | 4281/16384 [00:00<00:02, 5830.77probe position/s]Normalizing amplitudes:  30%|██▉       | 4866/16384 [00:00<00:02, 4454.92probe position/s]Normalizing amplitudes:  34%|███▍      | 5572/16384 [00:01<00:02, 5110.10probe position/s]Normalizing amplitudes:  37%|███▋      | 6142/16384 [00:01<00:01, 5265.30probe position/s]Normalizing amplitudes:  41%|████      | 6704/16384 [00:01<00:02, 4573.15probe position/s]Normalizing amplitudes:  44%|████▍     | 7264/16384 [00:01<00:01, 4830.27probe position/s]Normalizing amplitudes:  48%|████▊     | 7871/16384 [00:01<00:01, 5153.95probe position/s]Normalizing amplitudes:  52%|█████▏    | 8506/16384 [00:01<00:01, 5480.39probe position/s]Normalizing amplitudes:  55%|█████▌    | 9077/16384 [00:01<00:01, 5511.15probe position/s]Normalizing amplitudes:  59%|█████▉    | 9644/16384 [00:01<00:01, 4443.64probe position/s]Normalizing amplitudes:  62%|██████▏   | 10239/16384 [00:01<00:01, 4812.27probe position/s]Normalizing amplitudes:  66%|██████▌   | 10847/16384 [00:02<00:01, 5141.42probe position/s]Normalizing amplitudes:  70%|███████   | 11490/16384 [00:02<00:00, 5487.10probe position/s]Normalizing amplitudes:  74%|███████▎  | 12065/16384 [00:02<00:00, 5558.32probe position/s]Normalizing amplitudes:  77%|███████▋  | 12696/16384 [00:02<00:00, 5717.25probe position/s]Normalizing amplitudes:  81%|████████  | 13282/16384 [00:02<00:00, 5154.87probe position/s]Normalizing amplitudes:  85%|████████▍ | 13923/16384 [00:02<00:00, 5490.88probe position/s]Normalizing amplitudes:  88%|████████▊ | 14490/16384 [00:02<00:00, 5504.69probe position/s]Normalizing amplitudes:  92%|█████████▏| 15082/16384 [00:02<00:00, 5621.73probe position/s]Normalizing amplitudes:  96%|█████████▌| 15699/16384 [00:02<00:00, 5777.57probe position/s]Normalizing amplitudes:  99%|█████████▉| 16284/16384 [00:03<00:00, 5506.01probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:03<00:00, 5326.68probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random1024_p6_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random1024_p6_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.1985 in 6.078 sec
Iter: 2, Total Loss: 0.008296 in 6.019 sec
Iter: 3, Total Loss: 0.007209 in 6.011 sec
Iter: 4, Total Loss: 0.00689 in 6.002 sec
Iter: 5, Total Loss: 0.006736 in 6.016 sec
Iter: 6, Total Loss: 0.006631 in 5.995 sec
Iter: 7, Total Loss: 0.006552 in 5.957 sec
Iter: 8, Total Loss: 0.006489 in 5.970 sec
Iter: 9, Total Loss: 0.006435 in 5.954 sec
Iter: 10, Total Loss: 0.006391 in 5.945 sec
Iter: 11, Total Loss: 0.006352 in 5.958 sec
Iter: 12, Total Loss: 0.006317 in 5.960 sec
Iter: 13, Total Loss: 0.006286 in 5.961 sec
Iter: 14, Total Loss: 0.006257 in 5.953 sec
Iter: 15, Total Loss: 0.006232 in 5.950 sec
Iter: 16, Total Loss: 0.00621 in 5.947 sec
Iter: 17, Total Loss: 0.006188 in 6.010 sec
Iter: 18, Total Loss: 0.006168 in 5.932 sec
Iter: 19, Total Loss: 0.00615 in 5.948 sec
Iter: 20, Total Loss: 0.006132 in 5.936 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 5.975 with std = 0.036 sec ###
### py4DSTEM ptycho solver is finished in 2 min 1.275 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 924.85 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 1024, 6, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 647/16384 [00:00<00:02, 6466.20probe position/s]Normalizing amplitudes:   8%|▊         | 1329/16384 [00:00<00:02, 6670.51probe position/s]Normalizing amplitudes:  12%|█▏        | 2014/16384 [00:00<00:02, 6748.93probe position/s]Normalizing amplitudes:  16%|█▋        | 2689/16384 [00:00<00:02, 6741.20probe position/s]Normalizing amplitudes:  21%|██        | 3364/16384 [00:00<00:02, 6459.46probe position/s]Normalizing amplitudes:  24%|██▍       | 4012/16384 [00:00<00:01, 6447.49probe position/s]Normalizing amplitudes:  29%|██▊       | 4705/16384 [00:00<00:01, 6599.25probe position/s]Normalizing amplitudes:  33%|███▎      | 5373/16384 [00:00<00:01, 6621.89probe position/s]Normalizing amplitudes:  37%|███▋      | 6037/16384 [00:00<00:01, 6522.81probe position/s]Normalizing amplitudes:  41%|████      | 6708/16384 [00:01<00:01, 6576.32probe position/s]Normalizing amplitudes:  45%|████▌     | 7399/16384 [00:01<00:01, 6673.83probe position/s]Normalizing amplitudes:  49%|████▉     | 8067/16384 [00:01<00:01, 6653.47probe position/s]Normalizing amplitudes:  53%|█████▎    | 8733/16384 [00:01<00:01, 6632.13probe position/s]Normalizing amplitudes:  57%|█████▋    | 9411/16384 [00:01<00:01, 6673.92probe position/s]Normalizing amplitudes:  62%|██████▏   | 10079/16384 [00:01<00:00, 6647.89probe position/s]Normalizing amplitudes:  66%|██████▌   | 10749/16384 [00:01<00:00, 6663.17probe position/s]Normalizing amplitudes:  70%|██████▉   | 11434/16384 [00:01<00:00, 6716.83probe position/s]Normalizing amplitudes:  74%|███████▍  | 12106/16384 [00:01<00:00, 6709.02probe position/s]Normalizing amplitudes:  78%|███████▊  | 12798/16384 [00:01<00:00, 6768.80probe position/s]Normalizing amplitudes:  82%|████████▏ | 13475/16384 [00:02<00:00, 6729.89probe position/s]Normalizing amplitudes:  86%|████████▋ | 14155/16384 [00:02<00:00, 6750.63probe position/s]Normalizing amplitudes:  91%|█████████ | 14831/16384 [00:02<00:00, 6715.49probe position/s]Normalizing amplitudes:  95%|█████████▍| 15503/16384 [00:02<00:00, 6648.97probe position/s]Normalizing amplitudes:  99%|█████████▊| 16176/16384 [00:02<00:00, 6672.01probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6660.24probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random1024_p6_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random1024_p6_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.1948 in 11.503 sec
Iter: 2, Total Loss: 0.01015 in 11.435 sec
Iter: 3, Total Loss: 0.007805 in 11.461 sec
Iter: 4, Total Loss: 0.007129 in 11.720 sec
Iter: 5, Total Loss: 0.00681 in 11.438 sec
Iter: 6, Total Loss: 0.006619 in 11.697 sec
Iter: 7, Total Loss: 0.006485 in 11.639 sec
Iter: 8, Total Loss: 0.006387 in 11.551 sec
Iter: 9, Total Loss: 0.006309 in 11.514 sec
Iter: 10, Total Loss: 0.006247 in 11.517 sec
Iter: 11, Total Loss: 0.006199 in 11.747 sec
Iter: 12, Total Loss: 0.006156 in 11.940 sec
Iter: 13, Total Loss: 0.006121 in 11.643 sec
Iter: 14, Total Loss: 0.006091 in 11.564 sec
Iter: 15, Total Loss: 0.006064 in 11.565 sec
Iter: 16, Total Loss: 0.00604 in 11.662 sec
Iter: 17, Total Loss: 0.006018 in 11.544 sec
Iter: 18, Total Loss: 0.005999 in 11.585 sec
Iter: 19, Total Loss: 0.005981 in 11.589 sec
Iter: 20, Total Loss: 0.005963 in 11.576 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 11.595 with std = 0.117 sec ###
### py4DSTEM ptycho solver is finished in 3 min 53.578 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 912.13 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 1024, 12, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 599/16384 [00:00<00:02, 5984.40probe position/s]Normalizing amplitudes:   8%|▊         | 1237/16384 [00:00<00:02, 6214.64probe position/s]Normalizing amplitudes:  11%|█▏        | 1859/16384 [00:00<00:02, 5796.17probe position/s]Normalizing amplitudes:  15%|█▌        | 2475/16384 [00:00<00:02, 5930.05probe position/s]Normalizing amplitudes:  19%|█▊        | 3071/16384 [00:00<00:02, 5612.13probe position/s]Normalizing amplitudes:  22%|██▏       | 3684/16384 [00:00<00:02, 5776.91probe position/s]Normalizing amplitudes:  26%|██▌       | 4299/16384 [00:00<00:02, 5892.40probe position/s]Normalizing amplitudes:  30%|███       | 4924/16384 [00:00<00:01, 6001.57probe position/s]Normalizing amplitudes:  34%|███▍      | 5539/16384 [00:00<00:01, 6042.28probe position/s]Normalizing amplitudes:  38%|███▊      | 6145/16384 [00:01<00:01, 5919.69probe position/s]Normalizing amplitudes:  41%|████▏     | 6784/16384 [00:01<00:01, 6058.09probe position/s]Normalizing amplitudes:  45%|████▌     | 7392/16384 [00:01<00:01, 5850.16probe position/s]Normalizing amplitudes:  49%|████▊     | 7980/16384 [00:01<00:01, 5817.45probe position/s]Normalizing amplitudes:  52%|█████▏    | 8585/16384 [00:01<00:01, 5883.81probe position/s]Normalizing amplitudes:  56%|█████▌    | 9175/16384 [00:01<00:01, 5856.35probe position/s]Normalizing amplitudes:  60%|█████▉    | 9762/16384 [00:01<00:01, 5812.54probe position/s]Normalizing amplitudes:  63%|██████▎   | 10344/16384 [00:01<00:01, 5814.08probe position/s]Normalizing amplitudes:  67%|██████▋   | 10998/16384 [00:01<00:00, 6028.69probe position/s]Normalizing amplitudes:  71%|███████   | 11647/16384 [00:01<00:00, 6163.32probe position/s]Normalizing amplitudes:  75%|███████▍  | 12264/16384 [00:02<00:00, 6077.92probe position/s]Normalizing amplitudes:  79%|███████▊  | 12873/16384 [00:02<00:00, 5879.17probe position/s]Normalizing amplitudes:  82%|████████▏ | 13463/16384 [00:02<00:00, 5828.49probe position/s]Normalizing amplitudes:  86%|████████▌ | 14047/16384 [00:02<00:00, 5595.29probe position/s]Normalizing amplitudes:  89%|████████▉ | 14633/16384 [00:02<00:00, 5668.98probe position/s]Normalizing amplitudes:  93%|█████████▎| 15280/16384 [00:02<00:00, 5898.11probe position/s]Normalizing amplitudes:  97%|█████████▋| 15953/16384 [00:02<00:00, 6139.75probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5879.99probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random1024_p12_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random1024_p12_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.5344 in 4.103 sec
Iter: 2, Total Loss: 0.007292 in 4.067 sec
Iter: 3, Total Loss: 0.006844 in 4.106 sec
Iter: 4, Total Loss: 0.006658 in 4.077 sec
Iter: 5, Total Loss: 0.006565 in 4.045 sec
Iter: 6, Total Loss: 0.006509 in 4.046 sec
Iter: 7, Total Loss: 0.006469 in 4.072 sec
Iter: 8, Total Loss: 0.006438 in 4.056 sec
Iter: 9, Total Loss: 0.006413 in 4.065 sec
Iter: 10, Total Loss: 0.006391 in 4.014 sec
Iter: 11, Total Loss: 0.00637 in 4.062 sec
Iter: 12, Total Loss: 0.006351 in 4.106 sec
Iter: 13, Total Loss: 0.006332 in 4.061 sec
Iter: 14, Total Loss: 0.006314 in 4.059 sec
Iter: 15, Total Loss: 0.006297 in 4.055 sec
Iter: 16, Total Loss: 0.006281 in 4.045 sec
Iter: 17, Total Loss: 0.006264 in 4.076 sec
Iter: 18, Total Loss: 0.006248 in 4.057 sec
Iter: 19, Total Loss: 0.006232 in 4.042 sec
Iter: 20, Total Loss: 0.006217 in 4.038 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 4.063 with std = 0.023 sec ###
### py4DSTEM ptycho solver is finished in 1 min 22.975 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 912.11 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 1024, 12, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 633/16384 [00:00<00:02, 6328.44probe position/s]Normalizing amplitudes:   8%|▊         | 1266/16384 [00:00<00:02, 6197.36probe position/s]Normalizing amplitudes:  12%|█▏        | 1910/16384 [00:00<00:02, 6304.62probe position/s]Normalizing amplitudes:  16%|█▌        | 2576/16384 [00:00<00:02, 6440.62probe position/s]Normalizing amplitudes:  20%|█▉        | 3221/16384 [00:00<00:02, 6348.65probe position/s]Normalizing amplitudes:  24%|██▎       | 3867/16384 [00:00<00:01, 6384.94probe position/s]Normalizing amplitudes:  28%|██▊       | 4515/16384 [00:00<00:01, 6413.06probe position/s]Normalizing amplitudes:  32%|███▏      | 5184/16384 [00:00<00:01, 6497.03probe position/s]Normalizing amplitudes:  36%|███▌      | 5834/16384 [00:00<00:01, 6421.38probe position/s]Normalizing amplitudes:  40%|███▉      | 6477/16384 [00:01<00:01, 6241.04probe position/s]Normalizing amplitudes:  43%|████▎     | 7103/16384 [00:01<00:01, 5966.88probe position/s]Normalizing amplitudes:  47%|████▋     | 7706/16384 [00:01<00:01, 5984.26probe position/s]Normalizing amplitudes:  51%|█████     | 8347/16384 [00:01<00:01, 6107.91probe position/s]Normalizing amplitudes:  55%|█████▍    | 8982/16384 [00:01<00:01, 6177.41probe position/s]Normalizing amplitudes:  59%|█████▉    | 9659/16384 [00:01<00:01, 6351.04probe position/s]Normalizing amplitudes:  63%|██████▎   | 10296/16384 [00:01<00:00, 6230.82probe position/s]Normalizing amplitudes:  67%|██████▋   | 10921/16384 [00:01<00:00, 6031.80probe position/s]Normalizing amplitudes:  70%|███████   | 11527/16384 [00:01<00:00, 5893.41probe position/s]Normalizing amplitudes:  74%|███████▍  | 12118/16384 [00:01<00:00, 5768.17probe position/s]Normalizing amplitudes:  77%|███████▋  | 12697/16384 [00:02<00:00, 5729.22probe position/s]Normalizing amplitudes:  81%|████████▏ | 13341/16384 [00:02<00:00, 5932.49probe position/s]Normalizing amplitudes:  86%|████████▌ | 14013/16384 [00:02<00:00, 6160.26probe position/s]Normalizing amplitudes:  89%|████████▉ | 14631/16384 [00:02<00:00, 6123.47probe position/s]Normalizing amplitudes:  93%|█████████▎| 15245/16384 [00:02<00:00, 5960.05probe position/s]Normalizing amplitudes:  97%|█████████▋| 15843/16384 [00:02<00:00, 5821.48probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6080.74probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random1024_p12_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random1024_p12_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
An error occurred for (round, batch, pmode, slice) = (3, 1024, 12, 3): Out of memory allocating 1,610,612,736 bytes (allocated so far: 18,790,481,920 bytes).
### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 912.03 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 1024, 12, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 656/16384 [00:00<00:02, 6553.99probe position/s]Normalizing amplitudes:   8%|▊         | 1314/16384 [00:00<00:02, 6564.72probe position/s]Normalizing amplitudes:  12%|█▏        | 1971/16384 [00:00<00:02, 6353.96probe position/s]Normalizing amplitudes:  16%|█▌        | 2608/16384 [00:00<00:02, 6289.48probe position/s]Normalizing amplitudes:  20%|█▉        | 3242/16384 [00:00<00:02, 6306.30probe position/s]Normalizing amplitudes:  24%|██▎       | 3873/16384 [00:00<00:02, 6221.29probe position/s]Normalizing amplitudes:  27%|██▋       | 4496/16384 [00:00<00:01, 6179.78probe position/s]Normalizing amplitudes:  31%|███▏      | 5134/16384 [00:00<00:01, 6242.36probe position/s]Normalizing amplitudes:  35%|███▌      | 5759/16384 [00:00<00:01, 6175.46probe position/s]Normalizing amplitudes:  39%|███▉      | 6384/16384 [00:01<00:01, 6197.93probe position/s]Normalizing amplitudes:  43%|████▎     | 7005/16384 [00:01<00:01, 6102.04probe position/s]Normalizing amplitudes:  46%|████▋     | 7616/16384 [00:01<00:01, 5934.36probe position/s]Normalizing amplitudes:  50%|█████     | 8211/16384 [00:01<00:01, 5822.58probe position/s]Normalizing amplitudes:  54%|█████▎    | 8801/16384 [00:01<00:01, 5843.96probe position/s]Normalizing amplitudes:  57%|█████▋    | 9387/16384 [00:01<00:01, 5823.99probe position/s]Normalizing amplitudes:  61%|██████    | 10031/16384 [00:01<00:01, 6002.40probe position/s]Normalizing amplitudes:  65%|██████▌   | 10652/16384 [00:01<00:00, 6058.74probe position/s]Normalizing amplitudes:  69%|██████▊   | 11259/16384 [00:01<00:00, 5932.50probe position/s]Normalizing amplitudes:  72%|███████▏  | 11856/16384 [00:01<00:00, 5943.43probe position/s]Normalizing amplitudes:  76%|███████▌  | 12479/16384 [00:02<00:00, 6027.46probe position/s]Normalizing amplitudes:  80%|███████▉  | 13083/16384 [00:02<00:00, 6002.47probe position/s]Normalizing amplitudes:  84%|████████▎ | 13684/16384 [00:02<00:00, 5836.68probe position/s]Normalizing amplitudes:  87%|████████▋ | 14331/16384 [00:02<00:00, 6019.44probe position/s]Normalizing amplitudes:  91%|█████████ | 14935/16384 [00:02<00:00, 5980.74probe position/s]Normalizing amplitudes:  95%|█████████▌| 15568/16384 [00:02<00:00, 6080.19probe position/s]Normalizing amplitudes:  99%|█████████▊| 16177/16384 [00:02<00:00, 6010.98probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6049.78probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random1024_p12_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random1024_p12_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
An error occurred for (round, batch, pmode, slice) = (3, 1024, 12, 6): Out of memory allocating 1,610,612,736 bytes (allocated so far: 18,790,481,920 bytes).
### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 913.90 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 512, 1, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 655/16384 [00:00<00:02, 6544.51probe position/s]Normalizing amplitudes:   8%|▊         | 1310/16384 [00:00<00:02, 6506.91probe position/s]Normalizing amplitudes:  12%|█▏        | 1961/16384 [00:00<00:02, 6193.63probe position/s]Normalizing amplitudes:  16%|█▌        | 2582/16384 [00:00<00:02, 5565.13probe position/s]Normalizing amplitudes:  19%|█▉        | 3155/16384 [00:00<00:02, 5617.51probe position/s]Normalizing amplitudes:  23%|██▎       | 3728/16384 [00:00<00:02, 5653.26probe position/s]Normalizing amplitudes:  26%|██▌       | 4298/16384 [00:00<00:02, 5507.07probe position/s]Normalizing amplitudes:  30%|██▉       | 4867/16384 [00:00<00:02, 5560.96probe position/s]Normalizing amplitudes:  34%|███▍      | 5530/16384 [00:00<00:01, 5882.95probe position/s]Normalizing amplitudes:  37%|███▋      | 6121/16384 [00:01<00:01, 5726.25probe position/s]Normalizing amplitudes:  41%|████      | 6697/16384 [00:01<00:01, 5662.21probe position/s]Normalizing amplitudes:  44%|████▍     | 7265/16384 [00:01<00:01, 5647.52probe position/s]Normalizing amplitudes:  48%|████▊     | 7831/16384 [00:01<00:01, 5586.65probe position/s]Normalizing amplitudes:  51%|█████     | 8391/16384 [00:01<00:01, 5474.40probe position/s]Normalizing amplitudes:  55%|█████▍    | 8940/16384 [00:01<00:01, 5464.14probe position/s]Normalizing amplitudes:  58%|█████▊    | 9532/16384 [00:01<00:01, 5596.68probe position/s]Normalizing amplitudes:  62%|██████▏   | 10184/16384 [00:01<00:01, 5868.11probe position/s]Normalizing amplitudes:  66%|██████▌   | 10824/16384 [00:01<00:00, 6025.69probe position/s]Normalizing amplitudes:  70%|██████▉   | 11449/16384 [00:01<00:00, 6092.07probe position/s]Normalizing amplitudes:  74%|███████▍  | 12124/16384 [00:02<00:00, 6287.08probe position/s]Normalizing amplitudes:  78%|███████▊  | 12769/16384 [00:02<00:00, 6335.44probe position/s]Normalizing amplitudes:  82%|████████▏ | 13403/16384 [00:02<00:00, 6245.57probe position/s]Normalizing amplitudes:  86%|████████▌ | 14029/16384 [00:02<00:00, 6189.85probe position/s]Normalizing amplitudes:  90%|████████▉ | 14685/16384 [00:02<00:00, 6297.93probe position/s]Normalizing amplitudes:  94%|█████████▎| 15330/16384 [00:02<00:00, 6342.35probe position/s]Normalizing amplitudes:  98%|█████████▊| 15979/16384 [00:02<00:00, 6383.65probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5951.11probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random512_p1_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random512_p1_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.01436 in 0.839 sec
Iter: 2, Total Loss: 0.006511 in 0.787 sec
Iter: 3, Total Loss: 0.006486 in 0.808 sec
Iter: 4, Total Loss: 0.006474 in 0.801 sec
Iter: 5, Total Loss: 0.006467 in 0.797 sec
Iter: 6, Total Loss: 0.006462 in 0.800 sec
Iter: 7, Total Loss: 0.006459 in 0.815 sec
Iter: 8, Total Loss: 0.006455 in 0.906 sec
Iter: 9, Total Loss: 0.006451 in 1.012 sec
Iter: 10, Total Loss: 0.006448 in 0.901 sec
Iter: 11, Total Loss: 0.006444 in 0.890 sec
Iter: 12, Total Loss: 0.006441 in 0.935 sec
Iter: 13, Total Loss: 0.006438 in 0.772 sec
Iter: 14, Total Loss: 0.006435 in 0.790 sec
Iter: 15, Total Loss: 0.006432 in 0.807 sec
Iter: 16, Total Loss: 0.006428 in 0.849 sec
Iter: 17, Total Loss: 0.006424 in 0.818 sec
Iter: 18, Total Loss: 0.006421 in 0.777 sec
Iter: 19, Total Loss: 0.006417 in 0.785 sec
Iter: 20, Total Loss: 0.006413 in 0.803 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 0.835 with std = 0.061 sec ###
### py4DSTEM ptycho solver is finished in 18.317 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 912.48 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 512, 1, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 556/16384 [00:00<00:02, 5553.32probe position/s]Normalizing amplitudes:   8%|▊         | 1235/16384 [00:00<00:02, 6278.88probe position/s]Normalizing amplitudes:  12%|█▏        | 1906/16384 [00:00<00:02, 6473.49probe position/s]Normalizing amplitudes:  16%|█▌        | 2563/16384 [00:00<00:02, 6508.52probe position/s]Normalizing amplitudes:  20%|█▉        | 3214/16384 [00:00<00:02, 6405.81probe position/s]Normalizing amplitudes:  24%|██▍       | 3892/16384 [00:00<00:01, 6531.23probe position/s]Normalizing amplitudes:  28%|██▊       | 4546/16384 [00:00<00:01, 6440.48probe position/s]Normalizing amplitudes:  32%|███▏      | 5191/16384 [00:00<00:01, 6374.87probe position/s]Normalizing amplitudes:  36%|███▌      | 5888/16384 [00:00<00:01, 6556.59probe position/s]Normalizing amplitudes:  40%|███▉      | 6545/16384 [00:01<00:01, 6352.63probe position/s]Normalizing amplitudes:  44%|████▍     | 7182/16384 [00:01<00:01, 6116.65probe position/s]Normalizing amplitudes:  48%|████▊     | 7796/16384 [00:01<00:01, 6063.78probe position/s]Normalizing amplitudes:  51%|█████▏    | 8404/16384 [00:01<00:01, 5960.12probe position/s]Normalizing amplitudes:  55%|█████▍    | 9010/16384 [00:01<00:01, 5987.26probe position/s]Normalizing amplitudes:  59%|█████▉    | 9680/16384 [00:01<00:01, 6193.88probe position/s]Normalizing amplitudes:  63%|██████▎   | 10310/16384 [00:01<00:00, 6223.75probe position/s]Normalizing amplitudes:  67%|██████▋   | 10934/16384 [00:01<00:00, 6187.76probe position/s]Normalizing amplitudes:  71%|███████   | 11557/16384 [00:01<00:00, 6196.65probe position/s]Normalizing amplitudes:  74%|███████▍  | 12178/16384 [00:01<00:00, 6009.84probe position/s]Normalizing amplitudes:  78%|███████▊  | 12781/16384 [00:02<00:00, 5952.39probe position/s]Normalizing amplitudes:  82%|████████▏ | 13418/16384 [00:02<00:00, 6072.86probe position/s]Normalizing amplitudes:  86%|████████▌ | 14078/16384 [00:02<00:00, 6227.18probe position/s]Normalizing amplitudes:  90%|████████▉ | 14734/16384 [00:02<00:00, 6324.50probe position/s]Normalizing amplitudes:  94%|█████████▍| 15368/16384 [00:02<00:00, 6300.78probe position/s]Normalizing amplitudes:  98%|█████████▊| 15999/16384 [00:02<00:00, 6115.42probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6194.73probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random512_p1_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random512_p1_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.01471 in 1.578 sec
Iter: 2, Total Loss: 0.006505 in 1.537 sec
Iter: 3, Total Loss: 0.006483 in 1.544 sec
Iter: 4, Total Loss: 0.006473 in 1.522 sec
Iter: 5, Total Loss: 0.006465 in 1.562 sec
Iter: 6, Total Loss: 0.006458 in 1.533 sec
Iter: 7, Total Loss: 0.006451 in 1.548 sec
Iter: 8, Total Loss: 0.006446 in 1.513 sec
Iter: 9, Total Loss: 0.006441 in 1.560 sec
Iter: 10, Total Loss: 0.006435 in 1.521 sec
Iter: 11, Total Loss: 0.006429 in 1.534 sec
Iter: 12, Total Loss: 0.006422 in 1.516 sec
Iter: 13, Total Loss: 0.006418 in 1.515 sec
Iter: 14, Total Loss: 0.006413 in 1.517 sec
Iter: 15, Total Loss: 0.006408 in 1.520 sec
Iter: 16, Total Loss: 0.006402 in 1.511 sec
Iter: 17, Total Loss: 0.006398 in 1.509 sec
Iter: 18, Total Loss: 0.006392 in 1.513 sec
Iter: 19, Total Loss: 0.006387 in 1.518 sec
Iter: 20, Total Loss: 0.006382 in 1.530 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 1.530 with std = 0.019 sec ###
### py4DSTEM ptycho solver is finished in 32.102 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 922.19 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 512, 1, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 681/16384 [00:00<00:02, 6808.77probe position/s]Normalizing amplitudes:   8%|▊         | 1362/16384 [00:00<00:02, 6781.60probe position/s]Normalizing amplitudes:  13%|█▎        | 2062/16384 [00:00<00:02, 6877.48probe position/s]Normalizing amplitudes:  17%|█▋        | 2750/16384 [00:00<00:02, 6721.27probe position/s]Normalizing amplitudes:  21%|██        | 3423/16384 [00:00<00:01, 6486.21probe position/s]Normalizing amplitudes:  25%|██▍       | 4079/16384 [00:00<00:01, 6509.56probe position/s]Normalizing amplitudes:  29%|██▉       | 4731/16384 [00:00<00:01, 6503.84probe position/s]Normalizing amplitudes:  33%|███▎      | 5423/16384 [00:00<00:01, 6631.45probe position/s]Normalizing amplitudes:  37%|███▋      | 6114/16384 [00:00<00:01, 6717.26probe position/s]Normalizing amplitudes:  41%|████▏     | 6788/16384 [00:01<00:01, 6722.97probe position/s]Normalizing amplitudes:  46%|████▌     | 7461/16384 [00:01<00:01, 6530.16probe position/s]Normalizing amplitudes:  50%|████▉     | 8116/16384 [00:01<00:01, 6448.42probe position/s]Normalizing amplitudes:  54%|█████▎    | 8786/16384 [00:01<00:01, 6521.55probe position/s]Normalizing amplitudes:  58%|█████▊    | 9440/16384 [00:01<00:01, 6306.96probe position/s]Normalizing amplitudes:  62%|██████▏   | 10129/16384 [00:01<00:00, 6475.14probe position/s]Normalizing amplitudes:  66%|██████▌   | 10788/16384 [00:01<00:00, 6508.40probe position/s]Normalizing amplitudes:  70%|██████▉   | 11461/16384 [00:01<00:00, 6573.02probe position/s]Normalizing amplitudes:  74%|███████▍  | 12123/16384 [00:01<00:00, 6585.04probe position/s]Normalizing amplitudes:  78%|███████▊  | 12783/16384 [00:01<00:00, 6521.42probe position/s]Normalizing amplitudes:  82%|████████▏ | 13439/16384 [00:02<00:00, 6531.16probe position/s]Normalizing amplitudes:  86%|████████▌ | 14093/16384 [00:02<00:00, 6470.06probe position/s]Normalizing amplitudes:  90%|█████████ | 14783/16384 [00:02<00:00, 6596.11probe position/s]Normalizing amplitudes:  94%|█████████▍| 15444/16384 [00:02<00:00, 6587.69probe position/s]Normalizing amplitudes:  98%|█████████▊| 16125/16384 [00:02<00:00, 6652.34probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6575.86probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random512_p1_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random512_p1_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.01499 in 2.680 sec
Iter: 2, Total Loss: 0.00653 in 2.591 sec
Iter: 3, Total Loss: 0.006509 in 2.627 sec
Iter: 4, Total Loss: 0.006492 in 2.595 sec
Iter: 5, Total Loss: 0.006481 in 2.595 sec
Iter: 6, Total Loss: 0.006473 in 2.579 sec
Iter: 7, Total Loss: 0.006462 in 2.667 sec
Iter: 8, Total Loss: 0.006453 in 2.606 sec
Iter: 9, Total Loss: 0.006445 in 2.562 sec
Iter: 10, Total Loss: 0.006436 in 2.590 sec
Iter: 11, Total Loss: 0.006431 in 2.633 sec
Iter: 12, Total Loss: 0.006422 in 2.609 sec
Iter: 13, Total Loss: 0.006415 in 2.592 sec
Iter: 14, Total Loss: 0.006408 in 2.603 sec
Iter: 15, Total Loss: 0.006402 in 2.590 sec
Iter: 16, Total Loss: 0.006394 in 2.582 sec
Iter: 17, Total Loss: 0.006386 in 2.593 sec
Iter: 18, Total Loss: 0.006381 in 2.579 sec
Iter: 19, Total Loss: 0.006376 in 2.645 sec
Iter: 20, Total Loss: 0.006369 in 2.607 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 2.606 with std = 0.029 sec ###
### py4DSTEM ptycho solver is finished in 53.622 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 922.52 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 512, 3, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 628/16384 [00:00<00:02, 6268.35probe position/s]Normalizing amplitudes:   8%|▊         | 1309/16384 [00:00<00:02, 6583.63probe position/s]Normalizing amplitudes:  12%|█▏        | 1969/16384 [00:00<00:02, 6586.24probe position/s]Normalizing amplitudes:  16%|█▌        | 2628/16384 [00:00<00:02, 6556.91probe position/s]Normalizing amplitudes:  20%|██        | 3284/16384 [00:00<00:02, 6492.52probe position/s]Normalizing amplitudes:  24%|██▍       | 3957/16384 [00:00<00:01, 6570.67probe position/s]Normalizing amplitudes:  28%|██▊       | 4634/16384 [00:00<00:01, 6634.81probe position/s]Normalizing amplitudes:  33%|███▎      | 5331/16384 [00:00<00:01, 6740.02probe position/s]Normalizing amplitudes:  37%|███▋      | 6032/16384 [00:00<00:01, 6823.28probe position/s]Normalizing amplitudes:  41%|████      | 6715/16384 [00:01<00:01, 6801.20probe position/s]Normalizing amplitudes:  45%|████▌     | 7396/16384 [00:01<00:01, 6701.56probe position/s]Normalizing amplitudes:  49%|████▉     | 8067/16384 [00:01<00:01, 6557.84probe position/s]Normalizing amplitudes:  53%|█████▎    | 8727/16384 [00:01<00:01, 6570.05probe position/s]Normalizing amplitudes:  57%|█████▋    | 9385/16384 [00:01<00:01, 6558.50probe position/s]Normalizing amplitudes:  61%|██████▏   | 10065/16384 [00:01<00:00, 6626.30probe position/s]Normalizing amplitudes:  66%|██████▌   | 10739/16384 [00:01<00:00, 6658.33probe position/s]Normalizing amplitudes:  70%|██████▉   | 11406/16384 [00:01<00:00, 6650.94probe position/s]Normalizing amplitudes:  74%|███████▎  | 12079/16384 [00:01<00:00, 6674.02probe position/s]Normalizing amplitudes:  78%|███████▊  | 12752/16384 [00:01<00:00, 6688.72probe position/s]Normalizing amplitudes:  82%|████████▏ | 13421/16384 [00:02<00:00, 6631.90probe position/s]Normalizing amplitudes:  86%|████████▌ | 14104/16384 [00:02<00:00, 6688.48probe position/s]Normalizing amplitudes:  90%|█████████ | 14774/16384 [00:02<00:00, 6333.09probe position/s]Normalizing amplitudes:  94%|█████████▍| 15459/16384 [00:02<00:00, 6481.33probe position/s]Normalizing amplitudes:  99%|█████████▊| 16144/16384 [00:02<00:00, 6588.49probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6609.67probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random512_p3_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random512_p3_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.03981 in 1.626 sec
Iter: 2, Total Loss: 0.006635 in 1.444 sec
Iter: 3, Total Loss: 0.006487 in 1.475 sec
Iter: 4, Total Loss: 0.00642 in 1.438 sec
Iter: 5, Total Loss: 0.00638 in 1.410 sec
Iter: 6, Total Loss: 0.006352 in 1.392 sec
Iter: 7, Total Loss: 0.006328 in 1.414 sec
Iter: 8, Total Loss: 0.006307 in 1.747 sec
Iter: 9, Total Loss: 0.006288 in 1.483 sec
Iter: 10, Total Loss: 0.006269 in 1.485 sec
Iter: 11, Total Loss: 0.006251 in 1.413 sec
Iter: 12, Total Loss: 0.006235 in 1.405 sec
Iter: 13, Total Loss: 0.006218 in 1.400 sec
Iter: 14, Total Loss: 0.006202 in 1.430 sec
Iter: 15, Total Loss: 0.006186 in 1.489 sec
Iter: 16, Total Loss: 0.006171 in 1.458 sec
Iter: 17, Total Loss: 0.006155 in 1.446 sec
Iter: 18, Total Loss: 0.006141 in 1.445 sec
Iter: 19, Total Loss: 0.006126 in 1.423 sec
Iter: 20, Total Loss: 0.006112 in 1.429 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 1.463 with std = 0.082 sec ###
### py4DSTEM ptycho solver is finished in 30.709 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 916.44 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 512, 3, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 633/16384 [00:00<00:02, 6329.00probe position/s]Normalizing amplitudes:   8%|▊         | 1266/16384 [00:00<00:02, 6279.50probe position/s]Normalizing amplitudes:  12%|█▏        | 1910/16384 [00:00<00:02, 6349.76probe position/s]Normalizing amplitudes:  16%|█▌        | 2556/16384 [00:00<00:02, 6391.29probe position/s]Normalizing amplitudes:  20%|█▉        | 3196/16384 [00:00<00:02, 6392.10probe position/s]Normalizing amplitudes:  23%|██▎       | 3836/16384 [00:00<00:01, 6354.99probe position/s]Normalizing amplitudes:  27%|██▋       | 4472/16384 [00:00<00:01, 6202.36probe position/s]Normalizing amplitudes:  31%|███▏      | 5130/16384 [00:00<00:01, 6318.48probe position/s]Normalizing amplitudes:  35%|███▌      | 5763/16384 [00:00<00:01, 6264.11probe position/s]Normalizing amplitudes:  39%|███▉      | 6390/16384 [00:01<00:01, 6263.07probe position/s]Normalizing amplitudes:  43%|████▎     | 7032/16384 [00:01<00:01, 6307.39probe position/s]Normalizing amplitudes:  47%|████▋     | 7664/16384 [00:01<00:01, 6287.22probe position/s]Normalizing amplitudes:  51%|█████     | 8324/16384 [00:01<00:01, 6380.54probe position/s]Normalizing amplitudes:  55%|█████▍    | 8963/16384 [00:01<00:01, 6374.53probe position/s]Normalizing amplitudes:  59%|█████▊    | 9617/16384 [00:01<00:01, 6421.80probe position/s]Normalizing amplitudes:  63%|██████▎   | 10268/16384 [00:01<00:00, 6447.67probe position/s]Normalizing amplitudes:  67%|██████▋   | 10914/16384 [00:01<00:00, 6450.21probe position/s]Normalizing amplitudes:  71%|███████   | 11589/16384 [00:01<00:00, 6538.71probe position/s]Normalizing amplitudes:  75%|███████▍  | 12243/16384 [00:01<00:00, 6362.85probe position/s]Normalizing amplitudes:  79%|███████▊  | 12881/16384 [00:02<00:00, 6150.97probe position/s]Normalizing amplitudes:  82%|████████▏ | 13499/16384 [00:02<00:00, 6016.28probe position/s]Normalizing amplitudes:  86%|████████▌ | 14103/16384 [00:02<00:00, 5972.37probe position/s]Normalizing amplitudes:  90%|█████████ | 14755/16384 [00:02<00:00, 6128.89probe position/s]Normalizing amplitudes:  94%|█████████▍| 15374/16384 [00:02<00:00, 6145.19probe position/s]Normalizing amplitudes:  98%|█████████▊| 16073/16384 [00:02<00:00, 6393.66probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6305.10probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random512_p3_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random512_p3_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.03883 in 3.545 sec
Iter: 2, Total Loss: 0.006711 in 3.497 sec
Iter: 3, Total Loss: 0.006481 in 3.515 sec
Iter: 4, Total Loss: 0.006421 in 3.520 sec
Iter: 5, Total Loss: 0.006386 in 3.632 sec
Iter: 6, Total Loss: 0.006356 in 3.621 sec
Iter: 7, Total Loss: 0.006331 in 3.568 sec
Iter: 8, Total Loss: 0.006304 in 3.510 sec
Iter: 9, Total Loss: 0.00628 in 3.495 sec
Iter: 10, Total Loss: 0.006257 in 3.528 sec
Iter: 11, Total Loss: 0.006234 in 3.508 sec
Iter: 12, Total Loss: 0.006212 in 3.494 sec
Iter: 13, Total Loss: 0.00619 in 3.527 sec
Iter: 14, Total Loss: 0.006171 in 3.528 sec
Iter: 15, Total Loss: 0.006149 in 3.477 sec
Iter: 16, Total Loss: 0.00613 in 3.508 sec
Iter: 17, Total Loss: 0.00611 in 3.555 sec
Iter: 18, Total Loss: 0.006092 in 3.548 sec
Iter: 19, Total Loss: 0.006071 in 3.484 sec
Iter: 20, Total Loss: 0.006055 in 3.506 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 3.528 with std = 0.040 sec ###
### py4DSTEM ptycho solver is finished in 1 min 12.242 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 911.93 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 512, 3, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 596/16384 [00:00<00:02, 5955.83probe position/s]Normalizing amplitudes:   7%|▋         | 1201/16384 [00:00<00:02, 6007.90probe position/s]Normalizing amplitudes:  11%|█         | 1802/16384 [00:00<00:02, 5618.31probe position/s]Normalizing amplitudes:  14%|█▍        | 2367/16384 [00:00<00:02, 5602.37probe position/s]Normalizing amplitudes:  18%|█▊        | 3009/16384 [00:00<00:02, 5886.40probe position/s]Normalizing amplitudes:  22%|██▏       | 3663/16384 [00:00<00:02, 6102.19probe position/s]Normalizing amplitudes:  26%|██▌       | 4283/16384 [00:00<00:01, 6131.62probe position/s]Normalizing amplitudes:  30%|██▉       | 4898/16384 [00:00<00:02, 5613.36probe position/s]Normalizing amplitudes:  34%|███▎      | 5519/16384 [00:00<00:01, 5786.87probe position/s]Normalizing amplitudes:  38%|███▊      | 6145/16384 [00:01<00:01, 5920.21probe position/s]Normalizing amplitudes:  41%|████      | 6749/16384 [00:01<00:01, 5955.31probe position/s]Normalizing amplitudes:  45%|████▍     | 7352/16384 [00:01<00:01, 5975.84probe position/s]Normalizing amplitudes:  49%|████▉     | 7993/16384 [00:01<00:01, 6102.79probe position/s]Normalizing amplitudes:  53%|█████▎    | 8622/16384 [00:01<00:01, 6156.70probe position/s]Normalizing amplitudes:  57%|█████▋    | 9288/16384 [00:01<00:01, 6305.72probe position/s]Normalizing amplitudes:  61%|██████    | 9920/16384 [00:01<00:01, 6142.42probe position/s]Normalizing amplitudes:  64%|██████▍   | 10543/16384 [00:01<00:00, 6166.18probe position/s]Normalizing amplitudes:  68%|██████▊   | 11185/16384 [00:01<00:00, 6238.18probe position/s]Normalizing amplitudes:  72%|███████▏  | 11810/16384 [00:01<00:00, 6164.67probe position/s]Normalizing amplitudes:  76%|███████▌  | 12428/16384 [00:02<00:00, 6160.71probe position/s]Normalizing amplitudes:  80%|███████▉  | 13050/16384 [00:02<00:00, 6175.21probe position/s]Normalizing amplitudes:  84%|████████▎ | 13682/16384 [00:02<00:00, 6216.65probe position/s]Normalizing amplitudes:  87%|████████▋ | 14319/16384 [00:02<00:00, 6261.42probe position/s]Normalizing amplitudes:  91%|█████████▏| 14967/16384 [00:02<00:00, 6326.56probe position/s]Normalizing amplitudes:  95%|█████████▌| 15621/16384 [00:02<00:00, 6389.59probe position/s]Normalizing amplitudes:  99%|█████████▉| 16261/16384 [00:02<00:00, 6158.34probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6071.63probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random512_p3_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random512_p3_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.04103 in 6.676 sec
Iter: 2, Total Loss: 0.006986 in 6.615 sec
Iter: 3, Total Loss: 0.006518 in 6.622 sec
Iter: 4, Total Loss: 0.006394 in 6.621 sec
Iter: 5, Total Loss: 0.00632 in 6.653 sec
Iter: 6, Total Loss: 0.006264 in 6.577 sec
Iter: 7, Total Loss: 0.006218 in 6.636 sec
Iter: 8, Total Loss: 0.006179 in 6.581 sec
Iter: 9, Total Loss: 0.006147 in 6.560 sec
Iter: 10, Total Loss: 0.006117 in 6.583 sec
Iter: 11, Total Loss: 0.006088 in 6.616 sec
Iter: 12, Total Loss: 0.006063 in 6.768 sec
Iter: 13, Total Loss: 0.006038 in 6.636 sec
Iter: 14, Total Loss: 0.006016 in 7.245 sec
Iter: 15, Total Loss: 0.005994 in 6.738 sec
Iter: 16, Total Loss: 0.005973 in 6.613 sec
Iter: 17, Total Loss: 0.005952 in 6.528 sec
Iter: 18, Total Loss: 0.005933 in 6.539 sec
Iter: 19, Total Loss: 0.005913 in 6.608 sec
Iter: 20, Total Loss: 0.005894 in 6.594 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 6.650 with std = 0.148 sec ###
### py4DSTEM ptycho solver is finished in 2 min 14.753 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 912.08 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 512, 6, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 612/16384 [00:00<00:02, 6112.59probe position/s]Normalizing amplitudes:   8%|▊         | 1256/16384 [00:00<00:02, 6299.17probe position/s]Normalizing amplitudes:  12%|█▏        | 1886/16384 [00:00<00:02, 5998.09probe position/s]Normalizing amplitudes:  15%|█▌        | 2488/16384 [00:00<00:02, 5848.57probe position/s]Normalizing amplitudes:  19%|█▉        | 3113/16384 [00:00<00:02, 5986.66probe position/s]Normalizing amplitudes:  23%|██▎       | 3753/16384 [00:00<00:02, 6119.15probe position/s]Normalizing amplitudes:  27%|██▋       | 4367/16384 [00:00<00:02, 5930.78probe position/s]Normalizing amplitudes:  30%|███       | 4964/16384 [00:00<00:01, 5940.64probe position/s]Normalizing amplitudes:  34%|███▍      | 5602/16384 [00:00<00:01, 6074.61probe position/s]Normalizing amplitudes:  38%|███▊      | 6211/16384 [00:01<00:01, 5923.32probe position/s]Normalizing amplitudes:  42%|████▏     | 6805/16384 [00:01<00:01, 5850.77probe position/s]Normalizing amplitudes:  45%|████▌     | 7392/16384 [00:01<00:01, 5658.38probe position/s]Normalizing amplitudes:  49%|████▉     | 8057/16384 [00:01<00:01, 5943.96probe position/s]Normalizing amplitudes:  53%|█████▎    | 8685/16384 [00:01<00:01, 6040.26probe position/s]Normalizing amplitudes:  57%|█████▋    | 9292/16384 [00:01<00:01, 5951.14probe position/s]Normalizing amplitudes:  60%|██████    | 9889/16384 [00:01<00:01, 5884.07probe position/s]Normalizing amplitudes:  64%|██████▍   | 10479/16384 [00:01<00:01, 5814.25probe position/s]Normalizing amplitudes:  68%|██████▊   | 11096/16384 [00:01<00:00, 5915.35probe position/s]Normalizing amplitudes:  71%|███████▏  | 11709/16384 [00:01<00:00, 5977.07probe position/s]Normalizing amplitudes:  75%|███████▌  | 12338/16384 [00:02<00:00, 6067.30probe position/s]Normalizing amplitudes:  79%|███████▉  | 12979/16384 [00:02<00:00, 6166.08probe position/s]Normalizing amplitudes:  83%|████████▎ | 13597/16384 [00:02<00:00, 6073.07probe position/s]Normalizing amplitudes:  87%|████████▋ | 14209/16384 [00:02<00:00, 6085.70probe position/s]Normalizing amplitudes:  90%|█████████ | 14819/16384 [00:02<00:00, 6056.82probe position/s]Normalizing amplitudes:  94%|█████████▍| 15475/16384 [00:02<00:00, 6204.97probe position/s]Normalizing amplitudes:  98%|█████████▊| 16096/16384 [00:02<00:00, 6065.25probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5989.01probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random512_p6_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random512_p6_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.1073 in 2.481 sec
Iter: 2, Total Loss: 0.006752 in 2.489 sec
Iter: 3, Total Loss: 0.006543 in 2.495 sec
Iter: 4, Total Loss: 0.006458 in 2.465 sec
Iter: 5, Total Loss: 0.006416 in 2.419 sec
Iter: 6, Total Loss: 0.006388 in 2.471 sec
Iter: 7, Total Loss: 0.006367 in 2.475 sec
Iter: 8, Total Loss: 0.006347 in 2.494 sec
Iter: 9, Total Loss: 0.00633 in 2.472 sec
Iter: 10, Total Loss: 0.006312 in 2.405 sec
Iter: 11, Total Loss: 0.006295 in 2.475 sec
Iter: 12, Total Loss: 0.006277 in 2.476 sec
Iter: 13, Total Loss: 0.00626 in 2.436 sec
Iter: 14, Total Loss: 0.006243 in 2.435 sec
Iter: 15, Total Loss: 0.006224 in 2.443 sec
Iter: 16, Total Loss: 0.006207 in 2.405 sec
Iter: 17, Total Loss: 0.006189 in 2.424 sec
Iter: 18, Total Loss: 0.006172 in 2.458 sec
Iter: 19, Total Loss: 0.006153 in 2.450 sec
Iter: 20, Total Loss: 0.006137 in 2.430 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 2.455 with std = 0.028 sec ###
### py4DSTEM ptycho solver is finished in 50.617 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 912.00 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 512, 6, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 560/16384 [00:00<00:02, 5589.40probe position/s]Normalizing amplitudes:   7%|▋         | 1144/16384 [00:00<00:02, 5732.02probe position/s]Normalizing amplitudes:  10%|█         | 1718/16384 [00:00<00:02, 5728.25probe position/s]Normalizing amplitudes:  15%|█▍        | 2384/16384 [00:00<00:02, 6092.58probe position/s]Normalizing amplitudes:  18%|█▊        | 2994/16384 [00:00<00:02, 6075.67probe position/s]Normalizing amplitudes:  22%|██▏       | 3606/16384 [00:00<00:02, 6089.53probe position/s]Normalizing amplitudes:  26%|██▌       | 4250/16384 [00:00<00:01, 6203.70probe position/s]Normalizing amplitudes:  30%|██▉       | 4879/16384 [00:00<00:01, 6229.67probe position/s]Normalizing amplitudes:  34%|███▎      | 5525/16384 [00:00<00:01, 6299.65probe position/s]Normalizing amplitudes:  38%|███▊      | 6155/16384 [00:01<00:01, 6283.89probe position/s]Normalizing amplitudes:  42%|████▏     | 6807/16384 [00:01<00:01, 6355.34probe position/s]Normalizing amplitudes:  46%|████▌     | 7469/16384 [00:01<00:01, 6433.49probe position/s]Normalizing amplitudes:  50%|████▉     | 8113/16384 [00:01<00:01, 6411.74probe position/s]Normalizing amplitudes:  53%|█████▎    | 8764/16384 [00:01<00:01, 6440.91probe position/s]Normalizing amplitudes:  57%|█████▋    | 9409/16384 [00:01<00:01, 6270.02probe position/s]Normalizing amplitudes:  61%|██████▏   | 10042/16384 [00:01<00:01, 6285.36probe position/s]Normalizing amplitudes:  65%|██████▌   | 10672/16384 [00:01<00:00, 6248.80probe position/s]Normalizing amplitudes:  69%|██████▉   | 11298/16384 [00:01<00:00, 6243.30probe position/s]Normalizing amplitudes:  73%|███████▎  | 11939/16384 [00:01<00:00, 6291.15probe position/s]Normalizing amplitudes:  77%|███████▋  | 12572/16384 [00:02<00:00, 6302.55probe position/s]Normalizing amplitudes:  81%|████████  | 13207/16384 [00:02<00:00, 6312.43probe position/s]Normalizing amplitudes:  84%|████████▍ | 13839/16384 [00:02<00:00, 6222.76probe position/s]Normalizing amplitudes:  88%|████████▊ | 14462/16384 [00:02<00:00, 6215.18probe position/s]Normalizing amplitudes:  92%|█████████▏| 15084/16384 [00:02<00:00, 6181.06probe position/s]Normalizing amplitudes:  96%|█████████▌| 15703/16384 [00:02<00:00, 6042.61probe position/s]Normalizing amplitudes: 100%|█████████▉| 16349/16384 [00:02<00:00, 6163.38probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6212.60probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random512_p6_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random512_p6_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.1055 in 6.542 sec
Iter: 2, Total Loss: 0.007383 in 6.537 sec
Iter: 3, Total Loss: 0.006675 in 6.516 sec
Iter: 4, Total Loss: 0.006468 in 6.476 sec
Iter: 5, Total Loss: 0.006357 in 6.469 sec
Iter: 6, Total Loss: 0.00628 in 6.415 sec
Iter: 7, Total Loss: 0.006219 in 6.430 sec
Iter: 8, Total Loss: 0.006171 in 6.435 sec
Iter: 9, Total Loss: 0.006129 in 6.440 sec
Iter: 10, Total Loss: 0.006092 in 6.473 sec
Iter: 11, Total Loss: 0.006058 in 6.457 sec
Iter: 12, Total Loss: 0.006027 in 6.361 sec
Iter: 13, Total Loss: 0.005997 in 6.371 sec
Iter: 14, Total Loss: 0.005968 in 6.339 sec
Iter: 15, Total Loss: 0.00594 in 6.408 sec
Iter: 16, Total Loss: 0.005913 in 6.492 sec
Iter: 17, Total Loss: 0.005887 in 6.359 sec
Iter: 18, Total Loss: 0.005862 in 6.393 sec
Iter: 19, Total Loss: 0.005837 in 6.447 sec
Iter: 20, Total Loss: 0.005813 in 6.592 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 6.448 with std = 0.065 sec ###
### py4DSTEM ptycho solver is finished in 2 min 10.523 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 921.37 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 512, 6, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 646/16384 [00:00<00:02, 6452.30probe position/s]Normalizing amplitudes:   8%|▊         | 1308/16384 [00:00<00:02, 6547.66probe position/s]Normalizing amplitudes:  12%|█▏        | 1979/16384 [00:00<00:02, 6617.97probe position/s]Normalizing amplitudes:  16%|█▌        | 2648/16384 [00:00<00:02, 6642.93probe position/s]Normalizing amplitudes:  20%|██        | 3327/16384 [00:00<00:01, 6692.05probe position/s]Normalizing amplitudes:  24%|██▍       | 4009/16384 [00:00<00:01, 6735.34probe position/s]Normalizing amplitudes:  29%|██▊       | 4683/16384 [00:00<00:01, 6727.61probe position/s]Normalizing amplitudes:  33%|███▎      | 5356/16384 [00:00<00:01, 6599.35probe position/s]Normalizing amplitudes:  37%|███▋      | 6017/16384 [00:00<00:01, 6536.51probe position/s]Normalizing amplitudes:  41%|████      | 6672/16384 [00:01<00:01, 6438.15probe position/s]Normalizing amplitudes:  45%|████▍     | 7326/16384 [00:01<00:01, 6465.93probe position/s]Normalizing amplitudes:  49%|████▊     | 7973/16384 [00:01<00:01, 6412.67probe position/s]Normalizing amplitudes:  53%|█████▎    | 8632/16384 [00:01<00:01, 6463.45probe position/s]Normalizing amplitudes:  57%|█████▋    | 9316/16384 [00:01<00:01, 6574.14probe position/s]Normalizing amplitudes:  61%|██████    | 9974/16384 [00:01<00:00, 6559.43probe position/s]Normalizing amplitudes:  65%|██████▌   | 10661/16384 [00:01<00:00, 6650.25probe position/s]Normalizing amplitudes:  69%|██████▉   | 11327/16384 [00:01<00:00, 6650.05probe position/s]Normalizing amplitudes:  73%|███████▎  | 11996/16384 [00:01<00:00, 6659.88probe position/s]Normalizing amplitudes:  77%|███████▋  | 12669/16384 [00:01<00:00, 6677.65probe position/s]Normalizing amplitudes:  82%|████████▏ | 13353/16384 [00:02<00:00, 6724.43probe position/s]Normalizing amplitudes:  86%|████████▌ | 14030/16384 [00:02<00:00, 6737.60probe position/s]Normalizing amplitudes:  90%|████████▉ | 14721/16384 [00:02<00:00, 6787.28probe position/s]Normalizing amplitudes:  94%|█████████▍| 15415/16384 [00:02<00:00, 6831.96probe position/s]Normalizing amplitudes:  98%|█████████▊| 16099/16384 [00:02<00:00, 6784.59probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6647.32probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random512_p6_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random512_p6_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.1051 in 12.650 sec
Iter: 2, Total Loss: 0.007832 in 12.493 sec
Iter: 3, Total Loss: 0.006744 in 12.527 sec
Iter: 4, Total Loss: 0.006465 in 12.603 sec
Iter: 5, Total Loss: 0.006326 in 12.467 sec
Iter: 6, Total Loss: 0.006232 in 12.454 sec
Iter: 7, Total Loss: 0.006162 in 12.548 sec
Iter: 8, Total Loss: 0.006107 in 12.396 sec
Iter: 9, Total Loss: 0.00606 in 12.462 sec
Iter: 10, Total Loss: 0.006021 in 12.405 sec
Iter: 11, Total Loss: 0.005986 in 12.423 sec
Iter: 12, Total Loss: 0.005955 in 12.293 sec
Iter: 13, Total Loss: 0.005926 in 12.354 sec
Iter: 14, Total Loss: 0.005899 in 12.404 sec
Iter: 15, Total Loss: 0.005874 in 12.427 sec
Iter: 16, Total Loss: 0.005851 in 12.427 sec
Iter: 17, Total Loss: 0.005828 in 12.482 sec
Iter: 18, Total Loss: 0.005807 in 12.486 sec
Iter: 19, Total Loss: 0.005786 in 12.485 sec
Iter: 20, Total Loss: 0.005766 in 12.547 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 12.467 with std = 0.081 sec ###
### py4DSTEM ptycho solver is finished in 4 min 11.101 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 915.10 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 512, 12, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 617/16384 [00:00<00:02, 6168.23probe position/s]Normalizing amplitudes:   8%|▊         | 1241/16384 [00:00<00:02, 6207.34probe position/s]Normalizing amplitudes:  12%|█▏        | 1896/16384 [00:00<00:02, 6358.99probe position/s]Normalizing amplitudes:  15%|█▌        | 2532/16384 [00:00<00:02, 6138.34probe position/s]Normalizing amplitudes:  19%|█▉        | 3147/16384 [00:00<00:02, 6077.55probe position/s]Normalizing amplitudes:  23%|██▎       | 3783/16384 [00:00<00:02, 6170.59probe position/s]Normalizing amplitudes:  27%|██▋       | 4406/16384 [00:00<00:01, 6188.93probe position/s]Normalizing amplitudes:  31%|███       | 5026/16384 [00:00<00:01, 6189.71probe position/s]Normalizing amplitudes:  34%|███▍      | 5646/16384 [00:00<00:01, 6164.88probe position/s]Normalizing amplitudes:  38%|███▊      | 6296/16384 [00:01<00:01, 6264.71probe position/s]Normalizing amplitudes:  42%|████▏     | 6923/16384 [00:01<00:01, 6169.50probe position/s]Normalizing amplitudes:  46%|████▌     | 7541/16384 [00:01<00:01, 5942.73probe position/s]Normalizing amplitudes:  50%|████▉     | 8138/16384 [00:01<00:01, 5920.76probe position/s]Normalizing amplitudes:  53%|█████▎    | 8755/16384 [00:01<00:01, 5992.45probe position/s]Normalizing amplitudes:  57%|█████▋    | 9406/16384 [00:01<00:01, 6141.75probe position/s]Normalizing amplitudes:  61%|██████    | 10022/16384 [00:01<00:01, 6070.96probe position/s]Normalizing amplitudes:  65%|██████▌   | 10657/16384 [00:01<00:00, 6149.90probe position/s]Normalizing amplitudes:  69%|██████▉   | 11274/16384 [00:01<00:00, 6152.22probe position/s]Normalizing amplitudes:  73%|███████▎  | 11890/16384 [00:01<00:00, 6106.85probe position/s]Normalizing amplitudes:  77%|███████▋  | 12546/16384 [00:02<00:00, 6237.80probe position/s]Normalizing amplitudes:  80%|████████  | 13180/16384 [00:02<00:00, 6266.64probe position/s]Normalizing amplitudes:  84%|████████▍ | 13824/16384 [00:02<00:00, 6316.29probe position/s]Normalizing amplitudes:  88%|████████▊ | 14456/16384 [00:02<00:00, 6238.44probe position/s]Normalizing amplitudes:  92%|█████████▏| 15081/16384 [00:02<00:00, 6188.98probe position/s]Normalizing amplitudes:  96%|█████████▌| 15732/16384 [00:02<00:00, 6281.78probe position/s]Normalizing amplitudes: 100%|█████████▉| 16361/16384 [00:02<00:00, 6188.47probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6162.94probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random512_p12_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random512_p12_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.2745 in 4.537 sec
Iter: 2, Total Loss: 0.006901 in 4.482 sec
Iter: 3, Total Loss: 0.0066 in 4.436 sec
Iter: 4, Total Loss: 0.006468 in 4.408 sec
Iter: 5, Total Loss: 0.00639 in 4.499 sec
Iter: 6, Total Loss: 0.006336 in 4.369 sec
Iter: 7, Total Loss: 0.00629 in 4.370 sec
Iter: 8, Total Loss: 0.006251 in 4.367 sec
Iter: 9, Total Loss: 0.006216 in 4.393 sec
Iter: 10, Total Loss: 0.006184 in 4.362 sec
Iter: 11, Total Loss: 0.006152 in 4.421 sec
Iter: 12, Total Loss: 0.006123 in 4.358 sec
Iter: 13, Total Loss: 0.006094 in 4.487 sec
Iter: 14, Total Loss: 0.006067 in 4.390 sec
Iter: 15, Total Loss: 0.006041 in 4.348 sec
Iter: 16, Total Loss: 0.006016 in 4.373 sec
Iter: 17, Total Loss: 0.005991 in 4.393 sec
Iter: 18, Total Loss: 0.005966 in 4.350 sec
Iter: 19, Total Loss: 0.005942 in 4.364 sec
Iter: 20, Total Loss: 0.005919 in 4.404 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 4.406 with std = 0.054 sec ###
### py4DSTEM ptycho solver is finished in 1 min 29.627 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 910.01 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 512, 12, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 636/16384 [00:00<00:02, 6352.33probe position/s]Normalizing amplitudes:   8%|▊         | 1272/16384 [00:00<00:02, 6132.90probe position/s]Normalizing amplitudes:  12%|█▏        | 1886/16384 [00:00<00:02, 5947.82probe position/s]Normalizing amplitudes:  16%|█▌        | 2550/16384 [00:00<00:02, 6210.27probe position/s]Normalizing amplitudes:  20%|█▉        | 3217/16384 [00:00<00:02, 6370.09probe position/s]Normalizing amplitudes:  24%|██▎       | 3856/16384 [00:00<00:01, 6315.85probe position/s]Normalizing amplitudes:  27%|██▋       | 4503/16384 [00:00<00:01, 6364.88probe position/s]Normalizing amplitudes:  32%|███▏      | 5168/16384 [00:00<00:01, 6449.08probe position/s]Normalizing amplitudes:  35%|███▌      | 5814/16384 [00:00<00:01, 6407.58probe position/s]Normalizing amplitudes:  40%|███▉      | 6472/16384 [00:01<00:01, 6458.35probe position/s]Normalizing amplitudes:  43%|████▎     | 7119/16384 [00:01<00:01, 6404.56probe position/s]Normalizing amplitudes:  47%|████▋     | 7761/16384 [00:01<00:01, 6405.75probe position/s]Normalizing amplitudes:  51%|█████▏    | 8429/16384 [00:01<00:01, 6487.39probe position/s]Normalizing amplitudes:  55%|█████▌    | 9078/16384 [00:01<00:01, 6478.70probe position/s]Normalizing amplitudes:  59%|█████▉    | 9727/16384 [00:01<00:01, 6479.93probe position/s]Normalizing amplitudes:  63%|██████▎   | 10376/16384 [00:01<00:00, 6025.73probe position/s]Normalizing amplitudes:  67%|██████▋   | 10985/16384 [00:01<00:01, 5233.98probe position/s]Normalizing amplitudes:  71%|███████   | 11624/16384 [00:01<00:00, 5534.82probe position/s]Normalizing amplitudes:  75%|███████▍  | 12262/16384 [00:02<00:00, 5761.75probe position/s]Normalizing amplitudes:  79%|███████▉  | 12929/16384 [00:02<00:00, 6014.68probe position/s]Normalizing amplitudes:  83%|████████▎ | 13586/16384 [00:02<00:00, 6171.46probe position/s]Normalizing amplitudes:  87%|████████▋ | 14252/16384 [00:02<00:00, 6312.52probe position/s]Normalizing amplitudes:  91%|█████████ | 14919/16384 [00:02<00:00, 6414.04probe position/s]Normalizing amplitudes:  95%|█████████▌| 15575/16384 [00:02<00:00, 6456.75probe position/s]Normalizing amplitudes:  99%|█████████▉| 16225/16384 [00:02<00:00, 6399.56probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6227.17probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random512_p12_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random512_p12_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.2719 in 12.309 sec
Iter: 2, Total Loss: 0.00769 in 12.345 sec
Iter: 3, Total Loss: 0.006831 in 12.339 sec
Iter: 4, Total Loss: 0.006574 in 12.250 sec
Iter: 5, Total Loss: 0.006441 in 12.270 sec
Iter: 6, Total Loss: 0.006351 in 12.198 sec
Iter: 7, Total Loss: 0.006283 in 12.236 sec
Iter: 8, Total Loss: 0.006228 in 12.406 sec
Iter: 9, Total Loss: 0.006182 in 12.420 sec
Iter: 10, Total Loss: 0.006141 in 12.273 sec
Iter: 11, Total Loss: 0.006104 in 12.523 sec
Iter: 12, Total Loss: 0.006071 in 12.597 sec
Iter: 13, Total Loss: 0.006041 in 12.725 sec
Iter: 14, Total Loss: 0.006012 in 12.447 sec
Iter: 15, Total Loss: 0.005985 in 12.504 sec
Iter: 16, Total Loss: 0.005959 in 12.535 sec
Iter: 17, Total Loss: 0.005934 in 12.490 sec
Iter: 18, Total Loss: 0.00591 in 12.429 sec
Iter: 19, Total Loss: 0.005887 in 12.472 sec
Iter: 20, Total Loss: 0.005865 in 12.392 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 12.408 with std = 0.131 sec ###
### py4DSTEM ptycho solver is finished in 4 min 9.844 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 911.85 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 512, 12, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 645/16384 [00:00<00:02, 6448.70probe position/s]Normalizing amplitudes:   8%|▊         | 1290/16384 [00:00<00:02, 6350.45probe position/s]Normalizing amplitudes:  12%|█▏        | 1930/16384 [00:00<00:02, 6371.26probe position/s]Normalizing amplitudes:  16%|█▌        | 2568/16384 [00:00<00:02, 6269.81probe position/s]Normalizing amplitudes:  20%|█▉        | 3196/16384 [00:00<00:02, 6003.79probe position/s]Normalizing amplitudes:  23%|██▎       | 3799/16384 [00:00<00:02, 5950.59probe position/s]Normalizing amplitudes:  27%|██▋       | 4438/16384 [00:00<00:01, 6085.80probe position/s]Normalizing amplitudes:  31%|███       | 5048/16384 [00:00<00:01, 5999.13probe position/s]Normalizing amplitudes:  34%|███▍      | 5649/16384 [00:00<00:01, 5793.28probe position/s]Normalizing amplitudes:  38%|███▊      | 6245/16384 [00:01<00:01, 5841.61probe position/s]Normalizing amplitudes:  42%|████▏     | 6864/16384 [00:01<00:01, 5944.01probe position/s]Normalizing amplitudes:  46%|████▌     | 7480/16384 [00:01<00:01, 6006.77probe position/s]Normalizing amplitudes:  49%|████▉     | 8082/16384 [00:01<00:01, 6002.24probe position/s]Normalizing amplitudes:  53%|█████▎    | 8734/16384 [00:01<00:01, 6156.73probe position/s]Normalizing amplitudes:  57%|█████▋    | 9397/16384 [00:01<00:01, 6297.59probe position/s]Normalizing amplitudes:  61%|██████    | 10028/16384 [00:01<00:01, 6241.22probe position/s]Normalizing amplitudes:  65%|██████▌   | 10676/16384 [00:01<00:00, 6311.68probe position/s]Normalizing amplitudes:  69%|██████▉   | 11308/16384 [00:01<00:00, 6246.63probe position/s]Normalizing amplitudes:  73%|███████▎  | 11938/16384 [00:01<00:00, 6260.92probe position/s]Normalizing amplitudes:  77%|███████▋  | 12565/16384 [00:02<00:00, 6242.14probe position/s]Normalizing amplitudes:  81%|████████  | 13190/16384 [00:02<00:00, 6232.33probe position/s]Normalizing amplitudes:  84%|████████▍ | 13814/16384 [00:02<00:00, 6215.08probe position/s]Normalizing amplitudes:  88%|████████▊ | 14436/16384 [00:02<00:00, 6174.58probe position/s]Normalizing amplitudes:  92%|█████████▏| 15064/16384 [00:02<00:00, 6205.05probe position/s]Normalizing amplitudes:  96%|█████████▌| 15685/16384 [00:02<00:00, 6169.42probe position/s]Normalizing amplitudes: 100%|█████████▉| 16303/16384 [00:02<00:00, 6171.70probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6142.80probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random512_p12_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random512_p12_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.2684 in 24.163 sec
Iter: 2, Total Loss: 0.009305 in 24.066 sec
Iter: 3, Total Loss: 0.007356 in 24.180 sec
Iter: 4, Total Loss: 0.006794 in 24.188 sec
Iter: 5, Total Loss: 0.006528 in 24.195 sec
Iter: 6, Total Loss: 0.006368 in 24.248 sec
Iter: 7, Total Loss: 0.00626 in 24.531 sec
Iter: 8, Total Loss: 0.00618 in 24.942 sec
Iter: 9, Total Loss: 0.006117 in 24.245 sec
Iter: 10, Total Loss: 0.006065 in 24.171 sec
Iter: 11, Total Loss: 0.006022 in 23.890 sec
Iter: 12, Total Loss: 0.005983 in 24.204 sec
Iter: 13, Total Loss: 0.00595 in 24.158 sec
Iter: 14, Total Loss: 0.005919 in 24.229 sec
Iter: 15, Total Loss: 0.005891 in 24.347 sec
Iter: 16, Total Loss: 0.005866 in 24.095 sec
Iter: 17, Total Loss: 0.005841 in 24.096 sec
Iter: 18, Total Loss: 0.005819 in 24.412 sec
Iter: 19, Total Loss: 0.005797 in 24.359 sec
Iter: 20, Total Loss: 0.005776 in 24.594 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 24.266 with std = 0.220 sec ###
### py4DSTEM ptycho solver is finished in 8 min 7.209 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 913.77 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 256, 1, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 429/16384 [00:00<00:03, 4287.08probe position/s]Normalizing amplitudes:   6%|▋         | 1035/16384 [00:00<00:02, 5327.97probe position/s]Normalizing amplitudes:  10%|█         | 1653/16384 [00:00<00:02, 5713.96probe position/s]Normalizing amplitudes:  14%|█▍        | 2259/16384 [00:00<00:02, 5849.99probe position/s]Normalizing amplitudes:  17%|█▋        | 2844/16384 [00:00<00:02, 5825.30probe position/s]Normalizing amplitudes:  21%|██        | 3441/16384 [00:00<00:02, 5873.62probe position/s]Normalizing amplitudes:  25%|██▍       | 4060/16384 [00:00<00:02, 5975.34probe position/s]Normalizing amplitudes:  28%|██▊       | 4658/16384 [00:00<00:02, 5639.39probe position/s]Normalizing amplitudes:  32%|███▏      | 5226/16384 [00:00<00:01, 5646.29probe position/s]Normalizing amplitudes:  36%|███▌      | 5820/16384 [00:01<00:01, 5732.74probe position/s]Normalizing amplitudes:  39%|███▉      | 6450/16384 [00:01<00:01, 5901.69probe position/s]Normalizing amplitudes:  43%|████▎     | 7042/16384 [00:01<00:01, 5800.87probe position/s]Normalizing amplitudes:  47%|████▋     | 7624/16384 [00:01<00:01, 5730.08probe position/s]Normalizing amplitudes:  50%|█████     | 8199/16384 [00:01<00:01, 5698.15probe position/s]Normalizing amplitudes:  54%|█████▎    | 8782/16384 [00:01<00:01, 5735.29probe position/s]Normalizing amplitudes:  57%|█████▋    | 9358/16384 [00:01<00:01, 5742.44probe position/s]Normalizing amplitudes:  61%|██████    | 9970/16384 [00:01<00:01, 5851.55probe position/s]Normalizing amplitudes:  65%|██████▍   | 10601/16384 [00:01<00:00, 5986.92probe position/s]Normalizing amplitudes:  68%|██████▊   | 11201/16384 [00:01<00:00, 5937.12probe position/s]Normalizing amplitudes:  72%|███████▏  | 11796/16384 [00:02<00:00, 5684.78probe position/s]Normalizing amplitudes:  76%|███████▌  | 12386/16384 [00:02<00:00, 5746.72probe position/s]Normalizing amplitudes:  79%|███████▉  | 13006/16384 [00:02<00:00, 5876.74probe position/s]Normalizing amplitudes:  83%|████████▎ | 13677/16384 [00:02<00:00, 6120.10probe position/s]Normalizing amplitudes:  87%|████████▋ | 14305/16384 [00:02<00:00, 6166.89probe position/s]Normalizing amplitudes:  91%|█████████ | 14931/16384 [00:02<00:00, 6192.55probe position/s]Normalizing amplitudes:  95%|█████████▍| 15552/16384 [00:02<00:00, 6154.18probe position/s]Normalizing amplitudes:  99%|█████████▉| 16182/16384 [00:02<00:00, 6195.58probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5877.37probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random256_p1_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random256_p1_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.01045 in 0.930 sec
Iter: 2, Total Loss: 0.006511 in 0.874 sec
Iter: 3, Total Loss: 0.006487 in 0.962 sec
Iter: 4, Total Loss: 0.006475 in 0.876 sec
Iter: 5, Total Loss: 0.006466 in 0.881 sec
Iter: 6, Total Loss: 0.006459 in 0.840 sec
Iter: 7, Total Loss: 0.006452 in 0.861 sec
Iter: 8, Total Loss: 0.006445 in 0.873 sec
Iter: 9, Total Loss: 0.006439 in 0.859 sec
Iter: 10, Total Loss: 0.006432 in 0.857 sec
Iter: 11, Total Loss: 0.006425 in 0.879 sec
Iter: 12, Total Loss: 0.006418 in 0.836 sec
Iter: 13, Total Loss: 0.00641 in 0.848 sec
Iter: 14, Total Loss: 0.006403 in 0.838 sec
Iter: 15, Total Loss: 0.006396 in 0.816 sec
Iter: 16, Total Loss: 0.006388 in 0.869 sec
Iter: 17, Total Loss: 0.00638 in 0.835 sec
Iter: 18, Total Loss: 0.006372 in 0.839 sec
Iter: 19, Total Loss: 0.006364 in 0.857 sec
Iter: 20, Total Loss: 0.006356 in 0.835 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 0.863 with std = 0.033 sec ###
### py4DSTEM ptycho solver is finished in 18.802 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 911.91 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 256, 1, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 670/16384 [00:00<00:02, 6693.56probe position/s]Normalizing amplitudes:   8%|▊         | 1340/16384 [00:00<00:02, 6220.85probe position/s]Normalizing amplitudes:  12%|█▏        | 1981/16384 [00:00<00:02, 6300.33probe position/s]Normalizing amplitudes:  16%|█▌        | 2619/16384 [00:00<00:02, 6330.13probe position/s]Normalizing amplitudes:  20%|█▉        | 3254/16384 [00:00<00:02, 6283.34probe position/s]Normalizing amplitudes:  24%|██▎       | 3883/16384 [00:00<00:02, 6139.72probe position/s]Normalizing amplitudes:  27%|██▋       | 4498/16384 [00:00<00:01, 6121.32probe position/s]Normalizing amplitudes:  31%|███▏      | 5158/16384 [00:00<00:01, 6269.48probe position/s]Normalizing amplitudes:  35%|███▌      | 5786/16384 [00:00<00:01, 6065.00probe position/s]Normalizing amplitudes:  39%|███▉      | 6395/16384 [00:01<00:01, 6016.09probe position/s]Normalizing amplitudes:  43%|████▎     | 7052/16384 [00:01<00:01, 6179.06probe position/s]Normalizing amplitudes:  47%|████▋     | 7672/16384 [00:01<00:01, 6164.46probe position/s]Normalizing amplitudes:  51%|█████     | 8290/16384 [00:01<00:01, 6091.48probe position/s]Normalizing amplitudes:  54%|█████▍    | 8913/16384 [00:01<00:01, 6129.33probe position/s]Normalizing amplitudes:  58%|█████▊    | 9536/16384 [00:01<00:01, 6158.52probe position/s]Normalizing amplitudes:  62%|██████▏   | 10196/16384 [00:01<00:00, 6287.04probe position/s]Normalizing amplitudes:  66%|██████▌   | 10826/16384 [00:01<00:00, 6171.85probe position/s]Normalizing amplitudes:  70%|███████   | 11476/16384 [00:01<00:00, 6267.02probe position/s]Normalizing amplitudes:  74%|███████▍  | 12104/16384 [00:01<00:00, 6178.55probe position/s]Normalizing amplitudes:  78%|███████▊  | 12747/16384 [00:02<00:00, 6250.99probe position/s]Normalizing amplitudes:  82%|████████▏ | 13373/16384 [00:02<00:00, 6187.50probe position/s]Normalizing amplitudes:  85%|████████▌ | 13994/16384 [00:02<00:00, 6192.00probe position/s]Normalizing amplitudes:  89%|████████▉ | 14629/16384 [00:02<00:00, 6237.13probe position/s]Normalizing amplitudes:  93%|█████████▎| 15263/16384 [00:02<00:00, 6266.28probe position/s]Normalizing amplitudes:  97%|█████████▋| 15930/16384 [00:02<00:00, 6385.66probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6227.18probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random256_p1_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random256_p1_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.01068 in 1.847 sec
Iter: 2, Total Loss: 0.006518 in 1.813 sec
Iter: 3, Total Loss: 0.006496 in 1.767 sec
Iter: 4, Total Loss: 0.006483 in 1.794 sec
Iter: 5, Total Loss: 0.006471 in 1.791 sec
Iter: 6, Total Loss: 0.00646 in 1.805 sec
Iter: 7, Total Loss: 0.00645 in 1.836 sec
Iter: 8, Total Loss: 0.006438 in 1.798 sec
Iter: 9, Total Loss: 0.006428 in 1.789 sec
Iter: 10, Total Loss: 0.006419 in 1.777 sec
Iter: 11, Total Loss: 0.006409 in 1.764 sec
Iter: 12, Total Loss: 0.006398 in 1.750 sec
Iter: 13, Total Loss: 0.006389 in 1.756 sec
Iter: 14, Total Loss: 0.006379 in 1.732 sec
Iter: 15, Total Loss: 0.006368 in 1.749 sec
Iter: 16, Total Loss: 0.006359 in 1.748 sec
Iter: 17, Total Loss: 0.00635 in 1.747 sec
Iter: 18, Total Loss: 0.006341 in 1.761 sec
Iter: 19, Total Loss: 0.006332 in 1.729 sec
Iter: 20, Total Loss: 0.006322 in 1.748 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 1.775 with std = 0.032 sec ###
### py4DSTEM ptycho solver is finished in 37.066 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 911.90 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 256, 1, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 644/16384 [00:00<00:02, 6437.63probe position/s]Normalizing amplitudes:   8%|▊         | 1288/16384 [00:00<00:02, 6291.38probe position/s]Normalizing amplitudes:  12%|█▏        | 1918/16384 [00:00<00:02, 5879.03probe position/s]Normalizing amplitudes:  16%|█▌        | 2565/16384 [00:00<00:02, 6098.61probe position/s]Normalizing amplitudes:  20%|█▉        | 3220/16384 [00:00<00:02, 6255.50probe position/s]Normalizing amplitudes:  23%|██▎       | 3848/16384 [00:00<00:02, 6196.84probe position/s]Normalizing amplitudes:  27%|██▋       | 4470/16384 [00:00<00:01, 6105.09probe position/s]Normalizing amplitudes:  31%|███       | 5082/16384 [00:00<00:01, 6006.07probe position/s]Normalizing amplitudes:  35%|███▍      | 5727/16384 [00:00<00:01, 6139.41probe position/s]Normalizing amplitudes:  39%|███▉      | 6359/16384 [00:01<00:01, 6192.06probe position/s]Normalizing amplitudes:  43%|████▎     | 6984/16384 [00:01<00:01, 6206.47probe position/s]Normalizing amplitudes:  46%|████▋     | 7612/16384 [00:01<00:01, 6227.67probe position/s]Normalizing amplitudes:  50%|█████     | 8255/16384 [00:01<00:01, 6286.53probe position/s]Normalizing amplitudes:  54%|█████▍    | 8909/16384 [00:01<00:01, 6360.42probe position/s]Normalizing amplitudes:  58%|█████▊    | 9546/16384 [00:01<00:01, 6319.08probe position/s]Normalizing amplitudes:  62%|██████▏   | 10181/16384 [00:01<00:00, 6327.29probe position/s]Normalizing amplitudes:  66%|██████▌   | 10814/16384 [00:01<00:00, 6276.60probe position/s]Normalizing amplitudes:  70%|██████▉   | 11442/16384 [00:01<00:00, 6252.25probe position/s]Normalizing amplitudes:  74%|███████▎  | 12068/16384 [00:01<00:00, 6244.60probe position/s]Normalizing amplitudes:  77%|███████▋  | 12693/16384 [00:02<00:00, 6226.90probe position/s]Normalizing amplitudes:  81%|████████▏ | 13340/16384 [00:02<00:00, 6296.88probe position/s]Normalizing amplitudes:  85%|████████▌ | 14000/16384 [00:02<00:00, 6385.73probe position/s]Normalizing amplitudes:  89%|████████▉ | 14639/16384 [00:02<00:00, 6251.17probe position/s]Normalizing amplitudes:  93%|█████████▎| 15277/16384 [00:02<00:00, 6288.79probe position/s]Normalizing amplitudes:  97%|█████████▋| 15917/16384 [00:02<00:00, 6320.64probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6244.49probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random256_p1_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random256_p1_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.01086 in 3.215 sec
Iter: 2, Total Loss: 0.006561 in 3.085 sec
Iter: 3, Total Loss: 0.006536 in 3.077 sec
Iter: 4, Total Loss: 0.006517 in 3.114 sec
Iter: 5, Total Loss: 0.006498 in 3.060 sec
Iter: 6, Total Loss: 0.006485 in 3.078 sec
Iter: 7, Total Loss: 0.006471 in 3.270 sec
Iter: 8, Total Loss: 0.006455 in 3.180 sec
Iter: 9, Total Loss: 0.006443 in 3.089 sec
Iter: 10, Total Loss: 0.006427 in 3.078 sec
Iter: 11, Total Loss: 0.006412 in 3.337 sec
Iter: 12, Total Loss: 0.006402 in 3.522 sec
Iter: 13, Total Loss: 0.006387 in 3.275 sec
Iter: 14, Total Loss: 0.006377 in 3.153 sec
Iter: 15, Total Loss: 0.006365 in 3.583 sec
Iter: 16, Total Loss: 0.006352 in 3.327 sec
Iter: 17, Total Loss: 0.006341 in 3.166 sec
Iter: 18, Total Loss: 0.006327 in 3.095 sec
Iter: 19, Total Loss: 0.006318 in 3.033 sec
Iter: 20, Total Loss: 0.006304 in 3.133 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 3.194 with std = 0.148 sec ###
### py4DSTEM ptycho solver is finished in 1 min 5.404 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 910.90 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 256, 3, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 542/16384 [00:00<00:02, 5418.78probe position/s]Normalizing amplitudes:   7%|▋         | 1203/16384 [00:00<00:02, 6113.63probe position/s]Normalizing amplitudes:  11%|█▏        | 1863/16384 [00:00<00:02, 6333.57probe position/s]Normalizing amplitudes:  15%|█▌        | 2514/16384 [00:00<00:02, 6402.90probe position/s]Normalizing amplitudes:  19%|█▉        | 3155/16384 [00:00<00:02, 6400.55probe position/s]Normalizing amplitudes:  23%|██▎       | 3796/16384 [00:00<00:01, 6365.15probe position/s]Normalizing amplitudes:  27%|██▋       | 4473/16384 [00:00<00:01, 6494.02probe position/s]Normalizing amplitudes:  31%|███▏      | 5135/16384 [00:00<00:01, 6530.96probe position/s]Normalizing amplitudes:  35%|███▌      | 5789/16384 [00:00<00:01, 6512.87probe position/s]Normalizing amplitudes:  39%|███▉      | 6445/16384 [00:01<00:01, 6525.58probe position/s]Normalizing amplitudes:  43%|████▎     | 7098/16384 [00:01<00:01, 6389.05probe position/s]Normalizing amplitudes:  47%|████▋     | 7738/16384 [00:01<00:01, 6153.52probe position/s]Normalizing amplitudes:  51%|█████     | 8371/16384 [00:01<00:01, 6204.18probe position/s]Normalizing amplitudes:  55%|█████▌    | 9037/16384 [00:01<00:01, 6337.31probe position/s]Normalizing amplitudes:  59%|█████▉    | 9673/16384 [00:01<00:01, 6238.64probe position/s]Normalizing amplitudes:  63%|██████▎   | 10300/16384 [00:01<00:00, 6247.65probe position/s]Normalizing amplitudes:  67%|██████▋   | 10926/16384 [00:01<00:00, 6109.40probe position/s]Normalizing amplitudes:  71%|███████   | 11567/16384 [00:01<00:00, 6196.95probe position/s]Normalizing amplitudes:  75%|███████▍  | 12222/16384 [00:01<00:00, 6299.44probe position/s]Normalizing amplitudes:  79%|███████▊  | 12875/16384 [00:02<00:00, 6366.87probe position/s]Normalizing amplitudes:  83%|████████▎ | 13529/16384 [00:02<00:00, 6418.13probe position/s]Normalizing amplitudes:  87%|████████▋ | 14184/16384 [00:02<00:00, 6455.13probe position/s]Normalizing amplitudes:  91%|█████████ | 14846/16384 [00:02<00:00, 6502.30probe position/s]Normalizing amplitudes:  95%|█████████▍| 15506/16384 [00:02<00:00, 6529.25probe position/s]Normalizing amplitudes:  99%|█████████▊| 16160/16384 [00:02<00:00, 6530.36probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6372.77probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random256_p3_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random256_p3_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.02268 in 1.734 sec
Iter: 2, Total Loss: 0.006526 in 1.642 sec
Iter: 3, Total Loss: 0.006421 in 1.635 sec
Iter: 4, Total Loss: 0.006369 in 1.647 sec
Iter: 5, Total Loss: 0.00633 in 1.685 sec
Iter: 6, Total Loss: 0.006296 in 1.644 sec
Iter: 7, Total Loss: 0.006263 in 1.678 sec
Iter: 8, Total Loss: 0.00623 in 1.655 sec
Iter: 9, Total Loss: 0.006197 in 1.660 sec
Iter: 10, Total Loss: 0.006165 in 1.644 sec
Iter: 11, Total Loss: 0.006133 in 1.737 sec
Iter: 12, Total Loss: 0.006103 in 1.646 sec
Iter: 13, Total Loss: 0.006072 in 1.636 sec
Iter: 14, Total Loss: 0.006042 in 1.704 sec
Iter: 15, Total Loss: 0.006013 in 1.727 sec
Iter: 16, Total Loss: 0.005983 in 1.668 sec
Iter: 17, Total Loss: 0.005955 in 1.752 sec
Iter: 18, Total Loss: 0.005928 in 1.663 sec
Iter: 19, Total Loss: 0.005901 in 1.671 sec
Iter: 20, Total Loss: 0.005875 in 1.679 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 1.675 with std = 0.036 sec ###
### py4DSTEM ptycho solver is finished in 35.057 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 919.32 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 256, 3, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 625/16384 [00:00<00:02, 6246.12probe position/s]Normalizing amplitudes:   8%|▊         | 1250/16384 [00:00<00:02, 6204.43probe position/s]Normalizing amplitudes:  12%|█▏        | 1906/16384 [00:00<00:02, 6365.18probe position/s]Normalizing amplitudes:  16%|█▌        | 2543/16384 [00:00<00:02, 6306.85probe position/s]Normalizing amplitudes:  20%|█▉        | 3218/16384 [00:00<00:02, 6463.22probe position/s]Normalizing amplitudes:  24%|██▍       | 3912/16384 [00:00<00:01, 6621.91probe position/s]Normalizing amplitudes:  28%|██▊       | 4575/16384 [00:00<00:01, 6498.32probe position/s]Normalizing amplitudes:  32%|███▏      | 5226/16384 [00:00<00:01, 5967.17probe position/s]Normalizing amplitudes:  36%|███▌      | 5853/16384 [00:00<00:01, 6053.08probe position/s]Normalizing amplitudes:  40%|███▉      | 6480/16384 [00:01<00:01, 6113.71probe position/s]Normalizing amplitudes:  43%|████▎     | 7113/16384 [00:01<00:01, 6177.36probe position/s]Normalizing amplitudes:  47%|████▋     | 7735/16384 [00:01<00:01, 6106.77probe position/s]Normalizing amplitudes:  51%|█████▏    | 8424/16384 [00:01<00:01, 6336.70probe position/s]Normalizing amplitudes:  55%|█████▌    | 9075/16384 [00:01<00:01, 6380.00probe position/s]Normalizing amplitudes:  59%|█████▉    | 9739/16384 [00:01<00:01, 6456.02probe position/s]Normalizing amplitudes:  63%|██████▎   | 10388/16384 [00:01<00:00, 6464.29probe position/s]Normalizing amplitudes:  67%|██████▋   | 11048/16384 [00:01<00:00, 6503.40probe position/s]Normalizing amplitudes:  71%|███████▏  | 11699/16384 [00:01<00:00, 6464.03probe position/s]Normalizing amplitudes:  75%|███████▌  | 12366/16384 [00:01<00:00, 6524.69probe position/s]Normalizing amplitudes:  80%|███████▉  | 13044/16384 [00:02<00:00, 6599.75probe position/s]Normalizing amplitudes:  84%|████████▎ | 13721/16384 [00:02<00:00, 6650.52probe position/s]Normalizing amplitudes:  88%|████████▊ | 14389/16384 [00:02<00:00, 6656.54probe position/s]Normalizing amplitudes:  92%|█████████▏| 15055/16384 [00:02<00:00, 6576.49probe position/s]Normalizing amplitudes:  96%|█████████▌| 15728/16384 [00:02<00:00, 6621.07probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6408.46probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random256_p3_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random256_p3_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.02336 in 4.348 sec
Iter: 2, Total Loss: 0.006526 in 4.164 sec
Iter: 3, Total Loss: 0.00639 in 4.572 sec
Iter: 4, Total Loss: 0.00634 in 4.288 sec
Iter: 5, Total Loss: 0.0063 in 4.223 sec
Iter: 6, Total Loss: 0.006261 in 4.243 sec
Iter: 7, Total Loss: 0.006225 in 4.227 sec
Iter: 8, Total Loss: 0.00619 in 4.125 sec
Iter: 9, Total Loss: 0.006157 in 4.166 sec
Iter: 10, Total Loss: 0.006124 in 4.168 sec
Iter: 11, Total Loss: 0.00609 in 4.362 sec
Iter: 12, Total Loss: 0.006059 in 4.434 sec
Iter: 13, Total Loss: 0.006026 in 4.152 sec
Iter: 14, Total Loss: 0.005995 in 4.199 sec
Iter: 15, Total Loss: 0.005962 in 4.172 sec
Iter: 16, Total Loss: 0.005934 in 4.235 sec
Iter: 17, Total Loss: 0.005903 in 4.554 sec
Iter: 18, Total Loss: 0.005875 in 4.331 sec
Iter: 19, Total Loss: 0.005845 in 4.272 sec
Iter: 20, Total Loss: 0.005818 in 4.257 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 4.275 with std = 0.124 sec ###
### py4DSTEM ptycho solver is finished in 1 min 26.988 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 916.40 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 256, 3, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 616/16384 [00:00<00:02, 6155.52probe position/s]Normalizing amplitudes:   8%|▊         | 1253/16384 [00:00<00:02, 6277.93probe position/s]Normalizing amplitudes:  12%|█▏        | 1929/16384 [00:00<00:02, 6494.96probe position/s]Normalizing amplitudes:  16%|█▌        | 2579/16384 [00:00<00:02, 6314.33probe position/s]Normalizing amplitudes:  20%|█▉        | 3212/16384 [00:00<00:02, 6015.71probe position/s]Normalizing amplitudes:  23%|██▎       | 3816/16384 [00:00<00:02, 5902.10probe position/s]Normalizing amplitudes:  27%|██▋       | 4408/16384 [00:00<00:02, 5794.68probe position/s]Normalizing amplitudes:  31%|███       | 4998/16384 [00:00<00:01, 5826.24probe position/s]Normalizing amplitudes:  34%|███▍      | 5617/16384 [00:00<00:01, 5935.29probe position/s]Normalizing amplitudes:  38%|███▊      | 6264/16384 [00:01<00:01, 6095.81probe position/s]Normalizing amplitudes:  42%|████▏     | 6924/16384 [00:01<00:01, 6245.86probe position/s]Normalizing amplitudes:  46%|████▌     | 7570/16384 [00:01<00:01, 6308.74probe position/s]Normalizing amplitudes:  50%|█████     | 8202/16384 [00:01<00:01, 6279.74probe position/s]Normalizing amplitudes:  54%|█████▍    | 8843/16384 [00:01<00:01, 6317.28probe position/s]Normalizing amplitudes:  58%|█████▊    | 9476/16384 [00:01<00:01, 6305.44probe position/s]Normalizing amplitudes:  62%|██████▏   | 10107/16384 [00:01<00:01, 6251.80probe position/s]Normalizing amplitudes:  66%|██████▌   | 10752/16384 [00:01<00:00, 6309.37probe position/s]Normalizing amplitudes:  70%|██████▉   | 11411/16384 [00:01<00:00, 6391.11probe position/s]Normalizing amplitudes:  74%|███████▎  | 12065/16384 [00:01<00:00, 6434.83probe position/s]Normalizing amplitudes:  78%|███████▊  | 12709/16384 [00:02<00:00, 6358.29probe position/s]Normalizing amplitudes:  81%|████████▏ | 13346/16384 [00:02<00:00, 6098.32probe position/s]Normalizing amplitudes:  85%|████████▌ | 13988/16384 [00:02<00:00, 6190.19probe position/s]Normalizing amplitudes:  89%|████████▉ | 14609/16384 [00:02<00:00, 6180.63probe position/s]Normalizing amplitudes:  93%|█████████▎| 15229/16384 [00:02<00:00, 6117.88probe position/s]Normalizing amplitudes:  97%|█████████▋| 15896/16384 [00:02<00:00, 6276.99probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6199.71probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random256_p3_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random256_p3_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.02436 in 8.246 sec
Iter: 2, Total Loss: 0.00655 in 8.082 sec
Iter: 3, Total Loss: 0.006354 in 8.133 sec
Iter: 4, Total Loss: 0.006279 in 8.256 sec
Iter: 5, Total Loss: 0.006222 in 8.366 sec
Iter: 6, Total Loss: 0.006173 in 8.090 sec
Iter: 7, Total Loss: 0.006128 in 8.082 sec
Iter: 8, Total Loss: 0.006088 in 8.160 sec
Iter: 9, Total Loss: 0.006047 in 8.209 sec
Iter: 10, Total Loss: 0.006009 in 8.123 sec
Iter: 11, Total Loss: 0.00597 in 8.186 sec
Iter: 12, Total Loss: 0.005934 in 8.244 sec
Iter: 13, Total Loss: 0.005897 in 8.306 sec
Iter: 14, Total Loss: 0.005863 in 8.167 sec
Iter: 15, Total Loss: 0.005829 in 8.203 sec
Iter: 16, Total Loss: 0.005797 in 8.229 sec
Iter: 17, Total Loss: 0.005765 in 8.149 sec
Iter: 18, Total Loss: 0.005737 in 8.227 sec
Iter: 19, Total Loss: 0.005708 in 8.238 sec
Iter: 20, Total Loss: 0.005679 in 8.275 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 8.198 with std = 0.074 sec ###
### py4DSTEM ptycho solver is finished in 2 min 46.539 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 911.84 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 256, 6, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 559/16384 [00:00<00:02, 5584.87probe position/s]Normalizing amplitudes:   7%|▋         | 1181/16384 [00:00<00:02, 5958.05probe position/s]Normalizing amplitudes:  11%|█         | 1824/16384 [00:00<00:02, 6171.28probe position/s]Normalizing amplitudes:  15%|█▍        | 2442/16384 [00:00<00:02, 6111.72probe position/s]Normalizing amplitudes:  19%|█▉        | 3097/16384 [00:00<00:02, 6266.91probe position/s]Normalizing amplitudes:  23%|██▎       | 3724/16384 [00:00<00:02, 5934.11probe position/s]Normalizing amplitudes:  26%|██▋       | 4321/16384 [00:00<00:02, 5829.83probe position/s]Normalizing amplitudes:  30%|██▉       | 4907/16384 [00:00<00:01, 5806.06probe position/s]Normalizing amplitudes:  34%|███▎      | 5521/16384 [00:00<00:01, 5904.88probe position/s]Normalizing amplitudes:  38%|███▊      | 6151/16384 [00:01<00:01, 6021.09probe position/s]Normalizing amplitudes:  41%|████▏     | 6761/16384 [00:01<00:01, 6041.22probe position/s]Normalizing amplitudes:  45%|████▍     | 7366/16384 [00:01<00:01, 6034.93probe position/s]Normalizing amplitudes:  49%|████▉     | 8024/16384 [00:01<00:01, 6197.61probe position/s]Normalizing amplitudes:  53%|█████▎    | 8645/16384 [00:01<00:01, 6107.15probe position/s]Normalizing amplitudes:  57%|█████▋    | 9284/16384 [00:01<00:01, 6189.03probe position/s]Normalizing amplitudes:  60%|██████    | 9904/16384 [00:01<00:01, 6114.49probe position/s]Normalizing amplitudes:  64%|██████▍   | 10516/16384 [00:01<00:00, 6054.45probe position/s]Normalizing amplitudes:  68%|██████▊   | 11159/16384 [00:01<00:00, 6162.99probe position/s]Normalizing amplitudes:  72%|███████▏  | 11791/16384 [00:01<00:00, 6208.24probe position/s]Normalizing amplitudes:  76%|███████▌  | 12431/16384 [00:02<00:00, 6263.61probe position/s]Normalizing amplitudes:  80%|███████▉  | 13058/16384 [00:02<00:00, 6216.53probe position/s]Normalizing amplitudes:  83%|████████▎ | 13680/16384 [00:02<00:00, 6145.92probe position/s]Normalizing amplitudes:  87%|████████▋ | 14295/16384 [00:02<00:00, 6031.74probe position/s]Normalizing amplitudes:  91%|█████████ | 14914/16384 [00:02<00:00, 6075.55probe position/s]Normalizing amplitudes:  95%|█████████▍| 15523/16384 [00:02<00:00, 6063.92probe position/s]Normalizing amplitudes:  99%|█████████▊| 16153/16384 [00:02<00:00, 6131.71probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6081.08probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random256_p6_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random256_p6_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.05705 in 3.007 sec
Iter: 2, Total Loss: 0.00663 in 2.951 sec
Iter: 3, Total Loss: 0.00646 in 2.962 sec
Iter: 4, Total Loss: 0.006391 in 3.036 sec
Iter: 5, Total Loss: 0.006349 in 3.019 sec
Iter: 6, Total Loss: 0.006315 in 3.090 sec
Iter: 7, Total Loss: 0.006283 in 3.108 sec
Iter: 8, Total Loss: 0.006251 in 3.051 sec
Iter: 9, Total Loss: 0.006219 in 3.044 sec
Iter: 10, Total Loss: 0.006189 in 3.210 sec
Iter: 11, Total Loss: 0.006157 in 3.048 sec
Iter: 12, Total Loss: 0.006128 in 3.087 sec
Iter: 13, Total Loss: 0.006096 in 3.111 sec
Iter: 14, Total Loss: 0.006068 in 2.964 sec
Iter: 15, Total Loss: 0.006038 in 3.108 sec
Iter: 16, Total Loss: 0.006011 in 3.012 sec
Iter: 17, Total Loss: 0.005982 in 3.074 sec
Iter: 18, Total Loss: 0.005955 in 3.065 sec
Iter: 19, Total Loss: 0.005927 in 3.035 sec
Iter: 20, Total Loss: 0.005899 in 3.105 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 3.054 with std = 0.060 sec ###
### py4DSTEM ptycho solver is finished in 1 min 2.847 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 914.26 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 256, 6, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 600/16384 [00:00<00:02, 5995.16probe position/s]Normalizing amplitudes:   7%|▋         | 1200/16384 [00:00<00:02, 5843.50probe position/s]Normalizing amplitudes:  11%|█         | 1839/16384 [00:00<00:02, 6086.32probe position/s]Normalizing amplitudes:  15%|█▍        | 2449/16384 [00:00<00:02, 5995.97probe position/s]Normalizing amplitudes:  19%|█▊        | 3050/16384 [00:00<00:02, 5963.56probe position/s]Normalizing amplitudes:  22%|██▏       | 3668/16384 [00:00<00:02, 6034.22probe position/s]Normalizing amplitudes:  26%|██▌       | 4279/16384 [00:00<00:01, 6056.89probe position/s]Normalizing amplitudes:  30%|██▉       | 4885/16384 [00:00<00:01, 6019.44probe position/s]Normalizing amplitudes:  34%|███▎      | 5516/16384 [00:00<00:01, 6106.88probe position/s]Normalizing amplitudes:  37%|███▋      | 6127/16384 [00:01<00:01, 6027.54probe position/s]Normalizing amplitudes:  41%|████      | 6731/16384 [00:01<00:01, 5773.72probe position/s]Normalizing amplitudes:  45%|████▍     | 7311/16384 [00:01<00:01, 5512.68probe position/s]Normalizing amplitudes:  48%|████▊     | 7866/16384 [00:01<00:01, 5457.05probe position/s]Normalizing amplitudes:  51%|█████▏    | 8414/16384 [00:01<00:01, 5453.20probe position/s]Normalizing amplitudes:  55%|█████▌    | 9059/16384 [00:01<00:01, 5741.55probe position/s]Normalizing amplitudes:  59%|█████▉    | 9655/16384 [00:01<00:01, 5803.93probe position/s]Normalizing amplitudes:  62%|██████▏   | 10239/16384 [00:01<00:01, 5811.82probe position/s]Normalizing amplitudes:  66%|██████▌   | 10847/16384 [00:01<00:00, 5890.20probe position/s]Normalizing amplitudes:  70%|██████▉   | 11437/16384 [00:01<00:00, 5820.62probe position/s]Normalizing amplitudes:  73%|███████▎  | 12020/16384 [00:02<00:00, 5806.88probe position/s]Normalizing amplitudes:  77%|███████▋  | 12602/16384 [00:02<00:00, 5701.34probe position/s]Normalizing amplitudes:  80%|████████  | 13179/16384 [00:02<00:00, 5720.59probe position/s]Normalizing amplitudes:  84%|████████▍ | 13844/16384 [00:02<00:00, 5994.84probe position/s]Normalizing amplitudes:  88%|████████▊ | 14445/16384 [00:02<00:00, 5874.80probe position/s]Normalizing amplitudes:  92%|█████████▏| 15080/16384 [00:02<00:00, 6012.52probe position/s]Normalizing amplitudes:  96%|█████████▌| 15684/16384 [00:02<00:00, 6019.29probe position/s]Normalizing amplitudes:  99%|█████████▉| 16287/16384 [00:02<00:00, 5938.26probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5856.17probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random256_p6_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random256_p6_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.05767 in 8.298 sec
Iter: 2, Total Loss: 0.006658 in 8.299 sec
Iter: 3, Total Loss: 0.006381 in 8.382 sec
Iter: 4, Total Loss: 0.006278 in 8.338 sec
Iter: 5, Total Loss: 0.006206 in 8.120 sec
Iter: 6, Total Loss: 0.006147 in 8.185 sec
Iter: 7, Total Loss: 0.006094 in 8.261 sec
Iter: 8, Total Loss: 0.006046 in 8.266 sec
Iter: 9, Total Loss: 0.006 in 8.097 sec
Iter: 10, Total Loss: 0.005956 in 8.051 sec
Iter: 11, Total Loss: 0.005913 in 7.998 sec
Iter: 12, Total Loss: 0.005872 in 8.021 sec
Iter: 13, Total Loss: 0.005833 in 8.037 sec
Iter: 14, Total Loss: 0.005794 in 7.994 sec
Iter: 15, Total Loss: 0.005757 in 8.063 sec
Iter: 16, Total Loss: 0.005722 in 7.983 sec
Iter: 17, Total Loss: 0.005688 in 7.854 sec
Iter: 18, Total Loss: 0.005655 in 7.906 sec
Iter: 19, Total Loss: 0.005623 in 7.857 sec
Iter: 20, Total Loss: 0.005592 in 7.922 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 8.097 with std = 0.160 sec ###
### py4DSTEM ptycho solver is finished in 2 min 43.922 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 921.45 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 256, 6, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 490/16384 [00:00<00:03, 4767.99probe position/s]Normalizing amplitudes:   6%|▌         | 967/16384 [00:00<00:03, 4484.81probe position/s]Normalizing amplitudes:  10%|▉         | 1613/16384 [00:00<00:02, 5348.41probe position/s]Normalizing amplitudes:  14%|█▍        | 2283/16384 [00:00<00:02, 5868.37probe position/s]Normalizing amplitudes:  18%|█▊        | 2976/16384 [00:00<00:02, 6243.76probe position/s]Normalizing amplitudes:  22%|██▏       | 3605/16384 [00:00<00:02, 6258.90probe position/s]Normalizing amplitudes:  26%|██▌       | 4274/16384 [00:00<00:01, 6395.85probe position/s]Normalizing amplitudes:  30%|███       | 4946/16384 [00:00<00:01, 6496.58probe position/s]Normalizing amplitudes:  34%|███▍      | 5597/16384 [00:00<00:01, 6485.24probe position/s]Normalizing amplitudes:  38%|███▊      | 6250/16384 [00:01<00:01, 6498.41probe position/s]Normalizing amplitudes:  42%|████▏     | 6901/16384 [00:01<00:01, 6493.10probe position/s]Normalizing amplitudes:  46%|████▌     | 7551/16384 [00:01<00:01, 6479.69probe position/s]Normalizing amplitudes:  50%|█████     | 8234/16384 [00:01<00:01, 6583.51probe position/s]Normalizing amplitudes:  54%|█████▍    | 8913/16384 [00:01<00:01, 6642.33probe position/s]Normalizing amplitudes:  58%|█████▊    | 9578/16384 [00:01<00:01, 6600.57probe position/s]Normalizing amplitudes:  62%|██████▏   | 10239/16384 [00:01<00:00, 6576.10probe position/s]Normalizing amplitudes:  67%|██████▋   | 10897/16384 [00:01<00:00, 6510.56probe position/s]Normalizing amplitudes:  71%|███████   | 11565/16384 [00:01<00:00, 6557.19probe position/s]Normalizing amplitudes:  75%|███████▍  | 12221/16384 [00:01<00:00, 6403.02probe position/s]Normalizing amplitudes:  79%|███████▊  | 12867/16384 [00:02<00:00, 6417.96probe position/s]Normalizing amplitudes:  83%|████████▎ | 13562/16384 [00:02<00:00, 6574.08probe position/s]Normalizing amplitudes:  87%|████████▋ | 14248/16384 [00:02<00:00, 6657.91probe position/s]Normalizing amplitudes:  91%|█████████ | 14915/16384 [00:02<00:00, 6635.12probe position/s]Normalizing amplitudes:  95%|█████████▌| 15579/16384 [00:02<00:00, 6605.77probe position/s]Normalizing amplitudes:  99%|█████████▉| 16244/16384 [00:02<00:00, 6617.39probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6408.26probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random256_p6_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random256_p6_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.05906 in 15.499 sec
Iter: 2, Total Loss: 0.006893 in 15.625 sec
Iter: 3, Total Loss: 0.006346 in 15.709 sec
Iter: 4, Total Loss: 0.006191 in 16.420 sec
Iter: 5, Total Loss: 0.0061 in 16.547 sec
Iter: 6, Total Loss: 0.006029 in 16.108 sec
Iter: 7, Total Loss: 0.005969 in 16.081 sec
Iter: 8, Total Loss: 0.005914 in 16.002 sec
Iter: 9, Total Loss: 0.005865 in 16.106 sec
Iter: 10, Total Loss: 0.005818 in 16.046 sec
Iter: 11, Total Loss: 0.005775 in 15.986 sec
Iter: 12, Total Loss: 0.005734 in 15.931 sec
Iter: 13, Total Loss: 0.005695 in 16.110 sec
Iter: 14, Total Loss: 0.005658 in 15.881 sec
Iter: 15, Total Loss: 0.005622 in 15.891 sec
Iter: 16, Total Loss: 0.005588 in 15.754 sec
Iter: 17, Total Loss: 0.005555 in 15.765 sec
Iter: 18, Total Loss: 0.005524 in 15.792 sec
Iter: 19, Total Loss: 0.005494 in 16.018 sec
Iter: 20, Total Loss: 0.005465 in 15.860 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 15.957 with std = 0.242 sec ###
### py4DSTEM ptycho solver is finished in 5 min 20.998 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 912.70 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 256, 12, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 604/16384 [00:00<00:02, 6025.65probe position/s]Normalizing amplitudes:   7%|▋         | 1207/16384 [00:00<00:02, 5941.01probe position/s]Normalizing amplitudes:  11%|█         | 1806/16384 [00:00<00:02, 5959.96probe position/s]Normalizing amplitudes:  15%|█▍        | 2403/16384 [00:00<00:02, 5854.51probe position/s]Normalizing amplitudes:  18%|█▊        | 3030/16384 [00:00<00:02, 6000.32probe position/s]Normalizing amplitudes:  22%|██▏       | 3665/16384 [00:00<00:02, 6114.71probe position/s]Normalizing amplitudes:  26%|██▌       | 4277/16384 [00:00<00:01, 6073.28probe position/s]Normalizing amplitudes:  30%|██▉       | 4888/16384 [00:00<00:01, 6083.38probe position/s]Normalizing amplitudes:  34%|███▎      | 5497/16384 [00:00<00:01, 6011.64probe position/s]Normalizing amplitudes:  37%|███▋      | 6122/16384 [00:01<00:01, 6081.52probe position/s]Normalizing amplitudes:  41%|████      | 6743/16384 [00:01<00:01, 6118.11probe position/s]Normalizing amplitudes:  45%|████▌     | 7374/16384 [00:01<00:01, 6172.54probe position/s]Normalizing amplitudes:  49%|████▉     | 8031/16384 [00:01<00:01, 6289.96probe position/s]Normalizing amplitudes:  53%|█████▎    | 8661/16384 [00:01<00:01, 6243.02probe position/s]Normalizing amplitudes:  57%|█████▋    | 9286/16384 [00:01<00:01, 6197.05probe position/s]Normalizing amplitudes:  61%|██████    | 9922/16384 [00:01<00:01, 6243.77probe position/s]Normalizing amplitudes:  64%|██████▍   | 10547/16384 [00:01<00:00, 6222.96probe position/s]Normalizing amplitudes:  68%|██████▊   | 11170/16384 [00:01<00:00, 6217.54probe position/s]Normalizing amplitudes:  72%|███████▏  | 11811/16384 [00:01<00:00, 6273.20probe position/s]Normalizing amplitudes:  76%|███████▌  | 12439/16384 [00:02<00:00, 6147.28probe position/s]Normalizing amplitudes:  80%|███████▉  | 13055/16384 [00:02<00:00, 5952.15probe position/s]Normalizing amplitudes:  83%|████████▎ | 13652/16384 [00:02<00:00, 5939.08probe position/s]Normalizing amplitudes:  87%|████████▋ | 14256/16384 [00:02<00:00, 5966.00probe position/s]Normalizing amplitudes:  91%|█████████ | 14863/16384 [00:02<00:00, 5994.64probe position/s]Normalizing amplitudes:  95%|█████████▍| 15504/16384 [00:02<00:00, 6116.28probe position/s]Normalizing amplitudes:  99%|█████████▊| 16165/16384 [00:02<00:00, 6261.21probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6124.88probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random256_p12_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random256_p12_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.1408 in 5.516 sec
Iter: 2, Total Loss: 0.006677 in 5.663 sec
Iter: 3, Total Loss: 0.006468 in 5.812 sec
Iter: 4, Total Loss: 0.006373 in 5.867 sec
Iter: 5, Total Loss: 0.006312 in 5.614 sec
Iter: 6, Total Loss: 0.006262 in 5.584 sec
Iter: 7, Total Loss: 0.006217 in 5.690 sec
Iter: 8, Total Loss: 0.006178 in 5.705 sec
Iter: 9, Total Loss: 0.006138 in 5.533 sec
Iter: 10, Total Loss: 0.006101 in 5.374 sec
Iter: 11, Total Loss: 0.006064 in 5.608 sec
Iter: 12, Total Loss: 0.006028 in 5.625 sec
Iter: 13, Total Loss: 0.005991 in 5.505 sec
Iter: 14, Total Loss: 0.005956 in 5.995 sec
Iter: 15, Total Loss: 0.00592 in 5.387 sec
Iter: 16, Total Loss: 0.005886 in 5.354 sec
Iter: 17, Total Loss: 0.005851 in 5.402 sec
Iter: 18, Total Loss: 0.005818 in 5.405 sec
Iter: 19, Total Loss: 0.005785 in 5.211 sec
Iter: 20, Total Loss: 0.005754 in 5.242 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 5.555 with std = 0.199 sec ###
### py4DSTEM ptycho solver is finished in 1 min 52.780 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 922.56 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 256, 12, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 677/16384 [00:00<00:02, 6768.75probe position/s]Normalizing amplitudes:   8%|▊         | 1376/16384 [00:00<00:02, 6894.94probe position/s]Normalizing amplitudes:  13%|█▎        | 2086/16384 [00:00<00:02, 6984.57probe position/s]Normalizing amplitudes:  17%|█▋        | 2792/16384 [00:00<00:01, 7013.57probe position/s]Normalizing amplitudes:  21%|██▏       | 3494/16384 [00:00<00:01, 6917.07probe position/s]Normalizing amplitudes:  26%|██▌       | 4186/16384 [00:00<00:01, 6866.92probe position/s]Normalizing amplitudes:  30%|██▉       | 4873/16384 [00:00<00:01, 6631.71probe position/s]Normalizing amplitudes:  34%|███▍      | 5538/16384 [00:00<00:01, 6459.28probe position/s]Normalizing amplitudes:  38%|███▊      | 6244/16384 [00:00<00:01, 6638.50probe position/s]Normalizing amplitudes:  42%|████▏     | 6910/16384 [00:01<00:01, 6620.16probe position/s]Normalizing amplitudes:  46%|████▌     | 7574/16384 [00:01<00:01, 6470.37probe position/s]Normalizing amplitudes:  50%|█████     | 8258/16384 [00:01<00:01, 6577.23probe position/s]Normalizing amplitudes:  55%|█████▍    | 8949/16384 [00:01<00:01, 6672.72probe position/s]Normalizing amplitudes:  59%|█████▉    | 9631/16384 [00:01<00:01, 6714.58probe position/s]Normalizing amplitudes:  63%|██████▎   | 10320/16384 [00:01<00:00, 6764.43probe position/s]Normalizing amplitudes:  67%|██████▋   | 11030/16384 [00:01<00:00, 6861.87probe position/s]Normalizing amplitudes:  72%|███████▏  | 11717/16384 [00:01<00:00, 6703.89probe position/s]Normalizing amplitudes:  76%|███████▌  | 12407/16384 [00:01<00:00, 6760.63probe position/s]Normalizing amplitudes:  80%|███████▉  | 13088/16384 [00:01<00:00, 6774.88probe position/s]Normalizing amplitudes:  84%|████████▍ | 13780/16384 [00:02<00:00, 6816.40probe position/s]Normalizing amplitudes:  88%|████████▊ | 14479/16384 [00:02<00:00, 6866.60probe position/s]Normalizing amplitudes:  93%|█████████▎| 15168/16384 [00:02<00:00, 6872.08probe position/s]Normalizing amplitudes:  97%|█████████▋| 15889/16384 [00:02<00:00, 6972.65probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6770.41probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random256_p12_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random256_p12_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.1423 in 15.642 sec
Iter: 2, Total Loss: 0.006948 in 15.112 sec
Iter: 3, Total Loss: 0.006454 in 15.530 sec
Iter: 4, Total Loss: 0.006298 in 15.638 sec
Iter: 5, Total Loss: 0.006206 in 16.279 sec
Iter: 6, Total Loss: 0.006136 in 15.626 sec
Iter: 7, Total Loss: 0.006075 in 16.340 sec
Iter: 8, Total Loss: 0.006022 in 16.121 sec
Iter: 9, Total Loss: 0.00597 in 15.939 sec
Iter: 10, Total Loss: 0.005922 in 15.858 sec
Iter: 11, Total Loss: 0.005875 in 16.126 sec
Iter: 12, Total Loss: 0.005831 in 16.114 sec
Iter: 13, Total Loss: 0.005788 in 16.067 sec
Iter: 14, Total Loss: 0.005747 in 16.056 sec
Iter: 15, Total Loss: 0.005707 in 16.008 sec
Iter: 16, Total Loss: 0.00567 in 15.960 sec
Iter: 17, Total Loss: 0.005634 in 15.895 sec
Iter: 18, Total Loss: 0.005599 in 16.098 sec
Iter: 19, Total Loss: 0.005567 in 15.972 sec
Iter: 20, Total Loss: 0.005536 in 15.859 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 15.912 with std = 0.280 sec ###
### py4DSTEM ptycho solver is finished in 5 min 20.291 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 911.89 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 256, 12, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 625/16384 [00:00<00:02, 6242.59probe position/s]Normalizing amplitudes:   8%|▊         | 1250/16384 [00:00<00:02, 6050.61probe position/s]Normalizing amplitudes:  11%|█▏        | 1881/16384 [00:00<00:02, 6166.35probe position/s]Normalizing amplitudes:  15%|█▌        | 2499/16384 [00:00<00:02, 5889.27probe position/s]Normalizing amplitudes:  19%|█▉        | 3090/16384 [00:00<00:02, 5798.79probe position/s]Normalizing amplitudes:  22%|██▏       | 3671/16384 [00:00<00:02, 5780.47probe position/s]Normalizing amplitudes:  26%|██▌       | 4250/16384 [00:00<00:02, 5700.46probe position/s]Normalizing amplitudes:  30%|██▉       | 4847/16384 [00:00<00:01, 5780.27probe position/s]Normalizing amplitudes:  33%|███▎      | 5457/16384 [00:00<00:01, 5876.22probe position/s]Normalizing amplitudes:  37%|███▋      | 6077/16384 [00:01<00:01, 5974.33probe position/s]Normalizing amplitudes:  41%|████      | 6691/16384 [00:01<00:01, 6023.65probe position/s]Normalizing amplitudes:  45%|████▍     | 7294/16384 [00:01<00:01, 5980.54probe position/s]Normalizing amplitudes:  48%|████▊     | 7910/16384 [00:01<00:01, 6031.90probe position/s]Normalizing amplitudes:  52%|█████▏    | 8514/16384 [00:01<00:01, 5724.59probe position/s]Normalizing amplitudes:  55%|█████▌    | 9090/16384 [00:01<00:01, 5730.12probe position/s]Normalizing amplitudes:  59%|█████▉    | 9666/16384 [00:01<00:01, 5511.67probe position/s]Normalizing amplitudes:  63%|██████▎   | 10277/16384 [00:01<00:01, 5680.66probe position/s]Normalizing amplitudes:  66%|██████▌   | 10848/16384 [00:01<00:00, 5554.41probe position/s]Normalizing amplitudes:  70%|██████▉   | 11406/16384 [00:02<00:00, 5040.74probe position/s]Normalizing amplitudes:  74%|███████▎  | 12047/16384 [00:02<00:00, 5412.47probe position/s]Normalizing amplitudes:  77%|███████▋  | 12608/16384 [00:02<00:00, 5462.70probe position/s]Normalizing amplitudes:  81%|████████  | 13201/16384 [00:02<00:00, 5594.61probe position/s]Normalizing amplitudes:  85%|████████▍ | 13851/16384 [00:02<00:00, 5854.17probe position/s]Normalizing amplitudes:  88%|████████▊ | 14453/16384 [00:02<00:00, 5901.58probe position/s]Normalizing amplitudes:  92%|█████████▏| 15090/16384 [00:02<00:00, 6038.77probe position/s]Normalizing amplitudes:  96%|█████████▌| 15697/16384 [00:02<00:00, 6035.50probe position/s]Normalizing amplitudes: 100%|█████████▉| 16309/16384 [00:02<00:00, 6060.21probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5807.37probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random256_p12_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random256_p12_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.1453 in 31.199 sec
Iter: 2, Total Loss: 0.007909 in 30.627 sec
Iter: 3, Total Loss: 0.006636 in 30.336 sec
Iter: 4, Total Loss: 0.006327 in 30.399 sec
Iter: 5, Total Loss: 0.006186 in 30.234 sec
Iter: 6, Total Loss: 0.006094 in 31.174 sec
Iter: 7, Total Loss: 0.006024 in 31.243 sec
Iter: 8, Total Loss: 0.005964 in 30.969 sec
Iter: 9, Total Loss: 0.005913 in 31.003 sec
Iter: 10, Total Loss: 0.005865 in 31.736 sec
Iter: 11, Total Loss: 0.005821 in 31.131 sec
Iter: 12, Total Loss: 0.005778 in 31.249 sec
Iter: 13, Total Loss: 0.00574 in 31.252 sec
Iter: 14, Total Loss: 0.005703 in 31.167 sec
Iter: 15, Total Loss: 0.005667 in 31.093 sec
Iter: 16, Total Loss: 0.005632 in 31.327 sec
Iter: 17, Total Loss: 0.005599 in 31.134 sec
Iter: 18, Total Loss: 0.005567 in 29.995 sec
Iter: 19, Total Loss: 0.005537 in 30.362 sec
Iter: 20, Total Loss: 0.005507 in 30.436 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 30.903 with std = 0.450 sec ###
### py4DSTEM ptycho solver is finished in 10 min 19.847 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 918.88 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 128, 1, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 582/16384 [00:00<00:02, 5818.52probe position/s]Normalizing amplitudes:   8%|▊         | 1255/16384 [00:00<00:02, 6349.36probe position/s]Normalizing amplitudes:  12%|█▏        | 1934/16384 [00:00<00:02, 6547.43probe position/s]Normalizing amplitudes:  16%|█▌        | 2634/16384 [00:00<00:02, 6722.81probe position/s]Normalizing amplitudes:  20%|██        | 3308/16384 [00:00<00:01, 6726.16probe position/s]Normalizing amplitudes:  24%|██▍       | 3981/16384 [00:00<00:01, 6712.19probe position/s]Normalizing amplitudes:  28%|██▊       | 4656/16384 [00:00<00:01, 6724.47probe position/s]Normalizing amplitudes:  33%|███▎      | 5329/16384 [00:00<00:01, 6206.31probe position/s]Normalizing amplitudes:  37%|███▋      | 5991/16384 [00:00<00:01, 6325.43probe position/s]Normalizing amplitudes:  41%|████      | 6653/16384 [00:01<00:01, 6410.31probe position/s]Normalizing amplitudes:  45%|████▍     | 7299/16384 [00:01<00:01, 6388.70probe position/s]Normalizing amplitudes:  49%|████▊     | 7959/16384 [00:01<00:01, 6449.91probe position/s]Normalizing amplitudes:  53%|█████▎    | 8644/16384 [00:01<00:01, 6566.38probe position/s]Normalizing amplitudes:  57%|█████▋    | 9303/16384 [00:01<00:01, 6360.71probe position/s]Normalizing amplitudes:  61%|██████    | 9962/16384 [00:01<00:00, 6425.10probe position/s]Normalizing amplitudes:  65%|██████▍   | 10607/16384 [00:01<00:00, 6262.58probe position/s]Normalizing amplitudes:  69%|██████▊   | 11236/16384 [00:01<00:00, 6070.46probe position/s]Normalizing amplitudes:  73%|███████▎  | 11899/16384 [00:01<00:00, 6230.40probe position/s]Normalizing amplitudes:  77%|███████▋  | 12537/16384 [00:01<00:00, 6272.32probe position/s]Normalizing amplitudes:  80%|████████  | 13185/16384 [00:02<00:00, 6331.46probe position/s]Normalizing amplitudes:  84%|████████▍ | 13820/16384 [00:02<00:00, 6225.75probe position/s]Normalizing amplitudes:  88%|████████▊ | 14444/16384 [00:02<00:00, 6085.30probe position/s]Normalizing amplitudes:  92%|█████████▏| 15121/16384 [00:02<00:00, 6281.53probe position/s]Normalizing amplitudes:  96%|█████████▌| 15751/16384 [00:02<00:00, 6235.29probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6368.29probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random128_p1_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random128_p1_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.00851 in 1.207 sec
Iter: 2, Total Loss: 0.006513 in 1.110 sec
Iter: 3, Total Loss: 0.006489 in 1.193 sec
Iter: 4, Total Loss: 0.006472 in 1.167 sec
Iter: 5, Total Loss: 0.006459 in 1.286 sec
Iter: 6, Total Loss: 0.006445 in 1.224 sec
Iter: 7, Total Loss: 0.006432 in 1.221 sec
Iter: 8, Total Loss: 0.006418 in 1.156 sec
Iter: 9, Total Loss: 0.006403 in 1.160 sec
Iter: 10, Total Loss: 0.006388 in 1.172 sec
Iter: 11, Total Loss: 0.006373 in 1.239 sec
Iter: 12, Total Loss: 0.006358 in 1.212 sec
Iter: 13, Total Loss: 0.006342 in 1.163 sec
Iter: 14, Total Loss: 0.006327 in 1.232 sec
Iter: 15, Total Loss: 0.006313 in 1.308 sec
Iter: 16, Total Loss: 0.006298 in 1.207 sec
Iter: 17, Total Loss: 0.006284 in 1.261 sec
Iter: 18, Total Loss: 0.006271 in 1.309 sec
Iter: 19, Total Loss: 0.006258 in 1.271 sec
Iter: 20, Total Loss: 0.006244 in 1.147 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 1.212 with std = 0.054 sec ###
### py4DSTEM ptycho solver is finished in 26.029 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 918.47 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 128, 1, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 577/16384 [00:00<00:02, 5766.31probe position/s]Normalizing amplitudes:   7%|▋         | 1177/16384 [00:00<00:02, 5898.92probe position/s]Normalizing amplitudes:  11%|█         | 1792/16384 [00:00<00:02, 6006.11probe position/s]Normalizing amplitudes:  15%|█▍        | 2393/16384 [00:00<00:02, 5943.13probe position/s]Normalizing amplitudes:  18%|█▊        | 2988/16384 [00:00<00:02, 5818.99probe position/s]Normalizing amplitudes:  22%|██▏       | 3604/16384 [00:00<00:02, 5932.20probe position/s]Normalizing amplitudes:  26%|██▌       | 4209/16384 [00:00<00:02, 5969.71probe position/s]Normalizing amplitudes:  29%|██▉       | 4807/16384 [00:00<00:01, 5903.36probe position/s]Normalizing amplitudes:  33%|███▎      | 5402/16384 [00:00<00:01, 5915.88probe position/s]Normalizing amplitudes:  37%|███▋      | 6031/16384 [00:01<00:01, 6027.54probe position/s]Normalizing amplitudes:  40%|████      | 6635/16384 [00:01<00:01, 6011.84probe position/s]Normalizing amplitudes:  44%|████▍     | 7237/16384 [00:01<00:01, 6005.92probe position/s]Normalizing amplitudes:  48%|████▊     | 7838/16384 [00:01<00:01, 5913.77probe position/s]Normalizing amplitudes:  51%|█████▏    | 8430/16384 [00:01<00:01, 5855.02probe position/s]Normalizing amplitudes:  55%|█████▌    | 9024/16384 [00:01<00:01, 5878.57probe position/s]Normalizing amplitudes:  59%|█████▉    | 9652/16384 [00:01<00:01, 5994.87probe position/s]Normalizing amplitudes:  63%|██████▎   | 10273/16384 [00:01<00:01, 6054.80probe position/s]Normalizing amplitudes:  66%|██████▋   | 10884/16384 [00:01<00:00, 6070.93probe position/s]Normalizing amplitudes:  70%|███████   | 11492/16384 [00:01<00:00, 5870.84probe position/s]Normalizing amplitudes:  74%|███████▍  | 12104/16384 [00:02<00:00, 5942.56probe position/s]Normalizing amplitudes:  78%|███████▊  | 12747/16384 [00:02<00:00, 6083.82probe position/s]Normalizing amplitudes:  82%|████████▏ | 13378/16384 [00:02<00:00, 6148.39probe position/s]Normalizing amplitudes:  86%|████████▌ | 14028/16384 [00:02<00:00, 6252.16probe position/s]Normalizing amplitudes:  89%|████████▉ | 14654/16384 [00:02<00:00, 5786.74probe position/s]Normalizing amplitudes:  93%|█████████▎| 15308/16384 [00:02<00:00, 5998.69probe position/s]Normalizing amplitudes:  97%|█████████▋| 15915/16384 [00:02<00:00, 5983.04probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5971.86probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random128_p1_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random128_p1_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.00861 in 2.864 sec
Iter: 2, Total Loss: 0.006519 in 2.761 sec
Iter: 3, Total Loss: 0.006493 in 2.689 sec
Iter: 4, Total Loss: 0.006472 in 2.715 sec
Iter: 5, Total Loss: 0.006452 in 2.626 sec
Iter: 6, Total Loss: 0.006433 in 2.657 sec
Iter: 7, Total Loss: 0.006414 in 2.653 sec
Iter: 8, Total Loss: 0.006395 in 2.720 sec
Iter: 9, Total Loss: 0.006378 in 2.692 sec
Iter: 10, Total Loss: 0.006358 in 2.701 sec
Iter: 11, Total Loss: 0.00634 in 2.758 sec
Iter: 12, Total Loss: 0.006323 in 2.723 sec
Iter: 13, Total Loss: 0.006306 in 2.659 sec
Iter: 14, Total Loss: 0.00629 in 2.600 sec
Iter: 15, Total Loss: 0.006274 in 2.694 sec
Iter: 16, Total Loss: 0.006258 in 2.499 sec
Iter: 17, Total Loss: 0.006244 in 2.649 sec
Iter: 18, Total Loss: 0.006231 in 2.584 sec
Iter: 19, Total Loss: 0.006217 in 2.780 sec
Iter: 20, Total Loss: 0.006204 in 2.747 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 2.688 with std = 0.077 sec ###
### py4DSTEM ptycho solver is finished in 55.782 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 913.20 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 128, 1, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 575/16384 [00:00<00:02, 5746.92probe position/s]Normalizing amplitudes:   7%|▋         | 1150/16384 [00:00<00:02, 5582.78probe position/s]Normalizing amplitudes:  10%|█         | 1716/16384 [00:00<00:02, 5613.55probe position/s]Normalizing amplitudes:  14%|█▍        | 2278/16384 [00:00<00:02, 5522.06probe position/s]Normalizing amplitudes:  18%|█▊        | 2893/16384 [00:00<00:02, 5743.23probe position/s]Normalizing amplitudes:  21%|██        | 3468/16384 [00:00<00:02, 5671.67probe position/s]Normalizing amplitudes:  25%|██▍       | 4036/16384 [00:00<00:02, 5529.29probe position/s]Normalizing amplitudes:  28%|██▊       | 4621/16384 [00:00<00:02, 5623.04probe position/s]Normalizing amplitudes:  32%|███▏      | 5207/16384 [00:00<00:01, 5695.21probe position/s]Normalizing amplitudes:  35%|███▌      | 5799/16384 [00:01<00:01, 5762.69probe position/s]Normalizing amplitudes:  39%|███▉      | 6402/16384 [00:01<00:01, 5842.92probe position/s]Normalizing amplitudes:  43%|████▎     | 7030/16384 [00:01<00:01, 5972.85probe position/s]Normalizing amplitudes:  47%|████▋     | 7654/16384 [00:01<00:01, 6052.00probe position/s]Normalizing amplitudes:  51%|█████     | 8285/16384 [00:01<00:01, 6127.32probe position/s]Normalizing amplitudes:  54%|█████▍    | 8898/16384 [00:01<00:01, 6103.35probe position/s]Normalizing amplitudes:  58%|█████▊    | 9509/16384 [00:01<00:01, 6102.96probe position/s]Normalizing amplitudes:  62%|██████▏   | 10136/16384 [00:01<00:01, 6150.49probe position/s]Normalizing amplitudes:  66%|██████▌   | 10752/16384 [00:01<00:00, 6144.21probe position/s]Normalizing amplitudes:  70%|██████▉   | 11407/16384 [00:01<00:00, 6263.43probe position/s]Normalizing amplitudes:  73%|███████▎  | 12034/16384 [00:02<00:00, 5925.37probe position/s]Normalizing amplitudes:  77%|███████▋  | 12656/16384 [00:02<00:00, 6008.42probe position/s]Normalizing amplitudes:  81%|████████▏ | 13312/16384 [00:02<00:00, 6167.44probe position/s]Normalizing amplitudes:  85%|████████▌ | 13944/16384 [00:02<00:00, 6210.91probe position/s]Normalizing amplitudes:  89%|████████▉ | 14567/16384 [00:02<00:00, 6055.96probe position/s]Normalizing amplitudes:  93%|█████████▎| 15175/16384 [00:02<00:00, 5962.70probe position/s]Normalizing amplitudes:  96%|█████████▋| 15773/16384 [00:02<00:00, 5857.09probe position/s]Normalizing amplitudes: 100%|█████████▉| 16360/16384 [00:02<00:00, 5814.24probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5909.13probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random128_p1_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random128_p1_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.008755 in 4.865 sec
Iter: 2, Total Loss: 0.006566 in 4.760 sec
Iter: 3, Total Loss: 0.00653 in 4.889 sec
Iter: 4, Total Loss: 0.0065 in 4.699 sec
Iter: 5, Total Loss: 0.006474 in 4.757 sec
Iter: 6, Total Loss: 0.006448 in 4.673 sec
Iter: 7, Total Loss: 0.006423 in 4.769 sec
Iter: 8, Total Loss: 0.006401 in 4.618 sec
Iter: 9, Total Loss: 0.006379 in 4.774 sec
Iter: 10, Total Loss: 0.006358 in 4.742 sec
Iter: 11, Total Loss: 0.006337 in 4.729 sec
Iter: 12, Total Loss: 0.006317 in 4.722 sec
Iter: 13, Total Loss: 0.006297 in 4.654 sec
Iter: 14, Total Loss: 0.00628 in 4.627 sec
Iter: 15, Total Loss: 0.006261 in 4.700 sec
Iter: 16, Total Loss: 0.006241 in 4.698 sec
Iter: 17, Total Loss: 0.006223 in 4.746 sec
Iter: 18, Total Loss: 0.006208 in 4.714 sec
Iter: 19, Total Loss: 0.006191 in 4.667 sec
Iter: 20, Total Loss: 0.006175 in 4.682 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 4.724 with std = 0.067 sec ###
### py4DSTEM ptycho solver is finished in 1 min 36.446 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 911.87 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 128, 3, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 613/16384 [00:00<00:02, 6125.45probe position/s]Normalizing amplitudes:   8%|▊         | 1254/16384 [00:00<00:02, 6288.42probe position/s]Normalizing amplitudes:  11%|█▏        | 1883/16384 [00:00<00:02, 6230.15probe position/s]Normalizing amplitudes:  15%|█▌        | 2507/16384 [00:00<00:02, 6228.51probe position/s]Normalizing amplitudes:  19%|█▉        | 3130/16384 [00:00<00:02, 6168.32probe position/s]Normalizing amplitudes:  23%|██▎       | 3747/16384 [00:00<00:02, 6151.62probe position/s]Normalizing amplitudes:  27%|██▋       | 4386/16384 [00:00<00:01, 6227.86probe position/s]Normalizing amplitudes:  31%|███       | 5009/16384 [00:00<00:01, 5960.41probe position/s]Normalizing amplitudes:  34%|███▍      | 5608/16384 [00:00<00:02, 5332.01probe position/s]Normalizing amplitudes:  38%|███▊      | 6154/16384 [00:01<00:01, 5236.69probe position/s]Normalizing amplitudes:  41%|████▏     | 6787/16384 [00:01<00:01, 5541.37probe position/s]Normalizing amplitudes:  45%|████▍     | 7372/16384 [00:01<00:01, 5627.31probe position/s]Normalizing amplitudes:  49%|████▊     | 7966/16384 [00:01<00:01, 5715.46probe position/s]Normalizing amplitudes:  53%|█████▎    | 8603/16384 [00:01<00:01, 5906.35probe position/s]Normalizing amplitudes:  56%|█████▋    | 9229/16384 [00:01<00:01, 6008.31probe position/s]Normalizing amplitudes:  60%|██████    | 9865/16384 [00:01<00:01, 6111.32probe position/s]Normalizing amplitudes:  64%|██████▍   | 10479/16384 [00:01<00:00, 5956.41probe position/s]Normalizing amplitudes:  68%|██████▊   | 11077/16384 [00:01<00:00, 5823.06probe position/s]Normalizing amplitudes:  71%|███████   | 11663/16384 [00:01<00:00, 5831.55probe position/s]Normalizing amplitudes:  75%|███████▍  | 12262/16384 [00:02<00:00, 5877.10probe position/s]Normalizing amplitudes:  79%|███████▊  | 12888/16384 [00:02<00:00, 5987.81probe position/s]Normalizing amplitudes:  82%|████████▏ | 13488/16384 [00:02<00:00, 5977.54probe position/s]Normalizing amplitudes:  86%|████████▌ | 14105/16384 [00:02<00:00, 6031.75probe position/s]Normalizing amplitudes:  90%|████████▉ | 14723/16384 [00:02<00:00, 6074.34probe position/s]Normalizing amplitudes:  94%|█████████▎| 15337/16384 [00:02<00:00, 6090.81probe position/s]Normalizing amplitudes:  97%|█████████▋| 15968/16384 [00:02<00:00, 6155.10probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5945.14probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random128_p3_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random128_p3_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.01492 in 2.474 sec
Iter: 2, Total Loss: 0.006506 in 2.417 sec
Iter: 3, Total Loss: 0.006399 in 2.464 sec
Iter: 4, Total Loss: 0.006337 in 2.408 sec
Iter: 5, Total Loss: 0.006285 in 2.459 sec
Iter: 6, Total Loss: 0.006237 in 2.347 sec
Iter: 7, Total Loss: 0.00619 in 2.361 sec
Iter: 8, Total Loss: 0.006143 in 2.457 sec
Iter: 9, Total Loss: 0.006098 in 2.429 sec
Iter: 10, Total Loss: 0.006054 in 2.448 sec
Iter: 11, Total Loss: 0.006012 in 2.486 sec
Iter: 12, Total Loss: 0.005971 in 2.395 sec
Iter: 13, Total Loss: 0.005931 in 2.448 sec
Iter: 14, Total Loss: 0.005893 in 2.462 sec
Iter: 15, Total Loss: 0.005855 in 2.471 sec
Iter: 16, Total Loss: 0.005821 in 2.520 sec
Iter: 17, Total Loss: 0.005787 in 2.485 sec
Iter: 18, Total Loss: 0.005754 in 2.442 sec
Iter: 19, Total Loss: 0.005724 in 2.398 sec
Iter: 20, Total Loss: 0.005695 in 2.394 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 2.438 with std = 0.043 sec ###
### py4DSTEM ptycho solver is finished in 50.600 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 911.86 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 128, 3, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 671/16384 [00:00<00:02, 6705.26probe position/s]Normalizing amplitudes:   8%|▊         | 1342/16384 [00:00<00:02, 6198.11probe position/s]Normalizing amplitudes:  12%|█▏        | 1971/16384 [00:00<00:02, 6236.81probe position/s]Normalizing amplitudes:  16%|█▌        | 2597/16384 [00:00<00:02, 6179.53probe position/s]Normalizing amplitudes:  20%|█▉        | 3224/16384 [00:00<00:02, 6208.88probe position/s]Normalizing amplitudes:  24%|██▎       | 3858/16384 [00:00<00:02, 6250.08probe position/s]Normalizing amplitudes:  27%|██▋       | 4484/16384 [00:00<00:01, 6079.91probe position/s]Normalizing amplitudes:  31%|███       | 5094/16384 [00:00<00:01, 5918.14probe position/s]Normalizing amplitudes:  35%|███▍      | 5688/16384 [00:00<00:01, 5865.41probe position/s]Normalizing amplitudes:  38%|███▊      | 6276/16384 [00:01<00:01, 5786.68probe position/s]Normalizing amplitudes:  42%|████▏     | 6856/16384 [00:01<00:01, 5554.71probe position/s]Normalizing amplitudes:  45%|████▌     | 7414/16384 [00:01<00:01, 5524.47probe position/s]Normalizing amplitudes:  49%|████▉     | 8056/16384 [00:01<00:01, 5783.43probe position/s]Normalizing amplitudes:  53%|█████▎    | 8678/16384 [00:01<00:01, 5910.77probe position/s]Normalizing amplitudes:  57%|█████▋    | 9315/16384 [00:01<00:01, 6044.20probe position/s]Normalizing amplitudes:  61%|██████    | 9961/16384 [00:01<00:01, 6167.13probe position/s]Normalizing amplitudes:  65%|██████▍   | 10579/16384 [00:01<00:00, 5825.93probe position/s]Normalizing amplitudes:  68%|██████▊   | 11167/16384 [00:01<00:00, 5821.78probe position/s]Normalizing amplitudes:  72%|███████▏  | 11774/16384 [00:01<00:00, 5892.57probe position/s]Normalizing amplitudes:  76%|███████▌  | 12396/16384 [00:02<00:00, 5987.37probe position/s]Normalizing amplitudes:  79%|███████▉  | 13017/16384 [00:02<00:00, 6051.25probe position/s]Normalizing amplitudes:  83%|████████▎ | 13636/16384 [00:02<00:00, 6090.21probe position/s]Normalizing amplitudes:  87%|████████▋ | 14283/16384 [00:02<00:00, 6200.43probe position/s]Normalizing amplitudes:  91%|█████████ | 14904/16384 [00:02<00:00, 6181.49probe position/s]Normalizing amplitudes:  95%|█████████▍| 15523/16384 [00:02<00:00, 6150.47probe position/s]Normalizing amplitudes:  99%|█████████▊| 16139/16384 [00:02<00:00, 6088.78probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6008.19probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random128_p3_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random128_p3_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.01547 in 6.366 sec
Iter: 2, Total Loss: 0.006418 in 6.256 sec
Iter: 3, Total Loss: 0.006294 in 6.259 sec
Iter: 4, Total Loss: 0.006215 in 6.315 sec
Iter: 5, Total Loss: 0.006144 in 6.306 sec
Iter: 6, Total Loss: 0.00608 in 6.327 sec
Iter: 7, Total Loss: 0.006021 in 6.298 sec
Iter: 8, Total Loss: 0.005965 in 6.403 sec
Iter: 9, Total Loss: 0.005913 in 6.444 sec
Iter: 10, Total Loss: 0.005863 in 6.571 sec
Iter: 11, Total Loss: 0.005818 in 6.541 sec
Iter: 12, Total Loss: 0.005775 in 6.493 sec
Iter: 13, Total Loss: 0.005735 in 6.435 sec
Iter: 14, Total Loss: 0.005697 in 6.282 sec
Iter: 15, Total Loss: 0.005662 in 6.344 sec
Iter: 16, Total Loss: 0.00563 in 6.455 sec
Iter: 17, Total Loss: 0.005599 in 6.286 sec
Iter: 18, Total Loss: 0.005571 in 6.311 sec
Iter: 19, Total Loss: 0.005545 in 6.200 sec
Iter: 20, Total Loss: 0.005521 in 6.175 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 6.353 with std = 0.106 sec ###
### py4DSTEM ptycho solver is finished in 2 min 9.997 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 916.42 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 128, 3, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 675/16384 [00:00<00:02, 6742.77probe position/s]Normalizing amplitudes:   8%|▊         | 1350/16384 [00:00<00:02, 6719.73probe position/s]Normalizing amplitudes:  12%|█▏        | 2022/16384 [00:00<00:02, 6688.91probe position/s]Normalizing amplitudes:  16%|█▋        | 2698/16384 [00:00<00:02, 6715.40probe position/s]Normalizing amplitudes:  21%|██        | 3402/16384 [00:00<00:01, 6827.95probe position/s]Normalizing amplitudes:  25%|██▍       | 4085/16384 [00:00<00:01, 6722.86probe position/s]Normalizing amplitudes:  29%|██▉       | 4758/16384 [00:00<00:01, 6550.10probe position/s]Normalizing amplitudes:  33%|███▎      | 5414/16384 [00:00<00:01, 6358.71probe position/s]Normalizing amplitudes:  37%|███▋      | 6108/16384 [00:00<00:01, 6532.18probe position/s]Normalizing amplitudes:  41%|████▏     | 6763/16384 [00:01<00:01, 6408.65probe position/s]Normalizing amplitudes:  45%|████▌     | 7426/16384 [00:01<00:01, 6471.50probe position/s]Normalizing amplitudes:  50%|████▉     | 8120/16384 [00:01<00:01, 6607.92probe position/s]Normalizing amplitudes:  54%|█████▎    | 8803/16384 [00:01<00:01, 6673.26probe position/s]Normalizing amplitudes:  58%|█████▊    | 9487/16384 [00:01<00:01, 6719.37probe position/s]Normalizing amplitudes:  62%|██████▏   | 10160/16384 [00:01<00:00, 6675.47probe position/s]Normalizing amplitudes:  66%|██████▌   | 10831/16384 [00:01<00:00, 6685.26probe position/s]Normalizing amplitudes:  70%|███████   | 11524/16384 [00:01<00:00, 6756.38probe position/s]Normalizing amplitudes:  74%|███████▍  | 12200/16384 [00:01<00:00, 6702.33probe position/s]Normalizing amplitudes:  79%|███████▊  | 12871/16384 [00:01<00:00, 6436.08probe position/s]Normalizing amplitudes:  83%|████████▎ | 13517/16384 [00:02<00:00, 5375.23probe position/s]Normalizing amplitudes:  86%|████████▌ | 14116/16384 [00:02<00:00, 5532.57probe position/s]Normalizing amplitudes:  90%|████████▉ | 14719/16384 [00:02<00:00, 5665.38probe position/s]Normalizing amplitudes:  94%|█████████▍| 15404/16384 [00:02<00:00, 5993.32probe position/s]Normalizing amplitudes:  98%|█████████▊| 16079/16384 [00:02<00:00, 6201.66probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6362.44probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random128_p3_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random128_p3_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.01576 in 11.948 sec
Iter: 2, Total Loss: 0.006383 in 11.910 sec
Iter: 3, Total Loss: 0.006236 in 11.705 sec
Iter: 4, Total Loss: 0.006146 in 11.718 sec
Iter: 5, Total Loss: 0.006068 in 12.185 sec
Iter: 6, Total Loss: 0.005996 in 12.013 sec
Iter: 7, Total Loss: 0.005928 in 11.973 sec
Iter: 8, Total Loss: 0.005864 in 11.956 sec
Iter: 9, Total Loss: 0.005805 in 12.283 sec
Iter: 10, Total Loss: 0.005749 in 12.316 sec
Iter: 11, Total Loss: 0.005697 in 11.948 sec
Iter: 12, Total Loss: 0.005649 in 12.182 sec
Iter: 13, Total Loss: 0.005606 in 12.051 sec
Iter: 14, Total Loss: 0.005565 in 12.110 sec
Iter: 15, Total Loss: 0.005529 in 12.330 sec
Iter: 16, Total Loss: 0.005496 in 12.396 sec
Iter: 17, Total Loss: 0.005466 in 12.254 sec
Iter: 18, Total Loss: 0.005439 in 12.187 sec
Iter: 19, Total Loss: 0.005414 in 12.248 sec
Iter: 20, Total Loss: 0.005391 in 12.083 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 12.090 with std = 0.189 sec ###
### py4DSTEM ptycho solver is finished in 4 min 3.661 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 913.89 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 128, 6, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 624/16384 [00:00<00:02, 6232.64probe position/s]Normalizing amplitudes:   8%|▊         | 1255/16384 [00:00<00:02, 6274.44probe position/s]Normalizing amplitudes:  11%|█▏        | 1883/16384 [00:00<00:02, 6204.56probe position/s]Normalizing amplitudes:  15%|█▌        | 2504/16384 [00:00<00:02, 6028.31probe position/s]Normalizing amplitudes:  19%|█▉        | 3108/16384 [00:00<00:02, 6028.47probe position/s]Normalizing amplitudes:  23%|██▎       | 3712/16384 [00:00<00:02, 6020.84probe position/s]Normalizing amplitudes:  27%|██▋       | 4354/16384 [00:00<00:01, 6148.57probe position/s]Normalizing amplitudes:  30%|███       | 4995/16384 [00:00<00:01, 6228.58probe position/s]Normalizing amplitudes:  34%|███▍      | 5619/16384 [00:00<00:01, 6206.52probe position/s]Normalizing amplitudes:  38%|███▊      | 6240/16384 [00:01<00:01, 6179.93probe position/s]Normalizing amplitudes:  42%|████▏     | 6902/16384 [00:01<00:01, 6310.91probe position/s]Normalizing amplitudes:  46%|████▌     | 7534/16384 [00:01<00:01, 6270.03probe position/s]Normalizing amplitudes:  50%|████▉     | 8181/16384 [00:01<00:01, 6328.95probe position/s]Normalizing amplitudes:  54%|█████▍    | 8835/16384 [00:01<00:01, 6391.76probe position/s]Normalizing amplitudes:  58%|█████▊    | 9475/16384 [00:01<00:01, 6306.73probe position/s]Normalizing amplitudes:  62%|██████▏   | 10107/16384 [00:01<00:01, 6247.25probe position/s]Normalizing amplitudes:  66%|██████▌   | 10733/16384 [00:01<00:01, 5628.95probe position/s]Normalizing amplitudes:  69%|██████▉   | 11372/16384 [00:01<00:00, 5838.00probe position/s]Normalizing amplitudes:  73%|███████▎  | 11966/16384 [00:01<00:00, 5721.17probe position/s]Normalizing amplitudes:  77%|███████▋  | 12621/16384 [00:02<00:00, 5954.63probe position/s]Normalizing amplitudes:  81%|████████▏ | 13313/16384 [00:02<00:00, 6226.88probe position/s]Normalizing amplitudes:  85%|████████▌ | 13942/16384 [00:02<00:00, 6237.92probe position/s]Normalizing amplitudes:  89%|████████▉ | 14599/16384 [00:02<00:00, 6332.46probe position/s]Normalizing amplitudes:  93%|█████████▎| 15236/16384 [00:02<00:00, 6311.96probe position/s]Normalizing amplitudes:  97%|█████████▋| 15888/16384 [00:02<00:00, 6372.72probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6171.14probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random128_p6_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random128_p6_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.03197 in 4.383 sec
Iter: 2, Total Loss: 0.006513 in 4.332 sec
Iter: 3, Total Loss: 0.006388 in 4.318 sec
Iter: 4, Total Loss: 0.006317 in 4.261 sec
Iter: 5, Total Loss: 0.006258 in 4.378 sec
Iter: 6, Total Loss: 0.006204 in 4.383 sec
Iter: 7, Total Loss: 0.006151 in 4.307 sec
Iter: 8, Total Loss: 0.006101 in 4.331 sec
Iter: 9, Total Loss: 0.00605 in 4.297 sec
Iter: 10, Total Loss: 0.006001 in 4.349 sec
Iter: 11, Total Loss: 0.005953 in 4.547 sec
Iter: 12, Total Loss: 0.005907 in 4.335 sec
Iter: 13, Total Loss: 0.005862 in 4.528 sec
Iter: 14, Total Loss: 0.00582 in 4.285 sec
Iter: 15, Total Loss: 0.005779 in 4.270 sec
Iter: 16, Total Loss: 0.005741 in 4.320 sec
Iter: 17, Total Loss: 0.005705 in 4.316 sec
Iter: 18, Total Loss: 0.005671 in 4.224 sec
Iter: 19, Total Loss: 0.005638 in 4.256 sec
Iter: 20, Total Loss: 0.005607 in 4.238 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 4.333 with std = 0.081 sec ###
### py4DSTEM ptycho solver is finished in 1 min 28.297 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 910.65 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 128, 6, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 647/16384 [00:00<00:02, 6462.04probe position/s]Normalizing amplitudes:   8%|▊         | 1317/16384 [00:00<00:02, 6597.66probe position/s]Normalizing amplitudes:  12%|█▏        | 1977/16384 [00:00<00:02, 6524.47probe position/s]Normalizing amplitudes:  16%|█▌        | 2643/16384 [00:00<00:02, 6576.07probe position/s]Normalizing amplitudes:  20%|██        | 3301/16384 [00:00<00:01, 6560.74probe position/s]Normalizing amplitudes:  24%|██▍       | 3958/16384 [00:00<00:01, 6264.40probe position/s]Normalizing amplitudes:  28%|██▊       | 4587/16384 [00:00<00:01, 6042.41probe position/s]Normalizing amplitudes:  32%|███▏      | 5194/16384 [00:00<00:01, 5965.14probe position/s]Normalizing amplitudes:  36%|███▌      | 5833/16384 [00:00<00:01, 6089.89probe position/s]Normalizing amplitudes:  39%|███▉      | 6451/16384 [00:01<00:01, 6115.15probe position/s]Normalizing amplitudes:  43%|████▎     | 7116/16384 [00:01<00:01, 6274.46probe position/s]Normalizing amplitudes:  48%|████▊     | 7786/16384 [00:01<00:01, 6400.54probe position/s]Normalizing amplitudes:  52%|█████▏    | 8442/16384 [00:01<00:01, 6446.82probe position/s]Normalizing amplitudes:  56%|█████▌    | 9117/16384 [00:01<00:01, 6535.69probe position/s]Normalizing amplitudes:  60%|█████▉    | 9783/16384 [00:01<00:01, 6571.83probe position/s]Normalizing amplitudes:  64%|██████▍   | 10445/16384 [00:01<00:00, 6583.55probe position/s]Normalizing amplitudes:  68%|██████▊   | 11104/16384 [00:01<00:00, 6580.84probe position/s]Normalizing amplitudes:  72%|███████▏  | 11763/16384 [00:01<00:00, 6579.53probe position/s]Normalizing amplitudes:  76%|███████▌  | 12429/16384 [00:01<00:00, 6600.44probe position/s]Normalizing amplitudes:  80%|███████▉  | 13090/16384 [00:02<00:00, 6510.47probe position/s]Normalizing amplitudes:  84%|████████▍ | 13742/16384 [00:02<00:00, 6453.62probe position/s]Normalizing amplitudes:  88%|████████▊ | 14394/16384 [00:02<00:00, 6472.61probe position/s]Normalizing amplitudes:  92%|█████████▏| 15081/16384 [00:02<00:00, 6587.01probe position/s]Normalizing amplitudes:  96%|█████████▌| 15740/16384 [00:02<00:00, 6462.21probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6416.86probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random128_p6_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random128_p6_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.03272 in 11.907 sec
Iter: 2, Total Loss: 0.006478 in 11.920 sec
Iter: 3, Total Loss: 0.006304 in 12.116 sec
Iter: 4, Total Loss: 0.006218 in 12.166 sec
Iter: 5, Total Loss: 0.006143 in 11.971 sec
Iter: 6, Total Loss: 0.006073 in 11.761 sec
Iter: 7, Total Loss: 0.006002 in 11.737 sec
Iter: 8, Total Loss: 0.005937 in 12.524 sec
Iter: 9, Total Loss: 0.005867 in 12.131 sec
Iter: 10, Total Loss: 0.005805 in 11.759 sec
Iter: 11, Total Loss: 0.005742 in 11.894 sec
Iter: 12, Total Loss: 0.005686 in 11.924 sec
Iter: 13, Total Loss: 0.005632 in 12.280 sec
Iter: 14, Total Loss: 0.005583 in 11.941 sec
Iter: 15, Total Loss: 0.005537 in 12.373 sec
Iter: 16, Total Loss: 0.005495 in 11.713 sec
Iter: 17, Total Loss: 0.005455 in 12.155 sec
Iter: 18, Total Loss: 0.005417 in 12.545 sec
Iter: 19, Total Loss: 0.005383 in 12.870 sec
Iter: 20, Total Loss: 0.005348 in 12.897 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 12.129 with std = 0.347 sec ###
### py4DSTEM ptycho solver is finished in 4 min 4.548 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 912.34 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 128, 6, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 621/16384 [00:00<00:02, 6207.40probe position/s]Normalizing amplitudes:   8%|▊         | 1313/16384 [00:00<00:02, 6622.55probe position/s]Normalizing amplitudes:  12%|█▏        | 1976/16384 [00:00<00:02, 6108.12probe position/s]Normalizing amplitudes:  16%|█▌        | 2592/16384 [00:00<00:02, 6021.52probe position/s]Normalizing amplitudes:  20%|█▉        | 3217/16384 [00:00<00:02, 6098.05probe position/s]Normalizing amplitudes:  23%|██▎       | 3832/16384 [00:00<00:02, 6112.36probe position/s]Normalizing amplitudes:  27%|██▋       | 4445/16384 [00:00<00:01, 6059.71probe position/s]Normalizing amplitudes:  31%|███       | 5062/16384 [00:00<00:01, 6093.62probe position/s]Normalizing amplitudes:  35%|███▌      | 5742/16384 [00:00<00:01, 6310.41probe position/s]Normalizing amplitudes:  39%|███▉      | 6374/16384 [00:01<00:01, 6298.80probe position/s]Normalizing amplitudes:  43%|████▎     | 7038/16384 [00:01<00:01, 6401.84probe position/s]Normalizing amplitudes:  47%|████▋     | 7679/16384 [00:01<00:01, 6331.45probe position/s]Normalizing amplitudes:  51%|█████     | 8319/16384 [00:01<00:01, 6351.13probe position/s]Normalizing amplitudes:  55%|█████▍    | 8955/16384 [00:01<00:01, 6104.08probe position/s]Normalizing amplitudes:  58%|█████▊    | 9568/16384 [00:01<00:01, 5941.32probe position/s]Normalizing amplitudes:  62%|██████▏   | 10189/16384 [00:01<00:01, 6016.48probe position/s]Normalizing amplitudes:  66%|██████▌   | 10821/16384 [00:01<00:00, 6102.80probe position/s]Normalizing amplitudes:  70%|███████   | 11469/16384 [00:01<00:00, 6213.29probe position/s]Normalizing amplitudes:  74%|███████▍  | 12132/16384 [00:01<00:00, 6335.42probe position/s]Normalizing amplitudes:  78%|███████▊  | 12813/16384 [00:02<00:00, 6474.60probe position/s]Normalizing amplitudes:  82%|████████▏ | 13462/16384 [00:02<00:00, 6475.53probe position/s]Normalizing amplitudes:  86%|████████▌ | 14111/16384 [00:02<00:00, 6418.05probe position/s]Normalizing amplitudes:  90%|█████████ | 14760/16384 [00:02<00:00, 6436.67probe position/s]Normalizing amplitudes:  94%|█████████▍| 15405/16384 [00:02<00:00, 6206.87probe position/s]Normalizing amplitudes:  98%|█████████▊| 16028/16384 [00:02<00:00, 6069.95probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6214.38probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random128_p6_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random128_p6_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.03403 in 24.008 sec
Iter: 2, Total Loss: 0.006518 in 24.118 sec
Iter: 3, Total Loss: 0.00615 in 23.903 sec
Iter: 4, Total Loss: 0.006005 in 23.632 sec
Iter: 5, Total Loss: 0.005895 in 23.528 sec
Iter: 6, Total Loss: 0.005799 in 23.905 sec
Iter: 7, Total Loss: 0.005711 in 24.613 sec
Iter: 8, Total Loss: 0.005632 in 24.196 sec
Iter: 9, Total Loss: 0.00556 in 24.026 sec
Iter: 10, Total Loss: 0.005496 in 23.797 sec
Iter: 11, Total Loss: 0.005436 in 23.645 sec
Iter: 12, Total Loss: 0.005384 in 24.116 sec
Iter: 13, Total Loss: 0.005335 in 24.187 sec
Iter: 14, Total Loss: 0.005291 in 23.604 sec
Iter: 15, Total Loss: 0.005251 in 23.125 sec
Iter: 16, Total Loss: 0.005214 in 22.719 sec
Iter: 17, Total Loss: 0.00518 in 23.602 sec
Iter: 18, Total Loss: 0.005148 in 23.610 sec
Iter: 19, Total Loss: 0.005119 in 23.522 sec
Iter: 20, Total Loss: 0.005091 in 23.561 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 23.771 with std = 0.404 sec ###
### py4DSTEM ptycho solver is finished in 7 min 57.200 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 912.76 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 128, 12, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 635/16384 [00:00<00:02, 6343.16probe position/s]Normalizing amplitudes:   8%|▊         | 1274/16384 [00:00<00:02, 6369.70probe position/s]Normalizing amplitudes:  12%|█▏        | 1911/16384 [00:00<00:02, 6345.51probe position/s]Normalizing amplitudes:  16%|█▌        | 2546/16384 [00:00<00:02, 6331.75probe position/s]Normalizing amplitudes:  19%|█▉        | 3180/16384 [00:00<00:02, 6325.76probe position/s]Normalizing amplitudes:  23%|██▎       | 3813/16384 [00:00<00:01, 6294.77probe position/s]Normalizing amplitudes:  27%|██▋       | 4443/16384 [00:00<00:01, 6274.21probe position/s]Normalizing amplitudes:  31%|███▏      | 5124/16384 [00:00<00:01, 6441.01probe position/s]Normalizing amplitudes:  35%|███▌      | 5769/16384 [00:00<00:01, 6374.14probe position/s]Normalizing amplitudes:  39%|███▉      | 6410/16384 [00:01<00:01, 6381.79probe position/s]Normalizing amplitudes:  43%|████▎     | 7049/16384 [00:01<00:01, 6218.24probe position/s]Normalizing amplitudes:  47%|████▋     | 7672/16384 [00:01<00:01, 6033.97probe position/s]Normalizing amplitudes:  51%|█████     | 8279/16384 [00:01<00:01, 6043.47probe position/s]Normalizing amplitudes:  54%|█████▍    | 8893/16384 [00:01<00:01, 6069.77probe position/s]Normalizing amplitudes:  58%|█████▊    | 9581/16384 [00:01<00:01, 6306.00probe position/s]Normalizing amplitudes:  62%|██████▏   | 10219/16384 [00:01<00:00, 6326.76probe position/s]Normalizing amplitudes:  66%|██████▋   | 10859/16384 [00:01<00:00, 6344.97probe position/s]Normalizing amplitudes:  70%|███████   | 11495/16384 [00:01<00:00, 6088.81probe position/s]Normalizing amplitudes:  74%|███████▍  | 12121/16384 [00:01<00:00, 6135.59probe position/s]Normalizing amplitudes:  78%|███████▊  | 12737/16384 [00:02<00:00, 5954.38probe position/s]Normalizing amplitudes:  81%|████████▏ | 13335/16384 [00:02<00:00, 5931.25probe position/s]Normalizing amplitudes:  85%|████████▌ | 13930/16384 [00:02<00:00, 5822.32probe position/s]Normalizing amplitudes:  89%|████████▊ | 14514/16384 [00:02<00:00, 5745.89probe position/s]Normalizing amplitudes:  93%|█████████▎| 15165/16384 [00:02<00:00, 5965.68probe position/s]Normalizing amplitudes:  96%|█████████▌| 15763/16384 [00:02<00:00, 5854.30probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6132.87probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random128_p12_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random128_p12_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.07457 in 8.173 sec
Iter: 2, Total Loss: 0.006555 in 8.133 sec
Iter: 3, Total Loss: 0.006393 in 8.176 sec
Iter: 4, Total Loss: 0.0063 in 8.286 sec
Iter: 5, Total Loss: 0.006228 in 8.236 sec
Iter: 6, Total Loss: 0.006163 in 8.388 sec
Iter: 7, Total Loss: 0.0061 in 8.290 sec
Iter: 8, Total Loss: 0.006041 in 8.275 sec
Iter: 9, Total Loss: 0.005982 in 8.327 sec
Iter: 10, Total Loss: 0.005923 in 8.224 sec
Iter: 11, Total Loss: 0.005865 in 8.351 sec
Iter: 12, Total Loss: 0.005809 in 8.414 sec
Iter: 13, Total Loss: 0.005754 in 8.338 sec
Iter: 14, Total Loss: 0.005702 in 8.266 sec
Iter: 15, Total Loss: 0.005653 in 8.328 sec
Iter: 16, Total Loss: 0.005607 in 8.290 sec
Iter: 17, Total Loss: 0.005563 in 8.148 sec
Iter: 18, Total Loss: 0.005522 in 8.287 sec
Iter: 19, Total Loss: 0.005484 in 8.276 sec
Iter: 20, Total Loss: 0.005449 in 8.261 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 8.273 with std = 0.074 sec ###
### py4DSTEM ptycho solver is finished in 2 min 47.291 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 911.91 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 128, 12, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 607/16384 [00:00<00:02, 6066.87probe position/s]Normalizing amplitudes:   7%|▋         | 1214/16384 [00:00<00:02, 5919.72probe position/s]Normalizing amplitudes:  11%|█         | 1817/16384 [00:00<00:02, 5968.30probe position/s]Normalizing amplitudes:  15%|█▍        | 2430/16384 [00:00<00:02, 6029.47probe position/s]Normalizing amplitudes:  19%|█▊        | 3045/16384 [00:00<00:02, 6069.40probe position/s]Normalizing amplitudes:  22%|██▏       | 3653/16384 [00:00<00:02, 6018.06probe position/s]Normalizing amplitudes:  26%|██▌       | 4262/16384 [00:00<00:02, 6039.31probe position/s]Normalizing amplitudes:  30%|██▉       | 4885/16384 [00:00<00:01, 6097.02probe position/s]Normalizing amplitudes:  34%|███▎      | 5495/16384 [00:00<00:01, 6041.18probe position/s]Normalizing amplitudes:  37%|███▋      | 6100/16384 [00:01<00:01, 5971.27probe position/s]Normalizing amplitudes:  41%|████      | 6716/16384 [00:01<00:01, 6027.79probe position/s]Normalizing amplitudes:  45%|████▍     | 7328/16384 [00:01<00:01, 6054.93probe position/s]Normalizing amplitudes:  48%|████▊     | 7934/16384 [00:01<00:01, 5930.69probe position/s]Normalizing amplitudes:  52%|█████▏    | 8528/16384 [00:01<00:01, 5878.76probe position/s]Normalizing amplitudes:  56%|█████▌    | 9132/16384 [00:01<00:01, 5923.69probe position/s]Normalizing amplitudes:  59%|█████▉    | 9740/16384 [00:01<00:01, 5967.56probe position/s]Normalizing amplitudes:  63%|██████▎   | 10338/16384 [00:01<00:01, 5970.54probe position/s]Normalizing amplitudes:  67%|██████▋   | 10952/16384 [00:01<00:00, 6019.32probe position/s]Normalizing amplitudes:  71%|███████   | 11555/16384 [00:01<00:00, 5851.48probe position/s]Normalizing amplitudes:  74%|███████▍  | 12142/16384 [00:02<00:00, 5806.42probe position/s]Normalizing amplitudes:  78%|███████▊  | 12724/16384 [00:02<00:00, 5791.40probe position/s]Normalizing amplitudes:  81%|████████▏ | 13338/16384 [00:02<00:00, 5893.85probe position/s]Normalizing amplitudes:  85%|████████▌ | 13954/16384 [00:02<00:00, 5970.67probe position/s]Normalizing amplitudes:  89%|████████▉ | 14565/16384 [00:02<00:00, 6011.05probe position/s]Normalizing amplitudes:  93%|█████████▎| 15181/16384 [00:02<00:00, 6054.70probe position/s]Normalizing amplitudes:  96%|█████████▋| 15787/16384 [00:02<00:00, 5988.41probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5977.50probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random128_p12_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random128_p12_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.07526 in 23.824 sec
Iter: 2, Total Loss: 0.006559 in 23.491 sec
Iter: 3, Total Loss: 0.006273 in 23.555 sec
Iter: 4, Total Loss: 0.006151 in 24.083 sec
Iter: 5, Total Loss: 0.006055 in 24.475 sec
Iter: 6, Total Loss: 0.005967 in 23.847 sec
Iter: 7, Total Loss: 0.005885 in 23.068 sec
Iter: 8, Total Loss: 0.005808 in 23.543 sec
Iter: 9, Total Loss: 0.005735 in 23.250 sec
Iter: 10, Total Loss: 0.005669 in 23.348 sec
Iter: 11, Total Loss: 0.005609 in 23.301 sec
Iter: 12, Total Loss: 0.005552 in 24.192 sec
Iter: 13, Total Loss: 0.005501 in 24.267 sec
Iter: 14, Total Loss: 0.005453 in 23.724 sec
Iter: 15, Total Loss: 0.00541 in 23.880 sec
Iter: 16, Total Loss: 0.00537 in 23.754 sec
Iter: 17, Total Loss: 0.005333 in 23.993 sec
Iter: 18, Total Loss: 0.005298 in 23.480 sec
Iter: 19, Total Loss: 0.005265 in 23.642 sec
Iter: 20, Total Loss: 0.005232 in 23.260 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 23.699 with std = 0.367 sec ###
### py4DSTEM ptycho solver is finished in 7 min 56.539 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 910.91 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 128, 12, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 634/16384 [00:00<00:02, 6323.86probe position/s]Normalizing amplitudes:   8%|▊         | 1272/16384 [00:00<00:02, 6352.30probe position/s]Normalizing amplitudes:  12%|█▏        | 1922/16384 [00:00<00:02, 6416.67probe position/s]Normalizing amplitudes:  16%|█▌        | 2564/16384 [00:00<00:02, 6393.51probe position/s]Normalizing amplitudes:  20%|█▉        | 3204/16384 [00:00<00:02, 5677.31probe position/s]Normalizing amplitudes:  23%|██▎       | 3832/16384 [00:00<00:02, 5866.00probe position/s]Normalizing amplitudes:  27%|██▋       | 4484/16384 [00:00<00:01, 6067.04probe position/s]Normalizing amplitudes:  31%|███       | 5118/16384 [00:00<00:01, 6148.41probe position/s]Normalizing amplitudes:  35%|███▌      | 5743/16384 [00:00<00:01, 6178.69probe position/s]Normalizing amplitudes:  39%|███▉      | 6365/16384 [00:01<00:01, 6098.53probe position/s]Normalizing amplitudes:  43%|████▎     | 6991/16384 [00:01<00:01, 6144.32probe position/s]Normalizing amplitudes:  47%|████▋     | 7619/16384 [00:01<00:01, 6182.20probe position/s]Normalizing amplitudes:  50%|█████     | 8239/16384 [00:01<00:01, 6156.99probe position/s]Normalizing amplitudes:  54%|█████▍    | 8893/16384 [00:01<00:01, 6271.23probe position/s]Normalizing amplitudes:  58%|█████▊    | 9538/16384 [00:01<00:01, 6322.88probe position/s]Normalizing amplitudes:  62%|██████▏   | 10172/16384 [00:01<00:00, 6327.23probe position/s]Normalizing amplitudes:  66%|██████▌   | 10806/16384 [00:01<00:00, 6323.38probe position/s]Normalizing amplitudes:  70%|██████▉   | 11442/16384 [00:01<00:00, 6331.93probe position/s]Normalizing amplitudes:  74%|███████▎  | 12076/16384 [00:01<00:00, 6317.50probe position/s]Normalizing amplitudes:  78%|███████▊  | 12708/16384 [00:02<00:00, 6294.80probe position/s]Normalizing amplitudes:  81%|████████▏ | 13338/16384 [00:02<00:00, 6157.20probe position/s]Normalizing amplitudes:  85%|████████▌ | 13955/16384 [00:02<00:00, 5991.22probe position/s]Normalizing amplitudes:  89%|████████▉ | 14556/16384 [00:02<00:00, 5920.32probe position/s]Normalizing amplitudes:  93%|█████████▎| 15187/16384 [00:02<00:00, 6033.20probe position/s]Normalizing amplitudes:  96%|█████████▋| 15807/16384 [00:02<00:00, 6081.23probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6145.38probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random128_p12_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random128_p12_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.07821 in 45.745 sec
Iter: 2, Total Loss: 0.006737 in 46.461 sec
Iter: 3, Total Loss: 0.006142 in 44.815 sec
Iter: 4, Total Loss: 0.005953 in 46.666 sec
Iter: 5, Total Loss: 0.005825 in 47.165 sec
Iter: 6, Total Loss: 0.005717 in 46.741 sec
Iter: 7, Total Loss: 0.005621 in 46.810 sec
Iter: 8, Total Loss: 0.005534 in 46.985 sec
Iter: 9, Total Loss: 0.005455 in 46.820 sec
Iter: 10, Total Loss: 0.005385 in 46.374 sec
Iter: 11, Total Loss: 0.005322 in 46.342 sec
Iter: 12, Total Loss: 0.005265 in 44.639 sec
Iter: 13, Total Loss: 0.005214 in 46.868 sec
Iter: 14, Total Loss: 0.005166 in 45.981 sec
Iter: 15, Total Loss: 0.005123 in 46.056 sec
Iter: 16, Total Loss: 0.005082 in 46.873 sec
Iter: 17, Total Loss: 0.005044 in 46.723 sec
Iter: 18, Total Loss: 0.005006 in 46.719 sec
Iter: 19, Total Loss: 0.004972 in 47.595 sec
Iter: 20, Total Loss: 0.004938 in 47.247 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 46.481 with std = 0.723 sec ###
### py4DSTEM ptycho solver is finished in 15 min 31.920 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 915.83 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 64, 1, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 587/16384 [00:00<00:02, 5864.13probe position/s]Normalizing amplitudes:   7%|▋         | 1174/16384 [00:00<00:02, 5785.66probe position/s]Normalizing amplitudes:  11%|█         | 1753/16384 [00:00<00:02, 5702.05probe position/s]Normalizing amplitudes:  14%|█▍        | 2373/16384 [00:00<00:02, 5892.14probe position/s]Normalizing amplitudes:  18%|█▊        | 2979/16384 [00:00<00:02, 5951.91probe position/s]Normalizing amplitudes:  22%|██▏       | 3606/16384 [00:00<00:02, 6057.83probe position/s]Normalizing amplitudes:  26%|██▌       | 4226/16384 [00:00<00:01, 6101.15probe position/s]Normalizing amplitudes:  30%|██▉       | 4837/16384 [00:00<00:01, 5869.75probe position/s]Normalizing amplitudes:  33%|███▎      | 5426/16384 [00:00<00:01, 5865.55probe position/s]Normalizing amplitudes:  37%|███▋      | 6014/16384 [00:01<00:01, 5863.36probe position/s]Normalizing amplitudes:  40%|████      | 6613/16384 [00:01<00:01, 5898.64probe position/s]Normalizing amplitudes:  44%|████▍     | 7204/16384 [00:01<00:01, 5821.00probe position/s]Normalizing amplitudes:  48%|████▊     | 7787/16384 [00:01<00:01, 5737.02probe position/s]Normalizing amplitudes:  51%|█████     | 8362/16384 [00:01<00:01, 5719.53probe position/s]Normalizing amplitudes:  55%|█████▍    | 8939/16384 [00:01<00:01, 5730.83probe position/s]Normalizing amplitudes:  59%|█████▊    | 9603/16384 [00:01<00:01, 5997.33probe position/s]Normalizing amplitudes:  62%|██████▏   | 10204/16384 [00:01<00:01, 5245.98probe position/s]Normalizing amplitudes:  66%|██████▌   | 10798/16384 [00:01<00:01, 5433.45probe position/s]Normalizing amplitudes:  70%|██████▉   | 11405/16384 [00:01<00:00, 5609.57probe position/s]Normalizing amplitudes:  73%|███████▎  | 12019/16384 [00:02<00:00, 5758.62probe position/s]Normalizing amplitudes:  77%|███████▋  | 12611/16384 [00:02<00:00, 5800.88probe position/s]Normalizing amplitudes:  81%|████████  | 13198/16384 [00:02<00:00, 5712.85probe position/s]Normalizing amplitudes:  84%|████████▍ | 13775/16384 [00:02<00:00, 5727.28probe position/s]Normalizing amplitudes:  88%|████████▊ | 14432/16384 [00:02<00:00, 5973.24probe position/s]Normalizing amplitudes:  92%|█████████▏| 15033/16384 [00:02<00:00, 5973.29probe position/s]Normalizing amplitudes:  95%|█████████▌| 15633/16384 [00:02<00:00, 5824.10probe position/s]Normalizing amplitudes:  99%|█████████▉| 16230/16384 [00:02<00:00, 5864.88probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5806.52probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random64_p1_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random64_p1_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.007549 in 2.011 sec
Iter: 2, Total Loss: 0.006519 in 1.914 sec
Iter: 3, Total Loss: 0.006487 in 1.890 sec
Iter: 4, Total Loss: 0.006462 in 1.916 sec
Iter: 5, Total Loss: 0.006433 in 1.921 sec
Iter: 6, Total Loss: 0.006405 in 1.988 sec
Iter: 7, Total Loss: 0.006376 in 1.931 sec
Iter: 8, Total Loss: 0.006347 in 1.878 sec
Iter: 9, Total Loss: 0.006321 in 1.936 sec
Iter: 10, Total Loss: 0.006295 in 1.918 sec
Iter: 11, Total Loss: 0.00627 in 1.879 sec
Iter: 12, Total Loss: 0.006246 in 1.887 sec
Iter: 13, Total Loss: 0.006227 in 1.833 sec
Iter: 14, Total Loss: 0.006207 in 1.867 sec
Iter: 15, Total Loss: 0.00619 in 1.859 sec
Iter: 16, Total Loss: 0.006173 in 1.826 sec
Iter: 17, Total Loss: 0.006159 in 1.813 sec
Iter: 18, Total Loss: 0.006148 in 1.876 sec
Iter: 19, Total Loss: 0.006136 in 1.792 sec
Iter: 20, Total Loss: 0.006124 in 1.769 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 1.885 with std = 0.059 sec ###
### py4DSTEM ptycho solver is finished in 39.418 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 916.34 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 64, 1, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 648/16384 [00:00<00:02, 6479.81probe position/s]Normalizing amplitudes:   8%|▊         | 1296/16384 [00:00<00:02, 6404.48probe position/s]Normalizing amplitudes:  12%|█▏        | 1997/16384 [00:00<00:02, 6678.14probe position/s]Normalizing amplitudes:  16%|█▋        | 2666/16384 [00:00<00:02, 6643.60probe position/s]Normalizing amplitudes:  20%|██        | 3331/16384 [00:00<00:01, 6593.98probe position/s]Normalizing amplitudes:  24%|██▍       | 3996/16384 [00:00<00:01, 6609.59probe position/s]Normalizing amplitudes:  28%|██▊       | 4658/16384 [00:00<00:01, 6583.61probe position/s]Normalizing amplitudes:  32%|███▏      | 5317/16384 [00:00<00:01, 6584.71probe position/s]Normalizing amplitudes:  36%|███▋      | 5976/16384 [00:00<00:01, 6579.57probe position/s]Normalizing amplitudes:  40%|████      | 6634/16384 [00:01<00:01, 6465.29probe position/s]Normalizing amplitudes:  44%|████▍     | 7281/16384 [00:01<00:01, 6293.14probe position/s]Normalizing amplitudes:  48%|████▊     | 7912/16384 [00:01<00:01, 6258.17probe position/s]Normalizing amplitudes:  52%|█████▏    | 8539/16384 [00:01<00:01, 6178.04probe position/s]Normalizing amplitudes:  56%|█████▌    | 9158/16384 [00:01<00:01, 6046.47probe position/s]Normalizing amplitudes:  60%|█████▉    | 9764/16384 [00:01<00:01, 5953.42probe position/s]Normalizing amplitudes:  63%|██████▎   | 10403/16384 [00:01<00:00, 6077.91probe position/s]Normalizing amplitudes:  67%|██████▋   | 11012/16384 [00:01<00:00, 5945.01probe position/s]Normalizing amplitudes:  71%|███████   | 11608/16384 [00:01<00:00, 5908.24probe position/s]Normalizing amplitudes:  75%|███████▍  | 12257/16384 [00:01<00:00, 6077.92probe position/s]Normalizing amplitudes:  79%|███████▊  | 12866/16384 [00:02<00:00, 6060.84probe position/s]Normalizing amplitudes:  82%|████████▏ | 13483/16384 [00:02<00:00, 6091.46probe position/s]Normalizing amplitudes:  86%|████████▌ | 14105/16384 [00:02<00:00, 6126.49probe position/s]Normalizing amplitudes:  90%|████████▉ | 14731/16384 [00:02<00:00, 6165.22probe position/s]Normalizing amplitudes:  94%|█████████▍| 15363/16384 [00:02<00:00, 6209.55probe position/s]Normalizing amplitudes:  98%|█████████▊| 15985/16384 [00:02<00:00, 6044.45probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6229.12probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random64_p1_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random64_p1_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.007631 in 4.357 sec
Iter: 2, Total Loss: 0.006529 in 4.174 sec
Iter: 3, Total Loss: 0.006488 in 4.130 sec
Iter: 4, Total Loss: 0.006448 in 4.425 sec
Iter: 5, Total Loss: 0.006412 in 4.192 sec
Iter: 6, Total Loss: 0.006377 in 4.161 sec
Iter: 7, Total Loss: 0.006344 in 3.995 sec
Iter: 8, Total Loss: 0.006314 in 4.111 sec
Iter: 9, Total Loss: 0.006286 in 4.079 sec
Iter: 10, Total Loss: 0.006257 in 4.311 sec
Iter: 11, Total Loss: 0.00623 in 4.137 sec
Iter: 12, Total Loss: 0.00621 in 4.113 sec
Iter: 13, Total Loss: 0.00619 in 4.186 sec
Iter: 14, Total Loss: 0.006169 in 4.237 sec
Iter: 15, Total Loss: 0.006153 in 4.157 sec
Iter: 16, Total Loss: 0.006137 in 4.234 sec
Iter: 17, Total Loss: 0.006121 in 4.470 sec
Iter: 18, Total Loss: 0.006109 in 4.216 sec
Iter: 19, Total Loss: 0.006099 in 4.189 sec
Iter: 20, Total Loss: 0.006087 in 4.369 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 4.212 with std = 0.117 sec ###
### py4DSTEM ptycho solver is finished in 1 min 25.964 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 918.32 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 64, 1, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 650/16384 [00:00<00:02, 6495.90probe position/s]Normalizing amplitudes:   8%|▊         | 1323/16384 [00:00<00:02, 6628.76probe position/s]Normalizing amplitudes:  12%|█▏        | 1999/16384 [00:00<00:02, 6685.12probe position/s]Normalizing amplitudes:  16%|█▋        | 2668/16384 [00:00<00:02, 6486.46probe position/s]Normalizing amplitudes:  20%|██        | 3327/16384 [00:00<00:02, 6521.76probe position/s]Normalizing amplitudes:  24%|██▍       | 4010/16384 [00:00<00:01, 6624.08probe position/s]Normalizing amplitudes:  29%|██▊       | 4681/16384 [00:00<00:01, 6650.41probe position/s]Normalizing amplitudes:  33%|███▎      | 5361/16384 [00:00<00:01, 6697.26probe position/s]Normalizing amplitudes:  37%|███▋      | 6032/16384 [00:00<00:01, 6656.26probe position/s]Normalizing amplitudes:  41%|████      | 6710/16384 [00:01<00:01, 6693.31probe position/s]Normalizing amplitudes:  45%|████▌     | 7380/16384 [00:01<00:01, 6653.82probe position/s]Normalizing amplitudes:  49%|████▉     | 8046/16384 [00:01<00:01, 6649.32probe position/s]Normalizing amplitudes:  53%|█████▎    | 8712/16384 [00:01<00:01, 5802.14probe position/s]Normalizing amplitudes:  57%|█████▋    | 9315/16384 [00:01<00:01, 5862.45probe position/s]Normalizing amplitudes:  61%|██████    | 9982/16384 [00:01<00:01, 6088.35probe position/s]Normalizing amplitudes:  65%|██████▌   | 10654/16384 [00:01<00:00, 6266.77probe position/s]Normalizing amplitudes:  69%|██████▉   | 11323/16384 [00:01<00:00, 6387.36probe position/s]Normalizing amplitudes:  73%|███████▎  | 11969/16384 [00:01<00:00, 5966.56probe position/s]Normalizing amplitudes:  77%|███████▋  | 12619/16384 [00:01<00:00, 6115.70probe position/s]Normalizing amplitudes:  81%|████████  | 13306/16384 [00:02<00:00, 6329.17probe position/s]Normalizing amplitudes:  85%|████████▌ | 13946/16384 [00:02<00:00, 5629.26probe position/s]Normalizing amplitudes:  89%|████████▉ | 14586/16384 [00:02<00:00, 5835.85probe position/s]Normalizing amplitudes:  93%|█████████▎| 15259/16384 [00:02<00:00, 6082.94probe position/s]Normalizing amplitudes:  97%|█████████▋| 15880/16384 [00:02<00:00, 6041.92probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6256.74probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random64_p1_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random64_p1_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.007716 in 7.880 sec
Iter: 2, Total Loss: 0.006578 in 7.797 sec
Iter: 3, Total Loss: 0.006518 in 7.757 sec
Iter: 4, Total Loss: 0.006471 in 8.038 sec
Iter: 5, Total Loss: 0.006427 in 8.461 sec
Iter: 6, Total Loss: 0.006389 in 8.276 sec
Iter: 7, Total Loss: 0.00635 in 8.202 sec
Iter: 8, Total Loss: 0.00632 in 8.031 sec
Iter: 9, Total Loss: 0.00629 in 7.841 sec
Iter: 10, Total Loss: 0.00626 in 7.946 sec
Iter: 11, Total Loss: 0.006232 in 8.242 sec
Iter: 12, Total Loss: 0.006208 in 8.066 sec
Iter: 13, Total Loss: 0.006182 in 7.977 sec
Iter: 14, Total Loss: 0.006156 in 7.818 sec
Iter: 15, Total Loss: 0.006136 in 8.096 sec
Iter: 16, Total Loss: 0.006114 in 8.032 sec
Iter: 17, Total Loss: 0.006092 in 8.153 sec
Iter: 18, Total Loss: 0.006074 in 7.972 sec
Iter: 19, Total Loss: 0.006056 in 8.068 sec
Iter: 20, Total Loss: 0.006038 in 8.120 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 8.039 with std = 0.172 sec ###
### py4DSTEM ptycho solver is finished in 2 min 42.656 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 912.87 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 64, 3, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 581/16384 [00:00<00:02, 5808.68probe position/s]Normalizing amplitudes:   8%|▊         | 1238/16384 [00:00<00:02, 6253.50probe position/s]Normalizing amplitudes:  11%|█▏        | 1864/16384 [00:00<00:02, 6108.56probe position/s]Normalizing amplitudes:  15%|█▌        | 2494/16384 [00:00<00:02, 6179.89probe position/s]Normalizing amplitudes:  19%|█▉        | 3114/16384 [00:00<00:02, 6181.16probe position/s]Normalizing amplitudes:  23%|██▎       | 3748/16384 [00:00<00:02, 6233.54probe position/s]Normalizing amplitudes:  27%|██▋       | 4403/16384 [00:00<00:01, 6335.64probe position/s]Normalizing amplitudes:  31%|███       | 5037/16384 [00:00<00:01, 6291.39probe position/s]Normalizing amplitudes:  35%|███▍      | 5667/16384 [00:00<00:01, 6270.55probe position/s]Normalizing amplitudes:  38%|███▊      | 6295/16384 [00:01<00:01, 6269.15probe position/s]Normalizing amplitudes:  42%|████▏     | 6922/16384 [00:01<00:01, 6157.97probe position/s]Normalizing amplitudes:  46%|████▌     | 7539/16384 [00:01<00:01, 6112.58probe position/s]Normalizing amplitudes:  50%|████▉     | 8151/16384 [00:01<00:01, 5968.73probe position/s]Normalizing amplitudes:  53%|█████▎    | 8749/16384 [00:01<00:01, 5931.72probe position/s]Normalizing amplitudes:  57%|█████▋    | 9411/16384 [00:01<00:01, 6132.54probe position/s]Normalizing amplitudes:  61%|██████    | 10031/16384 [00:01<00:01, 6150.64probe position/s]Normalizing amplitudes:  65%|██████▍   | 10647/16384 [00:01<00:00, 5947.54probe position/s]Normalizing amplitudes:  69%|██████▊   | 11244/16384 [00:01<00:00, 5854.96probe position/s]Normalizing amplitudes:  72%|███████▏  | 11831/16384 [00:01<00:00, 5781.12probe position/s]Normalizing amplitudes:  76%|███████▌  | 12410/16384 [00:02<00:00, 5738.02probe position/s]Normalizing amplitudes:  79%|███████▉  | 13004/16384 [00:02<00:00, 5794.72probe position/s]Normalizing amplitudes:  83%|████████▎ | 13633/16384 [00:02<00:00, 5938.83probe position/s]Normalizing amplitudes:  87%|████████▋ | 14228/16384 [00:02<00:00, 5901.41probe position/s]Normalizing amplitudes:  90%|█████████ | 14819/16384 [00:02<00:00, 5810.30probe position/s]Normalizing amplitudes:  94%|█████████▍| 15431/16384 [00:02<00:00, 5900.40probe position/s]Normalizing amplitudes:  98%|█████████▊| 16022/16384 [00:02<00:00, 5581.53probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5931.63probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random64_p3_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random64_p3_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.01071 in 4.013 sec
Iter: 2, Total Loss: 0.006434 in 4.013 sec
Iter: 3, Total Loss: 0.006338 in 4.117 sec
Iter: 4, Total Loss: 0.006255 in 4.125 sec
Iter: 5, Total Loss: 0.006173 in 4.027 sec
Iter: 6, Total Loss: 0.006093 in 4.096 sec
Iter: 7, Total Loss: 0.006014 in 4.038 sec
Iter: 8, Total Loss: 0.005941 in 3.996 sec
Iter: 9, Total Loss: 0.005871 in 4.018 sec
Iter: 10, Total Loss: 0.005808 in 4.079 sec
Iter: 11, Total Loss: 0.005749 in 4.118 sec
Iter: 12, Total Loss: 0.005697 in 4.020 sec
Iter: 13, Total Loss: 0.00565 in 4.076 sec
Iter: 14, Total Loss: 0.005609 in 4.022 sec
Iter: 15, Total Loss: 0.005572 in 4.007 sec
Iter: 16, Total Loss: 0.005541 in 4.018 sec
Iter: 17, Total Loss: 0.005513 in 3.911 sec
Iter: 18, Total Loss: 0.005489 in 3.964 sec
Iter: 19, Total Loss: 0.005467 in 3.980 sec
Iter: 20, Total Loss: 0.005448 in 4.015 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 4.033 with std = 0.054 sec ###
### py4DSTEM ptycho solver is finished in 1 min 22.663 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 911.52 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 64, 3, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 614/16384 [00:00<00:02, 6132.43probe position/s]Normalizing amplitudes:   7%|▋         | 1228/16384 [00:00<00:02, 5886.73probe position/s]Normalizing amplitudes:  11%|█         | 1818/16384 [00:00<00:02, 5650.56probe position/s]Normalizing amplitudes:  15%|█▍        | 2451/16384 [00:00<00:02, 5905.95probe position/s]Normalizing amplitudes:  19%|█▊        | 3054/16384 [00:00<00:02, 5948.23probe position/s]Normalizing amplitudes:  22%|██▏       | 3674/16384 [00:00<00:02, 6030.28probe position/s]Normalizing amplitudes:  26%|██▌       | 4288/16384 [00:00<00:01, 6064.93probe position/s]Normalizing amplitudes:  30%|██▉       | 4896/16384 [00:00<00:01, 5885.10probe position/s]Normalizing amplitudes:  34%|███▍      | 5555/16384 [00:00<00:01, 6096.93probe position/s]Normalizing amplitudes:  38%|███▊      | 6186/16384 [00:01<00:01, 6159.41probe position/s]Normalizing amplitudes:  42%|████▏     | 6804/16384 [00:01<00:01, 6084.83probe position/s]Normalizing amplitudes:  45%|████▌     | 7439/16384 [00:01<00:01, 6162.09probe position/s]Normalizing amplitudes:  49%|████▉     | 8083/16384 [00:01<00:01, 6243.39probe position/s]Normalizing amplitudes:  53%|█████▎    | 8709/16384 [00:01<00:01, 6247.51probe position/s]Normalizing amplitudes:  57%|█████▋    | 9345/16384 [00:01<00:01, 6278.90probe position/s]Normalizing amplitudes:  61%|██████    | 9978/16384 [00:01<00:01, 6293.75probe position/s]Normalizing amplitudes:  65%|██████▍   | 10608/16384 [00:01<00:00, 6127.42probe position/s]Normalizing amplitudes:  69%|██████▊   | 11247/16384 [00:01<00:00, 6202.80probe position/s]Normalizing amplitudes:  72%|███████▏  | 11869/16384 [00:01<00:00, 6144.20probe position/s]Normalizing amplitudes:  76%|███████▌  | 12485/16384 [00:02<00:00, 6096.17probe position/s]Normalizing amplitudes:  80%|███████▉  | 13096/16384 [00:02<00:00, 5890.66probe position/s]Normalizing amplitudes:  84%|████████▎ | 13687/16384 [00:02<00:00, 5814.49probe position/s]Normalizing amplitudes:  87%|████████▋ | 14270/16384 [00:02<00:00, 5815.85probe position/s]Normalizing amplitudes:  91%|█████████ | 14853/16384 [00:02<00:00, 5796.48probe position/s]Normalizing amplitudes:  95%|█████████▍| 15507/16384 [00:02<00:00, 6013.38probe position/s]Normalizing amplitudes:  98%|█████████▊| 16113/16384 [00:02<00:00, 6024.52probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6040.98probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random64_p3_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random64_p3_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.01098 in 10.557 sec
Iter: 2, Total Loss: 0.006345 in 10.447 sec
Iter: 3, Total Loss: 0.006197 in 10.300 sec
Iter: 4, Total Loss: 0.00608 in 10.977 sec
Iter: 5, Total Loss: 0.005967 in 11.422 sec
Iter: 6, Total Loss: 0.005864 in 10.971 sec
Iter: 7, Total Loss: 0.005765 in 10.616 sec
Iter: 8, Total Loss: 0.005679 in 11.165 sec
Iter: 9, Total Loss: 0.005605 in 11.419 sec
Iter: 10, Total Loss: 0.005543 in 10.718 sec
Iter: 11, Total Loss: 0.005491 in 10.994 sec
Iter: 12, Total Loss: 0.005446 in 10.395 sec
Iter: 13, Total Loss: 0.005407 in 10.270 sec
Iter: 14, Total Loss: 0.005374 in 10.132 sec
Iter: 15, Total Loss: 0.005345 in 9.962 sec
Iter: 16, Total Loss: 0.005319 in 9.984 sec
Iter: 17, Total Loss: 0.005295 in 10.129 sec
Iter: 18, Total Loss: 0.005272 in 9.947 sec
Iter: 19, Total Loss: 0.005252 in 10.438 sec
Iter: 20, Total Loss: 0.005231 in 10.069 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 10.545 with std = 0.463 sec ###
### py4DSTEM ptycho solver is finished in 3 min 32.757 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 917.04 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 64, 3, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 647/16384 [00:00<00:02, 6463.35probe position/s]Normalizing amplitudes:   8%|▊         | 1294/16384 [00:00<00:02, 6378.09probe position/s]Normalizing amplitudes:  12%|█▏        | 1950/16384 [00:00<00:02, 6457.46probe position/s]Normalizing amplitudes:  16%|█▌        | 2632/16384 [00:00<00:02, 6599.75probe position/s]Normalizing amplitudes:  20%|██        | 3293/16384 [00:00<00:01, 6579.53probe position/s]Normalizing amplitudes:  24%|██▍       | 3952/16384 [00:00<00:01, 6511.98probe position/s]Normalizing amplitudes:  28%|██▊       | 4604/16384 [00:00<00:01, 6354.94probe position/s]Normalizing amplitudes:  32%|███▏      | 5241/16384 [00:00<00:01, 6253.34probe position/s]Normalizing amplitudes:  36%|███▌      | 5867/16384 [00:00<00:01, 6219.02probe position/s]Normalizing amplitudes:  40%|███▉      | 6521/16384 [00:01<00:01, 6315.10probe position/s]Normalizing amplitudes:  44%|████▍     | 7168/16384 [00:01<00:01, 6360.96probe position/s]Normalizing amplitudes:  48%|████▊     | 7805/16384 [00:01<00:01, 6182.27probe position/s]Normalizing amplitudes:  51%|█████▏    | 8425/16384 [00:01<00:01, 6164.35probe position/s]Normalizing amplitudes:  55%|█████▌    | 9077/16384 [00:01<00:01, 6267.64probe position/s]Normalizing amplitudes:  59%|█████▉    | 9728/16384 [00:01<00:01, 6338.36probe position/s]Normalizing amplitudes:  63%|██████▎   | 10387/16384 [00:01<00:00, 6411.83probe position/s]Normalizing amplitudes:  67%|██████▋   | 11052/16384 [00:01<00:00, 6482.71probe position/s]Normalizing amplitudes:  71%|███████▏  | 11705/16384 [00:01<00:00, 6491.42probe position/s]Normalizing amplitudes:  75%|███████▌  | 12355/16384 [00:01<00:00, 6442.29probe position/s]Normalizing amplitudes:  79%|███████▉  | 13001/16384 [00:02<00:00, 6446.52probe position/s]Normalizing amplitudes:  83%|████████▎ | 13662/16384 [00:02<00:00, 6492.84probe position/s]Normalizing amplitudes:  87%|████████▋ | 14312/16384 [00:02<00:00, 6424.01probe position/s]Normalizing amplitudes:  91%|█████████▏| 14955/16384 [00:02<00:00, 6252.13probe position/s]Normalizing amplitudes:  95%|█████████▌| 15582/16384 [00:02<00:00, 6235.11probe position/s]Normalizing amplitudes:  99%|█████████▉| 16207/16384 [00:02<00:00, 6232.59probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6346.35probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random64_p3_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random64_p3_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.01192 in 20.142 sec
Iter: 2, Total Loss: 0.006302 in 20.206 sec
Iter: 3, Total Loss: 0.006109 in 20.399 sec
Iter: 4, Total Loss: 0.005977 in 20.409 sec
Iter: 5, Total Loss: 0.005861 in 20.803 sec
Iter: 6, Total Loss: 0.005764 in 20.988 sec
Iter: 7, Total Loss: 0.005677 in 20.683 sec
Iter: 8, Total Loss: 0.005603 in 20.516 sec
Iter: 9, Total Loss: 0.005542 in 20.283 sec
Iter: 10, Total Loss: 0.005489 in 20.552 sec
Iter: 11, Total Loss: 0.005445 in 20.607 sec
Iter: 12, Total Loss: 0.005408 in 20.478 sec
Iter: 13, Total Loss: 0.005375 in 20.288 sec
Iter: 14, Total Loss: 0.005348 in 20.188 sec
Iter: 15, Total Loss: 0.005323 in 20.596 sec
Iter: 16, Total Loss: 0.005303 in 20.187 sec
Iter: 17, Total Loss: 0.005284 in 19.895 sec
Iter: 18, Total Loss: 0.005265 in 19.821 sec
Iter: 19, Total Loss: 0.005248 in 19.480 sec
Iter: 20, Total Loss: 0.005231 in 21.028 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 20.377 with std = 0.371 sec ###
### py4DSTEM ptycho solver is finished in 6 min 49.408 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 919.82 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 64, 6, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 648/16384 [00:00<00:02, 6474.03probe position/s]Normalizing amplitudes:   8%|▊         | 1300/16384 [00:00<00:02, 6496.62probe position/s]Normalizing amplitudes:  12%|█▏        | 1973/16384 [00:00<00:02, 6599.87probe position/s]Normalizing amplitudes:  16%|█▌        | 2661/16384 [00:00<00:02, 6707.34probe position/s]Normalizing amplitudes:  20%|██        | 3339/16384 [00:00<00:01, 6731.96probe position/s]Normalizing amplitudes:  24%|██▍       | 4013/16384 [00:00<00:01, 6638.71probe position/s]Normalizing amplitudes:  29%|██▊       | 4678/16384 [00:00<00:01, 6453.51probe position/s]Normalizing amplitudes:  33%|███▎      | 5325/16384 [00:00<00:01, 6438.42probe position/s]Normalizing amplitudes:  36%|███▋      | 5970/16384 [00:00<00:01, 6254.10probe position/s]Normalizing amplitudes:  40%|████      | 6628/16384 [00:01<00:01, 6350.80probe position/s]Normalizing amplitudes:  45%|████▍     | 7297/16384 [00:01<00:01, 6450.65probe position/s]Normalizing amplitudes:  49%|████▊     | 7959/16384 [00:01<00:01, 6499.98probe position/s]Normalizing amplitudes:  53%|█████▎    | 8610/16384 [00:01<00:01, 5526.17probe position/s]Normalizing amplitudes:  56%|█████▌    | 9188/16384 [00:01<00:01, 5311.25probe position/s]Normalizing amplitudes:  60%|██████    | 9842/16384 [00:01<00:01, 5636.16probe position/s]Normalizing amplitudes:  64%|██████▍   | 10515/16384 [00:01<00:00, 5935.89probe position/s]Normalizing amplitudes:  68%|██████▊   | 11184/16384 [00:01<00:00, 6146.43probe position/s]Normalizing amplitudes:  72%|███████▏  | 11854/16384 [00:01<00:00, 6304.72probe position/s]Normalizing amplitudes:  76%|███████▋  | 12520/16384 [00:02<00:00, 6407.63probe position/s]Normalizing amplitudes:  80%|████████  | 13168/16384 [00:02<00:00, 6415.24probe position/s]Normalizing amplitudes:  84%|████████▍ | 13842/16384 [00:02<00:00, 6510.40probe position/s]Normalizing amplitudes:  89%|████████▊ | 14513/16384 [00:02<00:00, 6567.64probe position/s]Normalizing amplitudes:  93%|█████████▎| 15173/16384 [00:02<00:00, 6510.63probe position/s]Normalizing amplitudes:  97%|█████████▋| 15862/16384 [00:02<00:00, 6622.12probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6314.84probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random64_p6_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random64_p6_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.01933 in 7.185 sec
Iter: 2, Total Loss: 0.006455 in 7.037 sec
Iter: 3, Total Loss: 0.006338 in 6.822 sec
Iter: 4, Total Loss: 0.006246 in 7.109 sec
Iter: 5, Total Loss: 0.00616 in 7.345 sec
Iter: 6, Total Loss: 0.006075 in 7.446 sec
Iter: 7, Total Loss: 0.005991 in 7.059 sec
Iter: 8, Total Loss: 0.005911 in 7.075 sec
Iter: 9, Total Loss: 0.005834 in 7.206 sec
Iter: 10, Total Loss: 0.005761 in 7.206 sec
Iter: 11, Total Loss: 0.005693 in 7.252 sec
Iter: 12, Total Loss: 0.00563 in 7.209 sec
Iter: 13, Total Loss: 0.005572 in 7.029 sec
Iter: 14, Total Loss: 0.005519 in 7.041 sec
Iter: 15, Total Loss: 0.00547 in 7.117 sec
Iter: 16, Total Loss: 0.005425 in 7.102 sec
Iter: 17, Total Loss: 0.005383 in 7.156 sec
Iter: 18, Total Loss: 0.005343 in 7.182 sec
Iter: 19, Total Loss: 0.005303 in 7.054 sec
Iter: 20, Total Loss: 0.005264 in 7.149 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 7.139 with std = 0.127 sec ###
### py4DSTEM ptycho solver is finished in 2 min 24.574 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 911.47 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 64, 6, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 619/16384 [00:00<00:02, 6169.41probe position/s]Normalizing amplitudes:   8%|▊         | 1236/16384 [00:00<00:02, 5865.66probe position/s]Normalizing amplitudes:  11%|█         | 1824/16384 [00:00<00:02, 5730.35probe position/s]Normalizing amplitudes:  15%|█▌        | 2483/16384 [00:00<00:02, 6057.49probe position/s]Normalizing amplitudes:  19%|█▉        | 3091/16384 [00:00<00:02, 6048.91probe position/s]Normalizing amplitudes:  23%|██▎       | 3744/16384 [00:00<00:02, 6208.94probe position/s]Normalizing amplitudes:  27%|██▋       | 4405/16384 [00:00<00:01, 6336.87probe position/s]Normalizing amplitudes:  31%|███       | 5045/16384 [00:00<00:01, 6354.30probe position/s]Normalizing amplitudes:  35%|███▍      | 5681/16384 [00:00<00:01, 6297.80probe position/s]Normalizing amplitudes:  39%|███▊      | 6312/16384 [00:01<00:01, 6276.14probe position/s]Normalizing amplitudes:  43%|████▎     | 6968/16384 [00:01<00:01, 6359.28probe position/s]Normalizing amplitudes:  46%|████▋     | 7605/16384 [00:01<00:01, 6362.26probe position/s]Normalizing amplitudes:  50%|█████     | 8242/16384 [00:01<00:01, 6343.97probe position/s]Normalizing amplitudes:  54%|█████▍    | 8877/16384 [00:01<00:01, 6123.97probe position/s]Normalizing amplitudes:  58%|█████▊    | 9499/16384 [00:01<00:01, 6151.86probe position/s]Normalizing amplitudes:  62%|██████▏   | 10145/16384 [00:01<00:01, 6238.74probe position/s]Normalizing amplitudes:  66%|██████▌   | 10802/16384 [00:01<00:00, 6335.81probe position/s]Normalizing amplitudes:  70%|██████▉   | 11443/16384 [00:01<00:00, 6355.73probe position/s]Normalizing amplitudes:  74%|███████▍  | 12100/16384 [00:01<00:00, 6418.62probe position/s]Normalizing amplitudes:  78%|███████▊  | 12743/16384 [00:02<00:00, 6415.33probe position/s]Normalizing amplitudes:  82%|████████▏ | 13428/16384 [00:02<00:00, 6543.19probe position/s]Normalizing amplitudes:  86%|████████▌ | 14083/16384 [00:02<00:00, 6337.35probe position/s]Normalizing amplitudes:  90%|████████▉ | 14719/16384 [00:02<00:00, 6224.18probe position/s]Normalizing amplitudes:  94%|█████████▎| 15351/16384 [00:02<00:00, 6251.44probe position/s]Normalizing amplitudes:  98%|█████████▊| 16002/16384 [00:02<00:00, 6325.59probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6275.93probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random64_p6_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random64_p6_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.01968 in 20.081 sec
Iter: 2, Total Loss: 0.006326 in 19.889 sec
Iter: 3, Total Loss: 0.006122 in 20.238 sec
Iter: 4, Total Loss: 0.005969 in 20.588 sec
Iter: 5, Total Loss: 0.005827 in 21.079 sec
Iter: 6, Total Loss: 0.005698 in 20.391 sec
Iter: 7, Total Loss: 0.005585 in 20.111 sec
Iter: 8, Total Loss: 0.005487 in 20.441 sec
Iter: 9, Total Loss: 0.005405 in 20.051 sec
Iter: 10, Total Loss: 0.005335 in 20.350 sec
Iter: 11, Total Loss: 0.005276 in 19.926 sec
Iter: 12, Total Loss: 0.005223 in 19.833 sec
Iter: 13, Total Loss: 0.005174 in 20.100 sec
Iter: 14, Total Loss: 0.005128 in 19.766 sec
Iter: 15, Total Loss: 0.005083 in 19.753 sec
Iter: 16, Total Loss: 0.005041 in 19.894 sec
Iter: 17, Total Loss: 0.005 in 20.978 sec
Iter: 18, Total Loss: 0.004963 in 20.285 sec
Iter: 19, Total Loss: 0.00493 in 20.246 sec
Iter: 20, Total Loss: 0.0049 in 20.362 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 20.218 with std = 0.355 sec ###
### py4DSTEM ptycho solver is finished in 6 min 46.978 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 911.59 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 64, 6, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 614/16384 [00:00<00:02, 6136.35probe position/s]Normalizing amplitudes:   8%|▊         | 1261/16384 [00:00<00:02, 6331.28probe position/s]Normalizing amplitudes:  12%|█▏        | 1920/16384 [00:00<00:02, 6444.59probe position/s]Normalizing amplitudes:  16%|█▌        | 2565/16384 [00:00<00:02, 6336.04probe position/s]Normalizing amplitudes:  20%|█▉        | 3227/16384 [00:00<00:02, 6434.33probe position/s]Normalizing amplitudes:  24%|██▎       | 3871/16384 [00:00<00:01, 6414.62probe position/s]Normalizing amplitudes:  28%|██▊       | 4535/16384 [00:00<00:01, 6487.59probe position/s]Normalizing amplitudes:  32%|███▏      | 5184/16384 [00:00<00:01, 6372.72probe position/s]Normalizing amplitudes:  36%|███▌      | 5822/16384 [00:00<00:01, 6367.40probe position/s]Normalizing amplitudes:  39%|███▉      | 6460/16384 [00:01<00:01, 6253.08probe position/s]Normalizing amplitudes:  43%|████▎     | 7086/16384 [00:01<00:01, 6033.05probe position/s]Normalizing amplitudes:  47%|████▋     | 7691/16384 [00:01<00:01, 5948.94probe position/s]Normalizing amplitudes:  51%|█████     | 8287/16384 [00:01<00:01, 5511.50probe position/s]Normalizing amplitudes:  54%|█████▍    | 8889/16384 [00:01<00:01, 5650.94probe position/s]Normalizing amplitudes:  58%|█████▊    | 9501/16384 [00:01<00:01, 5783.66probe position/s]Normalizing amplitudes:  62%|██████▏   | 10149/16384 [00:01<00:01, 5983.26probe position/s]Normalizing amplitudes:  66%|██████▌   | 10752/16384 [00:01<00:00, 5947.89probe position/s]Normalizing amplitudes:  69%|██████▉   | 11350/16384 [00:01<00:00, 5878.24probe position/s]Normalizing amplitudes:  73%|███████▎  | 11940/16384 [00:01<00:00, 5620.15probe position/s]Normalizing amplitudes:  77%|███████▋  | 12566/16384 [00:02<00:00, 5802.37probe position/s]Normalizing amplitudes:  80%|████████  | 13179/16384 [00:02<00:00, 5895.99probe position/s]Normalizing amplitudes:  84%|████████▍ | 13801/16384 [00:02<00:00, 5990.31probe position/s]Normalizing amplitudes:  88%|████████▊ | 14442/16384 [00:02<00:00, 6112.46probe position/s]Normalizing amplitudes:  92%|█████████▏| 15122/16384 [00:02<00:00, 6315.82probe position/s]Normalizing amplitudes:  96%|█████████▋| 15783/16384 [00:02<00:00, 6402.74probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6115.28probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random64_p6_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random64_p6_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.02139 in 40.663 sec
Iter: 2, Total Loss: 0.00635 in 40.916 sec
Iter: 3, Total Loss: 0.006062 in 39.977 sec
Iter: 4, Total Loss: 0.005901 in 40.229 sec
Iter: 5, Total Loss: 0.005768 in 39.698 sec
Iter: 6, Total Loss: 0.005651 in 39.467 sec
Iter: 7, Total Loss: 0.00555 in 38.767 sec
Iter: 8, Total Loss: 0.005464 in 38.606 sec
Iter: 9, Total Loss: 0.005389 in 38.439 sec
Iter: 10, Total Loss: 0.005324 in 39.206 sec
Iter: 11, Total Loss: 0.005264 in 39.689 sec
Iter: 12, Total Loss: 0.00521 in 39.380 sec
Iter: 13, Total Loss: 0.005159 in 40.242 sec
Iter: 14, Total Loss: 0.005114 in 39.796 sec
Iter: 15, Total Loss: 0.005068 in 39.833 sec
Iter: 16, Total Loss: 0.005025 in 39.550 sec
Iter: 17, Total Loss: 0.004983 in 39.357 sec
Iter: 18, Total Loss: 0.004944 in 39.588 sec
Iter: 19, Total Loss: 0.004906 in 41.227 sec
Iter: 20, Total Loss: 0.004871 in 39.325 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 39.698 with std = 0.699 sec ###
### py4DSTEM ptycho solver is finished in 13 min 15.762 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 908.76 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 64, 12, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 613/16384 [00:00<00:02, 6123.74probe position/s]Normalizing amplitudes:   8%|▊         | 1245/16384 [00:00<00:02, 6234.07probe position/s]Normalizing amplitudes:  11%|█▏        | 1881/16384 [00:00<00:02, 6287.54probe position/s]Normalizing amplitudes:  15%|█▌        | 2512/16384 [00:00<00:02, 6293.12probe position/s]Normalizing amplitudes:  19%|█▉        | 3164/16384 [00:00<00:02, 6374.39probe position/s]Normalizing amplitudes:  23%|██▎       | 3802/16384 [00:00<00:02, 6247.11probe position/s]Normalizing amplitudes:  27%|██▋       | 4428/16384 [00:00<00:01, 6088.94probe position/s]Normalizing amplitudes:  31%|███       | 5038/16384 [00:00<00:01, 5942.95probe position/s]Normalizing amplitudes:  34%|███▍      | 5643/16384 [00:00<00:01, 5974.46probe position/s]Normalizing amplitudes:  38%|███▊      | 6242/16384 [00:01<00:01, 5956.48probe position/s]Normalizing amplitudes:  42%|████▏     | 6863/16384 [00:01<00:01, 6031.63probe position/s]Normalizing amplitudes:  46%|████▌     | 7508/16384 [00:01<00:01, 6154.86probe position/s]Normalizing amplitudes:  50%|████▉     | 8125/16384 [00:01<00:01, 6082.83probe position/s]Normalizing amplitudes:  53%|█████▎    | 8734/16384 [00:01<00:01, 5894.98probe position/s]Normalizing amplitudes:  57%|█████▋    | 9326/16384 [00:01<00:01, 5902.21probe position/s]Normalizing amplitudes:  61%|██████    | 9918/16384 [00:01<00:01, 5815.07probe position/s]Normalizing amplitudes:  64%|██████▍   | 10501/16384 [00:01<00:01, 5794.13probe position/s]Normalizing amplitudes:  68%|██████▊   | 11081/16384 [00:01<00:00, 5789.34probe position/s]Normalizing amplitudes:  72%|███████▏  | 11733/16384 [00:01<00:00, 6004.79probe position/s]Normalizing amplitudes:  76%|███████▌  | 12375/16384 [00:02<00:00, 6127.74probe position/s]Normalizing amplitudes:  79%|███████▉  | 12989/16384 [00:02<00:00, 6057.70probe position/s]Normalizing amplitudes:  83%|████████▎ | 13609/16384 [00:02<00:00, 6098.45probe position/s]Normalizing amplitudes:  87%|████████▋ | 14221/16384 [00:02<00:00, 6103.77probe position/s]Normalizing amplitudes:  91%|█████████ | 14832/16384 [00:02<00:00, 5847.97probe position/s]Normalizing amplitudes:  94%|█████████▍| 15467/16384 [00:02<00:00, 5991.16probe position/s]Normalizing amplitudes:  98%|█████████▊| 16124/16384 [00:02<00:00, 6159.10probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6052.17probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random64_p12_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random64_p12_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.04114 in 13.758 sec
Iter: 2, Total Loss: 0.006477 in 13.858 sec
Iter: 3, Total Loss: 0.006294 in 13.999 sec
Iter: 4, Total Loss: 0.006167 in 13.755 sec
Iter: 5, Total Loss: 0.006054 in 14.079 sec
Iter: 6, Total Loss: 0.005947 in 14.184 sec
Iter: 7, Total Loss: 0.005848 in 13.885 sec
Iter: 8, Total Loss: 0.00576 in 14.017 sec
Iter: 9, Total Loss: 0.005682 in 14.010 sec
Iter: 10, Total Loss: 0.005612 in 14.068 sec
Iter: 11, Total Loss: 0.005549 in 14.176 sec
Iter: 12, Total Loss: 0.005489 in 13.978 sec
Iter: 13, Total Loss: 0.005432 in 14.152 sec
Iter: 14, Total Loss: 0.005377 in 14.189 sec
Iter: 15, Total Loss: 0.005324 in 14.343 sec
Iter: 16, Total Loss: 0.005273 in 14.395 sec
Iter: 17, Total Loss: 0.005222 in 14.232 sec
Iter: 18, Total Loss: 0.005171 in 14.302 sec
Iter: 19, Total Loss: 0.005122 in 14.216 sec
Iter: 20, Total Loss: 0.005074 in 14.214 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 14.091 with std = 0.178 sec ###
### py4DSTEM ptycho solver is finished in 4 min 44.279 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 900.99 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 64, 12, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 656/16384 [00:00<00:02, 6553.51probe position/s]Normalizing amplitudes:   8%|▊         | 1312/16384 [00:00<00:02, 6482.97probe position/s]Normalizing amplitudes:  12%|█▏        | 1961/16384 [00:00<00:02, 6395.20probe position/s]Normalizing amplitudes:  16%|█▌        | 2601/16384 [00:00<00:02, 6320.84probe position/s]Normalizing amplitudes:  20%|█▉        | 3247/16384 [00:00<00:02, 6367.74probe position/s]Normalizing amplitudes:  24%|██▍       | 3892/16384 [00:00<00:01, 6394.31probe position/s]Normalizing amplitudes:  28%|██▊       | 4532/16384 [00:00<00:01, 6365.22probe position/s]Normalizing amplitudes:  32%|███▏      | 5177/16384 [00:00<00:01, 6390.18probe position/s]Normalizing amplitudes:  36%|███▌      | 5817/16384 [00:00<00:01, 6182.46probe position/s]Normalizing amplitudes:  39%|███▉      | 6451/16384 [00:01<00:01, 6227.49probe position/s]Normalizing amplitudes:  43%|████▎     | 7077/16384 [00:01<00:01, 6235.14probe position/s]Normalizing amplitudes:  47%|████▋     | 7702/16384 [00:01<00:01, 6169.50probe position/s]Normalizing amplitudes:  51%|█████     | 8322/16384 [00:01<00:01, 6177.36probe position/s]Normalizing amplitudes:  55%|█████▍    | 8947/16384 [00:01<00:01, 6196.48probe position/s]Normalizing amplitudes:  58%|█████▊    | 9567/16384 [00:01<00:01, 6156.24probe position/s]Normalizing amplitudes:  62%|██████▏   | 10198/16384 [00:01<00:00, 6197.50probe position/s]Normalizing amplitudes:  66%|██████▌   | 10848/16384 [00:01<00:00, 6285.90probe position/s]Normalizing amplitudes:  70%|███████   | 11477/16384 [00:01<00:00, 6284.90probe position/s]Normalizing amplitudes:  74%|███████▍  | 12108/16384 [00:01<00:00, 6291.51probe position/s]Normalizing amplitudes:  78%|███████▊  | 12741/16384 [00:02<00:00, 6300.55probe position/s]Normalizing amplitudes:  82%|████████▏ | 13392/16384 [00:02<00:00, 6360.84probe position/s]Normalizing amplitudes:  86%|████████▌ | 14029/16384 [00:02<00:00, 6190.58probe position/s]Normalizing amplitudes:  89%|████████▉ | 14663/16384 [00:02<00:00, 6233.41probe position/s]Normalizing amplitudes:  93%|█████████▎| 15312/16384 [00:02<00:00, 6308.06probe position/s]Normalizing amplitudes:  97%|█████████▋| 15944/16384 [00:02<00:00, 6292.02probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6282.05probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random64_p12_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random64_p12_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.0419 in 40.384 sec
Iter: 2, Total Loss: 0.006412 in 40.098 sec
Iter: 3, Total Loss: 0.006126 in 40.193 sec
Iter: 4, Total Loss: 0.005964 in 39.841 sec
Iter: 5, Total Loss: 0.005817 in 40.272 sec
Iter: 6, Total Loss: 0.005684 in 40.261 sec
Iter: 7, Total Loss: 0.005564 in 40.047 sec
Iter: 8, Total Loss: 0.005463 in 39.971 sec
Iter: 9, Total Loss: 0.005379 in 39.726 sec
Iter: 10, Total Loss: 0.005305 in 40.134 sec
Iter: 11, Total Loss: 0.005239 in 40.484 sec
Iter: 12, Total Loss: 0.005178 in 40.645 sec
Iter: 13, Total Loss: 0.005119 in 40.384 sec
Iter: 14, Total Loss: 0.005063 in 39.937 sec
Iter: 15, Total Loss: 0.005007 in 40.768 sec
Iter: 16, Total Loss: 0.004954 in 40.947 sec
Iter: 17, Total Loss: 0.004904 in 39.507 sec
Iter: 18, Total Loss: 0.004859 in 39.878 sec
Iter: 19, Total Loss: 0.00482 in 40.786 sec
Iter: 20, Total Loss: 0.004785 in 40.672 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 40.247 with std = 0.378 sec ###
### py4DSTEM ptycho solver is finished in 13 min 27.306 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 902.10 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 64, 12, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 615/16384 [00:00<00:02, 6146.68probe position/s]Normalizing amplitudes:   8%|▊         | 1230/16384 [00:00<00:02, 5466.56probe position/s]Normalizing amplitudes:  11%|█         | 1831/16384 [00:00<00:02, 5698.21probe position/s]Normalizing amplitudes:  15%|█▌        | 2459/16384 [00:00<00:02, 5915.04probe position/s]Normalizing amplitudes:  19%|█▉        | 3080/16384 [00:00<00:02, 6018.27probe position/s]Normalizing amplitudes:  22%|██▏       | 3685/16384 [00:00<00:02, 5938.88probe position/s]Normalizing amplitudes:  26%|██▌       | 4292/16384 [00:00<00:02, 5979.91probe position/s]Normalizing amplitudes:  30%|██▉       | 4907/16384 [00:00<00:01, 6031.65probe position/s]Normalizing amplitudes:  34%|███▎      | 5515/16384 [00:00<00:01, 6045.18probe position/s]Normalizing amplitudes:  37%|███▋      | 6141/16384 [00:01<00:01, 6110.69probe position/s]Normalizing amplitudes:  41%|████▏     | 6772/16384 [00:01<00:01, 6169.85probe position/s]Normalizing amplitudes:  45%|████▌     | 7390/16384 [00:01<00:01, 6167.94probe position/s]Normalizing amplitudes:  49%|████▉     | 8009/16384 [00:01<00:01, 6172.22probe position/s]Normalizing amplitudes:  53%|█████▎    | 8627/16384 [00:01<00:01, 6110.99probe position/s]Normalizing amplitudes:  56%|█████▋    | 9239/16384 [00:01<00:01, 6023.93probe position/s]Normalizing amplitudes:  60%|██████    | 9842/16384 [00:01<00:01, 6020.90probe position/s]Normalizing amplitudes:  64%|██████▍   | 10445/16384 [00:01<00:01, 5924.18probe position/s]Normalizing amplitudes:  67%|██████▋   | 11038/16384 [00:01<00:00, 5841.72probe position/s]Normalizing amplitudes:  71%|███████   | 11637/16384 [00:01<00:00, 5884.57probe position/s]Normalizing amplitudes:  75%|███████▍  | 12269/16384 [00:02<00:00, 6011.73probe position/s]Normalizing amplitudes:  79%|███████▊  | 12881/16384 [00:02<00:00, 6041.30probe position/s]Normalizing amplitudes:  83%|████████▎ | 13518/16384 [00:02<00:00, 6137.11probe position/s]Normalizing amplitudes:  86%|████████▋ | 14133/16384 [00:02<00:00, 5949.38probe position/s]Normalizing amplitudes:  90%|████████▉ | 14730/16384 [00:02<00:00, 5878.65probe position/s]Normalizing amplitudes:  94%|█████████▍| 15381/16384 [00:02<00:00, 6061.42probe position/s]Normalizing amplitudes:  98%|█████████▊| 16019/16384 [00:02<00:00, 6153.99probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6013.96probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random64_p12_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random64_p12_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.04348 in 80.929 sec
Iter: 2, Total Loss: 0.0064 in 80.255 sec
Iter: 3, Total Loss: 0.005921 in 81.672 sec
Iter: 4, Total Loss: 0.005721 in 79.314 sec
Iter: 5, Total Loss: 0.005579 in 80.754 sec
Iter: 6, Total Loss: 0.005468 in 81.031 sec
Iter: 7, Total Loss: 0.005377 in 80.945 sec
Iter: 8, Total Loss: 0.0053 in 80.341 sec
Iter: 9, Total Loss: 0.005229 in 78.856 sec
Iter: 10, Total Loss: 0.005162 in 82.606 sec
Iter: 11, Total Loss: 0.005099 in 83.743 sec
Iter: 12, Total Loss: 0.005037 in 81.110 sec
Iter: 13, Total Loss: 0.004978 in 83.456 sec
Iter: 14, Total Loss: 0.004922 in 81.219 sec
Iter: 15, Total Loss: 0.004869 in 80.697 sec
Iter: 16, Total Loss: 0.00482 in 80.237 sec
Iter: 17, Total Loss: 0.004776 in 85.204 sec
Iter: 18, Total Loss: 0.004738 in 81.268 sec
Iter: 19, Total Loss: 0.004705 in 82.721 sec
Iter: 20, Total Loss: 0.004676 in 83.532 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 81.495 with std = 1.550 sec ###
### py4DSTEM ptycho solver is finished in 27 min 12.019 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 909.92 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 32, 1, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 642/16384 [00:00<00:02, 6413.58probe position/s]Normalizing amplitudes:   8%|▊         | 1284/16384 [00:00<00:02, 6388.67probe position/s]Normalizing amplitudes:  12%|█▏        | 1923/16384 [00:00<00:02, 6296.68probe position/s]Normalizing amplitudes:  16%|█▌        | 2553/16384 [00:00<00:02, 6239.99probe position/s]Normalizing amplitudes:  19%|█▉        | 3178/16384 [00:00<00:02, 6159.96probe position/s]Normalizing amplitudes:  23%|██▎       | 3839/16384 [00:00<00:01, 6306.95probe position/s]Normalizing amplitudes:  27%|██▋       | 4471/16384 [00:00<00:01, 6279.71probe position/s]Normalizing amplitudes:  31%|███       | 5100/16384 [00:00<00:01, 6245.18probe position/s]Normalizing amplitudes:  35%|███▍      | 5725/16384 [00:00<00:01, 6240.23probe position/s]Normalizing amplitudes:  39%|███▉      | 6371/16384 [00:01<00:01, 6305.26probe position/s]Normalizing amplitudes:  43%|████▎     | 7002/16384 [00:01<00:01, 6207.83probe position/s]Normalizing amplitudes:  47%|████▋     | 7624/16384 [00:01<00:01, 6185.10probe position/s]Normalizing amplitudes:  51%|█████     | 8274/16384 [00:01<00:01, 6277.10probe position/s]Normalizing amplitudes:  55%|█████▍    | 8940/16384 [00:01<00:01, 6391.33probe position/s]Normalizing amplitudes:  59%|█████▊    | 9621/16384 [00:01<00:01, 6512.91probe position/s]Normalizing amplitudes:  63%|██████▎   | 10273/16384 [00:01<00:00, 6411.59probe position/s]Normalizing amplitudes:  67%|██████▋   | 10915/16384 [00:01<00:00, 6232.07probe position/s]Normalizing amplitudes:  70%|███████   | 11540/16384 [00:01<00:00, 6115.45probe position/s]Normalizing amplitudes:  74%|███████▍  | 12153/16384 [00:01<00:00, 6113.75probe position/s]Normalizing amplitudes:  78%|███████▊  | 12813/16384 [00:02<00:00, 6255.96probe position/s]Normalizing amplitudes:  82%|████████▏ | 13456/16384 [00:02<00:00, 6306.33probe position/s]Normalizing amplitudes:  86%|████████▌ | 14117/16384 [00:02<00:00, 6396.27probe position/s]Normalizing amplitudes:  90%|█████████ | 14773/16384 [00:02<00:00, 6443.53probe position/s]Normalizing amplitudes:  94%|█████████▍| 15418/16384 [00:02<00:00, 5537.81probe position/s]Normalizing amplitudes:  98%|█████████▊| 16043/16384 [00:02<00:00, 5727.93probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6177.93probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random32_p1_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random32_p1_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.007089 in 3.947 sec
Iter: 2, Total Loss: 0.006534 in 3.713 sec
Iter: 3, Total Loss: 0.006479 in 3.643 sec
Iter: 4, Total Loss: 0.006424 in 3.539 sec
Iter: 5, Total Loss: 0.006371 in 3.539 sec
Iter: 6, Total Loss: 0.00632 in 3.592 sec
Iter: 7, Total Loss: 0.006276 in 3.733 sec
Iter: 8, Total Loss: 0.006239 in 3.747 sec
Iter: 9, Total Loss: 0.006206 in 3.724 sec
Iter: 10, Total Loss: 0.00618 in 3.813 sec
Iter: 11, Total Loss: 0.006159 in 3.713 sec
Iter: 12, Total Loss: 0.00614 in 3.649 sec
Iter: 13, Total Loss: 0.006126 in 3.783 sec
Iter: 14, Total Loss: 0.006114 in 3.719 sec
Iter: 15, Total Loss: 0.006105 in 3.985 sec
Iter: 16, Total Loss: 0.006096 in 3.905 sec
Iter: 17, Total Loss: 0.00609 in 3.628 sec
Iter: 18, Total Loss: 0.006085 in 3.594 sec
Iter: 19, Total Loss: 0.00608 in 3.687 sec
Iter: 20, Total Loss: 0.006076 in 3.692 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 3.717 with std = 0.120 sec ###
### py4DSTEM ptycho solver is finished in 1 min 16.361 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 906.10 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 32, 1, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 575/16384 [00:00<00:02, 5739.39probe position/s]Normalizing amplitudes:   7%|▋         | 1149/16384 [00:00<00:02, 5688.90probe position/s]Normalizing amplitudes:  11%|█         | 1751/16384 [00:00<00:02, 5837.33probe position/s]Normalizing amplitudes:  14%|█▍        | 2335/16384 [00:00<00:02, 5769.34probe position/s]Normalizing amplitudes:  18%|█▊        | 2971/16384 [00:00<00:02, 5976.40probe position/s]Normalizing amplitudes:  22%|██▏       | 3587/16384 [00:00<00:02, 6035.90probe position/s]Normalizing amplitudes:  26%|██▌       | 4191/16384 [00:00<00:02, 5980.45probe position/s]Normalizing amplitudes:  30%|██▉       | 4848/16384 [00:00<00:01, 6166.15probe position/s]Normalizing amplitudes:  33%|███▎      | 5465/16384 [00:00<00:01, 5861.03probe position/s]Normalizing amplitudes:  37%|███▋      | 6055/16384 [00:01<00:01, 5806.27probe position/s]Normalizing amplitudes:  41%|████      | 6651/16384 [00:01<00:01, 5850.05probe position/s]Normalizing amplitudes:  44%|████▍     | 7238/16384 [00:01<00:01, 5845.44probe position/s]Normalizing amplitudes:  48%|████▊     | 7878/16384 [00:01<00:01, 6008.79probe position/s]Normalizing amplitudes:  52%|█████▏    | 8480/16384 [00:01<00:01, 5858.55probe position/s]Normalizing amplitudes:  55%|█████▌    | 9068/16384 [00:01<00:01, 5778.26probe position/s]Normalizing amplitudes:  59%|█████▉    | 9647/16384 [00:01<00:01, 5720.30probe position/s]Normalizing amplitudes:  62%|██████▏   | 10220/16384 [00:01<00:01, 5707.97probe position/s]Normalizing amplitudes:  66%|██████▌   | 10800/16384 [00:01<00:00, 5730.86probe position/s]Normalizing amplitudes:  69%|██████▉   | 11374/16384 [00:01<00:00, 5731.57probe position/s]Normalizing amplitudes:  73%|███████▎  | 12022/16384 [00:02<00:00, 5952.52probe position/s]Normalizing amplitudes:  77%|███████▋  | 12623/16384 [00:02<00:00, 5969.25probe position/s]Normalizing amplitudes:  81%|████████  | 13221/16384 [00:02<00:00, 5800.76probe position/s]Normalizing amplitudes:  84%|████████▍ | 13803/16384 [00:02<00:00, 5738.43probe position/s]Normalizing amplitudes:  88%|████████▊ | 14398/16384 [00:02<00:00, 5798.98probe position/s]Normalizing amplitudes:  91%|█████████▏| 14979/16384 [00:02<00:00, 5799.90probe position/s]Normalizing amplitudes:  95%|█████████▌| 15623/16384 [00:02<00:00, 5986.75probe position/s]Normalizing amplitudes:  99%|█████████▉| 16286/16384 [00:02<00:00, 6176.48probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5896.09probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random32_p1_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random32_p1_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.00714 in 8.862 sec
Iter: 2, Total Loss: 0.006525 in 8.816 sec
Iter: 3, Total Loss: 0.006455 in 8.867 sec
Iter: 4, Total Loss: 0.00639 in 9.064 sec
Iter: 5, Total Loss: 0.006334 in 9.327 sec
Iter: 6, Total Loss: 0.006285 in 8.928 sec
Iter: 7, Total Loss: 0.006243 in 9.374 sec
Iter: 8, Total Loss: 0.006208 in 8.657 sec
Iter: 9, Total Loss: 0.006178 in 8.894 sec
Iter: 10, Total Loss: 0.006152 in 8.635 sec
Iter: 11, Total Loss: 0.00613 in 8.854 sec
Iter: 12, Total Loss: 0.006114 in 8.584 sec
Iter: 13, Total Loss: 0.0061 in 8.694 sec
Iter: 14, Total Loss: 0.00609 in 8.730 sec
Iter: 15, Total Loss: 0.006077 in 8.562 sec
Iter: 16, Total Loss: 0.006068 in 8.588 sec
Iter: 17, Total Loss: 0.00606 in 8.920 sec
Iter: 18, Total Loss: 0.006053 in 8.620 sec
Iter: 19, Total Loss: 0.006047 in 9.098 sec
Iter: 20, Total Loss: 0.006042 in 8.536 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 8.830 with std = 0.236 sec ###
### py4DSTEM ptycho solver is finished in 2 min 58.708 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 903.07 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 32, 1, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 576/16384 [00:00<00:02, 5753.16probe position/s]Normalizing amplitudes:   7%|▋         | 1179/16384 [00:00<00:02, 5912.83probe position/s]Normalizing amplitudes:  11%|█         | 1778/16384 [00:00<00:02, 5947.31probe position/s]Normalizing amplitudes:  14%|█▍        | 2373/16384 [00:00<00:02, 5850.59probe position/s]Normalizing amplitudes:  18%|█▊        | 2990/16384 [00:00<00:02, 5962.94probe position/s]Normalizing amplitudes:  22%|██▏       | 3587/16384 [00:00<00:02, 5954.88probe position/s]Normalizing amplitudes:  26%|██▌       | 4183/16384 [00:00<00:02, 5949.20probe position/s]Normalizing amplitudes:  29%|██▉       | 4797/16384 [00:00<00:01, 6006.70probe position/s]Normalizing amplitudes:  33%|███▎      | 5412/16384 [00:00<00:01, 6049.47probe position/s]Normalizing amplitudes:  37%|███▋      | 6019/16384 [00:01<00:01, 6053.99probe position/s]Normalizing amplitudes:  40%|████      | 6625/16384 [00:01<00:01, 6034.52probe position/s]Normalizing amplitudes:  44%|████▍     | 7229/16384 [00:01<00:01, 6014.46probe position/s]Normalizing amplitudes:  48%|████▊     | 7831/16384 [00:01<00:01, 5950.50probe position/s]Normalizing amplitudes:  51%|█████▏    | 8427/16384 [00:01<00:01, 5930.90probe position/s]Normalizing amplitudes:  55%|█████▌    | 9034/16384 [00:01<00:01, 5971.37probe position/s]Normalizing amplitudes:  59%|█████▉    | 9632/16384 [00:01<00:01, 5947.47probe position/s]Normalizing amplitudes:  62%|██████▏   | 10238/16384 [00:01<00:01, 5980.24probe position/s]Normalizing amplitudes:  66%|██████▌   | 10837/16384 [00:01<00:00, 5913.97probe position/s]Normalizing amplitudes:  70%|██████▉   | 11429/16384 [00:01<00:00, 5901.94probe position/s]Normalizing amplitudes:  73%|███████▎  | 12038/16384 [00:02<00:00, 5957.25probe position/s]Normalizing amplitudes:  77%|███████▋  | 12640/16384 [00:02<00:00, 5974.18probe position/s]Normalizing amplitudes:  81%|████████  | 13248/16384 [00:02<00:00, 6005.51probe position/s]Normalizing amplitudes:  85%|████████▍ | 13849/16384 [00:02<00:00, 5892.64probe position/s]Normalizing amplitudes:  88%|████████▊ | 14450/16384 [00:02<00:00, 5924.96probe position/s]Normalizing amplitudes:  92%|█████████▏| 15043/16384 [00:02<00:00, 5918.58probe position/s]Normalizing amplitudes:  95%|█████████▌| 15636/16384 [00:02<00:00, 5600.54probe position/s]Normalizing amplitudes:  99%|█████████▉| 16200/16384 [00:02<00:00, 5607.15probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5897.64probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random32_p1_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random32_p1_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.007217 in 16.093 sec
Iter: 2, Total Loss: 0.006568 in 16.516 sec
Iter: 3, Total Loss: 0.006483 in 16.398 sec
Iter: 4, Total Loss: 0.006413 in 16.241 sec
Iter: 5, Total Loss: 0.006357 in 16.417 sec
Iter: 6, Total Loss: 0.006311 in 16.185 sec
Iter: 7, Total Loss: 0.006267 in 16.152 sec
Iter: 8, Total Loss: 0.006229 in 15.814 sec
Iter: 9, Total Loss: 0.006193 in 15.520 sec
Iter: 10, Total Loss: 0.006167 in 15.508 sec
Iter: 11, Total Loss: 0.006141 in 14.944 sec
Iter: 12, Total Loss: 0.006118 in 15.098 sec
Iter: 13, Total Loss: 0.006095 in 15.238 sec
Iter: 14, Total Loss: 0.006078 in 15.526 sec
Iter: 15, Total Loss: 0.006055 in 16.483 sec
Iter: 16, Total Loss: 0.006037 in 16.846 sec
Iter: 17, Total Loss: 0.00602 in 16.889 sec
Iter: 18, Total Loss: 0.006001 in 15.825 sec
Iter: 19, Total Loss: 0.005985 in 16.056 sec
Iter: 20, Total Loss: 0.005971 in 16.393 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 16.007 with std = 0.543 sec ###
### py4DSTEM ptycho solver is finished in 5 min 25.327 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 907.69 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 32, 3, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 575/16384 [00:00<00:02, 5736.71probe position/s]Normalizing amplitudes:   7%|▋         | 1149/16384 [00:00<00:03, 4700.77probe position/s]Normalizing amplitudes:  10%|█         | 1719/16384 [00:00<00:02, 5105.50probe position/s]Normalizing amplitudes:  14%|█▍        | 2347/16384 [00:00<00:02, 5534.00probe position/s]Normalizing amplitudes:  18%|█▊        | 2998/16384 [00:00<00:02, 5867.81probe position/s]Normalizing amplitudes:  22%|██▏       | 3650/16384 [00:00<00:02, 6081.59probe position/s]Normalizing amplitudes:  26%|██▋       | 4301/16384 [00:00<00:01, 6216.31probe position/s]Normalizing amplitudes:  30%|███       | 4938/16384 [00:00<00:01, 6262.17probe position/s]Normalizing amplitudes:  34%|███▍      | 5580/16384 [00:00<00:01, 6307.44probe position/s]Normalizing amplitudes:  38%|███▊      | 6213/16384 [00:01<00:01, 6213.05probe position/s]Normalizing amplitudes:  42%|████▏     | 6836/16384 [00:01<00:01, 6170.69probe position/s]Normalizing amplitudes:  46%|████▌     | 7455/16384 [00:01<00:01, 6111.80probe position/s]Normalizing amplitudes:  49%|████▉     | 8068/16384 [00:01<00:01, 6105.32probe position/s]Normalizing amplitudes:  53%|█████▎    | 8719/16384 [00:01<00:01, 6223.64probe position/s]Normalizing amplitudes:  57%|█████▋    | 9342/16384 [00:01<00:01, 5989.51probe position/s]Normalizing amplitudes:  61%|██████    | 9980/16384 [00:01<00:01, 6101.01probe position/s]Normalizing amplitudes:  65%|██████▍   | 10609/16384 [00:01<00:00, 6153.15probe position/s]Normalizing amplitudes:  69%|██████▊   | 11226/16384 [00:01<00:00, 6106.73probe position/s]Normalizing amplitudes:  72%|███████▏  | 11838/16384 [00:01<00:00, 5976.60probe position/s]Normalizing amplitudes:  76%|███████▌  | 12437/16384 [00:02<00:00, 5979.41probe position/s]Normalizing amplitudes:  80%|███████▉  | 13079/16384 [00:02<00:00, 6108.04probe position/s]Normalizing amplitudes:  84%|████████▍ | 13722/16384 [00:02<00:00, 6202.14probe position/s]Normalizing amplitudes:  88%|████████▊ | 14361/16384 [00:02<00:00, 6257.07probe position/s]Normalizing amplitudes:  92%|█████████▏| 15018/16384 [00:02<00:00, 6350.00probe position/s]Normalizing amplitudes:  96%|█████████▌| 15677/16384 [00:02<00:00, 6419.29probe position/s]Normalizing amplitudes: 100%|█████████▉| 16320/16384 [00:02<00:00, 6364.27probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6090.27probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random32_p3_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random32_p3_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.008624 in 7.483 sec
Iter: 2, Total Loss: 0.006403 in 7.631 sec
Iter: 3, Total Loss: 0.006258 in 7.804 sec
Iter: 4, Total Loss: 0.00612 in 7.507 sec
Iter: 5, Total Loss: 0.005988 in 7.617 sec
Iter: 6, Total Loss: 0.005865 in 8.641 sec
Iter: 7, Total Loss: 0.00576 in 7.855 sec
Iter: 8, Total Loss: 0.005675 in 7.818 sec
Iter: 9, Total Loss: 0.005606 in 7.761 sec
Iter: 10, Total Loss: 0.005553 in 7.540 sec
Iter: 11, Total Loss: 0.005509 in 7.640 sec
Iter: 12, Total Loss: 0.005469 in 7.543 sec
Iter: 13, Total Loss: 0.005435 in 7.545 sec
Iter: 14, Total Loss: 0.005402 in 7.534 sec
Iter: 15, Total Loss: 0.005372 in 7.503 sec
Iter: 16, Total Loss: 0.005345 in 7.620 sec
Iter: 17, Total Loss: 0.005321 in 7.690 sec
Iter: 18, Total Loss: 0.005301 in 8.359 sec
Iter: 19, Total Loss: 0.005284 in 7.604 sec
Iter: 20, Total Loss: 0.00527 in 7.571 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 7.713 with std = 0.286 sec ###
### py4DSTEM ptycho solver is finished in 2 min 36.831 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 911.09 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 32, 3, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 606/16384 [00:00<00:02, 6056.51probe position/s]Normalizing amplitudes:   7%|▋         | 1212/16384 [00:00<00:02, 5978.93probe position/s]Normalizing amplitudes:  11%|█         | 1828/16384 [00:00<00:02, 6057.24probe position/s]Normalizing amplitudes:  15%|█▍        | 2434/16384 [00:00<00:02, 5776.83probe position/s]Normalizing amplitudes:  18%|█▊        | 3014/16384 [00:00<00:02, 5706.89probe position/s]Normalizing amplitudes:  22%|██▏       | 3586/16384 [00:00<00:02, 5695.04probe position/s]Normalizing amplitudes:  25%|██▌       | 4158/16384 [00:00<00:02, 5702.33probe position/s]Normalizing amplitudes:  29%|██▉       | 4771/16384 [00:00<00:01, 5833.64probe position/s]Normalizing amplitudes:  33%|███▎      | 5408/16384 [00:00<00:01, 5999.09probe position/s]Normalizing amplitudes:  37%|███▋      | 6079/16384 [00:01<00:01, 6213.72probe position/s]Normalizing amplitudes:  41%|████      | 6701/16384 [00:01<00:01, 5996.47probe position/s]Normalizing amplitudes:  45%|████▍     | 7303/16384 [00:01<00:01, 5913.69probe position/s]Normalizing amplitudes:  48%|████▊     | 7896/16384 [00:01<00:01, 5860.60probe position/s]Normalizing amplitudes:  52%|█████▏    | 8483/16384 [00:01<00:01, 5845.51probe position/s]Normalizing amplitudes:  55%|█████▌    | 9069/16384 [00:01<00:01, 5776.33probe position/s]Normalizing amplitudes:  59%|█████▉    | 9745/16384 [00:01<00:01, 6063.26probe position/s]Normalizing amplitudes:  63%|██████▎   | 10361/16384 [00:01<00:00, 6086.99probe position/s]Normalizing amplitudes:  67%|██████▋   | 10971/16384 [00:01<00:00, 5955.25probe position/s]Normalizing amplitudes:  71%|███████   | 11568/16384 [00:01<00:00, 5796.21probe position/s]Normalizing amplitudes:  74%|███████▍  | 12172/16384 [00:02<00:00, 5866.10probe position/s]Normalizing amplitudes:  78%|███████▊  | 12819/16384 [00:02<00:00, 6040.69probe position/s]Normalizing amplitudes:  82%|████████▏ | 13425/16384 [00:02<00:00, 6024.07probe position/s]Normalizing amplitudes:  86%|████████▌ | 14078/16384 [00:02<00:00, 6173.07probe position/s]Normalizing amplitudes:  90%|████████▉ | 14697/16384 [00:02<00:00, 6050.69probe position/s]Normalizing amplitudes:  94%|█████████▎| 15343/16384 [00:02<00:00, 6168.67probe position/s]Normalizing amplitudes:  98%|█████████▊| 15981/16384 [00:02<00:00, 6229.96probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5978.44probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random32_p3_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random32_p3_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.00881 in 20.820 sec
Iter: 2, Total Loss: 0.006261 in 21.154 sec
Iter: 3, Total Loss: 0.006063 in 20.222 sec
Iter: 4, Total Loss: 0.005893 in 19.856 sec
Iter: 5, Total Loss: 0.005745 in 19.627 sec
Iter: 6, Total Loss: 0.005625 in 20.034 sec
Iter: 7, Total Loss: 0.005536 in 20.441 sec
Iter: 8, Total Loss: 0.005471 in 19.506 sec
Iter: 9, Total Loss: 0.005421 in 19.010 sec
Iter: 10, Total Loss: 0.00538 in 19.311 sec
Iter: 11, Total Loss: 0.005343 in 19.996 sec
Iter: 12, Total Loss: 0.00531 in 19.899 sec
Iter: 13, Total Loss: 0.005279 in 19.771 sec
Iter: 14, Total Loss: 0.00525 in 20.888 sec
Iter: 15, Total Loss: 0.005221 in 21.474 sec
Iter: 16, Total Loss: 0.005196 in 20.698 sec
Iter: 17, Total Loss: 0.005172 in 20.568 sec
Iter: 18, Total Loss: 0.005152 in 21.393 sec
Iter: 19, Total Loss: 0.005135 in 21.272 sec
Iter: 20, Total Loss: 0.005118 in 20.925 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 20.343 with std = 0.707 sec ###
### py4DSTEM ptycho solver is finished in 6 min 49.162 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 912.42 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 32, 3, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 565/16384 [00:00<00:02, 5644.46probe position/s]Normalizing amplitudes:   7%|▋         | 1189/16384 [00:00<00:02, 5993.11probe position/s]Normalizing amplitudes:  11%|█         | 1824/16384 [00:00<00:02, 6154.06probe position/s]Normalizing amplitudes:  15%|█▍        | 2440/16384 [00:00<00:02, 5869.05probe position/s]Normalizing amplitudes:  18%|█▊        | 3029/16384 [00:00<00:02, 5815.13probe position/s]Normalizing amplitudes:  22%|██▏       | 3612/16384 [00:00<00:02, 5403.34probe position/s]Normalizing amplitudes:  25%|██▌       | 4158/16384 [00:00<00:02, 5253.00probe position/s]Normalizing amplitudes:  29%|██▉       | 4822/16384 [00:00<00:02, 5662.27probe position/s]Normalizing amplitudes:  33%|███▎      | 5429/16384 [00:00<00:01, 5783.13probe position/s]Normalizing amplitudes:  37%|███▋      | 6012/16384 [00:01<00:01, 5741.50probe position/s]Normalizing amplitudes:  40%|████      | 6589/16384 [00:01<00:01, 5728.53probe position/s]Normalizing amplitudes:  44%|████▎     | 7164/16384 [00:01<00:01, 5683.82probe position/s]Normalizing amplitudes:  47%|████▋     | 7736/16384 [00:01<00:01, 5693.14probe position/s]Normalizing amplitudes:  51%|█████     | 8307/16384 [00:01<00:01, 5686.03probe position/s]Normalizing amplitudes:  55%|█████▍    | 8948/16384 [00:01<00:01, 5900.81probe position/s]Normalizing amplitudes:  58%|█████▊    | 9544/16384 [00:01<00:01, 5917.51probe position/s]Normalizing amplitudes:  62%|██████▏   | 10137/16384 [00:01<00:01, 5827.67probe position/s]Normalizing amplitudes:  65%|██████▌   | 10721/16384 [00:01<00:00, 5735.59probe position/s]Normalizing amplitudes:  69%|██████▉   | 11334/16384 [00:01<00:00, 5849.37probe position/s]Normalizing amplitudes:  73%|███████▎  | 11947/16384 [00:02<00:00, 5931.30probe position/s]Normalizing amplitudes:  77%|███████▋  | 12541/16384 [00:02<00:00, 5879.21probe position/s]Normalizing amplitudes:  80%|████████  | 13174/16384 [00:02<00:00, 6011.45probe position/s]Normalizing amplitudes:  84%|████████▍ | 13792/16384 [00:02<00:00, 6060.62probe position/s]Normalizing amplitudes:  88%|████████▊ | 14399/16384 [00:02<00:00, 6019.61probe position/s]Normalizing amplitudes:  92%|█████████▏| 15011/16384 [00:02<00:00, 6046.42probe position/s]Normalizing amplitudes:  95%|█████████▌| 15616/16384 [00:02<00:00, 6021.00probe position/s]Normalizing amplitudes:  99%|█████████▉| 16219/16384 [00:02<00:00, 5951.86probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5829.07probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random32_p3_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random32_p3_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.008967 in 40.424 sec
Iter: 2, Total Loss: 0.006139 in 39.879 sec
Iter: 3, Total Loss: 0.005891 in 40.872 sec
Iter: 4, Total Loss: 0.005709 in 38.403 sec
Iter: 5, Total Loss: 0.005583 in 37.716 sec
Iter: 6, Total Loss: 0.005497 in 37.917 sec
Iter: 7, Total Loss: 0.00543 in 38.184 sec
Iter: 8, Total Loss: 0.005375 in 38.741 sec
Iter: 9, Total Loss: 0.005328 in 39.366 sec
Iter: 10, Total Loss: 0.005286 in 40.926 sec
Iter: 11, Total Loss: 0.005245 in 40.601 sec
Iter: 12, Total Loss: 0.005205 in 41.149 sec
Iter: 13, Total Loss: 0.005165 in 40.381 sec
Iter: 14, Total Loss: 0.005128 in 39.446 sec
Iter: 15, Total Loss: 0.005095 in 37.468 sec
Iter: 16, Total Loss: 0.005069 in 37.317 sec
Iter: 17, Total Loss: 0.005045 in 37.887 sec
Iter: 18, Total Loss: 0.005026 in 39.144 sec
Iter: 19, Total Loss: 0.005009 in 40.030 sec
Iter: 20, Total Loss: 0.004993 in 40.198 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 39.303 with std = 1.234 sec ###
### py4DSTEM ptycho solver is finished in 13 min 8.261 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 911.22 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 32, 6, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 605/16384 [00:00<00:02, 6049.39probe position/s]Normalizing amplitudes:   8%|▊         | 1272/16384 [00:00<00:02, 6413.82probe position/s]Normalizing amplitudes:  12%|█▏        | 1914/16384 [00:00<00:02, 6183.27probe position/s]Normalizing amplitudes:  15%|█▌        | 2534/16384 [00:00<00:02, 6181.91probe position/s]Normalizing amplitudes:  19%|█▉        | 3174/16384 [00:00<00:02, 6254.29probe position/s]Normalizing amplitudes:  23%|██▎       | 3816/16384 [00:00<00:01, 6307.97probe position/s]Normalizing amplitudes:  27%|██▋       | 4453/16384 [00:00<00:01, 6325.63probe position/s]Normalizing amplitudes:  31%|███       | 5087/16384 [00:00<00:01, 6328.71probe position/s]Normalizing amplitudes:  35%|███▍      | 5724/16384 [00:00<00:01, 6340.93probe position/s]Normalizing amplitudes:  39%|███▉      | 6359/16384 [00:01<00:01, 6225.10probe position/s]Normalizing amplitudes:  43%|████▎     | 6983/16384 [00:01<00:01, 6185.77probe position/s]Normalizing amplitudes:  46%|████▋     | 7602/16384 [00:01<00:01, 6126.92probe position/s]Normalizing amplitudes:  50%|█████     | 8215/16384 [00:01<00:01, 6095.68probe position/s]Normalizing amplitudes:  54%|█████▍    | 8924/16384 [00:01<00:01, 6389.54probe position/s]Normalizing amplitudes:  58%|█████▊    | 9564/16384 [00:01<00:01, 6352.92probe position/s]Normalizing amplitudes:  62%|██████▏   | 10200/16384 [00:01<00:00, 6275.17probe position/s]Normalizing amplitudes:  66%|██████▌   | 10828/16384 [00:01<00:00, 6088.07probe position/s]Normalizing amplitudes:  70%|██████▉   | 11439/16384 [00:01<00:00, 6073.31probe position/s]Normalizing amplitudes:  74%|███████▎  | 12065/16384 [00:01<00:00, 6125.15probe position/s]Normalizing amplitudes:  77%|███████▋  | 12691/16384 [00:02<00:00, 6164.78probe position/s]Normalizing amplitudes:  81%|████████  | 13309/16384 [00:02<00:00, 6119.52probe position/s]Normalizing amplitudes:  85%|████████▍ | 13922/16384 [00:02<00:00, 5965.04probe position/s]Normalizing amplitudes:  89%|████████▊ | 14534/16384 [00:02<00:00, 6008.65probe position/s]Normalizing amplitudes:  92%|█████████▏| 15136/16384 [00:02<00:00, 5879.31probe position/s]Normalizing amplitudes:  96%|█████████▌| 15725/16384 [00:02<00:00, 5767.70probe position/s]Normalizing amplitudes: 100%|█████████▉| 16342/16384 [00:02<00:00, 5882.89probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6124.86probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random32_p6_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random32_p6_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.01307 in 13.554 sec
Iter: 2, Total Loss: 0.006423 in 13.449 sec
Iter: 3, Total Loss: 0.006267 in 13.130 sec
Iter: 4, Total Loss: 0.006126 in 13.697 sec
Iter: 5, Total Loss: 0.005992 in 13.686 sec
Iter: 6, Total Loss: 0.005867 in 13.646 sec
Iter: 7, Total Loss: 0.005755 in 13.507 sec
Iter: 8, Total Loss: 0.00566 in 13.500 sec
Iter: 9, Total Loss: 0.005577 in 13.547 sec
Iter: 10, Total Loss: 0.005503 in 13.810 sec
Iter: 11, Total Loss: 0.005436 in 13.634 sec
Iter: 12, Total Loss: 0.005369 in 13.440 sec
Iter: 13, Total Loss: 0.0053 in 14.311 sec
Iter: 14, Total Loss: 0.00523 in 13.457 sec
Iter: 15, Total Loss: 0.005163 in 13.591 sec
Iter: 16, Total Loss: 0.005105 in 13.310 sec
Iter: 17, Total Loss: 0.005059 in 13.320 sec
Iter: 18, Total Loss: 0.005022 in 13.513 sec
Iter: 19, Total Loss: 0.004992 in 13.167 sec
Iter: 20, Total Loss: 0.004968 in 12.672 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 13.497 with std = 0.307 sec ###
### py4DSTEM ptycho solver is finished in 4 min 31.861 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 917.02 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 32, 6, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 698/16384 [00:00<00:02, 6973.62probe position/s]Normalizing amplitudes:   9%|▊         | 1396/16384 [00:00<00:02, 6915.79probe position/s]Normalizing amplitudes:  13%|█▎        | 2106/16384 [00:00<00:02, 6995.20probe position/s]Normalizing amplitudes:  17%|█▋        | 2806/16384 [00:00<00:01, 6982.57probe position/s]Normalizing amplitudes:  21%|██▏       | 3505/16384 [00:00<00:01, 6943.20probe position/s]Normalizing amplitudes:  26%|██▌       | 4200/16384 [00:00<00:01, 6886.55probe position/s]Normalizing amplitudes:  30%|██▉       | 4889/16384 [00:00<00:01, 6777.02probe position/s]Normalizing amplitudes:  34%|███▍      | 5621/16384 [00:00<00:01, 6945.78probe position/s]Normalizing amplitudes:  39%|███▊      | 6317/16384 [00:00<00:01, 6891.72probe position/s]Normalizing amplitudes:  43%|████▎     | 7007/16384 [00:01<00:01, 6579.79probe position/s]Normalizing amplitudes:  47%|████▋     | 7679/16384 [00:01<00:01, 6618.83probe position/s]Normalizing amplitudes:  51%|█████     | 8382/16384 [00:01<00:01, 6739.02probe position/s]Normalizing amplitudes:  55%|█████▌    | 9079/16384 [00:01<00:01, 6805.28probe position/s]Normalizing amplitudes:  60%|█████▉    | 9761/16384 [00:01<00:01, 6559.57probe position/s]Normalizing amplitudes:  64%|██████▎   | 10420/16384 [00:01<00:00, 6483.09probe position/s]Normalizing amplitudes:  68%|██████▊   | 11071/16384 [00:01<00:00, 6429.14probe position/s]Normalizing amplitudes:  72%|███████▏  | 11716/16384 [00:01<00:00, 6400.82probe position/s]Normalizing amplitudes:  76%|███████▌  | 12389/16384 [00:01<00:00, 6495.42probe position/s]Normalizing amplitudes:  80%|███████▉  | 13052/16384 [00:01<00:00, 6532.55probe position/s]Normalizing amplitudes:  84%|████████▍ | 13740/16384 [00:02<00:00, 6634.94probe position/s]Normalizing amplitudes:  88%|████████▊ | 14405/16384 [00:02<00:00, 6639.20probe position/s]Normalizing amplitudes:  92%|█████████▏| 15110/16384 [00:02<00:00, 6758.49probe position/s]Normalizing amplitudes:  96%|█████████▋| 15800/16384 [00:02<00:00, 6798.22probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6729.98probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random32_p6_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random32_p6_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.01326 in 37.636 sec
Iter: 2, Total Loss: 0.006236 in 37.443 sec
Iter: 3, Total Loss: 0.005996 in 38.391 sec
Iter: 4, Total Loss: 0.005789 in 38.214 sec
Iter: 5, Total Loss: 0.005614 in 39.715 sec
Iter: 6, Total Loss: 0.005481 in 39.742 sec
Iter: 7, Total Loss: 0.005374 in 38.495 sec
Iter: 8, Total Loss: 0.005281 in 39.436 sec
Iter: 9, Total Loss: 0.005193 in 37.884 sec
Iter: 10, Total Loss: 0.005108 in 37.873 sec
Iter: 11, Total Loss: 0.00503 in 36.066 sec
Iter: 12, Total Loss: 0.004965 in 36.810 sec
Iter: 13, Total Loss: 0.004915 in 36.566 sec
Iter: 14, Total Loss: 0.004877 in 37.387 sec
Iter: 15, Total Loss: 0.004849 in 38.775 sec
Iter: 16, Total Loss: 0.004825 in 37.687 sec
Iter: 17, Total Loss: 0.004805 in 38.096 sec
Iter: 18, Total Loss: 0.004789 in 37.566 sec
Iter: 19, Total Loss: 0.004774 in 40.430 sec
Iter: 20, Total Loss: 0.004761 in 38.699 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 38.146 with std = 1.082 sec ###
### py4DSTEM ptycho solver is finished in 12 min 46.941 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 911.36 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 32, 6, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 611/16384 [00:00<00:02, 6104.69probe position/s]Normalizing amplitudes:   7%|▋         | 1222/16384 [00:00<00:02, 6039.14probe position/s]Normalizing amplitudes:  11%|█▏        | 1854/16384 [00:00<00:02, 6162.58probe position/s]Normalizing amplitudes:  15%|█▌        | 2471/16384 [00:00<00:02, 6153.60probe position/s]Normalizing amplitudes:  19%|█▉        | 3088/16384 [00:00<00:02, 6157.89probe position/s]Normalizing amplitudes:  23%|██▎       | 3734/16384 [00:00<00:02, 6258.79probe position/s]Normalizing amplitudes:  27%|██▋       | 4376/16384 [00:00<00:01, 6309.56probe position/s]Normalizing amplitudes:  31%|███       | 5015/16384 [00:00<00:01, 6332.25probe position/s]Normalizing amplitudes:  34%|███▍      | 5649/16384 [00:00<00:01, 6214.22probe position/s]Normalizing amplitudes:  38%|███▊      | 6271/16384 [00:01<00:01, 6185.35probe position/s]Normalizing amplitudes:  42%|████▏     | 6892/16384 [00:01<00:01, 6191.94probe position/s]Normalizing amplitudes:  46%|████▌     | 7522/16384 [00:01<00:01, 6223.92probe position/s]Normalizing amplitudes:  50%|████▉     | 8145/16384 [00:01<00:01, 6224.57probe position/s]Normalizing amplitudes:  54%|█████▎    | 8768/16384 [00:01<00:01, 6134.27probe position/s]Normalizing amplitudes:  57%|█████▋    | 9382/16384 [00:01<00:01, 5491.73probe position/s]Normalizing amplitudes:  61%|██████    | 9944/16384 [00:01<00:01, 5216.30probe position/s]Normalizing amplitudes:  64%|██████▍   | 10560/16384 [00:01<00:01, 5470.36probe position/s]Normalizing amplitudes:  68%|██████▊   | 11176/16384 [00:01<00:00, 5660.12probe position/s]Normalizing amplitudes:  72%|███████▏  | 11792/16384 [00:01<00:00, 5800.96probe position/s]Normalizing amplitudes:  76%|███████▌  | 12379/16384 [00:02<00:00, 5638.89probe position/s]Normalizing amplitudes:  79%|███████▉  | 12991/16384 [00:02<00:00, 5774.17probe position/s]Normalizing amplitudes:  83%|████████▎ | 13661/16384 [00:02<00:00, 6041.67probe position/s]Normalizing amplitudes:  87%|████████▋ | 14325/16384 [00:02<00:00, 6215.78probe position/s]Normalizing amplitudes:  91%|█████████▏| 14979/16384 [00:02<00:00, 6310.19probe position/s]Normalizing amplitudes:  95%|█████████▌| 15630/16384 [00:02<00:00, 6366.77probe position/s]Normalizing amplitudes:  99%|█████████▉| 16269/16384 [00:02<00:00, 6328.43probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6047.14probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random32_p6_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random32_p6_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.01368 in 74.757 sec
Iter: 2, Total Loss: 0.006066 in 72.472 sec
Iter: 3, Total Loss: 0.005748 in 75.534 sec
Iter: 4, Total Loss: 0.00553 in 73.197 sec
Iter: 5, Total Loss: 0.005375 in 73.370 sec
Iter: 6, Total Loss: 0.005262 in 73.597 sec
Iter: 7, Total Loss: 0.005167 in 73.725 sec
Iter: 8, Total Loss: 0.005079 in 70.736 sec
Iter: 9, Total Loss: 0.005 in 74.931 sec
Iter: 10, Total Loss: 0.004933 in 73.840 sec
Iter: 11, Total Loss: 0.004882 in 74.222 sec
Iter: 12, Total Loss: 0.004843 in 73.493 sec
Iter: 13, Total Loss: 0.004812 in 73.292 sec
Iter: 14, Total Loss: 0.004786 in 69.870 sec
Iter: 15, Total Loss: 0.004766 in 71.996 sec
Iter: 16, Total Loss: 0.004747 in 74.802 sec
Iter: 17, Total Loss: 0.004732 in 73.668 sec
Iter: 18, Total Loss: 0.004718 in 74.159 sec
Iter: 19, Total Loss: 0.004706 in 74.111 sec
Iter: 20, Total Loss: 0.004695 in 73.092 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 73.443 with std = 1.330 sec ###
### py4DSTEM ptycho solver is finished in 24 min 30.927 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 918.20 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 32, 12, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 677/16384 [00:00<00:02, 6761.99probe position/s]Normalizing amplitudes:   8%|▊         | 1370/16384 [00:00<00:02, 6854.12probe position/s]Normalizing amplitudes:  13%|█▎        | 2056/16384 [00:00<00:02, 6670.05probe position/s]Normalizing amplitudes:  17%|█▋        | 2728/16384 [00:00<00:02, 6685.01probe position/s]Normalizing amplitudes:  21%|██        | 3397/16384 [00:00<00:01, 6574.41probe position/s]Normalizing amplitudes:  25%|██▍       | 4055/16384 [00:00<00:01, 6543.49probe position/s]Normalizing amplitudes:  29%|██▉       | 4727/16384 [00:00<00:01, 6600.11probe position/s]Normalizing amplitudes:  33%|███▎      | 5388/16384 [00:00<00:01, 6562.33probe position/s]Normalizing amplitudes:  37%|███▋      | 6045/16384 [00:00<00:01, 6459.85probe position/s]Normalizing amplitudes:  41%|████      | 6692/16384 [00:01<00:01, 6447.66probe position/s]Normalizing amplitudes:  45%|████▍     | 7344/16384 [00:01<00:01, 6468.07probe position/s]Normalizing amplitudes:  49%|████▉     | 8014/16384 [00:01<00:01, 6537.38probe position/s]Normalizing amplitudes:  53%|█████▎    | 8668/16384 [00:01<00:01, 6410.47probe position/s]Normalizing amplitudes:  57%|█████▋    | 9321/16384 [00:01<00:01, 6444.05probe position/s]Normalizing amplitudes:  61%|██████    | 9966/16384 [00:01<00:01, 6372.82probe position/s]Normalizing amplitudes:  65%|██████▍   | 10643/16384 [00:01<00:00, 6489.35probe position/s]Normalizing amplitudes:  69%|██████▉   | 11308/16384 [00:01<00:00, 6535.87probe position/s]Normalizing amplitudes:  73%|███████▎  | 11995/16384 [00:01<00:00, 6632.90probe position/s]Normalizing amplitudes:  77%|███████▋  | 12659/16384 [00:01<00:00, 6620.43probe position/s]Normalizing amplitudes:  81%|████████▏ | 13327/16384 [00:02<00:00, 6637.75probe position/s]Normalizing amplitudes:  85%|████████▌ | 13991/16384 [00:02<00:00, 6630.75probe position/s]Normalizing amplitudes:  89%|████████▉ | 14655/16384 [00:02<00:00, 6595.35probe position/s]Normalizing amplitudes:  93%|█████████▎| 15316/16384 [00:02<00:00, 6596.49probe position/s]Normalizing amplitudes:  98%|█████████▊| 15994/16384 [00:02<00:00, 6650.22probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6574.63probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random32_p12_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random32_p12_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.02363 in 25.814 sec
Iter: 2, Total Loss: 0.006408 in 26.195 sec
Iter: 3, Total Loss: 0.006216 in 25.179 sec
Iter: 4, Total Loss: 0.006043 in 26.275 sec
Iter: 5, Total Loss: 0.00588 in 26.984 sec
Iter: 6, Total Loss: 0.005739 in 25.240 sec
Iter: 7, Total Loss: 0.005618 in 25.452 sec
Iter: 8, Total Loss: 0.005517 in 25.755 sec
Iter: 9, Total Loss: 0.005428 in 26.576 sec
Iter: 10, Total Loss: 0.005345 in 25.590 sec
Iter: 11, Total Loss: 0.005263 in 25.671 sec
Iter: 12, Total Loss: 0.005181 in 25.602 sec
Iter: 13, Total Loss: 0.005104 in 24.920 sec
Iter: 14, Total Loss: 0.005039 in 24.812 sec
Iter: 15, Total Loss: 0.004986 in 24.229 sec
Iter: 16, Total Loss: 0.004944 in 24.883 sec
Iter: 17, Total Loss: 0.004909 in 25.134 sec
Iter: 18, Total Loss: 0.004879 in 24.560 sec
Iter: 19, Total Loss: 0.004852 in 24.710 sec
Iter: 20, Total Loss: 0.004828 in 24.587 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 25.408 with std = 0.705 sec ###
### py4DSTEM ptycho solver is finished in 8 min 30.062 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 913.87 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 32, 12, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 587/16384 [00:00<00:02, 5865.66probe position/s]Normalizing amplitudes:   8%|▊         | 1245/16384 [00:00<00:02, 6283.85probe position/s]Normalizing amplitudes:  11%|█▏        | 1874/16384 [00:00<00:02, 6181.60probe position/s]Normalizing amplitudes:  15%|█▌        | 2493/16384 [00:00<00:02, 6101.57probe position/s]Normalizing amplitudes:  19%|█▉        | 3141/16384 [00:00<00:02, 6231.87probe position/s]Normalizing amplitudes:  23%|██▎       | 3770/16384 [00:00<00:02, 6248.99probe position/s]Normalizing amplitudes:  27%|██▋       | 4396/16384 [00:00<00:01, 6189.54probe position/s]Normalizing amplitudes:  31%|███       | 5024/16384 [00:00<00:01, 6215.92probe position/s]Normalizing amplitudes:  35%|███▍      | 5675/16384 [00:00<00:01, 6303.75probe position/s]Normalizing amplitudes:  38%|███▊      | 6306/16384 [00:01<00:01, 6285.78probe position/s]Normalizing amplitudes:  42%|████▏     | 6935/16384 [00:01<00:01, 6210.47probe position/s]Normalizing amplitudes:  46%|████▌     | 7557/16384 [00:01<00:01, 6150.35probe position/s]Normalizing amplitudes:  50%|█████     | 8199/16384 [00:01<00:01, 6227.88probe position/s]Normalizing amplitudes:  54%|█████▍    | 8823/16384 [00:01<00:01, 5523.11probe position/s]Normalizing amplitudes:  57%|█████▋    | 9390/16384 [00:01<00:01, 5391.61probe position/s]Normalizing amplitudes:  61%|██████    | 10032/16384 [00:01<00:01, 5673.56probe position/s]Normalizing amplitudes:  65%|██████▌   | 10653/16384 [00:01<00:00, 5822.79probe position/s]Normalizing amplitudes:  69%|██████▉   | 11267/16384 [00:01<00:00, 5904.52probe position/s]Normalizing amplitudes:  73%|███████▎  | 11915/16384 [00:01<00:00, 6071.51probe position/s]Normalizing amplitudes:  77%|███████▋  | 12563/16384 [00:02<00:00, 6188.45probe position/s]Normalizing amplitudes:  81%|████████  | 13221/16384 [00:02<00:00, 6301.98probe position/s]Normalizing amplitudes:  85%|████████▍ | 13858/16384 [00:02<00:00, 6321.21probe position/s]Normalizing amplitudes:  88%|████████▊ | 14492/16384 [00:02<00:00, 6323.38probe position/s]Normalizing amplitudes:  92%|█████████▏| 15126/16384 [00:02<00:00, 6279.30probe position/s]Normalizing amplitudes:  96%|█████████▌| 15762/16384 [00:02<00:00, 6301.38probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6123.07probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random32_p12_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random32_p12_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.02412 in 73.474 sec
Iter: 2, Total Loss: 0.006183 in 74.400 sec
Iter: 3, Total Loss: 0.005868 in 74.818 sec
Iter: 4, Total Loss: 0.005635 in 71.849 sec
Iter: 5, Total Loss: 0.005464 in 70.582 sec
Iter: 6, Total Loss: 0.005329 in 74.846 sec
Iter: 7, Total Loss: 0.00521 in 74.358 sec
Iter: 8, Total Loss: 0.005096 in 74.269 sec
Iter: 9, Total Loss: 0.004989 in 74.651 sec
Iter: 10, Total Loss: 0.004898 in 73.709 sec
Iter: 11, Total Loss: 0.004831 in 71.333 sec
Iter: 12, Total Loss: 0.004781 in 73.007 sec
Iter: 13, Total Loss: 0.004742 in 74.649 sec
Iter: 14, Total Loss: 0.00471 in 75.488 sec
Iter: 15, Total Loss: 0.004683 in 73.943 sec
Iter: 16, Total Loss: 0.004659 in 73.401 sec
Iter: 17, Total Loss: 0.004638 in 70.685 sec
Iter: 18, Total Loss: 0.00462 in 70.948 sec
Iter: 19, Total Loss: 0.004603 in 77.257 sec
Iter: 20, Total Loss: 0.004588 in 74.841 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 73.625 with std = 1.714 sec ###
### py4DSTEM ptycho solver is finished in 24 min 34.628 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 913.39 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 32, 12, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 616/16384 [00:00<00:02, 6151.73probe position/s]Normalizing amplitudes:   8%|▊         | 1272/16384 [00:00<00:02, 6391.25probe position/s]Normalizing amplitudes:  12%|█▏        | 1912/16384 [00:00<00:02, 6125.10probe position/s]Normalizing amplitudes:  16%|█▌        | 2551/16384 [00:00<00:02, 6222.19probe position/s]Normalizing amplitudes:  19%|█▉        | 3175/16384 [00:00<00:02, 6213.17probe position/s]Normalizing amplitudes:  23%|██▎       | 3798/16384 [00:00<00:02, 6217.74probe position/s]Normalizing amplitudes:  27%|██▋       | 4422/16384 [00:00<00:01, 6223.24probe position/s]Normalizing amplitudes:  31%|███       | 5045/16384 [00:00<00:01, 5980.95probe position/s]Normalizing amplitudes:  34%|███▍      | 5646/16384 [00:00<00:01, 5808.79probe position/s]Normalizing amplitudes:  38%|███▊      | 6229/16384 [00:01<00:01, 5714.21probe position/s]Normalizing amplitudes:  42%|████▏     | 6802/16384 [00:01<00:01, 5644.19probe position/s]Normalizing amplitudes:  45%|████▌     | 7420/16384 [00:01<00:01, 5799.36probe position/s]Normalizing amplitudes:  49%|████▉     | 8006/16384 [00:01<00:01, 5816.92probe position/s]Normalizing amplitudes:  52%|█████▏    | 8589/16384 [00:01<00:01, 5816.29probe position/s]Normalizing amplitudes:  56%|█████▌    | 9172/16384 [00:01<00:01, 5818.39probe position/s]Normalizing amplitudes:  60%|█████▉    | 9770/16384 [00:01<00:01, 5863.80probe position/s]Normalizing amplitudes:  63%|██████▎   | 10357/16384 [00:01<00:01, 5815.48probe position/s]Normalizing amplitudes:  67%|██████▋   | 10950/16384 [00:01<00:00, 5848.68probe position/s]Normalizing amplitudes:  70%|███████   | 11536/16384 [00:01<00:00, 5847.25probe position/s]Normalizing amplitudes:  74%|███████▍  | 12145/16384 [00:02<00:00, 5917.35probe position/s]Normalizing amplitudes:  78%|███████▊  | 12758/16384 [00:02<00:00, 5978.01probe position/s]Normalizing amplitudes:  82%|████████▏ | 13356/16384 [00:02<00:00, 5920.53probe position/s]Normalizing amplitudes:  85%|████████▌ | 13967/16384 [00:02<00:00, 5974.00probe position/s]Normalizing amplitudes:  89%|████████▉ | 14565/16384 [00:02<00:00, 5969.60probe position/s]Normalizing amplitudes:  93%|█████████▎| 15163/16384 [00:02<00:00, 5828.88probe position/s]Normalizing amplitudes:  96%|█████████▌| 15747/16384 [00:02<00:00, 5541.86probe position/s]Normalizing amplitudes: 100%|█████████▉| 16316/16384 [00:02<00:00, 5582.84probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5864.23probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random32_p12_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random32_p12_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.02497 in 150.098 sec
Iter: 2, Total Loss: 0.006047 in 138.984 sec
Iter: 3, Total Loss: 0.005675 in 145.756 sec
Iter: 4, Total Loss: 0.005463 in 145.203 sec
Iter: 5, Total Loss: 0.005303 in 145.874 sec
Iter: 6, Total Loss: 0.005162 in 150.635 sec
Iter: 7, Total Loss: 0.005032 in 148.996 sec
Iter: 8, Total Loss: 0.004919 in 142.391 sec
Iter: 9, Total Loss: 0.004829 in 146.781 sec
Iter: 10, Total Loss: 0.004763 in 147.456 sec
Iter: 11, Total Loss: 0.004714 in 139.115 sec
Iter: 12, Total Loss: 0.004676 in 144.295 sec
Iter: 13, Total Loss: 0.004645 in 147.530 sec
Iter: 14, Total Loss: 0.00462 in 140.772 sec
Iter: 15, Total Loss: 0.004598 in 145.838 sec
Iter: 16, Total Loss: 0.00458 in 149.123 sec
Iter: 17, Total Loss: 0.004564 in 142.005 sec
Iter: 18, Total Loss: 0.004549 in 143.111 sec
Iter: 19, Total Loss: 0.004536 in 145.738 sec
Iter: 20, Total Loss: 0.004525 in 142.317 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 145.101 with std = 3.350 sec ###
### py4DSTEM ptycho solver is finished in 48 min 23.885 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 922.18 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 16, 1, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 663/16384 [00:00<00:02, 6624.24probe position/s]Normalizing amplitudes:   8%|▊         | 1357/16384 [00:00<00:02, 6805.47probe position/s]Normalizing amplitudes:  13%|█▎        | 2051/16384 [00:00<00:02, 6864.66probe position/s]Normalizing amplitudes:  17%|█▋        | 2760/16384 [00:00<00:01, 6952.97probe position/s]Normalizing amplitudes:  21%|██        | 3456/16384 [00:00<00:01, 6877.36probe position/s]Normalizing amplitudes:  25%|██▌       | 4144/16384 [00:00<00:01, 6828.31probe position/s]Normalizing amplitudes:  30%|██▉       | 4840/16384 [00:00<00:01, 6869.89probe position/s]Normalizing amplitudes:  34%|███▎      | 5528/16384 [00:00<00:01, 6835.24probe position/s]Normalizing amplitudes:  38%|███▊      | 6212/16384 [00:00<00:01, 6816.88probe position/s]Normalizing amplitudes:  42%|████▏     | 6914/16384 [00:01<00:01, 6878.98probe position/s]Normalizing amplitudes:  46%|████▋     | 7602/16384 [00:01<00:01, 6872.42probe position/s]Normalizing amplitudes:  51%|█████     | 8303/16384 [00:01<00:01, 6910.89probe position/s]Normalizing amplitudes:  55%|█████▍    | 8995/16384 [00:01<00:01, 6904.42probe position/s]Normalizing amplitudes:  59%|█████▉    | 9686/16384 [00:01<00:00, 6862.26probe position/s]Normalizing amplitudes:  63%|██████▎   | 10373/16384 [00:01<00:01, 5582.57probe position/s]Normalizing amplitudes:  67%|██████▋   | 11055/16384 [00:01<00:00, 5900.28probe position/s]Normalizing amplitudes:  72%|███████▏  | 11771/16384 [00:01<00:00, 6237.64probe position/s]Normalizing amplitudes:  76%|███████▌  | 12460/16384 [00:01<00:00, 6417.87probe position/s]Normalizing amplitudes:  80%|████████  | 13122/16384 [00:02<00:00, 5928.82probe position/s]Normalizing amplitudes:  84%|████████▍ | 13786/16384 [00:02<00:00, 6120.80probe position/s]Normalizing amplitudes:  88%|████████▊ | 14466/16384 [00:02<00:00, 6309.67probe position/s]Normalizing amplitudes:  92%|█████████▏| 15126/16384 [00:02<00:00, 6356.70probe position/s]Normalizing amplitudes:  96%|█████████▋| 15771/16384 [00:02<00:00, 5944.63probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6458.78probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random16_p1_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random16_p1_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.006898 in 6.626 sec
Iter: 2, Total Loss: 0.006561 in 6.450 sec
Iter: 3, Total Loss: 0.006466 in 6.443 sec
Iter: 4, Total Loss: 0.00637 in 6.684 sec
Iter: 5, Total Loss: 0.006296 in 7.013 sec
Iter: 6, Total Loss: 0.00624 in 6.838 sec
Iter: 7, Total Loss: 0.006204 in 6.772 sec
Iter: 8, Total Loss: 0.006179 in 7.153 sec
Iter: 9, Total Loss: 0.006162 in 6.815 sec
Iter: 10, Total Loss: 0.00615 in 6.897 sec
Iter: 11, Total Loss: 0.006139 in 6.880 sec
Iter: 12, Total Loss: 0.006134 in 6.848 sec
Iter: 13, Total Loss: 0.006128 in 6.824 sec
Iter: 14, Total Loss: 0.006124 in 6.828 sec
Iter: 15, Total Loss: 0.00612 in 6.969 sec
Iter: 16, Total Loss: 0.006117 in 6.983 sec
Iter: 17, Total Loss: 0.006115 in 7.237 sec
Iter: 18, Total Loss: 0.006113 in 7.408 sec
Iter: 19, Total Loss: 0.006109 in 7.276 sec
Iter: 20, Total Loss: 0.00611 in 7.286 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 6.911 with std = 0.257 sec ###
### py4DSTEM ptycho solver is finished in 2 min 20.351 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 911.86 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 16, 1, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 603/16384 [00:00<00:02, 6023.31probe position/s]Normalizing amplitudes:   7%|▋         | 1206/16384 [00:00<00:02, 5921.01probe position/s]Normalizing amplitudes:  11%|█▏        | 1856/16384 [00:00<00:02, 6181.82probe position/s]Normalizing amplitudes:  15%|█▌        | 2488/16384 [00:00<00:02, 6235.18probe position/s]Normalizing amplitudes:  19%|█▉        | 3112/16384 [00:00<00:02, 6049.90probe position/s]Normalizing amplitudes:  23%|██▎       | 3719/16384 [00:00<00:02, 6014.98probe position/s]Normalizing amplitudes:  26%|██▋       | 4328/16384 [00:00<00:01, 6038.57probe position/s]Normalizing amplitudes:  30%|███       | 4933/16384 [00:00<00:01, 6003.66probe position/s]Normalizing amplitudes:  34%|███▍      | 5574/16384 [00:00<00:01, 6128.04probe position/s]Normalizing amplitudes:  38%|███▊      | 6219/16384 [00:01<00:01, 6225.65probe position/s]Normalizing amplitudes:  42%|████▏     | 6842/16384 [00:01<00:01, 6189.77probe position/s]Normalizing amplitudes:  46%|████▌     | 7462/16384 [00:01<00:01, 5418.90probe position/s]Normalizing amplitudes:  49%|████▉     | 8081/16384 [00:01<00:01, 5628.09probe position/s]Normalizing amplitudes:  53%|█████▎    | 8681/16384 [00:01<00:01, 5730.75probe position/s]Normalizing amplitudes:  57%|█████▋    | 9322/16384 [00:01<00:01, 5923.30probe position/s]Normalizing amplitudes:  61%|██████    | 9971/16384 [00:01<00:01, 6086.03probe position/s]Normalizing amplitudes:  65%|██████▍   | 10587/16384 [00:01<00:00, 5914.35probe position/s]Normalizing amplitudes:  68%|██████▊   | 11184/16384 [00:01<00:00, 5901.52probe position/s]Normalizing amplitudes:  72%|███████▏  | 11778/16384 [00:01<00:00, 5775.99probe position/s]Normalizing amplitudes:  76%|███████▌  | 12399/16384 [00:02<00:00, 5900.75probe position/s]Normalizing amplitudes:  79%|███████▉  | 13002/16384 [00:02<00:00, 5936.10probe position/s]Normalizing amplitudes:  83%|████████▎ | 13662/16384 [00:02<00:00, 6128.36probe position/s]Normalizing amplitudes:  87%|████████▋ | 14277/16384 [00:02<00:00, 6050.86probe position/s]Normalizing amplitudes:  91%|█████████ | 14892/16384 [00:02<00:00, 6079.68probe position/s]Normalizing amplitudes:  95%|█████████▍| 15539/16384 [00:02<00:00, 6194.77probe position/s]Normalizing amplitudes:  99%|█████████▉| 16189/16384 [00:02<00:00, 6282.31probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6020.81probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random16_p1_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random16_p1_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.006923 in 16.726 sec
Iter: 2, Total Loss: 0.006518 in 16.589 sec
Iter: 3, Total Loss: 0.006408 in 16.683 sec
Iter: 4, Total Loss: 0.006323 in 16.501 sec
Iter: 5, Total Loss: 0.006259 in 17.029 sec
Iter: 6, Total Loss: 0.006217 in 17.608 sec
Iter: 7, Total Loss: 0.006183 in 16.869 sec
Iter: 8, Total Loss: 0.006161 in 17.415 sec
Iter: 9, Total Loss: 0.006145 in 16.841 sec
Iter: 10, Total Loss: 0.006131 in 16.894 sec
Iter: 11, Total Loss: 0.006121 in 16.694 sec
Iter: 12, Total Loss: 0.006113 in 16.579 sec
Iter: 13, Total Loss: 0.0061 in 16.257 sec
Iter: 14, Total Loss: 0.006097 in 15.938 sec
Iter: 15, Total Loss: 0.00609 in 16.195 sec
Iter: 16, Total Loss: 0.006083 in 16.275 sec
Iter: 17, Total Loss: 0.006077 in 15.495 sec
Iter: 18, Total Loss: 0.006071 in 15.396 sec
Iter: 19, Total Loss: 0.006066 in 15.950 sec
Iter: 20, Total Loss: 0.006062 in 15.526 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 16.473 with std = 0.586 sec ###
### py4DSTEM ptycho solver is finished in 5 min 31.379 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 917.16 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 16, 1, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 681/16384 [00:00<00:02, 6799.68probe position/s]Normalizing amplitudes:   8%|▊         | 1361/16384 [00:00<00:02, 6011.81probe position/s]Normalizing amplitudes:  12%|█▏        | 1969/16384 [00:00<00:02, 5803.50probe position/s]Normalizing amplitudes:  16%|█▌        | 2561/16384 [00:00<00:02, 5844.99probe position/s]Normalizing amplitudes:  20%|█▉        | 3201/16384 [00:00<00:02, 6034.75probe position/s]Normalizing amplitudes:  23%|██▎       | 3823/16384 [00:00<00:02, 6095.76probe position/s]Normalizing amplitudes:  28%|██▊       | 4509/16384 [00:00<00:01, 6338.91probe position/s]Normalizing amplitudes:  31%|███▏      | 5145/16384 [00:00<00:01, 6196.81probe position/s]Normalizing amplitudes:  35%|███▌      | 5774/16384 [00:00<00:01, 6223.30probe position/s]Normalizing amplitudes:  39%|███▉      | 6398/16384 [00:01<00:01, 6214.20probe position/s]Normalizing amplitudes:  43%|████▎     | 7021/16384 [00:01<00:01, 6209.59probe position/s]Normalizing amplitudes:  47%|████▋     | 7671/16384 [00:01<00:01, 6294.77probe position/s]Normalizing amplitudes:  51%|█████     | 8318/16384 [00:01<00:01, 6345.19probe position/s]Normalizing amplitudes:  55%|█████▍    | 8953/16384 [00:01<00:01, 6241.46probe position/s]Normalizing amplitudes:  59%|█████▉    | 9640/16384 [00:01<00:01, 6426.77probe position/s]Normalizing amplitudes:  63%|██████▎   | 10303/16384 [00:01<00:00, 6487.06probe position/s]Normalizing amplitudes:  67%|██████▋   | 10983/16384 [00:01<00:00, 6578.41probe position/s]Normalizing amplitudes:  71%|███████   | 11655/16384 [00:01<00:00, 6617.58probe position/s]Normalizing amplitudes:  75%|███████▌  | 12318/16384 [00:01<00:00, 6446.52probe position/s]Normalizing amplitudes:  79%|███████▉  | 12964/16384 [00:02<00:00, 5693.61probe position/s]Normalizing amplitudes:  83%|████████▎ | 13550/16384 [00:02<00:00, 5501.22probe position/s]Normalizing amplitudes:  86%|████████▌ | 14123/16384 [00:02<00:00, 5562.53probe position/s]Normalizing amplitudes:  90%|████████▉ | 14733/16384 [00:02<00:00, 5712.00probe position/s]Normalizing amplitudes:  94%|█████████▎| 15356/16384 [00:02<00:00, 5857.80probe position/s]Normalizing amplitudes:  98%|█████████▊| 16025/16384 [00:02<00:00, 6096.94probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6131.50probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random16_p1_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random16_p1_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.006993 in 30.147 sec
Iter: 2, Total Loss: 0.006554 in 30.207 sec
Iter: 3, Total Loss: 0.006439 in 30.414 sec
Iter: 4, Total Loss: 0.006358 in 30.211 sec
Iter: 5, Total Loss: 0.006301 in 30.661 sec
Iter: 6, Total Loss: 0.006261 in 31.198 sec
Iter: 7, Total Loss: 0.006229 in 30.728 sec
Iter: 8, Total Loss: 0.006207 in 30.283 sec
Iter: 9, Total Loss: 0.006179 in 30.379 sec
Iter: 10, Total Loss: 0.006158 in 30.388 sec
Iter: 11, Total Loss: 0.00614 in 30.435 sec
Iter: 12, Total Loss: 0.006123 in 29.491 sec
Iter: 13, Total Loss: 0.006104 in 29.240 sec
Iter: 14, Total Loss: 0.006084 in 28.557 sec
Iter: 15, Total Loss: 0.006064 in 28.627 sec
Iter: 16, Total Loss: 0.006047 in 29.944 sec
Iter: 17, Total Loss: 0.006026 in 30.525 sec
Iter: 18, Total Loss: 0.006008 in 30.386 sec
Iter: 19, Total Loss: 0.005993 in 31.033 sec
Iter: 20, Total Loss: 0.005977 in 30.531 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 30.169 with std = 0.680 sec ###
### py4DSTEM ptycho solver is finished in 10 min 5.619 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 911.04 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 16, 3, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 621/16384 [00:00<00:02, 6208.70probe position/s]Normalizing amplitudes:   8%|▊         | 1242/16384 [00:00<00:02, 6012.59probe position/s]Normalizing amplitudes:  11%|█▏        | 1844/16384 [00:00<00:02, 5993.17probe position/s]Normalizing amplitudes:  15%|█▍        | 2457/16384 [00:00<00:02, 6044.95probe position/s]Normalizing amplitudes:  19%|█▊        | 3062/16384 [00:00<00:02, 6037.20probe position/s]Normalizing amplitudes:  23%|██▎       | 3703/16384 [00:00<00:02, 6160.69probe position/s]Normalizing amplitudes:  26%|██▋       | 4325/16384 [00:00<00:01, 6174.87probe position/s]Normalizing amplitudes:  30%|███       | 4948/16384 [00:00<00:01, 6190.35probe position/s]Normalizing amplitudes:  34%|███▍      | 5568/16384 [00:00<00:01, 6144.25probe position/s]Normalizing amplitudes:  38%|███▊      | 6183/16384 [00:01<00:01, 6052.84probe position/s]Normalizing amplitudes:  42%|████▏     | 6813/16384 [00:01<00:01, 6120.22probe position/s]Normalizing amplitudes:  45%|████▌     | 7426/16384 [00:01<00:01, 6049.84probe position/s]Normalizing amplitudes:  49%|████▉     | 8062/16384 [00:01<00:01, 6141.73probe position/s]Normalizing amplitudes:  53%|█████▎    | 8677/16384 [00:01<00:01, 6082.33probe position/s]Normalizing amplitudes:  57%|█████▋    | 9291/16384 [00:01<00:01, 6098.30probe position/s]Normalizing amplitudes:  60%|██████    | 9905/16384 [00:01<00:01, 6110.57probe position/s]Normalizing amplitudes:  64%|██████▍   | 10517/16384 [00:01<00:00, 5949.85probe position/s]Normalizing amplitudes:  68%|██████▊   | 11113/16384 [00:01<00:00, 5945.03probe position/s]Normalizing amplitudes:  71%|███████▏  | 11709/16384 [00:01<00:00, 5913.44probe position/s]Normalizing amplitudes:  75%|███████▌  | 12310/16384 [00:02<00:00, 5939.34probe position/s]Normalizing amplitudes:  79%|███████▉  | 12935/16384 [00:02<00:00, 6030.04probe position/s]Normalizing amplitudes:  83%|████████▎ | 13539/16384 [00:02<00:00, 6022.14probe position/s]Normalizing amplitudes:  87%|████████▋ | 14190/16384 [00:02<00:00, 6166.65probe position/s]Normalizing amplitudes:  90%|█████████ | 14812/16384 [00:02<00:00, 6181.75probe position/s]Normalizing amplitudes:  94%|█████████▍| 15431/16384 [00:02<00:00, 6174.27probe position/s]Normalizing amplitudes:  98%|█████████▊| 16049/16384 [00:02<00:00, 6131.11probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6072.49probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random16_p3_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random16_p3_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.007683 in 14.895 sec
Iter: 2, Total Loss: 0.00642 in 14.672 sec
Iter: 3, Total Loss: 0.006211 in 14.710 sec
Iter: 4, Total Loss: 0.006016 in 14.854 sec
Iter: 5, Total Loss: 0.005857 in 14.971 sec
Iter: 6, Total Loss: 0.005738 in 14.929 sec
Iter: 7, Total Loss: 0.005644 in 15.121 sec
Iter: 8, Total Loss: 0.005562 in 15.085 sec
Iter: 9, Total Loss: 0.005491 in 14.881 sec
Iter: 10, Total Loss: 0.005428 in 15.280 sec
Iter: 11, Total Loss: 0.005378 in 15.646 sec
Iter: 12, Total Loss: 0.005342 in 14.400 sec
Iter: 13, Total Loss: 0.005317 in 14.346 sec
Iter: 14, Total Loss: 0.005297 in 14.297 sec
Iter: 15, Total Loss: 0.005282 in 13.601 sec
Iter: 16, Total Loss: 0.00527 in 13.573 sec
Iter: 17, Total Loss: 0.00526 in 13.573 sec
Iter: 18, Total Loss: 0.005252 in 14.454 sec
Iter: 19, Total Loss: 0.005244 in 14.231 sec
Iter: 20, Total Loss: 0.005238 in 14.083 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 14.580 with std = 0.560 sec ###
### py4DSTEM ptycho solver is finished in 4 min 53.371 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 915.38 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 16, 3, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 682/16384 [00:00<00:02, 6814.17probe position/s]Normalizing amplitudes:   8%|▊         | 1369/16384 [00:00<00:02, 6841.78probe position/s]Normalizing amplitudes:  13%|█▎        | 2054/16384 [00:00<00:02, 6519.88probe position/s]Normalizing amplitudes:  17%|█▋        | 2708/16384 [00:00<00:02, 6201.61probe position/s]Normalizing amplitudes:  21%|██        | 3380/16384 [00:00<00:02, 6374.95probe position/s]Normalizing amplitudes:  25%|██▍       | 4050/16384 [00:00<00:01, 6480.82probe position/s]Normalizing amplitudes:  29%|██▉       | 4752/16384 [00:00<00:01, 6652.49probe position/s]Normalizing amplitudes:  33%|███▎      | 5435/16384 [00:00<00:01, 6702.85probe position/s]Normalizing amplitudes:  37%|███▋      | 6107/16384 [00:00<00:01, 6701.82probe position/s]Normalizing amplitudes:  41%|████▏     | 6779/16384 [00:01<00:01, 6653.28probe position/s]Normalizing amplitudes:  45%|████▌     | 7445/16384 [00:01<00:01, 6343.01probe position/s]Normalizing amplitudes:  49%|████▉     | 8083/16384 [00:01<00:01, 6096.23probe position/s]Normalizing amplitudes:  53%|█████▎    | 8697/16384 [00:01<00:01, 5984.39probe position/s]Normalizing amplitudes:  57%|█████▋    | 9382/16384 [00:01<00:01, 6230.19probe position/s]Normalizing amplitudes:  61%|██████    | 10022/16384 [00:01<00:01, 6278.44probe position/s]Normalizing amplitudes:  65%|██████▌   | 10653/16384 [00:01<00:00, 6219.32probe position/s]Normalizing amplitudes:  69%|██████▉   | 11283/16384 [00:01<00:00, 6242.70probe position/s]Normalizing amplitudes:  73%|███████▎  | 11954/16384 [00:01<00:00, 6379.91probe position/s]Normalizing amplitudes:  77%|███████▋  | 12673/16384 [00:01<00:00, 6614.77probe position/s]Normalizing amplitudes:  81%|████████▏ | 13336/16384 [00:02<00:00, 6501.45probe position/s]Normalizing amplitudes:  85%|████████▌ | 13988/16384 [00:02<00:00, 6361.29probe position/s]Normalizing amplitudes:  90%|████████▉ | 14665/16384 [00:02<00:00, 6478.11probe position/s]Normalizing amplitudes:  94%|█████████▎| 15323/16384 [00:02<00:00, 6507.37probe position/s]Normalizing amplitudes:  98%|█████████▊| 16011/16384 [00:02<00:00, 6616.97probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6456.55probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random16_p3_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random16_p3_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.007705 in 40.118 sec
Iter: 2, Total Loss: 0.006199 in 40.397 sec
Iter: 3, Total Loss: 0.005922 in 41.295 sec
Iter: 4, Total Loss: 0.00572 in 39.405 sec
Iter: 5, Total Loss: 0.005577 in 39.376 sec
Iter: 6, Total Loss: 0.005466 in 39.632 sec
Iter: 7, Total Loss: 0.005374 in 39.657 sec
Iter: 8, Total Loss: 0.005297 in 39.470 sec
Iter: 9, Total Loss: 0.005239 in 39.635 sec
Iter: 10, Total Loss: 0.005199 in 37.343 sec
Iter: 11, Total Loss: 0.005169 in 37.404 sec
Iter: 12, Total Loss: 0.005146 in 38.464 sec
Iter: 13, Total Loss: 0.005127 in 40.059 sec
Iter: 14, Total Loss: 0.00511 in 39.374 sec
Iter: 15, Total Loss: 0.005095 in 39.185 sec
Iter: 16, Total Loss: 0.005082 in 39.127 sec
Iter: 17, Total Loss: 0.005069 in 39.159 sec
Iter: 18, Total Loss: 0.005057 in 38.676 sec
Iter: 19, Total Loss: 0.005045 in 39.314 sec
Iter: 20, Total Loss: 0.005034 in 39.680 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 39.339 with std = 0.881 sec ###
### py4DSTEM ptycho solver is finished in 13 min 8.954 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 919.97 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 16, 3, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 643/16384 [00:00<00:02, 6424.00probe position/s]Normalizing amplitudes:   8%|▊         | 1286/16384 [00:00<00:03, 3884.32probe position/s]Normalizing amplitudes:  11%|█         | 1811/16384 [00:00<00:03, 4343.71probe position/s]Normalizing amplitudes:  15%|█▍        | 2456/16384 [00:00<00:02, 5027.55probe position/s]Normalizing amplitudes:  18%|█▊        | 3021/16384 [00:00<00:02, 5223.06probe position/s]Normalizing amplitudes:  23%|██▎       | 3696/16384 [00:00<00:02, 5696.96probe position/s]Normalizing amplitudes:  26%|██▋       | 4323/16384 [00:00<00:02, 5872.54probe position/s]Normalizing amplitudes:  30%|███       | 4928/16384 [00:00<00:02, 5578.59probe position/s]Normalizing amplitudes:  34%|███▍      | 5573/16384 [00:01<00:01, 5831.44probe position/s]Normalizing amplitudes:  38%|███▊      | 6216/16384 [00:01<00:01, 6003.83probe position/s]Normalizing amplitudes:  42%|████▏     | 6960/16384 [00:01<00:01, 6427.91probe position/s]Normalizing amplitudes:  47%|████▋     | 7632/16384 [00:01<00:01, 6512.42probe position/s]Normalizing amplitudes:  51%|█████     | 8289/16384 [00:01<00:01, 6292.52probe position/s]Normalizing amplitudes:  54%|█████▍    | 8924/16384 [00:01<00:01, 4746.12probe position/s]Normalizing amplitudes:  59%|█████▉    | 9637/16384 [00:01<00:01, 5311.27probe position/s]Normalizing amplitudes:  62%|██████▏   | 10224/16384 [00:01<00:01, 5407.77probe position/s]Normalizing amplitudes:  66%|██████▋   | 10877/16384 [00:01<00:00, 5704.15probe position/s]Normalizing amplitudes:  71%|███████   | 11551/16384 [00:02<00:00, 5986.49probe position/s]Normalizing amplitudes:  74%|███████▍  | 12175/16384 [00:02<00:00, 5958.06probe position/s]Normalizing amplitudes:  78%|███████▊  | 12806/16384 [00:02<00:00, 6054.87probe position/s]Normalizing amplitudes:  82%|████████▏ | 13477/16384 [00:02<00:00, 6242.39probe position/s]Normalizing amplitudes:  86%|████████▌ | 14112/16384 [00:02<00:00, 4943.81probe position/s]Normalizing amplitudes:  90%|█████████ | 14783/16384 [00:02<00:00, 5378.20probe position/s]Normalizing amplitudes:  94%|█████████▍| 15365/16384 [00:02<00:00, 5168.88probe position/s]Normalizing amplitudes:  97%|█████████▋| 15936/16384 [00:02<00:00, 5308.04probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5531.83probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random16_p3_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random16_p3_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.007896 in 72.887 sec
Iter: 2, Total Loss: 0.006021 in 73.822 sec
Iter: 3, Total Loss: 0.005709 in 74.796 sec
Iter: 4, Total Loss: 0.005538 in 76.165 sec
Iter: 5, Total Loss: 0.005438 in 75.762 sec
Iter: 6, Total Loss: 0.00536 in 74.611 sec
Iter: 7, Total Loss: 0.005291 in 71.832 sec
Iter: 8, Total Loss: 0.00523 in 73.708 sec
Iter: 9, Total Loss: 0.005183 in 76.488 sec
Iter: 10, Total Loss: 0.005145 in 75.645 sec
Iter: 11, Total Loss: 0.005117 in 77.401 sec
Iter: 12, Total Loss: 0.005094 in 76.517 sec
Iter: 13, Total Loss: 0.005075 in 71.747 sec
Iter: 14, Total Loss: 0.005061 in 73.327 sec
Iter: 15, Total Loss: 0.005048 in 74.198 sec
Iter: 16, Total Loss: 0.005037 in 74.675 sec
Iter: 17, Total Loss: 0.005026 in 77.960 sec
Iter: 18, Total Loss: 0.005017 in 75.164 sec
Iter: 19, Total Loss: 0.005008 in 71.974 sec
Iter: 20, Total Loss: 0.005 in 73.075 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 74.588 with std = 1.772 sec ###
### py4DSTEM ptycho solver is finished in 24 min 54.128 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 915.84 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 16, 6, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 660/16384 [00:00<00:02, 6591.43probe position/s]Normalizing amplitudes:   8%|▊         | 1320/16384 [00:00<00:02, 6202.70probe position/s]Normalizing amplitudes:  12%|█▏        | 1959/16384 [00:00<00:02, 6284.86probe position/s]Normalizing amplitudes:  16%|█▌        | 2622/16384 [00:00<00:02, 6417.21probe position/s]Normalizing amplitudes:  20%|█▉        | 3270/16384 [00:00<00:02, 6438.61probe position/s]Normalizing amplitudes:  24%|██▍       | 3925/16384 [00:00<00:01, 6474.08probe position/s]Normalizing amplitudes:  28%|██▊       | 4590/16384 [00:00<00:01, 6528.74probe position/s]Normalizing amplitudes:  32%|███▏      | 5244/16384 [00:00<00:01, 6500.34probe position/s]Normalizing amplitudes:  36%|███▌      | 5897/16384 [00:00<00:01, 6508.93probe position/s]Normalizing amplitudes:  40%|███▉      | 6549/16384 [00:01<00:01, 6450.06probe position/s]Normalizing amplitudes:  44%|████▍     | 7195/16384 [00:01<00:01, 6448.40probe position/s]Normalizing amplitudes:  48%|████▊     | 7866/16384 [00:01<00:01, 6527.06probe position/s]Normalizing amplitudes:  52%|█████▏    | 8521/16384 [00:01<00:01, 6530.55probe position/s]Normalizing amplitudes:  56%|█████▌    | 9175/16384 [00:01<00:01, 6497.78probe position/s]Normalizing amplitudes:  60%|█████▉    | 9827/16384 [00:01<00:01, 6503.86probe position/s]Normalizing amplitudes:  64%|██████▍   | 10478/16384 [00:01<00:00, 6493.17probe position/s]Normalizing amplitudes:  68%|██████▊   | 11128/16384 [00:01<00:00, 6469.11probe position/s]Normalizing amplitudes:  72%|███████▏  | 11795/16384 [00:01<00:00, 6527.69probe position/s]Normalizing amplitudes:  76%|███████▌  | 12450/16384 [00:01<00:00, 6532.68probe position/s]Normalizing amplitudes:  80%|███████▉  | 13104/16384 [00:02<00:00, 6430.04probe position/s]Normalizing amplitudes:  84%|████████▍ | 13748/16384 [00:02<00:00, 6402.02probe position/s]Normalizing amplitudes:  88%|████████▊ | 14389/16384 [00:02<00:00, 6317.47probe position/s]Normalizing amplitudes:  92%|█████████▏| 15035/16384 [00:02<00:00, 6359.00probe position/s]Normalizing amplitudes:  96%|█████████▌| 15692/16384 [00:02<00:00, 6421.02probe position/s]Normalizing amplitudes: 100%|█████████▉| 16346/16384 [00:02<00:00, 6455.91probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6454.37probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random16_p6_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random16_p6_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.009854 in 25.895 sec
Iter: 2, Total Loss: 0.00638 in 26.012 sec
Iter: 3, Total Loss: 0.006137 in 25.843 sec
Iter: 4, Total Loss: 0.005918 in 26.002 sec
Iter: 5, Total Loss: 0.005752 in 26.412 sec
Iter: 6, Total Loss: 0.005626 in 25.996 sec
Iter: 7, Total Loss: 0.005515 in 25.764 sec
Iter: 8, Total Loss: 0.005403 in 26.172 sec
Iter: 9, Total Loss: 0.005289 in 25.937 sec
Iter: 10, Total Loss: 0.005192 in 25.810 sec
Iter: 11, Total Loss: 0.005119 in 25.683 sec
Iter: 12, Total Loss: 0.005064 in 25.668 sec
Iter: 13, Total Loss: 0.005023 in 25.441 sec
Iter: 14, Total Loss: 0.004989 in 24.170 sec
Iter: 15, Total Loss: 0.004961 in 24.792 sec
Iter: 16, Total Loss: 0.004938 in 24.830 sec
Iter: 17, Total Loss: 0.004918 in 25.149 sec
Iter: 18, Total Loss: 0.004901 in 25.438 sec
Iter: 19, Total Loss: 0.004886 in 25.787 sec
Iter: 20, Total Loss: 0.004873 in 25.968 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 25.638 with std = 0.525 sec ###
### py4DSTEM ptycho solver is finished in 8 min 34.935 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 910.79 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 16, 6, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 617/16384 [00:00<00:02, 6166.59probe position/s]Normalizing amplitudes:   8%|▊         | 1258/16384 [00:00<00:02, 6306.77probe position/s]Normalizing amplitudes:  12%|█▏        | 1889/16384 [00:00<00:02, 5748.46probe position/s]Normalizing amplitudes:  15%|█▌        | 2512/16384 [00:00<00:02, 5927.43probe position/s]Normalizing amplitudes:  19%|█▉        | 3149/16384 [00:00<00:02, 6079.49probe position/s]Normalizing amplitudes:  23%|██▎       | 3788/16384 [00:00<00:02, 6180.44probe position/s]Normalizing amplitudes:  27%|██▋       | 4409/16384 [00:00<00:01, 6176.79probe position/s]Normalizing amplitudes:  31%|███       | 5033/16384 [00:00<00:01, 6192.80probe position/s]Normalizing amplitudes:  35%|███▍      | 5654/16384 [00:00<00:01, 6127.31probe position/s]Normalizing amplitudes:  38%|███▊      | 6268/16384 [00:01<00:01, 6050.51probe position/s]Normalizing amplitudes:  42%|████▏     | 6884/16384 [00:01<00:01, 6082.58probe position/s]Normalizing amplitudes:  46%|████▌     | 7529/16384 [00:01<00:01, 6191.03probe position/s]Normalizing amplitudes:  50%|█████     | 8192/16384 [00:01<00:01, 6319.91probe position/s]Normalizing amplitudes:  54%|█████▍    | 8825/16384 [00:01<00:01, 6275.58probe position/s]Normalizing amplitudes:  58%|█████▊    | 9458/16384 [00:01<00:01, 6291.69probe position/s]Normalizing amplitudes:  62%|██████▏   | 10088/16384 [00:01<00:01, 6266.66probe position/s]Normalizing amplitudes:  65%|██████▌   | 10715/16384 [00:01<00:00, 6240.19probe position/s]Normalizing amplitudes:  69%|██████▉   | 11344/16384 [00:01<00:00, 6254.56probe position/s]Normalizing amplitudes:  73%|███████▎  | 11990/16384 [00:01<00:00, 6315.17probe position/s]Normalizing amplitudes:  77%|███████▋  | 12629/16384 [00:02<00:00, 6335.83probe position/s]Normalizing amplitudes:  81%|████████  | 13263/16384 [00:02<00:00, 6216.81probe position/s]Normalizing amplitudes:  85%|████████▍ | 13886/16384 [00:02<00:00, 6170.26probe position/s]Normalizing amplitudes:  89%|████████▊ | 14520/16384 [00:02<00:00, 6219.34probe position/s]Normalizing amplitudes:  92%|█████████▏| 15152/16384 [00:02<00:00, 6246.85probe position/s]Normalizing amplitudes:  96%|█████████▋| 15787/16384 [00:02<00:00, 6275.83probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6206.15probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random16_p6_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random16_p6_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.009963 in 72.710 sec
Iter: 2, Total Loss: 0.0061 in 73.728 sec
Iter: 3, Total Loss: 0.005744 in 74.804 sec
Iter: 4, Total Loss: 0.005516 in 70.388 sec
Iter: 5, Total Loss: 0.00534 in 70.666 sec
Iter: 6, Total Loss: 0.005178 in 74.487 sec
Iter: 7, Total Loss: 0.005053 in 73.482 sec
Iter: 8, Total Loss: 0.004975 in 73.824 sec
Iter: 9, Total Loss: 0.004924 in 74.774 sec
Iter: 10, Total Loss: 0.004885 in 70.429 sec
Iter: 11, Total Loss: 0.004855 in 69.975 sec
Iter: 12, Total Loss: 0.00483 in 72.296 sec
Iter: 13, Total Loss: 0.004808 in 73.129 sec
Iter: 14, Total Loss: 0.00479 in 73.273 sec
Iter: 15, Total Loss: 0.004773 in 72.300 sec
Iter: 16, Total Loss: 0.004758 in 71.076 sec
Iter: 17, Total Loss: 0.004745 in 69.381 sec
Iter: 18, Total Loss: 0.004733 in 72.105 sec
Iter: 19, Total Loss: 0.004722 in 74.043 sec
Iter: 20, Total Loss: 0.004712 in 74.497 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 72.568 with std = 1.680 sec ###
### py4DSTEM ptycho solver is finished in 24 min 13.628 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 910.68 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 16, 6, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 487/16384 [00:00<00:03, 4866.98probe position/s]Normalizing amplitudes:   7%|▋         | 1140/16384 [00:00<00:02, 5842.88probe position/s]Normalizing amplitudes:  11%|█         | 1725/16384 [00:00<00:02, 5837.54probe position/s]Normalizing amplitudes:  14%|█▍        | 2309/16384 [00:00<00:02, 5813.49probe position/s]Normalizing amplitudes:  18%|█▊        | 2927/16384 [00:00<00:02, 5943.23probe position/s]Normalizing amplitudes:  22%|██▏       | 3556/16384 [00:00<00:02, 6059.86probe position/s]Normalizing amplitudes:  25%|██▌       | 4171/16384 [00:00<00:02, 6086.45probe position/s]Normalizing amplitudes:  29%|██▉       | 4784/16384 [00:00<00:01, 6098.25probe position/s]Normalizing amplitudes:  33%|███▎      | 5401/16384 [00:00<00:01, 6120.19probe position/s]Normalizing amplitudes:  37%|███▋      | 6039/16384 [00:01<00:01, 6199.81probe position/s]Normalizing amplitudes:  41%|████      | 6672/16384 [00:01<00:01, 6238.56probe position/s]Normalizing amplitudes:  45%|████▍     | 7296/16384 [00:01<00:01, 6223.02probe position/s]Normalizing amplitudes:  48%|████▊     | 7919/16384 [00:01<00:01, 6173.60probe position/s]Normalizing amplitudes:  52%|█████▏    | 8537/16384 [00:01<00:01, 6157.00probe position/s]Normalizing amplitudes:  56%|█████▌    | 9153/16384 [00:01<00:01, 6138.50probe position/s]Normalizing amplitudes:  60%|█████▉    | 9767/16384 [00:01<00:01, 6112.88probe position/s]Normalizing amplitudes:  63%|██████▎   | 10379/16384 [00:01<00:00, 6039.31probe position/s]Normalizing amplitudes:  67%|██████▋   | 11009/16384 [00:01<00:00, 6115.79probe position/s]Normalizing amplitudes:  71%|███████   | 11622/16384 [00:01<00:00, 6119.25probe position/s]Normalizing amplitudes:  75%|███████▍  | 12247/16384 [00:02<00:00, 6155.94probe position/s]Normalizing amplitudes:  79%|███████▊  | 12863/16384 [00:02<00:00, 6151.56probe position/s]Normalizing amplitudes:  82%|████████▏ | 13479/16384 [00:02<00:00, 6152.33probe position/s]Normalizing amplitudes:  86%|████████▌ | 14095/16384 [00:02<00:00, 6123.78probe position/s]Normalizing amplitudes:  90%|████████▉ | 14708/16384 [00:02<00:00, 6018.83probe position/s]Normalizing amplitudes:  93%|█████████▎| 15311/16384 [00:02<00:00, 5980.28probe position/s]Normalizing amplitudes:  97%|█████████▋| 15951/16384 [00:02<00:00, 6101.47probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6087.88probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random16_p6_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random16_p6_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.0103 in 150.289 sec
Iter: 2, Total Loss: 0.005965 in 141.907 sec
Iter: 3, Total Loss: 0.005597 in 144.694 sec
Iter: 4, Total Loss: 0.005374 in 144.633 sec
Iter: 5, Total Loss: 0.005186 in 138.806 sec
Iter: 6, Total Loss: 0.005027 in 147.000 sec
Iter: 7, Total Loss: 0.00493 in 146.069 sec
Iter: 8, Total Loss: 0.004871 in 139.031 sec
Iter: 9, Total Loss: 0.00483 in 149.107 sec
Iter: 10, Total Loss: 0.004799 in 147.438 sec
Iter: 11, Total Loss: 0.004774 in 139.285 sec
Iter: 12, Total Loss: 0.004753 in 143.253 sec
Iter: 13, Total Loss: 0.004734 in 143.050 sec
Iter: 14, Total Loss: 0.004719 in 144.463 sec
Iter: 15, Total Loss: 0.004704 in 140.952 sec
Iter: 16, Total Loss: 0.004692 in 149.454 sec
Iter: 17, Total Loss: 0.00468 in 144.985 sec
Iter: 18, Total Loss: 0.004669 in 143.812 sec
Iter: 19, Total Loss: 0.004659 in 147.820 sec
Iter: 20, Total Loss: 0.004649 in 147.911 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 144.698 with std = 3.404 sec ###
### py4DSTEM ptycho solver is finished in 48 min 15.891 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 916.40 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 16, 12, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 696/16384 [00:00<00:02, 6951.72probe position/s]Normalizing amplitudes:   8%|▊         | 1392/16384 [00:00<00:02, 6757.38probe position/s]Normalizing amplitudes:  13%|█▎        | 2069/16384 [00:00<00:02, 6744.43probe position/s]Normalizing amplitudes:  17%|█▋        | 2744/16384 [00:00<00:02, 6224.57probe position/s]Normalizing amplitudes:  21%|██        | 3415/16384 [00:00<00:02, 6389.29probe position/s]Normalizing amplitudes:  25%|██▌       | 4097/16384 [00:00<00:01, 6527.62probe position/s]Normalizing amplitudes:  29%|██▉       | 4772/16384 [00:00<00:01, 6596.11probe position/s]Normalizing amplitudes:  33%|███▎      | 5461/16384 [00:00<00:01, 6685.64probe position/s]Normalizing amplitudes:  37%|███▋      | 6139/16384 [00:00<00:01, 6713.31probe position/s]Normalizing amplitudes:  42%|████▏     | 6831/16384 [00:01<00:01, 6774.70probe position/s]Normalizing amplitudes:  46%|████▌     | 7516/16384 [00:01<00:01, 6795.98probe position/s]Normalizing amplitudes:  50%|█████     | 8197/16384 [00:01<00:01, 6707.05probe position/s]Normalizing amplitudes:  55%|█████▍    | 8973/16384 [00:01<00:01, 7020.93probe position/s]Normalizing amplitudes:  59%|█████▉    | 9676/16384 [00:01<00:00, 6950.26probe position/s]Normalizing amplitudes:  63%|██████▎   | 10372/16384 [00:01<00:00, 6835.27probe position/s]Normalizing amplitudes:  68%|██████▊   | 11066/16384 [00:01<00:00, 6864.77probe position/s]Normalizing amplitudes:  72%|███████▏  | 11771/16384 [00:01<00:00, 6918.34probe position/s]Normalizing amplitudes:  76%|███████▌  | 12464/16384 [00:01<00:00, 6828.09probe position/s]Normalizing amplitudes:  80%|████████  | 13148/16384 [00:01<00:00, 6711.40probe position/s]Normalizing amplitudes:  84%|████████▍ | 13820/16384 [00:02<00:00, 6703.88probe position/s]Normalizing amplitudes:  88%|████████▊ | 14491/16384 [00:02<00:00, 6675.47probe position/s]Normalizing amplitudes:  93%|█████████▎| 15174/16384 [00:02<00:00, 6719.75probe position/s]Normalizing amplitudes:  97%|█████████▋| 15862/16384 [00:02<00:00, 6767.06probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6735.57probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random16_p12_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random16_p12_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.01523 in 46.294 sec
Iter: 2, Total Loss: 0.006387 in 48.047 sec
Iter: 3, Total Loss: 0.006138 in 48.840 sec
Iter: 4, Total Loss: 0.005905 in 52.160 sec
Iter: 5, Total Loss: 0.005721 in 49.141 sec
Iter: 6, Total Loss: 0.005581 in 49.323 sec
Iter: 7, Total Loss: 0.005449 in 49.488 sec
Iter: 8, Total Loss: 0.005315 in 49.069 sec
Iter: 9, Total Loss: 0.005195 in 48.018 sec
Iter: 10, Total Loss: 0.005106 in 45.667 sec
Iter: 11, Total Loss: 0.00504 in 46.561 sec
Iter: 12, Total Loss: 0.004986 in 47.495 sec
Iter: 13, Total Loss: 0.004943 in 48.610 sec
Iter: 14, Total Loss: 0.004905 in 49.085 sec
Iter: 15, Total Loss: 0.00487 in 52.737 sec
Iter: 16, Total Loss: 0.004839 in 49.129 sec
Iter: 17, Total Loss: 0.00481 in 48.715 sec
Iter: 18, Total Loss: 0.004784 in 48.876 sec
Iter: 19, Total Loss: 0.004758 in 47.728 sec
Iter: 20, Total Loss: 0.004734 in 46.666 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 48.582 with std = 1.684 sec ###
### py4DSTEM ptycho solver is finished in 16 min 15.106 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 922.60 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 16, 12, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 675/16384 [00:00<00:02, 6747.26probe position/s]Normalizing amplitudes:   8%|▊         | 1356/16384 [00:00<00:02, 6778.10probe position/s]Normalizing amplitudes:  12%|█▏        | 2034/16384 [00:00<00:02, 6735.67probe position/s]Normalizing amplitudes:  17%|█▋        | 2728/16384 [00:00<00:02, 6815.09probe position/s]Normalizing amplitudes:  21%|██        | 3448/16384 [00:00<00:01, 6952.90probe position/s]Normalizing amplitudes:  25%|██▌       | 4144/16384 [00:00<00:01, 6914.90probe position/s]Normalizing amplitudes:  30%|██▉       | 4836/16384 [00:00<00:01, 6830.13probe position/s]Normalizing amplitudes:  34%|███▎      | 5520/16384 [00:00<00:01, 6796.64probe position/s]Normalizing amplitudes:  38%|███▊      | 6200/16384 [00:00<00:01, 6741.69probe position/s]Normalizing amplitudes:  42%|████▏     | 6875/16384 [00:01<00:01, 6706.14probe position/s]Normalizing amplitudes:  46%|████▌     | 7570/16384 [00:01<00:01, 6777.17probe position/s]Normalizing amplitudes:  50%|█████     | 8252/16384 [00:01<00:01, 6789.18probe position/s]Normalizing amplitudes:  55%|█████▍    | 8950/16384 [00:01<00:01, 6846.05probe position/s]Normalizing amplitudes:  59%|█████▉    | 9652/16384 [00:01<00:00, 6897.24probe position/s]Normalizing amplitudes:  63%|██████▎   | 10342/16384 [00:01<00:00, 6833.51probe position/s]Normalizing amplitudes:  67%|██████▋   | 11026/16384 [00:01<00:00, 6820.29probe position/s]Normalizing amplitudes:  71%|███████▏  | 11709/16384 [00:01<00:00, 6819.85probe position/s]Normalizing amplitudes:  76%|███████▌  | 12392/16384 [00:01<00:00, 6789.22probe position/s]Normalizing amplitudes:  80%|███████▉  | 13072/16384 [00:01<00:00, 6728.72probe position/s]Normalizing amplitudes:  84%|████████▍ | 13760/16384 [00:02<00:00, 6772.09probe position/s]Normalizing amplitudes:  88%|████████▊ | 14446/16384 [00:02<00:00, 6796.11probe position/s]Normalizing amplitudes:  92%|█████████▏| 15126/16384 [00:02<00:00, 6768.35probe position/s]Normalizing amplitudes:  96%|█████████▋| 15804/16384 [00:02<00:00, 6770.41probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6798.07probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random16_p12_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random16_p12_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.01542 in 141.909 sec
Iter: 2, Total Loss: 0.006053 in 143.712 sec
Iter: 3, Total Loss: 0.00566 in 140.969 sec
Iter: 4, Total Loss: 0.005403 in 143.682 sec
Iter: 5, Total Loss: 0.005188 in 148.965 sec
Iter: 6, Total Loss: 0.005011 in 146.997 sec
Iter: 7, Total Loss: 0.004899 in 142.726 sec
Iter: 8, Total Loss: 0.004825 in 144.300 sec
Iter: 9, Total Loss: 0.004769 in 141.661 sec
Iter: 10, Total Loss: 0.004725 in 136.613 sec
Iter: 11, Total Loss: 0.004689 in 139.577 sec
Iter: 12, Total Loss: 0.004658 in 142.888 sec
Iter: 13, Total Loss: 0.00463 in 136.281 sec
Iter: 14, Total Loss: 0.004606 in 140.871 sec
Iter: 15, Total Loss: 0.004584 in 139.523 sec
Iter: 16, Total Loss: 0.004565 in 139.947 sec
Iter: 17, Total Loss: 0.004548 in 138.611 sec
Iter: 18, Total Loss: 0.004534 in 143.659 sec
Iter: 19, Total Loss: 0.004521 in 140.195 sec
Iter: 20, Total Loss: 0.00451 in 137.238 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 141.516 with std = 3.176 sec ###
### py4DSTEM ptycho solver is finished in 47 min 12.479 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 911.94 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (3, 16, 12, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 662/16384 [00:00<00:02, 6616.03probe position/s]Normalizing amplitudes:   8%|▊         | 1324/16384 [00:00<00:02, 6500.12probe position/s]Normalizing amplitudes:  12%|█▏        | 1975/16384 [00:00<00:02, 6344.63probe position/s]Normalizing amplitudes:  16%|█▌        | 2610/16384 [00:00<00:02, 6336.43probe position/s]Normalizing amplitudes:  20%|█▉        | 3244/16384 [00:00<00:02, 6067.64probe position/s]Normalizing amplitudes:  24%|██▎       | 3853/16384 [00:00<00:02, 6072.20probe position/s]Normalizing amplitudes:  27%|██▋       | 4472/16384 [00:00<00:01, 6108.18probe position/s]Normalizing amplitudes:  31%|███▏      | 5132/16384 [00:00<00:01, 6258.07probe position/s]Normalizing amplitudes:  35%|███▌      | 5759/16384 [00:00<00:01, 6073.43probe position/s]Normalizing amplitudes:  39%|███▉      | 6373/16384 [00:01<00:01, 6092.29probe position/s]Normalizing amplitudes:  43%|████▎     | 7011/16384 [00:01<00:01, 6177.85probe position/s]Normalizing amplitudes:  47%|████▋     | 7630/16384 [00:01<00:01, 6117.84probe position/s]Normalizing amplitudes:  50%|█████     | 8255/16384 [00:01<00:01, 6156.24probe position/s]Normalizing amplitudes:  54%|█████▍    | 8895/16384 [00:01<00:01, 6226.66probe position/s]Normalizing amplitudes:  58%|█████▊    | 9540/16384 [00:01<00:01, 6291.99probe position/s]Normalizing amplitudes:  62%|██████▏   | 10213/16384 [00:01<00:00, 6422.84probe position/s]Normalizing amplitudes:  66%|██████▋   | 10856/16384 [00:01<00:00, 6268.81probe position/s]Normalizing amplitudes:  70%|███████   | 11484/16384 [00:01<00:00, 6041.23probe position/s]Normalizing amplitudes:  74%|███████▍  | 12091/16384 [00:01<00:00, 5959.91probe position/s]Normalizing amplitudes:  78%|███████▊  | 12744/16384 [00:02<00:00, 6122.82probe position/s]Normalizing amplitudes:  82%|████████▏ | 13358/16384 [00:02<00:00, 6055.74probe position/s]Normalizing amplitudes:  85%|████████▌ | 13965/16384 [00:02<00:00, 5978.99probe position/s]Normalizing amplitudes:  89%|████████▉ | 14601/16384 [00:02<00:00, 6089.28probe position/s]Normalizing amplitudes:  93%|█████████▎| 15245/16384 [00:02<00:00, 6190.50probe position/s]Normalizing amplitudes:  97%|█████████▋| 15868/16384 [00:02<00:00, 6200.42probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6179.04probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random16_p12_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r3/N16384_dp128_flipT100_random16_p12_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.0162 in 287.258 sec
Iter: 2, Total Loss: 0.005911 in 280.344 sec
Iter: 3, Total Loss: 0.00547 in 282.838 sec
Iter: 4, Total Loss: 0.005207 in 287.728 sec
Iter: 5, Total Loss: 0.004999 in 280.523 sec
Iter: 6, Total Loss: 0.004867 in 280.997 sec
Iter: 7, Total Loss: 0.004781 in 279.105 sec
Iter: 8, Total Loss: 0.004722 in 271.104 sec
Iter: 9, Total Loss: 0.004676 in 283.551 sec
Iter: 10, Total Loss: 0.00464 in 276.721 sec
Iter: 11, Total Loss: 0.00461 in 284.333 sec
Iter: 12, Total Loss: 0.004585 in 278.921 sec
Iter: 13, Total Loss: 0.004564 in 280.270 sec
Iter: 14, Total Loss: 0.004546 in 286.829 sec
Iter: 15, Total Loss: 0.00453 in 283.014 sec
Iter: 16, Total Loss: 0.004516 in 281.439 sec
Iter: 17, Total Loss: 0.004504 in 281.081 sec
Iter: 18, Total Loss: 0.004493 in 279.784 sec
Iter: 19, Total Loss: 0.004483 in 285.789 sec
Iter: 20, Total Loss: 0.004474 in 279.158 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 281.539 with std = 3.814 sec ###
### py4DSTEM ptycho solver is finished in 1 hr 33 min 53.010 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 899.29 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 1024, 1, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 639/16384 [00:00<00:02, 6381.56probe position/s]Normalizing amplitudes:   8%|▊         | 1291/16384 [00:00<00:02, 6458.44probe position/s]Normalizing amplitudes:  12%|█▏        | 1937/16384 [00:00<00:02, 6419.67probe position/s]Normalizing amplitudes:  16%|█▌        | 2579/16384 [00:00<00:02, 6374.40probe position/s]Normalizing amplitudes:  20%|█▉        | 3217/16384 [00:00<00:02, 6357.46probe position/s]Normalizing amplitudes:  24%|██▎       | 3853/16384 [00:00<00:01, 6307.84probe position/s]Normalizing amplitudes:  27%|██▋       | 4490/16384 [00:00<00:01, 6324.83probe position/s]Normalizing amplitudes:  31%|███▏      | 5124/16384 [00:00<00:01, 6326.18probe position/s]Normalizing amplitudes:  35%|███▌      | 5757/16384 [00:00<00:01, 6291.03probe position/s]Normalizing amplitudes:  39%|███▉      | 6387/16384 [00:01<00:01, 6261.25probe position/s]Normalizing amplitudes:  43%|████▎     | 7022/16384 [00:01<00:01, 6287.49probe position/s]Normalizing amplitudes:  47%|████▋     | 7651/16384 [00:01<00:01, 6246.61probe position/s]Normalizing amplitudes:  51%|█████     | 8284/16384 [00:01<00:01, 6269.62probe position/s]Normalizing amplitudes:  55%|█████▍    | 8945/16384 [00:01<00:01, 6369.47probe position/s]Normalizing amplitudes:  58%|█████▊    | 9583/16384 [00:01<00:01, 6333.40probe position/s]Normalizing amplitudes:  62%|██████▏   | 10217/16384 [00:01<00:00, 6245.15probe position/s]Normalizing amplitudes:  66%|██████▌   | 10842/16384 [00:01<00:00, 6081.54probe position/s]Normalizing amplitudes:  70%|██████▉   | 11452/16384 [00:01<00:00, 5943.88probe position/s]Normalizing amplitudes:  74%|███████▎  | 12048/16384 [00:01<00:00, 5894.49probe position/s]Normalizing amplitudes:  77%|███████▋  | 12639/16384 [00:02<00:00, 5876.90probe position/s]Normalizing amplitudes:  81%|████████  | 13228/16384 [00:02<00:00, 5725.57probe position/s]Normalizing amplitudes:  85%|████████▍ | 13888/16384 [00:02<00:00, 5976.49probe position/s]Normalizing amplitudes:  88%|████████▊ | 14488/16384 [00:02<00:00, 5864.32probe position/s]Normalizing amplitudes:  92%|█████████▏| 15076/16384 [00:02<00:00, 5850.03probe position/s]Normalizing amplitudes:  96%|█████████▌| 15704/16384 [00:02<00:00, 5975.74probe position/s]Normalizing amplitudes: 100%|█████████▉| 16339/16384 [00:02<00:00, 6084.71probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6143.95probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random1024_p1_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random1024_p1_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.02219 in 0.773 sec
Iter: 2, Total Loss: 0.006519 in 0.745 sec
Iter: 3, Total Loss: 0.006491 in 0.750 sec
Iter: 4, Total Loss: 0.006476 in 0.750 sec
Iter: 5, Total Loss: 0.006469 in 0.771 sec
Iter: 6, Total Loss: 0.006464 in 0.734 sec
Iter: 7, Total Loss: 0.006461 in 0.747 sec
Iter: 8, Total Loss: 0.006458 in 0.743 sec
Iter: 9, Total Loss: 0.006456 in 0.744 sec
Iter: 10, Total Loss: 0.006454 in 0.729 sec
Iter: 11, Total Loss: 0.006453 in 0.723 sec
Iter: 12, Total Loss: 0.006451 in 0.740 sec
Iter: 13, Total Loss: 0.006449 in 0.733 sec
Iter: 14, Total Loss: 0.006448 in 0.751 sec
Iter: 15, Total Loss: 0.006446 in 0.753 sec
Iter: 16, Total Loss: 0.006444 in 0.742 sec
Iter: 17, Total Loss: 0.006443 in 0.730 sec
Iter: 18, Total Loss: 0.006441 in 0.728 sec
Iter: 19, Total Loss: 0.006439 in 0.727 sec
Iter: 20, Total Loss: 0.006438 in 0.721 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 0.742 with std = 0.014 sec ###
### py4DSTEM ptycho solver is finished in 16.829 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 899.18 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 1024, 1, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 628/16384 [00:00<00:02, 6265.35probe position/s]Normalizing amplitudes:   8%|▊         | 1255/16384 [00:00<00:02, 6123.12probe position/s]Normalizing amplitudes:  11%|█▏        | 1868/16384 [00:00<00:02, 6041.88probe position/s]Normalizing amplitudes:  15%|█▌        | 2473/16384 [00:00<00:02, 5898.71probe position/s]Normalizing amplitudes:  19%|█▉        | 3090/16384 [00:00<00:02, 5990.51probe position/s]Normalizing amplitudes:  23%|██▎       | 3712/16384 [00:00<00:02, 6066.35probe position/s]Normalizing amplitudes:  26%|██▋       | 4331/16384 [00:00<00:01, 6106.19probe position/s]Normalizing amplitudes:  30%|███       | 4942/16384 [00:00<00:01, 6073.18probe position/s]Normalizing amplitudes:  34%|███▍      | 5550/16384 [00:00<00:01, 5962.20probe position/s]Normalizing amplitudes:  38%|███▊      | 6160/16384 [00:01<00:01, 6000.93probe position/s]Normalizing amplitudes:  41%|████▏     | 6773/16384 [00:01<00:01, 6031.65probe position/s]Normalizing amplitudes:  45%|████▌     | 7377/16384 [00:01<00:01, 5999.86probe position/s]Normalizing amplitudes:  49%|████▊     | 7978/16384 [00:01<00:01, 5962.80probe position/s]Normalizing amplitudes:  52%|█████▏    | 8578/16384 [00:01<00:01, 5972.88probe position/s]Normalizing amplitudes:  56%|█████▋    | 9228/16384 [00:01<00:01, 6130.27probe position/s]Normalizing amplitudes:  60%|██████    | 9903/16384 [00:01<00:01, 6315.47probe position/s]Normalizing amplitudes:  64%|██████▍   | 10535/16384 [00:01<00:00, 6293.97probe position/s]Normalizing amplitudes:  68%|██████▊   | 11165/16384 [00:01<00:00, 6175.69probe position/s]Normalizing amplitudes:  72%|███████▏  | 11784/16384 [00:01<00:00, 6125.28probe position/s]Normalizing amplitudes:  76%|███████▌  | 12397/16384 [00:02<00:00, 6054.75probe position/s]Normalizing amplitudes:  79%|███████▉  | 13005/16384 [00:02<00:00, 6058.93probe position/s]Normalizing amplitudes:  83%|████████▎ | 13645/16384 [00:02<00:00, 6156.39probe position/s]Normalizing amplitudes:  87%|████████▋ | 14280/16384 [00:02<00:00, 6211.66probe position/s]Normalizing amplitudes:  91%|█████████ | 14925/16384 [00:02<00:00, 6280.57probe position/s]Normalizing amplitudes:  95%|█████████▍| 15554/16384 [00:02<00:00, 6112.42probe position/s]Normalizing amplitudes:  99%|█████████▊| 16167/16384 [00:02<00:00, 6069.01probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6093.99probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random1024_p1_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random1024_p1_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.02289 in 1.472 sec
Iter: 2, Total Loss: 0.006518 in 1.412 sec
Iter: 3, Total Loss: 0.006483 in 1.454 sec
Iter: 4, Total Loss: 0.006472 in 1.445 sec
Iter: 5, Total Loss: 0.006466 in 1.400 sec
Iter: 6, Total Loss: 0.006459 in 1.397 sec
Iter: 7, Total Loss: 0.006455 in 1.420 sec
Iter: 8, Total Loss: 0.00645 in 1.397 sec
Iter: 9, Total Loss: 0.006446 in 1.430 sec
Iter: 10, Total Loss: 0.006444 in 1.439 sec
Iter: 11, Total Loss: 0.006439 in 1.416 sec
Iter: 12, Total Loss: 0.006436 in 1.391 sec
Iter: 13, Total Loss: 0.006433 in 1.397 sec
Iter: 14, Total Loss: 0.00643 in 1.395 sec
Iter: 15, Total Loss: 0.006427 in 1.403 sec
Iter: 16, Total Loss: 0.006424 in 1.399 sec
Iter: 17, Total Loss: 0.00642 in 1.418 sec
Iter: 18, Total Loss: 0.006417 in 1.400 sec
Iter: 19, Total Loss: 0.006414 in 1.415 sec
Iter: 20, Total Loss: 0.006412 in 1.407 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 1.415 with std = 0.022 sec ###
### py4DSTEM ptycho solver is finished in 30.407 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 899.23 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 1024, 1, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 617/16384 [00:00<00:02, 6167.87probe position/s]Normalizing amplitudes:   8%|▊         | 1262/16384 [00:00<00:02, 6327.58probe position/s]Normalizing amplitudes:  12%|█▏        | 1895/16384 [00:00<00:02, 6279.98probe position/s]Normalizing amplitudes:  15%|█▌        | 2534/16384 [00:00<00:02, 6320.41probe position/s]Normalizing amplitudes:  19%|█▉        | 3183/16384 [00:00<00:02, 6379.30probe position/s]Normalizing amplitudes:  23%|██▎       | 3821/16384 [00:00<00:01, 6343.26probe position/s]Normalizing amplitudes:  27%|██▋       | 4456/16384 [00:00<00:01, 6340.48probe position/s]Normalizing amplitudes:  31%|███       | 5091/16384 [00:00<00:01, 6276.85probe position/s]Normalizing amplitudes:  35%|███▌      | 5736/16384 [00:00<00:01, 6327.51probe position/s]Normalizing amplitudes:  39%|███▉      | 6369/16384 [00:01<00:01, 6268.06probe position/s]Normalizing amplitudes:  43%|████▎     | 7009/16384 [00:01<00:01, 6305.26probe position/s]Normalizing amplitudes:  47%|████▋     | 7640/16384 [00:01<00:01, 6239.62probe position/s]Normalizing amplitudes:  50%|█████     | 8265/16384 [00:01<00:01, 6236.06probe position/s]Normalizing amplitudes:  54%|█████▍    | 8914/16384 [00:01<00:01, 6310.71probe position/s]Normalizing amplitudes:  58%|█████▊    | 9546/16384 [00:01<00:01, 6233.13probe position/s]Normalizing amplitudes:  62%|██████▏   | 10170/16384 [00:01<00:01, 6169.01probe position/s]Normalizing amplitudes:  66%|██████▌   | 10810/16384 [00:01<00:00, 6235.35probe position/s]Normalizing amplitudes:  70%|██████▉   | 11451/16384 [00:01<00:00, 6285.06probe position/s]Normalizing amplitudes:  74%|███████▍  | 12100/16384 [00:01<00:00, 6346.01probe position/s]Normalizing amplitudes:  78%|███████▊  | 12735/16384 [00:02<00:00, 6328.88probe position/s]Normalizing amplitudes:  82%|████████▏ | 13369/16384 [00:02<00:00, 6282.66probe position/s]Normalizing amplitudes:  85%|████████▌ | 13998/16384 [00:02<00:00, 6226.75probe position/s]Normalizing amplitudes:  89%|████████▉ | 14621/16384 [00:02<00:00, 6138.76probe position/s]Normalizing amplitudes:  93%|█████████▎| 15236/16384 [00:02<00:00, 6109.79probe position/s]Normalizing amplitudes:  97%|█████████▋| 15848/16384 [00:02<00:00, 5984.32probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6221.81probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random1024_p1_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random1024_p1_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.02395 in 2.484 sec
Iter: 2, Total Loss: 0.006569 in 2.414 sec
Iter: 3, Total Loss: 0.006503 in 2.412 sec
Iter: 4, Total Loss: 0.006487 in 2.421 sec
Iter: 5, Total Loss: 0.00648 in 2.447 sec
Iter: 6, Total Loss: 0.006473 in 2.420 sec
Iter: 7, Total Loss: 0.006465 in 2.433 sec
Iter: 8, Total Loss: 0.006457 in 2.424 sec
Iter: 9, Total Loss: 0.006453 in 2.446 sec
Iter: 10, Total Loss: 0.006447 in 2.421 sec
Iter: 11, Total Loss: 0.006441 in 2.412 sec
Iter: 12, Total Loss: 0.006436 in 2.440 sec
Iter: 13, Total Loss: 0.00643 in 2.449 sec
Iter: 14, Total Loss: 0.006425 in 2.402 sec
Iter: 15, Total Loss: 0.006422 in 2.420 sec
Iter: 16, Total Loss: 0.006417 in 2.427 sec
Iter: 17, Total Loss: 0.006413 in 2.418 sec
Iter: 18, Total Loss: 0.006409 in 2.413 sec
Iter: 19, Total Loss: 0.006406 in 2.406 sec
Iter: 20, Total Loss: 0.006402 in 2.424 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 2.427 with std = 0.019 sec ###
### py4DSTEM ptycho solver is finished in 50.677 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 899.27 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 1024, 3, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   2%|▏         | 399/16384 [00:00<00:04, 3985.44probe position/s]Normalizing amplitudes:   6%|▌         | 1001/16384 [00:00<00:02, 5175.60probe position/s]Normalizing amplitudes:  10%|█         | 1643/16384 [00:00<00:02, 5743.20probe position/s]Normalizing amplitudes:  14%|█▍        | 2279/16384 [00:00<00:02, 5985.87probe position/s]Normalizing amplitudes:  18%|█▊        | 2933/16384 [00:00<00:02, 6184.75probe position/s]Normalizing amplitudes:  22%|██▏       | 3564/16384 [00:00<00:02, 6222.87probe position/s]Normalizing amplitudes:  26%|██▌       | 4187/16384 [00:00<00:01, 6136.77probe position/s]Normalizing amplitudes:  29%|██▉       | 4816/16384 [00:00<00:01, 6184.81probe position/s]Normalizing amplitudes:  33%|███▎      | 5457/16384 [00:00<00:01, 6253.12probe position/s]Normalizing amplitudes:  37%|███▋      | 6083/16384 [00:01<00:01, 6243.82probe position/s]Normalizing amplitudes:  41%|████      | 6708/16384 [00:01<00:01, 6223.95probe position/s]Normalizing amplitudes:  45%|████▍     | 7353/16384 [00:01<00:01, 6291.79probe position/s]Normalizing amplitudes:  49%|████▉     | 8011/16384 [00:01<00:01, 6376.61probe position/s]Normalizing amplitudes:  53%|█████▎    | 8662/16384 [00:01<00:01, 6416.01probe position/s]Normalizing amplitudes:  57%|█████▋    | 9304/16384 [00:01<00:01, 6299.65probe position/s]Normalizing amplitudes:  61%|██████    | 9935/16384 [00:01<00:01, 6248.76probe position/s]Normalizing amplitudes:  64%|██████▍   | 10561/16384 [00:01<00:00, 6167.43probe position/s]Normalizing amplitudes:  68%|██████▊   | 11189/16384 [00:01<00:00, 6197.99probe position/s]Normalizing amplitudes:  72%|███████▏  | 11819/16384 [00:01<00:00, 6227.33probe position/s]Normalizing amplitudes:  76%|███████▌  | 12462/16384 [00:02<00:00, 6284.40probe position/s]Normalizing amplitudes:  80%|███████▉  | 13091/16384 [00:02<00:00, 6278.67probe position/s]Normalizing amplitudes:  84%|████████▎ | 13720/16384 [00:02<00:00, 6278.67probe position/s]Normalizing amplitudes:  88%|████████▊ | 14348/16384 [00:02<00:00, 6185.79probe position/s]Normalizing amplitudes:  91%|█████████▏| 14989/16384 [00:02<00:00, 6250.22probe position/s]Normalizing amplitudes:  95%|█████████▌| 15615/16384 [00:02<00:00, 6224.55probe position/s]Normalizing amplitudes:  99%|█████████▉| 16238/16384 [00:02<00:00, 6193.20probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6170.94probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random1024_p3_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random1024_p3_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.07172 in 1.396 sec
Iter: 2, Total Loss: 0.00674 in 1.321 sec
Iter: 3, Total Loss: 0.006561 in 1.366 sec
Iter: 4, Total Loss: 0.006489 in 1.313 sec
Iter: 5, Total Loss: 0.006455 in 1.337 sec
Iter: 6, Total Loss: 0.006433 in 1.326 sec
Iter: 7, Total Loss: 0.006419 in 1.336 sec
Iter: 8, Total Loss: 0.006407 in 1.347 sec
Iter: 9, Total Loss: 0.006397 in 1.351 sec
Iter: 10, Total Loss: 0.006387 in 1.322 sec
Iter: 11, Total Loss: 0.006379 in 1.338 sec
Iter: 12, Total Loss: 0.00637 in 1.338 sec
Iter: 13, Total Loss: 0.006361 in 1.328 sec
Iter: 14, Total Loss: 0.006352 in 1.311 sec
Iter: 15, Total Loss: 0.006344 in 1.318 sec
Iter: 16, Total Loss: 0.006335 in 1.357 sec
Iter: 17, Total Loss: 0.006326 in 1.310 sec
Iter: 18, Total Loss: 0.006318 in 1.328 sec
Iter: 19, Total Loss: 0.006309 in 1.340 sec
Iter: 20, Total Loss: 0.0063 in 1.342 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 1.336 with std = 0.020 sec ###
### py4DSTEM ptycho solver is finished in 28.877 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 899.12 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 1024, 3, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 615/16384 [00:00<00:02, 6146.01probe position/s]Normalizing amplitudes:   8%|▊         | 1249/16384 [00:00<00:02, 6257.67probe position/s]Normalizing amplitudes:  12%|█▏        | 1889/16384 [00:00<00:02, 6319.79probe position/s]Normalizing amplitudes:  15%|█▌        | 2521/16384 [00:00<00:02, 6254.64probe position/s]Normalizing amplitudes:  19%|█▉        | 3147/16384 [00:00<00:02, 6171.66probe position/s]Normalizing amplitudes:  23%|██▎       | 3783/16384 [00:00<00:02, 6234.62probe position/s]Normalizing amplitudes:  27%|██▋       | 4407/16384 [00:00<00:01, 6143.09probe position/s]Normalizing amplitudes:  31%|███       | 5030/16384 [00:00<00:01, 6169.59probe position/s]Normalizing amplitudes:  34%|███▍      | 5648/16384 [00:00<00:01, 6091.74probe position/s]Normalizing amplitudes:  38%|███▊      | 6282/16384 [00:01<00:01, 6166.23probe position/s]Normalizing amplitudes:  42%|████▏     | 6901/16384 [00:01<00:01, 6170.91probe position/s]Normalizing amplitudes:  46%|████▌     | 7539/16384 [00:01<00:01, 6231.64probe position/s]Normalizing amplitudes:  50%|████▉     | 8163/16384 [00:01<00:01, 6106.57probe position/s]Normalizing amplitudes:  54%|█████▎    | 8775/16384 [00:01<00:01, 5872.01probe position/s]Normalizing amplitudes:  57%|█████▋    | 9365/16384 [00:01<00:01, 5652.24probe position/s]Normalizing amplitudes:  61%|██████    | 9999/16384 [00:01<00:01, 5845.94probe position/s]Normalizing amplitudes:  65%|██████▍   | 10599/16384 [00:01<00:00, 5890.03probe position/s]Normalizing amplitudes:  69%|██████▊   | 11232/16384 [00:01<00:00, 6016.73probe position/s]Normalizing amplitudes:  72%|███████▏  | 11836/16384 [00:01<00:00, 5962.25probe position/s]Normalizing amplitudes:  76%|███████▌  | 12445/16384 [00:02<00:00, 5995.97probe position/s]Normalizing amplitudes:  80%|███████▉  | 13075/16384 [00:02<00:00, 6084.02probe position/s]Normalizing amplitudes:  84%|████████▎ | 13691/16384 [00:02<00:00, 6103.57probe position/s]Normalizing amplitudes:  87%|████████▋ | 14302/16384 [00:02<00:00, 6077.92probe position/s]Normalizing amplitudes:  91%|█████████ | 14911/16384 [00:02<00:00, 6059.05probe position/s]Normalizing amplitudes:  95%|█████████▍| 15525/16384 [00:02<00:00, 6081.26probe position/s]Normalizing amplitudes:  99%|█████████▊| 16156/16384 [00:02<00:00, 6149.23probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6084.33probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random1024_p3_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random1024_p3_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.06948 in 3.345 sec
Iter: 2, Total Loss: 0.007173 in 3.285 sec
Iter: 3, Total Loss: 0.006682 in 3.276 sec
Iter: 4, Total Loss: 0.006539 in 3.297 sec
Iter: 5, Total Loss: 0.006464 in 3.315 sec
Iter: 6, Total Loss: 0.006411 in 3.298 sec
Iter: 7, Total Loss: 0.006368 in 3.283 sec
Iter: 8, Total Loss: 0.006331 in 3.282 sec
Iter: 9, Total Loss: 0.006298 in 3.280 sec
Iter: 10, Total Loss: 0.006269 in 3.290 sec
Iter: 11, Total Loss: 0.006244 in 3.289 sec
Iter: 12, Total Loss: 0.006221 in 3.293 sec
Iter: 13, Total Loss: 0.006199 in 3.298 sec
Iter: 14, Total Loss: 0.006179 in 3.317 sec
Iter: 15, Total Loss: 0.006161 in 3.303 sec
Iter: 16, Total Loss: 0.006143 in 3.297 sec
Iter: 17, Total Loss: 0.006126 in 3.281 sec
Iter: 18, Total Loss: 0.00611 in 3.311 sec
Iter: 19, Total Loss: 0.006096 in 3.304 sec
Iter: 20, Total Loss: 0.006081 in 3.293 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 3.297 with std = 0.016 sec ###
### py4DSTEM ptycho solver is finished in 1 min 8.096 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 904.86 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 1024, 3, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 628/16384 [00:00<00:02, 6272.44probe position/s]Normalizing amplitudes:   8%|▊         | 1271/16384 [00:00<00:02, 6364.82probe position/s]Normalizing amplitudes:  12%|█▏        | 1922/16384 [00:00<00:02, 6428.66probe position/s]Normalizing amplitudes:  16%|█▌        | 2565/16384 [00:00<00:02, 6353.26probe position/s]Normalizing amplitudes:  20%|█▉        | 3201/16384 [00:00<00:02, 6279.72probe position/s]Normalizing amplitudes:  23%|██▎       | 3830/16384 [00:00<00:02, 6242.33probe position/s]Normalizing amplitudes:  27%|██▋       | 4472/16384 [00:00<00:01, 6297.18probe position/s]Normalizing amplitudes:  31%|███       | 5102/16384 [00:00<00:01, 6270.33probe position/s]Normalizing amplitudes:  35%|███▌      | 5745/16384 [00:00<00:01, 6316.76probe position/s]Normalizing amplitudes:  39%|███▉      | 6377/16384 [00:01<00:01, 6307.74probe position/s]Normalizing amplitudes:  43%|████▎     | 7008/16384 [00:01<00:01, 6216.33probe position/s]Normalizing amplitudes:  47%|████▋     | 7653/16384 [00:01<00:01, 6286.03probe position/s]Normalizing amplitudes:  51%|█████     | 8282/16384 [00:01<00:01, 5971.13probe position/s]Normalizing amplitudes:  54%|█████▍    | 8928/16384 [00:01<00:01, 6110.05probe position/s]Normalizing amplitudes:  58%|█████▊    | 9551/16384 [00:01<00:01, 6143.50probe position/s]Normalizing amplitudes:  62%|██████▏   | 10168/16384 [00:01<00:01, 6081.89probe position/s]Normalizing amplitudes:  66%|██████▌   | 10781/16384 [00:01<00:00, 6093.40probe position/s]Normalizing amplitudes:  70%|██████▉   | 11400/16384 [00:01<00:00, 6121.27probe position/s]Normalizing amplitudes:  73%|███████▎  | 12027/16384 [00:01<00:00, 6164.64probe position/s]Normalizing amplitudes:  78%|███████▊  | 12698/16384 [00:02<00:00, 6325.63probe position/s]Normalizing amplitudes:  82%|████████▏ | 13378/16384 [00:02<00:00, 6466.41probe position/s]Normalizing amplitudes:  86%|████████▌ | 14034/16384 [00:02<00:00, 6493.27probe position/s]Normalizing amplitudes:  90%|████████▉ | 14684/16384 [00:02<00:00, 6312.49probe position/s]Normalizing amplitudes:  93%|█████████▎| 15317/16384 [00:02<00:00, 6289.80probe position/s]Normalizing amplitudes:  97%|█████████▋| 15965/16384 [00:02<00:00, 6345.22probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6239.49probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random1024_p3_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random1024_p3_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.07163 in 6.144 sec
Iter: 2, Total Loss: 0.007999 in 6.036 sec
Iter: 3, Total Loss: 0.006887 in 6.038 sec
Iter: 4, Total Loss: 0.006621 in 6.044 sec
Iter: 5, Total Loss: 0.006489 in 6.036 sec
Iter: 6, Total Loss: 0.006401 in 6.028 sec
Iter: 7, Total Loss: 0.006336 in 6.003 sec
Iter: 8, Total Loss: 0.006283 in 6.027 sec
Iter: 9, Total Loss: 0.006243 in 6.044 sec
Iter: 10, Total Loss: 0.006207 in 6.085 sec
Iter: 11, Total Loss: 0.006177 in 6.030 sec
Iter: 12, Total Loss: 0.006152 in 6.063 sec
Iter: 13, Total Loss: 0.006129 in 6.346 sec
Iter: 14, Total Loss: 0.006109 in 6.024 sec
Iter: 15, Total Loss: 0.00609 in 6.010 sec
Iter: 16, Total Loss: 0.006072 in 6.090 sec
Iter: 17, Total Loss: 0.006057 in 6.038 sec
Iter: 18, Total Loss: 0.006042 in 6.064 sec
Iter: 19, Total Loss: 0.006028 in 6.038 sec
Iter: 20, Total Loss: 0.006015 in 6.022 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 6.060 with std = 0.073 sec ###
### py4DSTEM ptycho solver is finished in 2 min 3.410 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 907.49 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 1024, 6, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 616/16384 [00:00<00:02, 6152.96probe position/s]Normalizing amplitudes:   8%|▊         | 1232/16384 [00:00<00:02, 6024.58probe position/s]Normalizing amplitudes:  11%|█▏        | 1854/16384 [00:00<00:02, 6109.59probe position/s]Normalizing amplitudes:  15%|█▌        | 2485/16384 [00:00<00:02, 6186.06probe position/s]Normalizing amplitudes:  19%|█▉        | 3115/16384 [00:00<00:02, 6225.66probe position/s]Normalizing amplitudes:  23%|██▎       | 3765/16384 [00:00<00:01, 6315.83probe position/s]Normalizing amplitudes:  27%|██▋       | 4402/16384 [00:00<00:01, 6332.00probe position/s]Normalizing amplitudes:  31%|███       | 5036/16384 [00:00<00:01, 6310.45probe position/s]Normalizing amplitudes:  35%|███▍      | 5698/16384 [00:00<00:01, 6405.93probe position/s]Normalizing amplitudes:  39%|███▊      | 6339/16384 [00:01<00:01, 6238.66probe position/s]Normalizing amplitudes:  43%|████▎     | 6964/16384 [00:01<00:01, 6145.50probe position/s]Normalizing amplitudes:  46%|████▋     | 7607/16384 [00:01<00:01, 6229.69probe position/s]Normalizing amplitudes:  50%|█████     | 8238/16384 [00:01<00:01, 6251.92probe position/s]Normalizing amplitudes:  54%|█████▍    | 8908/16384 [00:01<00:01, 6383.58probe position/s]Normalizing amplitudes:  58%|█████▊    | 9562/16384 [00:01<00:01, 6426.63probe position/s]Normalizing amplitudes:  62%|██████▏   | 10206/16384 [00:01<00:00, 6324.55probe position/s]Normalizing amplitudes:  66%|██████▌   | 10840/16384 [00:01<00:00, 6324.71probe position/s]Normalizing amplitudes:  70%|███████   | 11473/16384 [00:01<00:00, 6291.82probe position/s]Normalizing amplitudes:  74%|███████▍  | 12134/16384 [00:01<00:00, 6385.15probe position/s]Normalizing amplitudes:  78%|███████▊  | 12810/16384 [00:02<00:00, 6496.66probe position/s]Normalizing amplitudes:  82%|████████▏ | 13460/16384 [00:02<00:00, 6433.57probe position/s]Normalizing amplitudes:  86%|████████▌ | 14104/16384 [00:02<00:00, 6379.73probe position/s]Normalizing amplitudes:  90%|████████▉ | 14743/16384 [00:02<00:00, 5772.45probe position/s]Normalizing amplitudes:  94%|█████████▎| 15331/16384 [00:02<00:00, 5700.23probe position/s]Normalizing amplitudes:  97%|█████████▋| 15947/16384 [00:02<00:00, 5827.85probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6188.57probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random1024_p6_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random1024_p6_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.2025 in 2.296 sec
Iter: 2, Total Loss: 0.006991 in 2.332 sec
Iter: 3, Total Loss: 0.006683 in 2.262 sec
Iter: 4, Total Loss: 0.006556 in 2.375 sec
Iter: 5, Total Loss: 0.006495 in 2.359 sec
Iter: 6, Total Loss: 0.006457 in 2.300 sec
Iter: 7, Total Loss: 0.006433 in 2.238 sec
Iter: 8, Total Loss: 0.006414 in 2.277 sec
Iter: 9, Total Loss: 0.006399 in 2.280 sec
Iter: 10, Total Loss: 0.006384 in 2.254 sec
Iter: 11, Total Loss: 0.006371 in 2.276 sec
Iter: 12, Total Loss: 0.006358 in 2.248 sec
Iter: 13, Total Loss: 0.006346 in 2.256 sec
Iter: 14, Total Loss: 0.006334 in 2.260 sec
Iter: 15, Total Loss: 0.006321 in 2.256 sec
Iter: 16, Total Loss: 0.006309 in 2.259 sec
Iter: 17, Total Loss: 0.006297 in 2.247 sec
Iter: 18, Total Loss: 0.006286 in 2.234 sec
Iter: 19, Total Loss: 0.006273 in 2.250 sec
Iter: 20, Total Loss: 0.006262 in 2.231 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 2.274 with std = 0.039 sec ###
### py4DSTEM ptycho solver is finished in 47.643 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 900.41 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 1024, 6, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 613/16384 [00:00<00:02, 6125.23probe position/s]Normalizing amplitudes:   7%|▋         | 1226/16384 [00:00<00:02, 6049.22probe position/s]Normalizing amplitudes:  11%|█         | 1842/16384 [00:00<00:02, 6095.85probe position/s]Normalizing amplitudes:  15%|█▌        | 2467/16384 [00:00<00:02, 6153.69probe position/s]Normalizing amplitudes:  19%|█▉        | 3108/16384 [00:00<00:02, 6243.12probe position/s]Normalizing amplitudes:  23%|██▎       | 3733/16384 [00:00<00:02, 6205.18probe position/s]Normalizing amplitudes:  27%|██▋       | 4354/16384 [00:00<00:01, 6200.13probe position/s]Normalizing amplitudes:  30%|███       | 4975/16384 [00:00<00:01, 6112.89probe position/s]Normalizing amplitudes:  34%|███▍      | 5605/16384 [00:00<00:01, 6168.78probe position/s]Normalizing amplitudes:  38%|███▊      | 6260/16384 [00:01<00:01, 6285.07probe position/s]Normalizing amplitudes:  42%|████▏     | 6890/16384 [00:01<00:01, 6287.85probe position/s]Normalizing amplitudes:  46%|████▌     | 7519/16384 [00:01<00:01, 6056.09probe position/s]Normalizing amplitudes:  50%|████▉     | 8127/16384 [00:01<00:01, 5872.18probe position/s]Normalizing amplitudes:  53%|█████▎    | 8717/16384 [00:01<00:01, 5879.79probe position/s]Normalizing amplitudes:  57%|█████▋    | 9307/16384 [00:01<00:01, 5841.60probe position/s]Normalizing amplitudes:  61%|██████    | 9942/16384 [00:01<00:01, 5988.73probe position/s]Normalizing amplitudes:  65%|██████▍   | 10596/16384 [00:01<00:00, 6149.23probe position/s]Normalizing amplitudes:  68%|██████▊   | 11212/16384 [00:01<00:00, 6063.04probe position/s]Normalizing amplitudes:  72%|███████▏  | 11820/16384 [00:01<00:00, 6039.92probe position/s]Normalizing amplitudes:  76%|███████▌  | 12425/16384 [00:02<00:00, 5748.85probe position/s]Normalizing amplitudes:  80%|███████▉  | 13054/16384 [00:02<00:00, 5902.63probe position/s]Normalizing amplitudes:  83%|████████▎ | 13648/16384 [00:02<00:00, 5806.14probe position/s]Normalizing amplitudes:  87%|████████▋ | 14261/16384 [00:02<00:00, 5897.37probe position/s]Normalizing amplitudes:  91%|█████████ | 14853/16384 [00:02<00:00, 5695.77probe position/s]Normalizing amplitudes:  94%|█████████▍| 15438/16384 [00:02<00:00, 5738.12probe position/s]Normalizing amplitudes:  98%|█████████▊| 16070/16384 [00:02<00:00, 5906.32probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6000.43probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random1024_p6_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random1024_p6_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.1947 in 6.020 sec
Iter: 2, Total Loss: 0.008171 in 6.011 sec
Iter: 3, Total Loss: 0.007118 in 6.017 sec
Iter: 4, Total Loss: 0.006787 in 5.994 sec
Iter: 5, Total Loss: 0.006618 in 5.989 sec
Iter: 6, Total Loss: 0.006506 in 5.994 sec
Iter: 7, Total Loss: 0.006425 in 5.966 sec
Iter: 8, Total Loss: 0.00636 in 6.023 sec
Iter: 9, Total Loss: 0.006306 in 5.999 sec
Iter: 10, Total Loss: 0.006259 in 6.032 sec
Iter: 11, Total Loss: 0.006219 in 6.019 sec
Iter: 12, Total Loss: 0.006184 in 5.998 sec
Iter: 13, Total Loss: 0.006152 in 5.974 sec
Iter: 14, Total Loss: 0.006123 in 6.029 sec
Iter: 15, Total Loss: 0.006097 in 5.984 sec
Iter: 16, Total Loss: 0.006073 in 6.020 sec
Iter: 17, Total Loss: 0.00605 in 6.009 sec
Iter: 18, Total Loss: 0.006029 in 6.000 sec
Iter: 19, Total Loss: 0.006009 in 6.012 sec
Iter: 20, Total Loss: 0.00599 in 5.992 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 6.004 with std = 0.018 sec ###
### py4DSTEM ptycho solver is finished in 2 min 2.336 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 899.26 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 1024, 6, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 620/16384 [00:00<00:02, 6191.39probe position/s]Normalizing amplitudes:   8%|▊         | 1253/16384 [00:00<00:02, 6270.15probe position/s]Normalizing amplitudes:  12%|█▏        | 1895/16384 [00:00<00:02, 6337.59probe position/s]Normalizing amplitudes:  15%|█▌        | 2529/16384 [00:00<00:02, 6337.41probe position/s]Normalizing amplitudes:  19%|█▉        | 3182/16384 [00:00<00:02, 6403.47probe position/s]Normalizing amplitudes:  23%|██▎       | 3823/16384 [00:00<00:01, 6339.45probe position/s]Normalizing amplitudes:  27%|██▋       | 4458/16384 [00:00<00:02, 5951.93probe position/s]Normalizing amplitudes:  31%|███       | 5086/16384 [00:00<00:01, 6048.04probe position/s]Normalizing amplitudes:  35%|███▍      | 5699/16384 [00:00<00:01, 6071.95probe position/s]Normalizing amplitudes:  39%|███▉      | 6359/16384 [00:01<00:01, 6229.24probe position/s]Normalizing amplitudes:  43%|████▎     | 6988/16384 [00:01<00:01, 6247.02probe position/s]Normalizing amplitudes:  46%|████▋     | 7615/16384 [00:01<00:01, 6047.14probe position/s]Normalizing amplitudes:  50%|█████     | 8234/16384 [00:01<00:01, 6087.72probe position/s]Normalizing amplitudes:  54%|█████▍    | 8845/16384 [00:01<00:01, 5986.44probe position/s]Normalizing amplitudes:  58%|█████▊    | 9495/16384 [00:01<00:01, 6136.07probe position/s]Normalizing amplitudes:  62%|██████▏   | 10110/16384 [00:01<00:01, 6104.29probe position/s]Normalizing amplitudes:  65%|██████▌   | 10722/16384 [00:01<00:00, 6093.50probe position/s]Normalizing amplitudes:  69%|██████▉   | 11332/16384 [00:01<00:00, 6084.79probe position/s]Normalizing amplitudes:  73%|███████▎  | 11955/16384 [00:01<00:00, 6127.65probe position/s]Normalizing amplitudes:  77%|███████▋  | 12569/16384 [00:02<00:00, 5885.26probe position/s]Normalizing amplitudes:  80%|████████  | 13160/16384 [00:02<00:00, 5783.79probe position/s]Normalizing amplitudes:  84%|████████▍ | 13740/16384 [00:02<00:00, 5732.50probe position/s]Normalizing amplitudes:  87%|████████▋ | 14315/16384 [00:02<00:00, 5720.97probe position/s]Normalizing amplitudes:  91%|█████████ | 14888/16384 [00:02<00:00, 5275.34probe position/s]Normalizing amplitudes:  94%|█████████▍| 15423/16384 [00:02<00:00, 5167.89probe position/s]Normalizing amplitudes:  98%|█████████▊| 16053/16384 [00:02<00:00, 5482.55probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5934.41probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random1024_p6_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random1024_p6_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.1943 in 11.553 sec
Iter: 2, Total Loss: 0.009304 in 11.533 sec
Iter: 3, Total Loss: 0.007531 in 11.524 sec
Iter: 4, Total Loss: 0.007029 in 11.515 sec
Iter: 5, Total Loss: 0.006782 in 11.516 sec
Iter: 6, Total Loss: 0.00662 in 11.508 sec
Iter: 7, Total Loss: 0.006504 in 11.510 sec
Iter: 8, Total Loss: 0.006415 in 11.522 sec
Iter: 9, Total Loss: 0.006345 in 11.513 sec
Iter: 10, Total Loss: 0.006289 in 11.500 sec
Iter: 11, Total Loss: 0.006243 in 11.466 sec
Iter: 12, Total Loss: 0.006204 in 11.534 sec
Iter: 13, Total Loss: 0.00617 in 11.501 sec
Iter: 14, Total Loss: 0.006141 in 11.487 sec
Iter: 15, Total Loss: 0.006116 in 11.479 sec
Iter: 16, Total Loss: 0.006093 in 11.473 sec
Iter: 17, Total Loss: 0.006071 in 11.490 sec
Iter: 18, Total Loss: 0.006052 in 11.465 sec
Iter: 19, Total Loss: 0.006034 in 11.457 sec
Iter: 20, Total Loss: 0.006018 in 11.444 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 11.500 with std = 0.028 sec ###
### py4DSTEM ptycho solver is finished in 3 min 52.230 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 911.82 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 1024, 12, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 666/16384 [00:00<00:02, 6654.66probe position/s]Normalizing amplitudes:   8%|▊         | 1332/16384 [00:00<00:02, 6369.71probe position/s]Normalizing amplitudes:  12%|█▏        | 1977/16384 [00:00<00:02, 6403.31probe position/s]Normalizing amplitudes:  16%|█▌        | 2626/16384 [00:00<00:02, 6436.91probe position/s]Normalizing amplitudes:  20%|█▉        | 3271/16384 [00:00<00:02, 6420.53probe position/s]Normalizing amplitudes:  24%|██▍       | 3949/16384 [00:00<00:01, 6541.45probe position/s]Normalizing amplitudes:  28%|██▊       | 4633/16384 [00:00<00:01, 6635.58probe position/s]Normalizing amplitudes:  32%|███▏      | 5297/16384 [00:00<00:01, 6361.38probe position/s]Normalizing amplitudes:  36%|███▌      | 5936/16384 [00:00<00:01, 6125.02probe position/s]Normalizing amplitudes:  40%|████      | 6567/16384 [00:01<00:01, 6176.56probe position/s]Normalizing amplitudes:  44%|████▍     | 7187/16384 [00:01<00:01, 6073.62probe position/s]Normalizing amplitudes:  48%|████▊     | 7796/16384 [00:01<00:01, 5877.82probe position/s]Normalizing amplitudes:  51%|█████     | 8386/16384 [00:01<00:01, 5803.15probe position/s]Normalizing amplitudes:  55%|█████▍    | 8968/16384 [00:01<00:01, 5782.93probe position/s]Normalizing amplitudes:  58%|█████▊    | 9548/16384 [00:01<00:01, 5678.83probe position/s]Normalizing amplitudes:  62%|██████▏   | 10135/16384 [00:01<00:01, 5732.42probe position/s]Normalizing amplitudes:  66%|██████▌   | 10758/16384 [00:01<00:00, 5876.34probe position/s]Normalizing amplitudes:  69%|██████▉   | 11374/16384 [00:01<00:00, 5957.63probe position/s]Normalizing amplitudes:  73%|███████▎  | 12015/16384 [00:01<00:00, 6088.63probe position/s]Normalizing amplitudes:  77%|███████▋  | 12625/16384 [00:02<00:00, 6089.97probe position/s]Normalizing amplitudes:  81%|████████  | 13269/16384 [00:02<00:00, 6192.32probe position/s]Normalizing amplitudes:  85%|████████▍ | 13907/16384 [00:02<00:00, 6245.99probe position/s]Normalizing amplitudes:  89%|████████▊ | 14534/16384 [00:02<00:00, 6251.77probe position/s]Normalizing amplitudes:  93%|█████████▎| 15160/16384 [00:02<00:00, 6239.03probe position/s]Normalizing amplitudes:  96%|█████████▋| 15810/16384 [00:02<00:00, 6316.05probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6163.56probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random1024_p12_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random1024_p12_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.5316 in 4.160 sec
Iter: 2, Total Loss: 0.007326 in 4.049 sec
Iter: 3, Total Loss: 0.006862 in 4.113 sec
Iter: 4, Total Loss: 0.00666 in 4.021 sec
Iter: 5, Total Loss: 0.006555 in 4.020 sec
Iter: 6, Total Loss: 0.006487 in 4.011 sec
Iter: 7, Total Loss: 0.006436 in 4.041 sec
Iter: 8, Total Loss: 0.006396 in 4.038 sec
Iter: 9, Total Loss: 0.006362 in 4.014 sec
Iter: 10, Total Loss: 0.006332 in 4.024 sec
Iter: 11, Total Loss: 0.006305 in 4.087 sec
Iter: 12, Total Loss: 0.00628 in 4.028 sec
Iter: 13, Total Loss: 0.006256 in 4.025 sec
Iter: 14, Total Loss: 0.006234 in 4.013 sec
Iter: 15, Total Loss: 0.006213 in 4.018 sec
Iter: 16, Total Loss: 0.006193 in 4.043 sec
Iter: 17, Total Loss: 0.006175 in 4.049 sec
Iter: 18, Total Loss: 0.006158 in 4.047 sec
Iter: 19, Total Loss: 0.006142 in 4.052 sec
Iter: 20, Total Loss: 0.006127 in 4.256 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 4.055 with std = 0.058 sec ###
### py4DSTEM ptycho solver is finished in 1 min 23.409 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 900.98 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 1024, 12, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 622/16384 [00:00<00:02, 6214.41probe position/s]Normalizing amplitudes:   8%|▊         | 1244/16384 [00:00<00:02, 6190.28probe position/s]Normalizing amplitudes:  11%|█▏        | 1864/16384 [00:00<00:02, 6125.75probe position/s]Normalizing amplitudes:  15%|█▌        | 2495/16384 [00:00<00:02, 6194.16probe position/s]Normalizing amplitudes:  19%|█▉        | 3140/16384 [00:00<00:02, 6283.76probe position/s]Normalizing amplitudes:  23%|██▎       | 3780/16384 [00:00<00:01, 6320.53probe position/s]Normalizing amplitudes:  27%|██▋       | 4431/16384 [00:00<00:01, 6381.35probe position/s]Normalizing amplitudes:  31%|███       | 5070/16384 [00:00<00:01, 6382.72probe position/s]Normalizing amplitudes:  35%|███▍      | 5716/16384 [00:00<00:01, 6404.95probe position/s]Normalizing amplitudes:  39%|███▉      | 6357/16384 [00:01<00:01, 6287.08probe position/s]Normalizing amplitudes:  43%|████▎     | 6987/16384 [00:01<00:01, 6205.92probe position/s]Normalizing amplitudes:  46%|████▋     | 7609/16384 [00:01<00:01, 6200.37probe position/s]Normalizing amplitudes:  50%|█████     | 8257/16384 [00:01<00:01, 6283.54probe position/s]Normalizing amplitudes:  54%|█████▍    | 8886/16384 [00:01<00:01, 6273.21probe position/s]Normalizing amplitudes:  58%|█████▊    | 9514/16384 [00:01<00:01, 6272.71probe position/s]Normalizing amplitudes:  62%|██████▏   | 10142/16384 [00:01<00:01, 6236.31probe position/s]Normalizing amplitudes:  66%|██████▌   | 10766/16384 [00:01<00:00, 6197.20probe position/s]Normalizing amplitudes:  70%|██████▉   | 11400/16384 [00:01<00:00, 6234.96probe position/s]Normalizing amplitudes:  73%|███████▎  | 12024/16384 [00:01<00:00, 6151.89probe position/s]Normalizing amplitudes:  77%|███████▋  | 12690/16384 [00:02<00:00, 6301.86probe position/s]Normalizing amplitudes:  81%|████████▏ | 13321/16384 [00:02<00:00, 6284.73probe position/s]Normalizing amplitudes:  85%|████████▌ | 13950/16384 [00:02<00:00, 6231.53probe position/s]Normalizing amplitudes:  89%|████████▉ | 14581/16384 [00:02<00:00, 6254.27probe position/s]Normalizing amplitudes:  93%|█████████▎| 15207/16384 [00:02<00:00, 6239.15probe position/s]Normalizing amplitudes:  97%|█████████▋| 15884/16384 [00:02<00:00, 6396.91probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6286.99probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random1024_p12_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random1024_p12_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
An error occurred for (round, batch, pmode, slice) = (4, 1024, 12, 3): Out of memory allocating 1,610,612,736 bytes (allocated so far: 18,790,481,920 bytes).
### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 900.54 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 1024, 12, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 613/16384 [00:00<00:02, 6128.82probe position/s]Normalizing amplitudes:   7%|▋         | 1226/16384 [00:00<00:02, 5951.61probe position/s]Normalizing amplitudes:  11%|█         | 1829/16384 [00:00<00:02, 5984.92probe position/s]Normalizing amplitudes:  15%|█▍        | 2456/16384 [00:00<00:02, 6096.24probe position/s]Normalizing amplitudes:  19%|█▊        | 3066/16384 [00:00<00:02, 6089.83probe position/s]Normalizing amplitudes:  22%|██▏       | 3676/16384 [00:00<00:02, 6048.86probe position/s]Normalizing amplitudes:  26%|██▋       | 4322/16384 [00:00<00:01, 6181.20probe position/s]Normalizing amplitudes:  30%|███       | 4979/16384 [00:00<00:01, 6302.35probe position/s]Normalizing amplitudes:  34%|███▍      | 5610/16384 [00:00<00:01, 6173.71probe position/s]Normalizing amplitudes:  38%|███▊      | 6229/16384 [00:01<00:01, 6144.58probe position/s]Normalizing amplitudes:  42%|████▏     | 6844/16384 [00:01<00:01, 6135.66probe position/s]Normalizing amplitudes:  46%|████▌     | 7468/16384 [00:01<00:01, 6166.54probe position/s]Normalizing amplitudes:  50%|████▉     | 8119/16384 [00:01<00:01, 6268.24probe position/s]Normalizing amplitudes:  53%|█████▎    | 8751/16384 [00:01<00:01, 6282.77probe position/s]Normalizing amplitudes:  57%|█████▋    | 9396/16384 [00:01<00:01, 6330.38probe position/s]Normalizing amplitudes:  61%|██████    | 10035/16384 [00:01<00:01, 6345.97probe position/s]Normalizing amplitudes:  65%|██████▌   | 10670/16384 [00:01<00:00, 6249.58probe position/s]Normalizing amplitudes:  69%|██████▉   | 11300/16384 [00:01<00:00, 6261.83probe position/s]Normalizing amplitudes:  73%|███████▎  | 11943/16384 [00:01<00:00, 6310.51probe position/s]Normalizing amplitudes:  77%|███████▋  | 12587/16384 [00:02<00:00, 6347.52probe position/s]Normalizing amplitudes:  81%|████████  | 13222/16384 [00:02<00:00, 6343.93probe position/s]Normalizing amplitudes:  85%|████████▍ | 13885/16384 [00:02<00:00, 6427.10probe position/s]Normalizing amplitudes:  89%|████████▉ | 14555/16384 [00:02<00:00, 6506.24probe position/s]Normalizing amplitudes:  93%|█████████▎| 15219/16384 [00:02<00:00, 6544.11probe position/s]Normalizing amplitudes:  97%|█████████▋| 15874/16384 [00:02<00:00, 6527.38probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6276.21probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random1024_p12_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random1024_p12_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
An error occurred for (round, batch, pmode, slice) = (4, 1024, 12, 6): Out of memory allocating 1,610,612,736 bytes (allocated so far: 18,790,481,920 bytes).
### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 899.87 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 512, 1, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 537/16384 [00:00<00:02, 5364.75probe position/s]Normalizing amplitudes:   7%|▋         | 1075/16384 [00:00<00:02, 5370.23probe position/s]Normalizing amplitudes:  10%|▉         | 1613/16384 [00:00<00:02, 5252.41probe position/s]Normalizing amplitudes:  14%|█▍        | 2276/16384 [00:00<00:02, 5784.85probe position/s]Normalizing amplitudes:  18%|█▊        | 2876/16384 [00:00<00:02, 5858.93probe position/s]Normalizing amplitudes:  21%|██        | 3468/16384 [00:00<00:02, 5878.68probe position/s]Normalizing amplitudes:  25%|██▌       | 4116/16384 [00:00<00:02, 6071.05probe position/s]Normalizing amplitudes:  29%|██▉       | 4737/16384 [00:00<00:01, 6112.99probe position/s]Normalizing amplitudes:  33%|███▎      | 5385/16384 [00:00<00:01, 6224.05probe position/s]Normalizing amplitudes:  37%|███▋      | 6010/16384 [00:01<00:01, 6228.83probe position/s]Normalizing amplitudes:  40%|████      | 6634/16384 [00:01<00:01, 6126.39probe position/s]Normalizing amplitudes:  44%|████▍     | 7248/16384 [00:01<00:01, 6066.99probe position/s]Normalizing amplitudes:  48%|████▊     | 7856/16384 [00:01<00:01, 5998.05probe position/s]Normalizing amplitudes:  52%|█████▏    | 8457/16384 [00:01<00:01, 5923.29probe position/s]Normalizing amplitudes:  56%|█████▌    | 9102/16384 [00:01<00:01, 6077.46probe position/s]Normalizing amplitudes:  59%|█████▉    | 9732/16384 [00:01<00:01, 6142.65probe position/s]Normalizing amplitudes:  63%|██████▎   | 10373/16384 [00:01<00:00, 6221.04probe position/s]Normalizing amplitudes:  67%|██████▋   | 11015/16384 [00:01<00:00, 6278.48probe position/s]Normalizing amplitudes:  71%|███████   | 11644/16384 [00:01<00:00, 6152.86probe position/s]Normalizing amplitudes:  75%|███████▍  | 12286/16384 [00:02<00:00, 6230.88probe position/s]Normalizing amplitudes:  79%|███████▉  | 12910/16384 [00:02<00:00, 6195.31probe position/s]Normalizing amplitudes:  83%|████████▎ | 13558/16384 [00:02<00:00, 6278.36probe position/s]Normalizing amplitudes:  87%|████████▋ | 14215/16384 [00:02<00:00, 6364.88probe position/s]Normalizing amplitudes:  91%|█████████ | 14870/16384 [00:02<00:00, 6418.04probe position/s]Normalizing amplitudes:  95%|█████████▍| 15524/16384 [00:02<00:00, 6452.35probe position/s]Normalizing amplitudes:  99%|█████████▊| 16170/16384 [00:02<00:00, 6396.40probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6135.22probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random512_p1_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random512_p1_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.01438 in 0.796 sec
Iter: 2, Total Loss: 0.006513 in 0.800 sec
Iter: 3, Total Loss: 0.006486 in 0.813 sec
Iter: 4, Total Loss: 0.006474 in 0.794 sec
Iter: 5, Total Loss: 0.006467 in 0.784 sec
Iter: 6, Total Loss: 0.006463 in 0.848 sec
Iter: 7, Total Loss: 0.006458 in 0.803 sec
Iter: 8, Total Loss: 0.006455 in 0.819 sec
Iter: 9, Total Loss: 0.006451 in 0.853 sec
Iter: 10, Total Loss: 0.006448 in 0.812 sec
Iter: 11, Total Loss: 0.006445 in 0.768 sec
Iter: 12, Total Loss: 0.006441 in 0.811 sec
Iter: 13, Total Loss: 0.006438 in 0.775 sec
Iter: 14, Total Loss: 0.006434 in 0.783 sec
Iter: 15, Total Loss: 0.006431 in 0.801 sec
Iter: 16, Total Loss: 0.006428 in 0.772 sec
Iter: 17, Total Loss: 0.006424 in 0.824 sec
Iter: 18, Total Loss: 0.006421 in 0.812 sec
Iter: 19, Total Loss: 0.006417 in 0.782 sec
Iter: 20, Total Loss: 0.006413 in 0.759 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 0.800 with std = 0.024 sec ###
### py4DSTEM ptycho solver is finished in 18.126 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 899.28 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 512, 1, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 641/16384 [00:00<00:02, 6408.46probe position/s]Normalizing amplitudes:   8%|▊         | 1282/16384 [00:00<00:02, 6352.55probe position/s]Normalizing amplitudes:  12%|█▏        | 1918/16384 [00:00<00:02, 6209.28probe position/s]Normalizing amplitudes:  16%|█▌        | 2552/16384 [00:00<00:02, 6256.99probe position/s]Normalizing amplitudes:  19%|█▉        | 3183/16384 [00:00<00:02, 6275.17probe position/s]Normalizing amplitudes:  23%|██▎       | 3811/16384 [00:00<00:02, 6084.14probe position/s]Normalizing amplitudes:  27%|██▋       | 4421/16384 [00:00<00:02, 5905.25probe position/s]Normalizing amplitudes:  31%|███       | 5036/16384 [00:00<00:01, 5978.34probe position/s]Normalizing amplitudes:  34%|███▍      | 5640/16384 [00:00<00:01, 5994.23probe position/s]Normalizing amplitudes:  38%|███▊      | 6241/16384 [00:01<00:01, 5788.57probe position/s]Normalizing amplitudes:  42%|████▏     | 6872/16384 [00:01<00:01, 5940.03probe position/s]Normalizing amplitudes:  46%|████▌     | 7470/16384 [00:01<00:01, 5949.86probe position/s]Normalizing amplitudes:  49%|████▉     | 8067/16384 [00:01<00:01, 5955.70probe position/s]Normalizing amplitudes:  53%|█████▎    | 8664/16384 [00:01<00:01, 5798.40probe position/s]Normalizing amplitudes:  57%|█████▋    | 9280/16384 [00:01<00:01, 5903.26probe position/s]Normalizing amplitudes:  60%|██████    | 9890/16384 [00:01<00:01, 5959.31probe position/s]Normalizing amplitudes:  64%|██████▍   | 10494/16384 [00:01<00:00, 5982.43probe position/s]Normalizing amplitudes:  68%|██████▊   | 11149/16384 [00:01<00:00, 6148.57probe position/s]Normalizing amplitudes:  72%|███████▏  | 11765/16384 [00:01<00:00, 5984.88probe position/s]Normalizing amplitudes:  75%|███████▌  | 12365/16384 [00:02<00:00, 5958.17probe position/s]Normalizing amplitudes:  79%|███████▉  | 12966/16384 [00:02<00:00, 5972.30probe position/s]Normalizing amplitudes:  83%|████████▎ | 13605/16384 [00:02<00:00, 6094.51probe position/s]Normalizing amplitudes:  87%|████████▋ | 14263/16384 [00:02<00:00, 6238.56probe position/s]Normalizing amplitudes:  91%|█████████ | 14888/16384 [00:02<00:00, 6207.09probe position/s]Normalizing amplitudes:  95%|█████████▍| 15510/16384 [00:02<00:00, 6095.40probe position/s]Normalizing amplitudes:  99%|█████████▊| 16142/16384 [00:02<00:00, 6158.61probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6055.69probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random512_p1_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random512_p1_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.01469 in 1.661 sec
Iter: 2, Total Loss: 0.006505 in 1.584 sec
Iter: 3, Total Loss: 0.006483 in 1.608 sec
Iter: 4, Total Loss: 0.006472 in 1.539 sec
Iter: 5, Total Loss: 0.006465 in 1.607 sec
Iter: 6, Total Loss: 0.006459 in 1.608 sec
Iter: 7, Total Loss: 0.006451 in 1.607 sec
Iter: 8, Total Loss: 0.006444 in 1.541 sec
Iter: 9, Total Loss: 0.006439 in 1.567 sec
Iter: 10, Total Loss: 0.006433 in 1.575 sec
Iter: 11, Total Loss: 0.006428 in 1.556 sec
Iter: 12, Total Loss: 0.006422 in 1.552 sec
Iter: 13, Total Loss: 0.006418 in 1.581 sec
Iter: 14, Total Loss: 0.006412 in 1.587 sec
Iter: 15, Total Loss: 0.006408 in 1.583 sec
Iter: 16, Total Loss: 0.006402 in 1.587 sec
Iter: 17, Total Loss: 0.006397 in 1.561 sec
Iter: 18, Total Loss: 0.006392 in 1.579 sec
Iter: 19, Total Loss: 0.006386 in 1.570 sec
Iter: 20, Total Loss: 0.006382 in 1.560 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 1.581 with std = 0.028 sec ###
### py4DSTEM ptycho solver is finished in 33.759 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 899.20 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 512, 1, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 596/16384 [00:00<00:02, 5953.99probe position/s]Normalizing amplitudes:   7%|▋         | 1192/16384 [00:00<00:02, 5951.07probe position/s]Normalizing amplitudes:  11%|█         | 1828/16384 [00:00<00:02, 6133.20probe position/s]Normalizing amplitudes:  15%|█▍        | 2443/16384 [00:00<00:02, 6137.59probe position/s]Normalizing amplitudes:  19%|█▊        | 3057/16384 [00:00<00:02, 5966.79probe position/s]Normalizing amplitudes:  22%|██▏       | 3655/16384 [00:00<00:02, 5868.22probe position/s]Normalizing amplitudes:  26%|██▌       | 4243/16384 [00:00<00:02, 5829.69probe position/s]Normalizing amplitudes:  30%|██▉       | 4857/16384 [00:00<00:01, 5925.56probe position/s]Normalizing amplitudes:  33%|███▎      | 5480/16384 [00:00<00:01, 6018.06probe position/s]Normalizing amplitudes:  37%|███▋      | 6083/16384 [00:01<00:01, 5932.10probe position/s]Normalizing amplitudes:  41%|████      | 6677/16384 [00:01<00:01, 5883.13probe position/s]Normalizing amplitudes:  45%|████▍     | 7291/16384 [00:01<00:01, 5958.47probe position/s]Normalizing amplitudes:  48%|████▊     | 7888/16384 [00:01<00:01, 5941.31probe position/s]Normalizing amplitudes:  52%|█████▏    | 8503/16384 [00:01<00:01, 6003.50probe position/s]Normalizing amplitudes:  56%|█████▌    | 9124/16384 [00:01<00:01, 6064.47probe position/s]Normalizing amplitudes:  59%|█████▉    | 9731/16384 [00:01<00:01, 5977.70probe position/s]Normalizing amplitudes:  63%|██████▎   | 10330/16384 [00:01<00:01, 5979.21probe position/s]Normalizing amplitudes:  67%|██████▋   | 10929/16384 [00:01<00:00, 5960.42probe position/s]Normalizing amplitudes:  70%|███████   | 11526/16384 [00:01<00:00, 5824.19probe position/s]Normalizing amplitudes:  74%|███████▍  | 12144/16384 [00:02<00:00, 5927.43probe position/s]Normalizing amplitudes:  78%|███████▊  | 12784/16384 [00:02<00:00, 6066.28probe position/s]Normalizing amplitudes:  82%|████████▏ | 13397/16384 [00:02<00:00, 6084.28probe position/s]Normalizing amplitudes:  85%|████████▌ | 14006/16384 [00:02<00:00, 5983.94probe position/s]Normalizing amplitudes:  89%|████████▉ | 14606/16384 [00:02<00:00, 5858.20probe position/s]Normalizing amplitudes:  93%|█████████▎| 15237/16384 [00:02<00:00, 5989.82probe position/s]Normalizing amplitudes:  97%|█████████▋| 15856/16384 [00:02<00:00, 6046.56probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5964.62probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random512_p1_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random512_p1_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.01518 in 2.731 sec
Iter: 2, Total Loss: 0.006537 in 2.659 sec
Iter: 3, Total Loss: 0.006505 in 2.660 sec
Iter: 4, Total Loss: 0.00649 in 2.673 sec
Iter: 5, Total Loss: 0.006479 in 2.668 sec
Iter: 6, Total Loss: 0.006469 in 2.683 sec
Iter: 7, Total Loss: 0.006459 in 2.666 sec
Iter: 8, Total Loss: 0.006452 in 2.672 sec
Iter: 9, Total Loss: 0.006443 in 2.663 sec
Iter: 10, Total Loss: 0.006436 in 2.650 sec
Iter: 11, Total Loss: 0.00643 in 2.639 sec
Iter: 12, Total Loss: 0.006422 in 2.645 sec
Iter: 13, Total Loss: 0.006412 in 2.671 sec
Iter: 14, Total Loss: 0.006408 in 2.657 sec
Iter: 15, Total Loss: 0.006399 in 2.658 sec
Iter: 16, Total Loss: 0.006392 in 2.681 sec
Iter: 17, Total Loss: 0.006386 in 2.644 sec
Iter: 18, Total Loss: 0.00638 in 2.656 sec
Iter: 19, Total Loss: 0.006374 in 2.667 sec
Iter: 20, Total Loss: 0.006367 in 2.654 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 2.665 with std = 0.019 sec ###
### py4DSTEM ptycho solver is finished in 55.539 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 899.21 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 512, 3, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 617/16384 [00:00<00:02, 6167.98probe position/s]Normalizing amplitudes:   8%|▊         | 1234/16384 [00:00<00:02, 6003.67probe position/s]Normalizing amplitudes:  11%|█▏        | 1859/16384 [00:00<00:02, 6113.81probe position/s]Normalizing amplitudes:  15%|█▌        | 2471/16384 [00:00<00:02, 6090.35probe position/s]Normalizing amplitudes:  19%|█▉        | 3081/16384 [00:00<00:02, 5956.96probe position/s]Normalizing amplitudes:  23%|██▎       | 3716/16384 [00:00<00:02, 6086.15probe position/s]Normalizing amplitudes:  27%|██▋       | 4362/16384 [00:00<00:01, 6204.27probe position/s]Normalizing amplitudes:  30%|███       | 4983/16384 [00:00<00:01, 5857.28probe position/s]Normalizing amplitudes:  34%|███▍      | 5573/16384 [00:00<00:01, 5774.99probe position/s]Normalizing amplitudes:  38%|███▊      | 6154/16384 [00:01<00:01, 5783.49probe position/s]Normalizing amplitudes:  41%|████      | 6743/16384 [00:01<00:01, 5814.03probe position/s]Normalizing amplitudes:  45%|████▍     | 7367/16384 [00:01<00:01, 5940.34probe position/s]Normalizing amplitudes:  49%|████▊     | 7963/16384 [00:01<00:01, 5941.56probe position/s]Normalizing amplitudes:  52%|█████▏    | 8582/16384 [00:01<00:01, 6013.36probe position/s]Normalizing amplitudes:  56%|█████▌    | 9211/16384 [00:01<00:01, 6095.88probe position/s]Normalizing amplitudes:  60%|█████▉    | 9822/16384 [00:01<00:01, 6060.95probe position/s]Normalizing amplitudes:  64%|██████▎   | 10439/16384 [00:01<00:00, 6091.65probe position/s]Normalizing amplitudes:  68%|██████▊   | 11084/16384 [00:01<00:00, 6195.29probe position/s]Normalizing amplitudes:  71%|███████▏  | 11704/16384 [00:01<00:00, 5891.99probe position/s]Normalizing amplitudes:  75%|███████▌  | 12297/16384 [00:02<00:00, 5711.60probe position/s]Normalizing amplitudes:  79%|███████▉  | 12937/16384 [00:02<00:00, 5906.48probe position/s]Normalizing amplitudes:  83%|████████▎ | 13557/16384 [00:02<00:00, 5991.04probe position/s]Normalizing amplitudes:  86%|████████▋ | 14159/16384 [00:02<00:00, 5967.59probe position/s]Normalizing amplitudes:  90%|█████████ | 14758/16384 [00:02<00:00, 5888.05probe position/s]Normalizing amplitudes:  94%|█████████▍| 15395/16384 [00:02<00:00, 6027.87probe position/s]Normalizing amplitudes:  98%|█████████▊| 16025/16384 [00:02<00:00, 6107.04probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5986.98probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random512_p3_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random512_p3_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.03909 in 1.491 sec
Iter: 2, Total Loss: 0.006644 in 1.446 sec
Iter: 3, Total Loss: 0.006498 in 1.452 sec
Iter: 4, Total Loss: 0.006444 in 1.459 sec
Iter: 5, Total Loss: 0.006418 in 1.462 sec
Iter: 6, Total Loss: 0.006398 in 1.491 sec
Iter: 7, Total Loss: 0.006385 in 1.452 sec
Iter: 8, Total Loss: 0.00637 in 1.438 sec
Iter: 9, Total Loss: 0.006358 in 1.447 sec
Iter: 10, Total Loss: 0.006343 in 1.446 sec
Iter: 11, Total Loss: 0.00633 in 1.461 sec
Iter: 12, Total Loss: 0.006316 in 1.419 sec
Iter: 13, Total Loss: 0.006302 in 1.441 sec
Iter: 14, Total Loss: 0.006288 in 1.435 sec
Iter: 15, Total Loss: 0.006273 in 1.434 sec
Iter: 16, Total Loss: 0.006259 in 1.476 sec
Iter: 17, Total Loss: 0.006243 in 1.435 sec
Iter: 18, Total Loss: 0.006229 in 1.437 sec
Iter: 19, Total Loss: 0.006213 in 1.467 sec
Iter: 20, Total Loss: 0.0062 in 1.479 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 1.453 with std = 0.019 sec ###
### py4DSTEM ptycho solver is finished in 31.491 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 899.27 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 512, 3, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 537/16384 [00:00<00:02, 5356.06probe position/s]Normalizing amplitudes:   7%|▋         | 1126/16384 [00:00<00:02, 5669.36probe position/s]Normalizing amplitudes:  11%|█         | 1816/16384 [00:00<00:02, 6229.88probe position/s]Normalizing amplitudes:  15%|█▍        | 2440/16384 [00:00<00:02, 5902.34probe position/s]Normalizing amplitudes:  19%|█▊        | 3033/16384 [00:00<00:02, 5857.58probe position/s]Normalizing amplitudes:  22%|██▏       | 3634/16384 [00:00<00:02, 5903.36probe position/s]Normalizing amplitudes:  26%|██▌       | 4227/16384 [00:00<00:02, 5911.16probe position/s]Normalizing amplitudes:  29%|██▉       | 4819/16384 [00:00<00:02, 5643.85probe position/s]Normalizing amplitudes:  33%|███▎      | 5390/16384 [00:00<00:01, 5661.81probe position/s]Normalizing amplitudes:  36%|███▋      | 5959/16384 [00:01<00:01, 5594.17probe position/s]Normalizing amplitudes:  40%|████      | 6586/16384 [00:01<00:01, 5791.77probe position/s]Normalizing amplitudes:  44%|████▎     | 7167/16384 [00:01<00:01, 5765.49probe position/s]Normalizing amplitudes:  47%|████▋     | 7745/16384 [00:01<00:01, 5693.14probe position/s]Normalizing amplitudes:  51%|█████     | 8316/16384 [00:01<00:01, 5690.49probe position/s]Normalizing amplitudes:  54%|█████▍    | 8888/16384 [00:01<00:01, 5697.34probe position/s]Normalizing amplitudes:  58%|█████▊    | 9490/16384 [00:01<00:01, 5789.38probe position/s]Normalizing amplitudes:  61%|██████▏   | 10070/16384 [00:01<00:01, 5757.75probe position/s]Normalizing amplitudes:  65%|██████▌   | 10702/16384 [00:01<00:00, 5924.26probe position/s]Normalizing amplitudes:  69%|██████▉   | 11324/16384 [00:01<00:00, 6006.61probe position/s]Normalizing amplitudes:  73%|███████▎  | 11925/16384 [00:02<00:00, 5857.17probe position/s]Normalizing amplitudes:  76%|███████▋  | 12512/16384 [00:02<00:00, 5751.71probe position/s]Normalizing amplitudes:  80%|███████▉  | 13089/16384 [00:02<00:00, 5709.66probe position/s]Normalizing amplitudes:  83%|████████▎ | 13669/16384 [00:02<00:00, 5735.07probe position/s]Normalizing amplitudes:  87%|████████▋ | 14266/16384 [00:02<00:00, 5801.15probe position/s]Normalizing amplitudes:  91%|█████████ | 14847/16384 [00:02<00:00, 5768.92probe position/s]Normalizing amplitudes:  94%|█████████▍| 15464/16384 [00:02<00:00, 5885.00probe position/s]Normalizing amplitudes:  98%|█████████▊| 16053/16384 [00:02<00:00, 5762.08probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5791.30probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random512_p3_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random512_p3_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.03834 in 3.722 sec
Iter: 2, Total Loss: 0.006665 in 3.646 sec
Iter: 3, Total Loss: 0.006466 in 3.605 sec
Iter: 4, Total Loss: 0.006414 in 3.562 sec
Iter: 5, Total Loss: 0.006384 in 3.571 sec
Iter: 6, Total Loss: 0.006357 in 3.564 sec
Iter: 7, Total Loss: 0.006334 in 3.550 sec
Iter: 8, Total Loss: 0.006309 in 3.584 sec
Iter: 9, Total Loss: 0.006286 in 3.573 sec
Iter: 10, Total Loss: 0.006263 in 3.532 sec
Iter: 11, Total Loss: 0.006241 in 3.540 sec
Iter: 12, Total Loss: 0.00622 in 3.561 sec
Iter: 13, Total Loss: 0.006198 in 3.532 sec
Iter: 14, Total Loss: 0.006179 in 3.571 sec
Iter: 15, Total Loss: 0.006157 in 3.581 sec
Iter: 16, Total Loss: 0.006138 in 3.566 sec
Iter: 17, Total Loss: 0.006117 in 3.559 sec
Iter: 18, Total Loss: 0.006099 in 3.573 sec
Iter: 19, Total Loss: 0.006078 in 3.574 sec
Iter: 20, Total Loss: 0.006062 in 3.602 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 3.578 with std = 0.041 sec ###
### py4DSTEM ptycho solver is finished in 1 min 13.827 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 900.16 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 512, 3, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 567/16384 [00:00<00:02, 5659.12probe position/s]Normalizing amplitudes:   7%|▋         | 1183/16384 [00:00<00:02, 5949.96probe position/s]Normalizing amplitudes:  11%|█         | 1793/16384 [00:00<00:02, 6015.97probe position/s]Normalizing amplitudes:  15%|█▍        | 2399/16384 [00:00<00:02, 6030.32probe position/s]Normalizing amplitudes:  18%|█▊        | 3003/16384 [00:00<00:02, 5917.94probe position/s]Normalizing amplitudes:  22%|██▏       | 3596/16384 [00:00<00:02, 5844.97probe position/s]Normalizing amplitudes:  26%|██▌       | 4186/16384 [00:00<00:02, 5860.90probe position/s]Normalizing amplitudes:  29%|██▉       | 4813/16384 [00:00<00:01, 5989.45probe position/s]Normalizing amplitudes:  33%|███▎      | 5413/16384 [00:00<00:01, 5785.41probe position/s]Normalizing amplitudes:  37%|███▋      | 6021/16384 [00:01<00:01, 5872.74probe position/s]Normalizing amplitudes:  41%|████      | 6640/16384 [00:01<00:01, 5967.38probe position/s]Normalizing amplitudes:  44%|████▍     | 7238/16384 [00:01<00:01, 5951.09probe position/s]Normalizing amplitudes:  48%|████▊     | 7852/16384 [00:01<00:01, 6004.16probe position/s]Normalizing amplitudes:  52%|█████▏    | 8462/16384 [00:01<00:01, 6030.75probe position/s]Normalizing amplitudes:  55%|█████▌    | 9066/16384 [00:01<00:01, 5958.54probe position/s]Normalizing amplitudes:  59%|█████▉    | 9663/16384 [00:01<00:01, 5904.86probe position/s]Normalizing amplitudes:  63%|██████▎   | 10254/16384 [00:01<00:01, 5827.64probe position/s]Normalizing amplitudes:  67%|██████▋   | 10896/16384 [00:01<00:00, 5999.81probe position/s]Normalizing amplitudes:  70%|███████   | 11507/16384 [00:01<00:00, 6032.06probe position/s]Normalizing amplitudes:  74%|███████▍  | 12111/16384 [00:02<00:00, 5690.43probe position/s]Normalizing amplitudes:  78%|███████▊  | 12745/16384 [00:02<00:00, 5875.78probe position/s]Normalizing amplitudes:  82%|████████▏ | 13363/16384 [00:02<00:00, 5963.28probe position/s]Normalizing amplitudes:  86%|████████▌ | 14009/16384 [00:02<00:00, 6108.21probe position/s]Normalizing amplitudes:  89%|████████▉ | 14655/16384 [00:02<00:00, 6211.13probe position/s]Normalizing amplitudes:  93%|█████████▎| 15278/16384 [00:02<00:00, 6148.34probe position/s]Normalizing amplitudes:  97%|█████████▋| 15895/16384 [00:02<00:00, 6073.24probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5962.72probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random512_p3_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random512_p3_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.04093 in 6.577 sec
Iter: 2, Total Loss: 0.007087 in 6.601 sec
Iter: 3, Total Loss: 0.006522 in 6.575 sec
Iter: 4, Total Loss: 0.006378 in 6.679 sec
Iter: 5, Total Loss: 0.006297 in 6.696 sec
Iter: 6, Total Loss: 0.006238 in 6.588 sec
Iter: 7, Total Loss: 0.006192 in 6.537 sec
Iter: 8, Total Loss: 0.006153 in 6.581 sec
Iter: 9, Total Loss: 0.006119 in 6.543 sec
Iter: 10, Total Loss: 0.006089 in 6.512 sec
Iter: 11, Total Loss: 0.006061 in 6.548 sec
Iter: 12, Total Loss: 0.006036 in 6.483 sec
Iter: 13, Total Loss: 0.006012 in 6.508 sec
Iter: 14, Total Loss: 0.005988 in 6.546 sec
Iter: 15, Total Loss: 0.005966 in 6.854 sec
Iter: 16, Total Loss: 0.005945 in 6.532 sec
Iter: 17, Total Loss: 0.005924 in 6.499 sec
Iter: 18, Total Loss: 0.005904 in 6.502 sec
Iter: 19, Total Loss: 0.005887 in 6.556 sec
Iter: 20, Total Loss: 0.005868 in 6.516 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 6.572 with std = 0.084 sec ###
### py4DSTEM ptycho solver is finished in 2 min 13.728 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 906.90 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 512, 6, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 660/16384 [00:00<00:02, 6593.29probe position/s]Normalizing amplitudes:   8%|▊         | 1320/16384 [00:00<00:02, 6382.43probe position/s]Normalizing amplitudes:  12%|█▏        | 1959/16384 [00:00<00:02, 6255.79probe position/s]Normalizing amplitudes:  16%|█▌        | 2593/16384 [00:00<00:02, 6287.64probe position/s]Normalizing amplitudes:  20%|█▉        | 3223/16384 [00:00<00:02, 6241.10probe position/s]Normalizing amplitudes:  24%|██▎       | 3885/16384 [00:00<00:01, 6367.88probe position/s]Normalizing amplitudes:  28%|██▊       | 4523/16384 [00:00<00:01, 6178.50probe position/s]Normalizing amplitudes:  31%|███▏      | 5143/16384 [00:00<00:01, 5812.96probe position/s]Normalizing amplitudes:  35%|███▌      | 5786/16384 [00:00<00:01, 5993.55probe position/s]Normalizing amplitudes:  39%|███▉      | 6418/16384 [00:01<00:01, 6089.45probe position/s]Normalizing amplitudes:  43%|████▎     | 7067/16384 [00:01<00:01, 6205.42probe position/s]Normalizing amplitudes:  47%|████▋     | 7697/16384 [00:01<00:01, 6233.53probe position/s]Normalizing amplitudes:  51%|█████     | 8323/16384 [00:01<00:01, 6159.28probe position/s]Normalizing amplitudes:  55%|█████▍    | 8963/16384 [00:01<00:01, 6227.51probe position/s]Normalizing amplitudes:  59%|█████▊    | 9606/16384 [00:01<00:01, 6285.10probe position/s]Normalizing amplitudes:  63%|██████▎   | 10268/16384 [00:01<00:00, 6382.13probe position/s]Normalizing amplitudes:  67%|██████▋   | 10907/16384 [00:01<00:00, 6313.45probe position/s]Normalizing amplitudes:  70%|███████   | 11539/16384 [00:01<00:00, 6276.70probe position/s]Normalizing amplitudes:  74%|███████▍  | 12168/16384 [00:01<00:00, 6200.18probe position/s]Normalizing amplitudes:  78%|███████▊  | 12789/16384 [00:02<00:00, 6159.73probe position/s]Normalizing amplitudes:  82%|████████▏ | 13441/16384 [00:02<00:00, 6264.27probe position/s]Normalizing amplitudes:  86%|████████▌ | 14068/16384 [00:02<00:00, 6219.18probe position/s]Normalizing amplitudes:  90%|████████▉ | 14708/16384 [00:02<00:00, 6270.31probe position/s]Normalizing amplitudes:  94%|█████████▎| 15336/16384 [00:02<00:00, 6014.73probe position/s]Normalizing amplitudes:  97%|█████████▋| 15940/16384 [00:02<00:00, 5833.96probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6140.98probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random512_p6_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random512_p6_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.1065 in 2.495 sec
Iter: 2, Total Loss: 0.006765 in 2.431 sec
Iter: 3, Total Loss: 0.006544 in 2.436 sec
Iter: 4, Total Loss: 0.006458 in 2.479 sec
Iter: 5, Total Loss: 0.006415 in 2.527 sec
Iter: 6, Total Loss: 0.006387 in 2.589 sec
Iter: 7, Total Loss: 0.006366 in 2.461 sec
Iter: 8, Total Loss: 0.006346 in 2.478 sec
Iter: 9, Total Loss: 0.006328 in 2.413 sec
Iter: 10, Total Loss: 0.006309 in 2.433 sec
Iter: 11, Total Loss: 0.006291 in 2.453 sec
Iter: 12, Total Loss: 0.006273 in 2.464 sec
Iter: 13, Total Loss: 0.006254 in 2.433 sec
Iter: 14, Total Loss: 0.006237 in 2.419 sec
Iter: 15, Total Loss: 0.006217 in 2.440 sec
Iter: 16, Total Loss: 0.0062 in 2.488 sec
Iter: 17, Total Loss: 0.006181 in 2.505 sec
Iter: 18, Total Loss: 0.006164 in 2.473 sec
Iter: 19, Total Loss: 0.006145 in 2.450 sec
Iter: 20, Total Loss: 0.006129 in 2.437 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 2.465 with std = 0.041 sec ###
### py4DSTEM ptycho solver is finished in 51.825 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 900.63 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 512, 6, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 619/16384 [00:00<00:02, 6184.31probe position/s]Normalizing amplitudes:   8%|▊         | 1238/16384 [00:00<00:02, 5896.48probe position/s]Normalizing amplitudes:  11%|█         | 1829/16384 [00:00<00:02, 5742.30probe position/s]Normalizing amplitudes:  15%|█▍        | 2411/16384 [00:00<00:02, 5770.72probe position/s]Normalizing amplitudes:  19%|█▊        | 3051/16384 [00:00<00:02, 5989.76probe position/s]Normalizing amplitudes:  23%|██▎       | 3689/16384 [00:00<00:02, 6117.14probe position/s]Normalizing amplitudes:  26%|██▋       | 4302/16384 [00:00<00:01, 6112.72probe position/s]Normalizing amplitudes:  30%|███       | 4945/16384 [00:00<00:01, 6210.10probe position/s]Normalizing amplitudes:  34%|███▍      | 5567/16384 [00:00<00:01, 6114.30probe position/s]Normalizing amplitudes:  38%|███▊      | 6189/16384 [00:01<00:01, 6144.25probe position/s]Normalizing amplitudes:  42%|████▏     | 6804/16384 [00:01<00:01, 6095.51probe position/s]Normalizing amplitudes:  45%|████▌     | 7416/16384 [00:01<00:01, 6102.27probe position/s]Normalizing amplitudes:  49%|████▉     | 8029/16384 [00:01<00:01, 6109.35probe position/s]Normalizing amplitudes:  53%|█████▎    | 8649/16384 [00:01<00:01, 6133.74probe position/s]Normalizing amplitudes:  57%|█████▋    | 9263/16384 [00:01<00:01, 5871.55probe position/s]Normalizing amplitudes:  60%|██████    | 9904/16384 [00:01<00:01, 6026.18probe position/s]Normalizing amplitudes:  64%|██████▍   | 10509/16384 [00:01<00:00, 5929.45probe position/s]Normalizing amplitudes:  68%|██████▊   | 11104/16384 [00:01<00:00, 5929.44probe position/s]Normalizing amplitudes:  71%|███████▏  | 11699/16384 [00:01<00:00, 5828.82probe position/s]Normalizing amplitudes:  75%|███████▍  | 12283/16384 [00:02<00:00, 5756.71probe position/s]Normalizing amplitudes:  79%|███████▉  | 12904/16384 [00:02<00:00, 5887.02probe position/s]Normalizing amplitudes:  83%|████████▎ | 13521/16384 [00:02<00:00, 5970.16probe position/s]Normalizing amplitudes:  86%|████████▋ | 14161/16384 [00:02<00:00, 6093.63probe position/s]Normalizing amplitudes:  90%|█████████ | 14784/16384 [00:02<00:00, 6131.47probe position/s]Normalizing amplitudes:  94%|█████████▍| 15398/16384 [00:02<00:00, 5942.62probe position/s]Normalizing amplitudes:  98%|█████████▊| 16024/16384 [00:02<00:00, 6033.69probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6013.69probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random512_p6_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random512_p6_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.1061 in 6.499 sec
Iter: 2, Total Loss: 0.007132 in 6.500 sec
Iter: 3, Total Loss: 0.006605 in 6.552 sec
Iter: 4, Total Loss: 0.006467 in 6.498 sec
Iter: 5, Total Loss: 0.006394 in 6.489 sec
Iter: 6, Total Loss: 0.006338 in 6.461 sec
Iter: 7, Total Loss: 0.00629 in 6.521 sec
Iter: 8, Total Loss: 0.006249 in 6.451 sec
Iter: 9, Total Loss: 0.006211 in 6.518 sec
Iter: 10, Total Loss: 0.006178 in 6.503 sec
Iter: 11, Total Loss: 0.006146 in 6.519 sec
Iter: 12, Total Loss: 0.006116 in 6.489 sec
Iter: 13, Total Loss: 0.006088 in 6.456 sec
Iter: 14, Total Loss: 0.006061 in 6.441 sec
Iter: 15, Total Loss: 0.006035 in 6.460 sec
Iter: 16, Total Loss: 0.006009 in 6.469 sec
Iter: 17, Total Loss: 0.005984 in 6.473 sec
Iter: 18, Total Loss: 0.005961 in 6.483 sec
Iter: 19, Total Loss: 0.005936 in 6.475 sec
Iter: 20, Total Loss: 0.005913 in 6.459 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 6.486 with std = 0.028 sec ###
### py4DSTEM ptycho solver is finished in 2 min 12.041 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 899.52 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 512, 6, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 629/16384 [00:00<00:02, 6284.64probe position/s]Normalizing amplitudes:   8%|▊         | 1258/16384 [00:00<00:02, 6139.63probe position/s]Normalizing amplitudes:  11%|█▏        | 1873/16384 [00:00<00:02, 6030.79probe position/s]Normalizing amplitudes:  15%|█▌        | 2477/16384 [00:00<00:02, 5909.01probe position/s]Normalizing amplitudes:  19%|█▊        | 3069/16384 [00:00<00:02, 5692.16probe position/s]Normalizing amplitudes:  22%|██▏       | 3686/16384 [00:00<00:02, 5846.42probe position/s]Normalizing amplitudes:  26%|██▌       | 4295/16384 [00:00<00:02, 5921.25probe position/s]Normalizing amplitudes:  30%|██▉       | 4902/16384 [00:00<00:01, 5965.15probe position/s]Normalizing amplitudes:  34%|███▎      | 5505/16384 [00:00<00:01, 5982.31probe position/s]Normalizing amplitudes:  37%|███▋      | 6104/16384 [00:01<00:01, 5922.72probe position/s]Normalizing amplitudes:  41%|████      | 6704/16384 [00:01<00:01, 5943.53probe position/s]Normalizing amplitudes:  45%|████▍     | 7299/16384 [00:01<00:01, 5840.32probe position/s]Normalizing amplitudes:  48%|████▊     | 7894/16384 [00:01<00:01, 5870.96probe position/s]Normalizing amplitudes:  52%|█████▏    | 8482/16384 [00:01<00:01, 5859.46probe position/s]Normalizing amplitudes:  55%|█████▌    | 9069/16384 [00:01<00:01, 5727.44probe position/s]Normalizing amplitudes:  59%|█████▉    | 9658/16384 [00:01<00:01, 5774.87probe position/s]Normalizing amplitudes:  63%|██████▎   | 10264/16384 [00:01<00:01, 5858.78probe position/s]Normalizing amplitudes:  66%|██████▋   | 10878/16384 [00:01<00:00, 5938.40probe position/s]Normalizing amplitudes:  70%|███████   | 11479/16384 [00:01<00:00, 5958.70probe position/s]Normalizing amplitudes:  74%|███████▎  | 12076/16384 [00:02<00:00, 5793.96probe position/s]Normalizing amplitudes:  77%|███████▋  | 12677/16384 [00:02<00:00, 5855.59probe position/s]Normalizing amplitudes:  81%|████████  | 13266/16384 [00:02<00:00, 5863.50probe position/s]Normalizing amplitudes:  85%|████████▍ | 13867/16384 [00:02<00:00, 5905.27probe position/s]Normalizing amplitudes:  88%|████████▊ | 14464/16384 [00:02<00:00, 5923.73probe position/s]Normalizing amplitudes:  92%|█████████▏| 15066/16384 [00:02<00:00, 5950.31probe position/s]Normalizing amplitudes:  96%|█████████▌| 15662/16384 [00:02<00:00, 5889.80probe position/s]Normalizing amplitudes:  99%|█████████▉| 16260/16384 [00:02<00:00, 5916.12probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5871.14probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random512_p6_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random512_p6_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.107 in 12.475 sec
Iter: 2, Total Loss: 0.007923 in 12.548 sec
Iter: 3, Total Loss: 0.006814 in 12.441 sec
Iter: 4, Total Loss: 0.006536 in 12.457 sec
Iter: 5, Total Loss: 0.0064 in 12.411 sec
Iter: 6, Total Loss: 0.006309 in 12.482 sec
Iter: 7, Total Loss: 0.006243 in 12.564 sec
Iter: 8, Total Loss: 0.00619 in 12.496 sec
Iter: 9, Total Loss: 0.006148 in 12.460 sec
Iter: 10, Total Loss: 0.006112 in 12.478 sec
Iter: 11, Total Loss: 0.006078 in 12.434 sec
Iter: 12, Total Loss: 0.00605 in 12.447 sec
Iter: 13, Total Loss: 0.006021 in 12.398 sec
Iter: 14, Total Loss: 0.005998 in 12.484 sec
Iter: 15, Total Loss: 0.00597 in 12.355 sec
Iter: 16, Total Loss: 0.005947 in 12.370 sec
Iter: 17, Total Loss: 0.005921 in 12.370 sec
Iter: 18, Total Loss: 0.0059 in 12.428 sec
Iter: 19, Total Loss: 0.005876 in 12.558 sec
Iter: 20, Total Loss: 0.005857 in 12.304 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 12.448 with std = 0.066 sec ###
### py4DSTEM ptycho solver is finished in 4 min 11.366 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 906.71 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 512, 12, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 643/16384 [00:00<00:02, 6428.32probe position/s]Normalizing amplitudes:   8%|▊         | 1289/16384 [00:00<00:02, 6445.09probe position/s]Normalizing amplitudes:  12%|█▏        | 1934/16384 [00:00<00:02, 6378.02probe position/s]Normalizing amplitudes:  16%|█▌        | 2576/16384 [00:00<00:02, 6390.94probe position/s]Normalizing amplitudes:  20%|█▉        | 3216/16384 [00:00<00:02, 6273.04probe position/s]Normalizing amplitudes:  24%|██▎       | 3858/16384 [00:00<00:01, 6319.92probe position/s]Normalizing amplitudes:  28%|██▊       | 4507/16384 [00:00<00:01, 6372.85probe position/s]Normalizing amplitudes:  31%|███▏      | 5145/16384 [00:00<00:01, 6366.14probe position/s]Normalizing amplitudes:  35%|███▌      | 5786/16384 [00:00<00:01, 6377.26probe position/s]Normalizing amplitudes:  39%|███▉      | 6464/16384 [00:01<00:01, 6500.15probe position/s]Normalizing amplitudes:  43%|████▎     | 7115/16384 [00:01<00:01, 6458.19probe position/s]Normalizing amplitudes:  47%|████▋     | 7761/16384 [00:01<00:01, 6425.55probe position/s]Normalizing amplitudes:  51%|█████▏    | 8404/16384 [00:01<00:01, 6327.31probe position/s]Normalizing amplitudes:  55%|█████▌    | 9038/16384 [00:01<00:01, 6241.19probe position/s]Normalizing amplitudes:  59%|█████▉    | 9663/16384 [00:01<00:01, 6218.53probe position/s]Normalizing amplitudes:  63%|██████▎   | 10286/16384 [00:01<00:00, 6118.57probe position/s]Normalizing amplitudes:  67%|██████▋   | 10944/16384 [00:01<00:00, 6251.00probe position/s]Normalizing amplitudes:  71%|███████   | 11575/16384 [00:01<00:00, 6265.99probe position/s]Normalizing amplitudes:  74%|███████▍  | 12203/16384 [00:01<00:00, 6193.92probe position/s]Normalizing amplitudes:  79%|███████▊  | 12868/16384 [00:02<00:00, 6324.16probe position/s]Normalizing amplitudes:  82%|████████▏ | 13501/16384 [00:02<00:00, 6285.51probe position/s]Normalizing amplitudes:  86%|████████▌ | 14130/16384 [00:02<00:00, 6265.07probe position/s]Normalizing amplitudes:  90%|█████████ | 14780/16384 [00:02<00:00, 6334.26probe position/s]Normalizing amplitudes:  94%|█████████▍| 15414/16384 [00:02<00:00, 6238.86probe position/s]Normalizing amplitudes:  98%|█████████▊| 16097/16384 [00:02<00:00, 6410.54probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6328.07probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random512_p12_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random512_p12_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.2743 in 4.415 sec
Iter: 2, Total Loss: 0.006922 in 4.385 sec
Iter: 3, Total Loss: 0.006607 in 4.328 sec
Iter: 4, Total Loss: 0.006477 in 4.379 sec
Iter: 5, Total Loss: 0.006403 in 4.542 sec
Iter: 6, Total Loss: 0.006352 in 4.785 sec
Iter: 7, Total Loss: 0.006312 in 4.458 sec
Iter: 8, Total Loss: 0.006279 in 4.880 sec
Iter: 9, Total Loss: 0.006248 in 4.452 sec
Iter: 10, Total Loss: 0.00622 in 4.416 sec
Iter: 11, Total Loss: 0.006192 in 4.535 sec
Iter: 12, Total Loss: 0.006167 in 4.585 sec
Iter: 13, Total Loss: 0.006142 in 4.480 sec
Iter: 14, Total Loss: 0.006118 in 4.544 sec
Iter: 15, Total Loss: 0.006095 in 4.560 sec
Iter: 16, Total Loss: 0.006073 in 4.432 sec
Iter: 17, Total Loss: 0.006051 in 4.441 sec
Iter: 18, Total Loss: 0.006029 in 4.605 sec
Iter: 19, Total Loss: 0.006009 in 4.829 sec
Iter: 20, Total Loss: 0.005989 in 4.447 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 4.525 with std = 0.147 sec ###
### py4DSTEM ptycho solver is finished in 1 min 32.891 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 917.70 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 512, 12, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 671/16384 [00:00<00:02, 6698.30probe position/s]Normalizing amplitudes:   8%|▊         | 1341/16384 [00:00<00:02, 6362.25probe position/s]Normalizing amplitudes:  12%|█▏        | 1979/16384 [00:00<00:02, 6103.10probe position/s]Normalizing amplitudes:  16%|█▌        | 2645/16384 [00:00<00:02, 6310.14probe position/s]Normalizing amplitudes:  20%|██        | 3328/16384 [00:00<00:02, 6492.19probe position/s]Normalizing amplitudes:  24%|██▍       | 3979/16384 [00:00<00:01, 6298.39probe position/s]Normalizing amplitudes:  29%|██▊       | 4691/16384 [00:00<00:01, 6556.35probe position/s]Normalizing amplitudes:  33%|███▎      | 5349/16384 [00:00<00:01, 6404.61probe position/s]Normalizing amplitudes:  37%|███▋      | 5992/16384 [00:00<00:01, 6356.48probe position/s]Normalizing amplitudes:  41%|████      | 6656/16384 [00:01<00:01, 6439.11probe position/s]Normalizing amplitudes:  45%|████▍     | 7301/16384 [00:01<00:01, 6313.07probe position/s]Normalizing amplitudes:  48%|████▊     | 7934/16384 [00:01<00:01, 6047.59probe position/s]Normalizing amplitudes:  52%|█████▏    | 8542/16384 [00:01<00:01, 5871.25probe position/s]Normalizing amplitudes:  56%|█████▌    | 9207/16384 [00:01<00:01, 6092.15probe position/s]Normalizing amplitudes:  60%|██████    | 9831/16384 [00:01<00:01, 6134.00probe position/s]Normalizing amplitudes:  64%|██████▍   | 10447/16384 [00:01<00:01, 5832.69probe position/s]Normalizing amplitudes:  68%|██████▊   | 11101/16384 [00:01<00:00, 6032.57probe position/s]Normalizing amplitudes:  72%|███████▏  | 11748/16384 [00:01<00:00, 6157.41probe position/s]Normalizing amplitudes:  75%|███████▌  | 12368/16384 [00:01<00:00, 6169.57probe position/s]Normalizing amplitudes:  79%|███████▉  | 12998/16384 [00:02<00:00, 6205.20probe position/s]Normalizing amplitudes:  83%|████████▎ | 13621/16384 [00:02<00:00, 6146.75probe position/s]Normalizing amplitudes:  87%|████████▋ | 14237/16384 [00:02<00:00, 6140.39probe position/s]Normalizing amplitudes:  91%|█████████ | 14900/16384 [00:02<00:00, 6283.30probe position/s]Normalizing amplitudes:  95%|█████████▍| 15546/16384 [00:02<00:00, 6334.04probe position/s]Normalizing amplitudes:  99%|█████████▉| 16181/16384 [00:02<00:00, 6294.24probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6228.85probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random512_p12_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random512_p12_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.2714 in 12.414 sec
Iter: 2, Total Loss: 0.007623 in 12.619 sec
Iter: 3, Total Loss: 0.006831 in 12.820 sec
Iter: 4, Total Loss: 0.006623 in 12.830 sec
Iter: 5, Total Loss: 0.006521 in 12.449 sec
Iter: 6, Total Loss: 0.00645 in 12.505 sec
Iter: 7, Total Loss: 0.006395 in 12.618 sec
Iter: 8, Total Loss: 0.006345 in 12.599 sec
Iter: 9, Total Loss: 0.006305 in 12.645 sec
Iter: 10, Total Loss: 0.006267 in 13.366 sec
Iter: 11, Total Loss: 0.006232 in 12.706 sec
Iter: 12, Total Loss: 0.006202 in 12.558 sec
Iter: 13, Total Loss: 0.006172 in 12.531 sec
Iter: 14, Total Loss: 0.006147 in 12.781 sec
Iter: 15, Total Loss: 0.006119 in 13.122 sec
Iter: 16, Total Loss: 0.006097 in 12.722 sec
Iter: 17, Total Loss: 0.006072 in 12.411 sec
Iter: 18, Total Loss: 0.006051 in 12.392 sec
Iter: 19, Total Loss: 0.006025 in 12.465 sec
Iter: 20, Total Loss: 0.006006 in 12.462 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 12.651 with std = 0.241 sec ###
### py4DSTEM ptycho solver is finished in 4 min 15.392 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 902.80 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 512, 12, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 677/16384 [00:00<00:02, 6769.20probe position/s]Normalizing amplitudes:   8%|▊         | 1354/16384 [00:00<00:02, 6506.20probe position/s]Normalizing amplitudes:  12%|█▏        | 2006/16384 [00:00<00:02, 6053.43probe position/s]Normalizing amplitudes:  16%|█▌        | 2615/16384 [00:00<00:02, 5906.81probe position/s]Normalizing amplitudes:  20%|█▉        | 3241/16384 [00:00<00:02, 6025.09probe position/s]Normalizing amplitudes:  23%|██▎       | 3846/16384 [00:00<00:02, 5971.61probe position/s]Normalizing amplitudes:  27%|██▋       | 4477/16384 [00:00<00:01, 6075.26probe position/s]Normalizing amplitudes:  31%|███       | 5099/16384 [00:00<00:01, 6119.81probe position/s]Normalizing amplitudes:  35%|███▌      | 5758/16384 [00:00<00:01, 6262.54probe position/s]Normalizing amplitudes:  39%|███▉      | 6386/16384 [00:01<00:01, 6261.95probe position/s]Normalizing amplitudes:  43%|████▎     | 7035/16384 [00:01<00:01, 6328.60probe position/s]Normalizing amplitudes:  47%|████▋     | 7706/16384 [00:01<00:01, 6442.16probe position/s]Normalizing amplitudes:  51%|█████     | 8351/16384 [00:01<00:01, 6280.91probe position/s]Normalizing amplitudes:  55%|█████▍    | 8981/16384 [00:01<00:01, 6214.85probe position/s]Normalizing amplitudes:  59%|█████▊    | 9619/16384 [00:01<00:01, 6261.60probe position/s]Normalizing amplitudes:  63%|██████▎   | 10297/16384 [00:01<00:00, 6414.17probe position/s]Normalizing amplitudes:  67%|██████▋   | 11043/16384 [00:01<00:00, 6724.80probe position/s]Normalizing amplitudes:  72%|███████▏  | 11717/16384 [00:01<00:00, 6400.36probe position/s]Normalizing amplitudes:  75%|███████▌  | 12361/16384 [00:01<00:00, 6353.07probe position/s]Normalizing amplitudes:  79%|███████▉  | 12999/16384 [00:02<00:00, 6166.79probe position/s]Normalizing amplitudes:  83%|████████▎ | 13619/16384 [00:02<00:00, 6175.91probe position/s]Normalizing amplitudes:  87%|████████▋ | 14239/16384 [00:02<00:00, 5005.17probe position/s]Normalizing amplitudes:  90%|█████████ | 14776/16384 [00:02<00:00, 4809.77probe position/s]Normalizing amplitudes:  94%|█████████▍| 15410/16384 [00:02<00:00, 5197.00probe position/s]Normalizing amplitudes:  98%|█████████▊| 16028/16384 [00:02<00:00, 5457.25probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5978.37probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random512_p12_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random512_p12_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.2718 in 24.852 sec
Iter: 2, Total Loss: 0.009531 in 24.008 sec
Iter: 3, Total Loss: 0.007376 in 24.403 sec
Iter: 4, Total Loss: 0.006764 in 24.112 sec
Iter: 5, Total Loss: 0.006491 in 24.388 sec
Iter: 6, Total Loss: 0.006326 in 24.386 sec
Iter: 7, Total Loss: 0.006211 in 24.911 sec
Iter: 8, Total Loss: 0.006124 in 24.464 sec
Iter: 9, Total Loss: 0.006056 in 24.402 sec
Iter: 10, Total Loss: 0.006001 in 25.095 sec
Iter: 11, Total Loss: 0.005954 in 24.289 sec
Iter: 12, Total Loss: 0.005912 in 24.280 sec
Iter: 13, Total Loss: 0.005875 in 24.261 sec
Iter: 14, Total Loss: 0.005842 in 24.245 sec
Iter: 15, Total Loss: 0.005811 in 24.361 sec
Iter: 16, Total Loss: 0.005782 in 25.401 sec
Iter: 17, Total Loss: 0.005755 in 24.548 sec
Iter: 18, Total Loss: 0.005729 in 24.457 sec
Iter: 19, Total Loss: 0.005706 in 24.524 sec
Iter: 20, Total Loss: 0.005683 in 24.580 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 24.498 with std = 0.327 sec ###
### py4DSTEM ptycho solver is finished in 8 min 12.407 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 900.18 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 256, 1, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 608/16384 [00:00<00:02, 6075.99probe position/s]Normalizing amplitudes:   7%|▋         | 1216/16384 [00:00<00:02, 5762.22probe position/s]Normalizing amplitudes:  11%|█         | 1794/16384 [00:00<00:02, 5537.56probe position/s]Normalizing amplitudes:  15%|█▍        | 2431/16384 [00:00<00:02, 5850.31probe position/s]Normalizing amplitudes:  19%|█▉        | 3080/16384 [00:00<00:02, 6073.83probe position/s]Normalizing amplitudes:  23%|██▎       | 3690/16384 [00:00<00:02, 5956.91probe position/s]Normalizing amplitudes:  27%|██▋       | 4363/16384 [00:00<00:01, 6201.25probe position/s]Normalizing amplitudes:  30%|███       | 4985/16384 [00:00<00:01, 5965.60probe position/s]Normalizing amplitudes:  34%|███▍      | 5585/16384 [00:00<00:01, 5945.39probe position/s]Normalizing amplitudes:  38%|███▊      | 6246/16384 [00:01<00:01, 6140.73probe position/s]Normalizing amplitudes:  42%|████▏     | 6862/16384 [00:01<00:01, 6134.29probe position/s]Normalizing amplitudes:  46%|████▌     | 7477/16384 [00:01<00:01, 6125.31probe position/s]Normalizing amplitudes:  49%|████▉     | 8091/16384 [00:01<00:01, 5883.48probe position/s]Normalizing amplitudes:  53%|█████▎    | 8689/16384 [00:01<00:01, 5910.73probe position/s]Normalizing amplitudes:  57%|█████▋    | 9384/16384 [00:01<00:01, 6215.06probe position/s]Normalizing amplitudes:  61%|██████    | 10018/16384 [00:01<00:01, 6249.73probe position/s]Normalizing amplitudes:  65%|██████▍   | 10645/16384 [00:01<00:00, 5943.13probe position/s]Normalizing amplitudes:  69%|██████▉   | 11265/16384 [00:01<00:00, 6016.07probe position/s]Normalizing amplitudes:  72%|███████▏  | 11870/16384 [00:01<00:00, 5941.04probe position/s]Normalizing amplitudes:  76%|███████▌  | 12467/16384 [00:02<00:00, 5870.88probe position/s]Normalizing amplitudes:  80%|████████  | 13138/16384 [00:02<00:00, 6112.72probe position/s]Normalizing amplitudes:  84%|████████▍ | 13772/16384 [00:02<00:00, 6177.91probe position/s]Normalizing amplitudes:  88%|████████▊ | 14408/16384 [00:02<00:00, 6229.56probe position/s]Normalizing amplitudes:  92%|█████████▏| 15062/16384 [00:02<00:00, 6319.13probe position/s]Normalizing amplitudes:  96%|█████████▌| 15726/16384 [00:02<00:00, 6412.83probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6107.40probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random256_p1_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random256_p1_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.01046 in 0.895 sec
Iter: 2, Total Loss: 0.00651 in 0.836 sec
Iter: 3, Total Loss: 0.006487 in 0.798 sec
Iter: 4, Total Loss: 0.006475 in 0.819 sec
Iter: 5, Total Loss: 0.006466 in 0.828 sec
Iter: 6, Total Loss: 0.006459 in 0.806 sec
Iter: 7, Total Loss: 0.006452 in 0.794 sec
Iter: 8, Total Loss: 0.006446 in 0.872 sec
Iter: 9, Total Loss: 0.006439 in 0.807 sec
Iter: 10, Total Loss: 0.006432 in 0.797 sec
Iter: 11, Total Loss: 0.006425 in 0.803 sec
Iter: 12, Total Loss: 0.006418 in 0.793 sec
Iter: 13, Total Loss: 0.006411 in 0.790 sec
Iter: 14, Total Loss: 0.006403 in 0.815 sec
Iter: 15, Total Loss: 0.006396 in 0.830 sec
Iter: 16, Total Loss: 0.006388 in 0.799 sec
Iter: 17, Total Loss: 0.00638 in 0.824 sec
Iter: 18, Total Loss: 0.006372 in 0.778 sec
Iter: 19, Total Loss: 0.006364 in 0.776 sec
Iter: 20, Total Loss: 0.006356 in 0.849 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 0.815 with std = 0.029 sec ###
### py4DSTEM ptycho solver is finished in 18.531 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 912.48 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 256, 1, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 603/16384 [00:00<00:02, 6022.22probe position/s]Normalizing amplitudes:   7%|▋         | 1206/16384 [00:00<00:02, 5770.12probe position/s]Normalizing amplitudes:  11%|█         | 1784/16384 [00:00<00:02, 5585.59probe position/s]Normalizing amplitudes:  15%|█▍        | 2415/16384 [00:00<00:02, 5861.62probe position/s]Normalizing amplitudes:  19%|█▊        | 3053/16384 [00:00<00:02, 6043.20probe position/s]Normalizing amplitudes:  22%|██▏       | 3659/16384 [00:00<00:02, 5966.37probe position/s]Normalizing amplitudes:  26%|██▌       | 4257/16384 [00:00<00:02, 5948.82probe position/s]Normalizing amplitudes:  30%|██▉       | 4899/16384 [00:00<00:01, 6094.31probe position/s]Normalizing amplitudes:  34%|███▍      | 5577/16384 [00:00<00:01, 6303.54probe position/s]Normalizing amplitudes:  39%|███▊      | 6313/16384 [00:01<00:01, 6626.11probe position/s]Normalizing amplitudes:  43%|████▎     | 6977/16384 [00:01<00:01, 6618.90probe position/s]Normalizing amplitudes:  47%|████▋     | 7640/16384 [00:01<00:01, 6494.50probe position/s]Normalizing amplitudes:  51%|█████     | 8291/16384 [00:01<00:01, 6486.55probe position/s]Normalizing amplitudes:  55%|█████▍    | 8941/16384 [00:01<00:01, 6291.09probe position/s]Normalizing amplitudes:  58%|█████▊    | 9572/16384 [00:01<00:01, 6016.01probe position/s]Normalizing amplitudes:  62%|██████▏   | 10177/16384 [00:01<00:01, 5831.68probe position/s]Normalizing amplitudes:  66%|██████▌   | 10763/16384 [00:01<00:00, 5803.42probe position/s]Normalizing amplitudes:  69%|██████▉   | 11345/16384 [00:01<00:00, 5656.33probe position/s]Normalizing amplitudes:  73%|███████▎  | 11975/16384 [00:01<00:00, 5838.48probe position/s]Normalizing amplitudes:  77%|███████▋  | 12574/16384 [00:02<00:00, 5880.22probe position/s]Normalizing amplitudes:  80%|████████  | 13164/16384 [00:02<00:00, 5864.89probe position/s]Normalizing amplitudes:  84%|████████▍ | 13752/16384 [00:02<00:00, 5821.76probe position/s]Normalizing amplitudes:  87%|████████▋ | 14335/16384 [00:02<00:00, 5753.32probe position/s]Normalizing amplitudes:  91%|█████████ | 14911/16384 [00:02<00:00, 5631.74probe position/s]Normalizing amplitudes:  94%|█████████▍| 15475/16384 [00:02<00:00, 5504.31probe position/s]Normalizing amplitudes:  98%|█████████▊| 16057/16384 [00:02<00:00, 5593.39probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5951.93probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random256_p1_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random256_p1_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.01065 in 1.827 sec
Iter: 2, Total Loss: 0.006514 in 1.825 sec
Iter: 3, Total Loss: 0.006493 in 1.742 sec
Iter: 4, Total Loss: 0.006481 in 1.800 sec
Iter: 5, Total Loss: 0.00647 in 2.050 sec
Iter: 6, Total Loss: 0.00646 in 2.035 sec
Iter: 7, Total Loss: 0.006448 in 1.726 sec
Iter: 8, Total Loss: 0.006439 in 1.838 sec
Iter: 9, Total Loss: 0.006428 in 1.856 sec
Iter: 10, Total Loss: 0.006418 in 1.801 sec
Iter: 11, Total Loss: 0.006409 in 1.794 sec
Iter: 12, Total Loss: 0.006399 in 1.726 sec
Iter: 13, Total Loss: 0.006389 in 1.704 sec
Iter: 14, Total Loss: 0.006378 in 1.749 sec
Iter: 15, Total Loss: 0.006369 in 1.709 sec
Iter: 16, Total Loss: 0.00636 in 1.748 sec
Iter: 17, Total Loss: 0.006351 in 1.728 sec
Iter: 18, Total Loss: 0.006341 in 1.829 sec
Iter: 19, Total Loss: 0.006332 in 1.786 sec
Iter: 20, Total Loss: 0.006322 in 1.795 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 1.803 with std = 0.091 sec ###
### py4DSTEM ptycho solver is finished in 38.583 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 906.60 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 256, 1, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 655/16384 [00:00<00:02, 6546.26probe position/s]Normalizing amplitudes:   8%|▊         | 1310/16384 [00:00<00:02, 6547.09probe position/s]Normalizing amplitudes:  12%|█▏        | 1965/16384 [00:00<00:02, 6166.92probe position/s]Normalizing amplitudes:  16%|█▌        | 2585/16384 [00:00<00:02, 5886.55probe position/s]Normalizing amplitudes:  20%|█▉        | 3201/16384 [00:00<00:02, 5977.88probe position/s]Normalizing amplitudes:  23%|██▎       | 3829/16384 [00:00<00:02, 6076.02probe position/s]Normalizing amplitudes:  27%|██▋       | 4450/16384 [00:00<00:01, 6118.65probe position/s]Normalizing amplitudes:  31%|███       | 5065/16384 [00:00<00:01, 6126.48probe position/s]Normalizing amplitudes:  35%|███▍      | 5724/16384 [00:00<00:01, 6268.15probe position/s]Normalizing amplitudes:  39%|███▉      | 6352/16384 [00:01<00:01, 6083.38probe position/s]Normalizing amplitudes:  42%|████▏     | 6962/16384 [00:01<00:01, 5903.96probe position/s]Normalizing amplitudes:  46%|████▌     | 7555/16384 [00:01<00:01, 5846.30probe position/s]Normalizing amplitudes:  50%|████▉     | 8173/16384 [00:01<00:01, 5941.80probe position/s]Normalizing amplitudes:  54%|█████▎    | 8791/16384 [00:01<00:01, 6011.14probe position/s]Normalizing amplitudes:  57%|█████▋    | 9394/16384 [00:01<00:01, 6013.47probe position/s]Normalizing amplitudes:  61%|██████▏   | 10039/16384 [00:01<00:01, 6141.77probe position/s]Normalizing amplitudes:  65%|██████▌   | 10654/16384 [00:01<00:00, 6029.51probe position/s]Normalizing amplitudes:  69%|██████▊   | 11258/16384 [00:01<00:00, 5883.32probe position/s]Normalizing amplitudes:  72%|███████▏  | 11848/16384 [00:01<00:00, 5752.24probe position/s]Normalizing amplitudes:  76%|███████▌  | 12425/16384 [00:02<00:00, 5715.36probe position/s]Normalizing amplitudes:  80%|███████▉  | 13031/16384 [00:02<00:00, 5814.19probe position/s]Normalizing amplitudes:  83%|████████▎ | 13648/16384 [00:02<00:00, 5916.30probe position/s]Normalizing amplitudes:  87%|████████▋ | 14291/16384 [00:02<00:00, 6066.40probe position/s]Normalizing amplitudes:  91%|█████████ | 14904/16384 [00:02<00:00, 6083.35probe position/s]Normalizing amplitudes:  95%|█████████▍| 15513/16384 [00:02<00:00, 5970.02probe position/s]Normalizing amplitudes:  98%|█████████▊| 16111/16384 [00:02<00:00, 5559.18probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5912.89probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random256_p1_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random256_p1_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.01088 in 3.133 sec
Iter: 2, Total Loss: 0.006561 in 3.073 sec
Iter: 3, Total Loss: 0.006535 in 3.171 sec
Iter: 4, Total Loss: 0.006515 in 3.236 sec
Iter: 5, Total Loss: 0.0065 in 3.217 sec
Iter: 6, Total Loss: 0.006481 in 3.199 sec
Iter: 7, Total Loss: 0.006466 in 3.044 sec
Iter: 8, Total Loss: 0.006453 in 3.156 sec
Iter: 9, Total Loss: 0.006437 in 3.256 sec
Iter: 10, Total Loss: 0.006426 in 3.118 sec
Iter: 11, Total Loss: 0.006412 in 3.106 sec
Iter: 12, Total Loss: 0.006399 in 3.137 sec
Iter: 13, Total Loss: 0.006387 in 3.146 sec
Iter: 14, Total Loss: 0.006375 in 3.133 sec
Iter: 15, Total Loss: 0.006362 in 3.125 sec
Iter: 16, Total Loss: 0.006348 in 3.069 sec
Iter: 17, Total Loss: 0.006337 in 3.098 sec
Iter: 18, Total Loss: 0.006325 in 3.074 sec
Iter: 19, Total Loss: 0.006313 in 3.189 sec
Iter: 20, Total Loss: 0.006302 in 3.383 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 3.153 with std = 0.077 sec ###
### py4DSTEM ptycho solver is finished in 1 min 5.793 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 903.85 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 256, 3, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 582/16384 [00:00<00:02, 5810.86probe position/s]Normalizing amplitudes:   7%|▋         | 1182/16384 [00:00<00:02, 5915.39probe position/s]Normalizing amplitudes:  11%|█         | 1774/16384 [00:00<00:02, 5719.70probe position/s]Normalizing amplitudes:  15%|█▍        | 2391/16384 [00:00<00:02, 5893.09probe position/s]Normalizing amplitudes:  18%|█▊        | 2982/16384 [00:00<00:02, 5657.00probe position/s]Normalizing amplitudes:  22%|██▏       | 3550/16384 [00:00<00:02, 5469.36probe position/s]Normalizing amplitudes:  25%|██▌       | 4107/16384 [00:00<00:02, 5498.03probe position/s]Normalizing amplitudes:  29%|██▊       | 4709/16384 [00:00<00:02, 5657.04probe position/s]Normalizing amplitudes:  33%|███▎      | 5367/16384 [00:00<00:01, 5937.80probe position/s]Normalizing amplitudes:  36%|███▋      | 5963/16384 [00:01<00:01, 5838.74probe position/s]Normalizing amplitudes:  40%|███▉      | 6549/16384 [00:01<00:01, 5579.87probe position/s]Normalizing amplitudes:  44%|████▎     | 7131/16384 [00:01<00:01, 5647.51probe position/s]Normalizing amplitudes:  47%|████▋     | 7717/16384 [00:01<00:01, 5709.10probe position/s]Normalizing amplitudes:  51%|█████     | 8290/16384 [00:01<00:01, 4534.75probe position/s]Normalizing amplitudes:  54%|█████▍    | 8920/16384 [00:01<00:01, 4976.56probe position/s]Normalizing amplitudes:  58%|█████▊    | 9584/16384 [00:01<00:01, 5413.54probe position/s]Normalizing amplitudes:  62%|██████▏   | 10212/16384 [00:01<00:01, 5648.69probe position/s]Normalizing amplitudes:  66%|██████▌   | 10801/16384 [00:02<00:01, 4836.01probe position/s]Normalizing amplitudes:  70%|██████▉   | 11387/16384 [00:02<00:00, 5095.24probe position/s]Normalizing amplitudes:  73%|███████▎  | 12016/16384 [00:02<00:00, 5412.36probe position/s]Normalizing amplitudes:  77%|███████▋  | 12623/16384 [00:02<00:00, 5588.63probe position/s]Normalizing amplitudes:  81%|████████  | 13201/16384 [00:02<00:00, 5525.02probe position/s]Normalizing amplitudes:  84%|████████▍ | 13767/16384 [00:02<00:00, 4648.94probe position/s]Normalizing amplitudes:  87%|████████▋ | 14264/16384 [00:02<00:00, 4626.22probe position/s]Normalizing amplitudes:  91%|█████████ | 14856/16384 [00:02<00:00, 4960.18probe position/s]Normalizing amplitudes:  94%|█████████▍| 15373/16384 [00:02<00:00, 4974.84probe position/s]Normalizing amplitudes:  97%|█████████▋| 15910/16384 [00:02<00:00, 5083.32probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:03<00:00, 5316.98probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random256_p3_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random256_p3_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.02263 in 1.848 sec
Iter: 2, Total Loss: 0.00651 in 1.775 sec
Iter: 3, Total Loss: 0.006423 in 1.788 sec
Iter: 4, Total Loss: 0.006381 in 1.663 sec
Iter: 5, Total Loss: 0.006353 in 1.718 sec
Iter: 6, Total Loss: 0.006326 in 1.815 sec
Iter: 7, Total Loss: 0.006299 in 1.749 sec
Iter: 8, Total Loss: 0.006271 in 1.775 sec
Iter: 9, Total Loss: 0.006243 in 1.728 sec
Iter: 10, Total Loss: 0.006215 in 1.741 sec
Iter: 11, Total Loss: 0.006185 in 1.709 sec
Iter: 12, Total Loss: 0.006159 in 1.696 sec
Iter: 13, Total Loss: 0.006129 in 1.747 sec
Iter: 14, Total Loss: 0.006104 in 1.731 sec
Iter: 15, Total Loss: 0.006074 in 1.700 sec
Iter: 16, Total Loss: 0.00605 in 1.703 sec
Iter: 17, Total Loss: 0.006023 in 1.731 sec
Iter: 18, Total Loss: 0.006 in 1.692 sec
Iter: 19, Total Loss: 0.005974 in 1.704 sec
Iter: 20, Total Loss: 0.005952 in 1.694 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 1.735 with std = 0.045 sec ###
### py4DSTEM ptycho solver is finished in 37.468 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 899.24 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 256, 3, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 564/16384 [00:00<00:02, 5638.24probe position/s]Normalizing amplitudes:   7%|▋         | 1148/16384 [00:00<00:02, 5756.40probe position/s]Normalizing amplitudes:  11%|█         | 1742/16384 [00:00<00:02, 5837.14probe position/s]Normalizing amplitudes:  14%|█▍        | 2360/16384 [00:00<00:02, 5970.22probe position/s]Normalizing amplitudes:  18%|█▊        | 2974/16384 [00:00<00:02, 6030.83probe position/s]Normalizing amplitudes:  22%|██▏       | 3595/16384 [00:00<00:02, 6090.67probe position/s]Normalizing amplitudes:  26%|██▌       | 4228/16384 [00:00<00:01, 6166.98probe position/s]Normalizing amplitudes:  30%|██▉       | 4845/16384 [00:00<00:01, 6091.60probe position/s]Normalizing amplitudes:  33%|███▎      | 5455/16384 [00:00<00:01, 5945.56probe position/s]Normalizing amplitudes:  37%|███▋      | 6057/16384 [00:01<00:01, 5966.79probe position/s]Normalizing amplitudes:  41%|████      | 6655/16384 [00:01<00:01, 5890.12probe position/s]Normalizing amplitudes:  44%|████▍     | 7266/16384 [00:01<00:01, 5953.13probe position/s]Normalizing amplitudes:  48%|████▊     | 7891/16384 [00:01<00:01, 6035.60probe position/s]Normalizing amplitudes:  52%|█████▏    | 8495/16384 [00:01<00:01, 5797.77probe position/s]Normalizing amplitudes:  56%|█████▌    | 9101/16384 [00:01<00:01, 5870.91probe position/s]Normalizing amplitudes:  59%|█████▉    | 9695/16384 [00:01<00:01, 5890.55probe position/s]Normalizing amplitudes:  63%|██████▎   | 10319/16384 [00:01<00:01, 5993.33probe position/s]Normalizing amplitudes:  67%|██████▋   | 10935/16384 [00:01<00:00, 6040.34probe position/s]Normalizing amplitudes:  70%|███████   | 11549/16384 [00:01<00:00, 6068.69probe position/s]Normalizing amplitudes:  74%|███████▍  | 12177/16384 [00:02<00:00, 6130.71probe position/s]Normalizing amplitudes:  78%|███████▊  | 12798/16384 [00:02<00:00, 6152.37probe position/s]Normalizing amplitudes:  82%|████████▏ | 13414/16384 [00:02<00:00, 6149.70probe position/s]Normalizing amplitudes:  86%|████████▌ | 14043/16384 [00:02<00:00, 6190.02probe position/s]Normalizing amplitudes:  89%|████████▉ | 14663/16384 [00:02<00:00, 6104.95probe position/s]Normalizing amplitudes:  93%|█████████▎| 15277/16384 [00:02<00:00, 6113.19probe position/s]Normalizing amplitudes:  97%|█████████▋| 15892/16384 [00:02<00:00, 6122.84probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6022.38probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random256_p3_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random256_p3_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.02305 in 4.437 sec
Iter: 2, Total Loss: 0.006491 in 4.336 sec
Iter: 3, Total Loss: 0.006345 in 4.330 sec
Iter: 4, Total Loss: 0.006277 in 4.289 sec
Iter: 5, Total Loss: 0.00622 in 4.310 sec
Iter: 6, Total Loss: 0.006166 in 4.279 sec
Iter: 7, Total Loss: 0.006118 in 4.393 sec
Iter: 8, Total Loss: 0.006073 in 4.402 sec
Iter: 9, Total Loss: 0.00603 in 4.536 sec
Iter: 10, Total Loss: 0.005991 in 4.340 sec
Iter: 11, Total Loss: 0.005952 in 4.398 sec
Iter: 12, Total Loss: 0.005916 in 4.781 sec
Iter: 13, Total Loss: 0.00588 in 4.571 sec
Iter: 14, Total Loss: 0.005846 in 4.504 sec
Iter: 15, Total Loss: 0.005814 in 4.401 sec
Iter: 16, Total Loss: 0.005783 in 4.410 sec
Iter: 17, Total Loss: 0.005754 in 4.360 sec
Iter: 18, Total Loss: 0.005727 in 4.398 sec
Iter: 19, Total Loss: 0.0057 in 4.362 sec
Iter: 20, Total Loss: 0.005675 in 4.361 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 4.410 with std = 0.113 sec ###
### py4DSTEM ptycho solver is finished in 1 min 30.985 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 899.29 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 256, 3, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 587/16384 [00:00<00:02, 5860.87probe position/s]Normalizing amplitudes:   7%|▋         | 1174/16384 [00:00<00:02, 5786.16probe position/s]Normalizing amplitudes:  11%|█         | 1753/16384 [00:00<00:02, 5582.98probe position/s]Normalizing amplitudes:  14%|█▍        | 2313/16384 [00:00<00:02, 5085.76probe position/s]Normalizing amplitudes:  17%|█▋        | 2854/16384 [00:00<00:02, 5192.18probe position/s]Normalizing amplitudes:  21%|██        | 3416/16384 [00:00<00:02, 5326.88probe position/s]Normalizing amplitudes:  25%|██▍       | 4032/16384 [00:00<00:02, 5587.41probe position/s]Normalizing amplitudes:  28%|██▊       | 4639/16384 [00:00<00:02, 5735.32probe position/s]Normalizing amplitudes:  32%|███▏      | 5216/16384 [00:00<00:01, 5720.74probe position/s]Normalizing amplitudes:  35%|███▌      | 5807/16384 [00:01<00:01, 5775.50probe position/s]Normalizing amplitudes:  39%|███▉      | 6397/16384 [00:01<00:01, 5810.51probe position/s]Normalizing amplitudes:  43%|████▎     | 6980/16384 [00:01<00:01, 5647.76probe position/s]Normalizing amplitudes:  46%|████▌     | 7569/16384 [00:01<00:01, 5716.81probe position/s]Normalizing amplitudes:  50%|████▉     | 8167/16384 [00:01<00:01, 5794.72probe position/s]Normalizing amplitudes:  53%|█████▎    | 8748/16384 [00:01<00:01, 5791.41probe position/s]Normalizing amplitudes:  57%|█████▋    | 9328/16384 [00:01<00:01, 5679.85probe position/s]Normalizing amplitudes:  61%|██████    | 9945/16384 [00:01<00:01, 5822.69probe position/s]Normalizing amplitudes:  64%|██████▍   | 10536/16384 [00:01<00:01, 5847.72probe position/s]Normalizing amplitudes:  68%|██████▊   | 11122/16384 [00:01<00:00, 5705.84probe position/s]Normalizing amplitudes:  71%|███████▏  | 11714/16384 [00:02<00:00, 5767.07probe position/s]Normalizing amplitudes:  75%|███████▌  | 12292/16384 [00:02<00:00, 5735.45probe position/s]Normalizing amplitudes:  79%|███████▊  | 12867/16384 [00:02<00:00, 5684.98probe position/s]Normalizing amplitudes:  82%|████████▏ | 13472/16384 [00:02<00:00, 5790.91probe position/s]Normalizing amplitudes:  86%|████████▌ | 14073/16384 [00:02<00:00, 5854.71probe position/s]Normalizing amplitudes:  89%|████████▉ | 14659/16384 [00:02<00:00, 5729.85probe position/s]Normalizing amplitudes:  93%|█████████▎| 15233/16384 [00:02<00:00, 5628.50probe position/s]Normalizing amplitudes:  97%|█████████▋| 15819/16384 [00:02<00:00, 5695.74probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5700.90probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random256_p3_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random256_p3_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.02484 in 8.395 sec
Iter: 2, Total Loss: 0.006588 in 8.289 sec
Iter: 3, Total Loss: 0.006315 in 8.297 sec
Iter: 4, Total Loss: 0.006224 in 8.301 sec
Iter: 5, Total Loss: 0.006161 in 8.201 sec
Iter: 6, Total Loss: 0.006109 in 8.513 sec
Iter: 7, Total Loss: 0.006062 in 8.428 sec
Iter: 8, Total Loss: 0.006018 in 8.493 sec
Iter: 9, Total Loss: 0.005975 in 8.366 sec
Iter: 10, Total Loss: 0.005937 in 8.319 sec
Iter: 11, Total Loss: 0.005898 in 8.230 sec
Iter: 12, Total Loss: 0.005862 in 8.191 sec
Iter: 13, Total Loss: 0.005827 in 8.188 sec
Iter: 14, Total Loss: 0.005796 in 8.199 sec
Iter: 15, Total Loss: 0.005763 in 8.168 sec
Iter: 16, Total Loss: 0.005733 in 8.210 sec
Iter: 17, Total Loss: 0.005705 in 8.201 sec
Iter: 18, Total Loss: 0.005679 in 8.315 sec
Iter: 19, Total Loss: 0.005652 in 8.157 sec
Iter: 20, Total Loss: 0.005627 in 8.174 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 8.282 with std = 0.107 sec ###
### py4DSTEM ptycho solver is finished in 2 min 48.253 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 901.42 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 256, 6, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 556/16384 [00:00<00:02, 5553.27probe position/s]Normalizing amplitudes:   7%|▋         | 1176/16384 [00:00<00:02, 5930.29probe position/s]Normalizing amplitudes:  12%|█▏        | 1900/16384 [00:00<00:02, 6516.18probe position/s]Normalizing amplitudes:  16%|█▌        | 2552/16384 [00:00<00:02, 6349.79probe position/s]Normalizing amplitudes:  19%|█▉        | 3188/16384 [00:00<00:02, 6314.66probe position/s]Normalizing amplitudes:  23%|██▎       | 3820/16384 [00:00<00:02, 6216.47probe position/s]Normalizing amplitudes:  27%|██▋       | 4443/16384 [00:00<00:01, 6005.38probe position/s]Normalizing amplitudes:  31%|███       | 5115/16384 [00:00<00:01, 6223.94probe position/s]Normalizing amplitudes:  35%|███▌      | 5740/16384 [00:00<00:01, 6157.03probe position/s]Normalizing amplitudes:  39%|███▉      | 6357/16384 [00:01<00:01, 6021.72probe position/s]Normalizing amplitudes:  42%|████▏     | 6963/16384 [00:01<00:01, 6032.50probe position/s]Normalizing amplitudes:  46%|████▋     | 7601/16384 [00:01<00:01, 6135.32probe position/s]Normalizing amplitudes:  50%|█████     | 8222/16384 [00:01<00:01, 6156.71probe position/s]Normalizing amplitudes:  54%|█████▍    | 8906/16384 [00:01<00:01, 6358.88probe position/s]Normalizing amplitudes:  58%|█████▊    | 9549/16384 [00:01<00:01, 6379.04probe position/s]Normalizing amplitudes:  62%|██████▏   | 10188/16384 [00:01<00:01, 6008.34probe position/s]Normalizing amplitudes:  66%|██████▌   | 10794/16384 [00:01<00:00, 5990.95probe position/s]Normalizing amplitudes:  70%|██████▉   | 11397/16384 [00:01<00:00, 5821.57probe position/s]Normalizing amplitudes:  73%|███████▎  | 11982/16384 [00:01<00:00, 5548.32probe position/s]Normalizing amplitudes:  77%|███████▋  | 12597/16384 [00:02<00:00, 5715.75probe position/s]Normalizing amplitudes:  81%|████████  | 13193/16384 [00:02<00:00, 5783.84probe position/s]Normalizing amplitudes:  84%|████████▍ | 13821/16384 [00:02<00:00, 5924.92probe position/s]Normalizing amplitudes:  88%|████████▊ | 14433/16384 [00:02<00:00, 5981.10probe position/s]Normalizing amplitudes:  92%|█████████▏| 15034/16384 [00:02<00:00, 5884.72probe position/s]Normalizing amplitudes:  96%|█████████▌| 15664/16384 [00:02<00:00, 6004.16probe position/s]Normalizing amplitudes:  99%|█████████▉| 16301/16384 [00:02<00:00, 6110.08probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6046.56probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random256_p6_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random256_p6_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.05737 in 3.305 sec
Iter: 2, Total Loss: 0.006612 in 3.023 sec
Iter: 3, Total Loss: 0.006442 in 2.924 sec
Iter: 4, Total Loss: 0.006364 in 2.911 sec
Iter: 5, Total Loss: 0.006312 in 3.072 sec
Iter: 6, Total Loss: 0.00627 in 3.063 sec
Iter: 7, Total Loss: 0.006231 in 2.833 sec
Iter: 8, Total Loss: 0.006195 in 3.031 sec
Iter: 9, Total Loss: 0.006159 in 3.011 sec
Iter: 10, Total Loss: 0.006127 in 3.288 sec
Iter: 11, Total Loss: 0.006092 in 3.419 sec
Iter: 12, Total Loss: 0.00606 in 2.852 sec
Iter: 13, Total Loss: 0.006026 in 2.820 sec
Iter: 14, Total Loss: 0.005995 in 2.801 sec
Iter: 15, Total Loss: 0.005963 in 2.891 sec
Iter: 16, Total Loss: 0.005933 in 2.960 sec
Iter: 17, Total Loss: 0.005902 in 2.896 sec
Iter: 18, Total Loss: 0.005872 in 3.082 sec
Iter: 19, Total Loss: 0.005844 in 2.897 sec
Iter: 20, Total Loss: 0.005816 in 2.946 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 3.001 with std = 0.165 sec ###
### py4DSTEM ptycho solver is finished in 1 min 2.515 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 907.80 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 256, 6, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 611/16384 [00:00<00:02, 6104.88probe position/s]Normalizing amplitudes:   8%|▊         | 1232/16384 [00:00<00:02, 6166.49probe position/s]Normalizing amplitudes:  11%|█▏        | 1873/16384 [00:00<00:02, 6274.66probe position/s]Normalizing amplitudes:  15%|█▌        | 2505/16384 [00:00<00:02, 6289.25probe position/s]Normalizing amplitudes:  19%|█▉        | 3134/16384 [00:00<00:02, 6210.18probe position/s]Normalizing amplitudes:  23%|██▎       | 3756/16384 [00:00<00:02, 6152.40probe position/s]Normalizing amplitudes:  27%|██▋       | 4388/16384 [00:00<00:01, 6205.80probe position/s]Normalizing amplitudes:  31%|███       | 5023/16384 [00:00<00:01, 6249.86probe position/s]Normalizing amplitudes:  34%|███▍      | 5649/16384 [00:00<00:01, 6162.56probe position/s]Normalizing amplitudes:  38%|███▊      | 6282/16384 [00:01<00:01, 6207.62probe position/s]Normalizing amplitudes:  42%|████▏     | 6904/16384 [00:01<00:01, 6143.96probe position/s]Normalizing amplitudes:  46%|████▌     | 7542/16384 [00:01<00:01, 6212.42probe position/s]Normalizing amplitudes:  50%|████▉     | 8172/16384 [00:01<00:01, 6232.32probe position/s]Normalizing amplitudes:  54%|█████▎    | 8801/16384 [00:01<00:01, 6249.45probe position/s]Normalizing amplitudes:  58%|█████▊    | 9427/16384 [00:01<00:01, 6139.62probe position/s]Normalizing amplitudes:  61%|██████▏   | 10046/16384 [00:01<00:01, 6150.46probe position/s]Normalizing amplitudes:  65%|██████▌   | 10669/16384 [00:01<00:00, 6172.17probe position/s]Normalizing amplitudes:  69%|██████▉   | 11287/16384 [00:01<00:00, 6001.94probe position/s]Normalizing amplitudes:  73%|███████▎  | 11904/16384 [00:01<00:00, 6048.23probe position/s]Normalizing amplitudes:  76%|███████▋  | 12521/16384 [00:02<00:00, 6083.39probe position/s]Normalizing amplitudes:  80%|████████  | 13131/16384 [00:02<00:00, 5974.67probe position/s]Normalizing amplitudes:  84%|████████▍ | 13769/16384 [00:02<00:00, 6090.52probe position/s]Normalizing amplitudes:  88%|████████▊ | 14393/16384 [00:02<00:00, 6133.96probe position/s]Normalizing amplitudes:  92%|█████████▏| 15043/16384 [00:02<00:00, 6241.49probe position/s]Normalizing amplitudes:  96%|█████████▌| 15668/16384 [00:02<00:00, 6195.84probe position/s]Normalizing amplitudes:  99%|█████████▉| 16295/16384 [00:02<00:00, 6215.47probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6155.38probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random256_p6_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random256_p6_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.05818 in 8.135 sec
Iter: 2, Total Loss: 0.006694 in 8.049 sec
Iter: 3, Total Loss: 0.006382 in 8.128 sec
Iter: 4, Total Loss: 0.006271 in 8.395 sec
Iter: 5, Total Loss: 0.006196 in 8.523 sec
Iter: 6, Total Loss: 0.006137 in 7.996 sec
Iter: 7, Total Loss: 0.006087 in 8.054 sec
Iter: 8, Total Loss: 0.00604 in 8.126 sec
Iter: 9, Total Loss: 0.005996 in 8.154 sec
Iter: 10, Total Loss: 0.005954 in 7.947 sec
Iter: 11, Total Loss: 0.005914 in 8.080 sec
Iter: 12, Total Loss: 0.005876 in 8.289 sec
Iter: 13, Total Loss: 0.005839 in 8.584 sec
Iter: 14, Total Loss: 0.005804 in 8.227 sec
Iter: 15, Total Loss: 0.005771 in 8.105 sec
Iter: 16, Total Loss: 0.00574 in 8.085 sec
Iter: 17, Total Loss: 0.005709 in 8.034 sec
Iter: 18, Total Loss: 0.005681 in 8.032 sec
Iter: 19, Total Loss: 0.005654 in 8.216 sec
Iter: 20, Total Loss: 0.005628 in 8.180 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 8.167 with std = 0.164 sec ###
### py4DSTEM ptycho solver is finished in 2 min 46.452 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 899.39 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 256, 6, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 592/16384 [00:00<00:02, 5914.01probe position/s]Normalizing amplitudes:   7%|▋         | 1186/16384 [00:00<00:02, 5925.01probe position/s]Normalizing amplitudes:  11%|█         | 1779/16384 [00:00<00:02, 5866.46probe position/s]Normalizing amplitudes:  15%|█▍        | 2406/16384 [00:00<00:02, 6021.56probe position/s]Normalizing amplitudes:  19%|█▊        | 3036/16384 [00:00<00:02, 6119.81probe position/s]Normalizing amplitudes:  22%|██▏       | 3649/16384 [00:00<00:02, 6049.04probe position/s]Normalizing amplitudes:  26%|██▌       | 4255/16384 [00:00<00:02, 5766.55probe position/s]Normalizing amplitudes:  30%|██▉       | 4835/16384 [00:00<00:02, 5689.25probe position/s]Normalizing amplitudes:  33%|███▎      | 5406/16384 [00:00<00:01, 5643.01probe position/s]Normalizing amplitudes:  36%|███▋      | 5972/16384 [00:01<00:01, 5596.29probe position/s]Normalizing amplitudes:  40%|████      | 6575/16384 [00:01<00:01, 5722.04probe position/s]Normalizing amplitudes:  44%|████▍     | 7186/16384 [00:01<00:01, 5835.08probe position/s]Normalizing amplitudes:  48%|████▊     | 7814/16384 [00:01<00:01, 5965.04probe position/s]Normalizing amplitudes:  51%|█████▏    | 8428/16384 [00:01<00:01, 6015.05probe position/s]Normalizing amplitudes:  55%|█████▌    | 9043/16384 [00:01<00:01, 6053.81probe position/s]Normalizing amplitudes:  59%|█████▉    | 9651/16384 [00:01<00:01, 6061.59probe position/s]Normalizing amplitudes:  63%|██████▎   | 10258/16384 [00:01<00:01, 6016.00probe position/s]Normalizing amplitudes:  66%|██████▋   | 10860/16384 [00:01<00:00, 5972.07probe position/s]Normalizing amplitudes:  70%|███████   | 11474/16384 [00:01<00:00, 6021.11probe position/s]Normalizing amplitudes:  74%|███████▍  | 12090/16384 [00:02<00:00, 6061.33probe position/s]Normalizing amplitudes:  77%|███████▋  | 12697/16384 [00:02<00:00, 6029.19probe position/s]Normalizing amplitudes:  81%|████████  | 13301/16384 [00:02<00:00, 6031.03probe position/s]Normalizing amplitudes:  85%|████████▍ | 13922/16384 [00:02<00:00, 6083.29probe position/s]Normalizing amplitudes:  89%|████████▊ | 14531/16384 [00:02<00:00, 5945.41probe position/s]Normalizing amplitudes:  92%|█████████▏| 15127/16384 [00:02<00:00, 5917.80probe position/s]Normalizing amplitudes:  96%|█████████▌| 15720/16384 [00:02<00:00, 5787.07probe position/s]Normalizing amplitudes: 100%|█████████▉| 16313/16384 [00:02<00:00, 5828.07probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5914.56probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random256_p6_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random256_p6_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.05975 in 16.224 sec
Iter: 2, Total Loss: 0.007091 in 16.275 sec
Iter: 3, Total Loss: 0.006403 in 15.706 sec
Iter: 4, Total Loss: 0.006229 in 15.872 sec
Iter: 5, Total Loss: 0.006133 in 16.390 sec
Iter: 6, Total Loss: 0.006062 in 15.731 sec
Iter: 7, Total Loss: 0.006004 in 15.552 sec
Iter: 8, Total Loss: 0.005952 in 15.438 sec
Iter: 9, Total Loss: 0.005907 in 15.622 sec
Iter: 10, Total Loss: 0.005864 in 15.679 sec
Iter: 11, Total Loss: 0.005824 in 15.813 sec
Iter: 12, Total Loss: 0.005787 in 16.336 sec
Iter: 13, Total Loss: 0.005751 in 15.514 sec
Iter: 14, Total Loss: 0.005716 in 15.501 sec
Iter: 15, Total Loss: 0.005684 in 15.446 sec
Iter: 16, Total Loss: 0.005653 in 15.585 sec
Iter: 17, Total Loss: 0.005623 in 15.314 sec
Iter: 18, Total Loss: 0.005593 in 15.608 sec
Iter: 19, Total Loss: 0.005566 in 15.650 sec
Iter: 20, Total Loss: 0.005539 in 15.501 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 15.738 with std = 0.312 sec ###
### py4DSTEM ptycho solver is finished in 5 min 17.266 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 905.75 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 256, 12, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 475/16384 [00:00<00:03, 4747.77probe position/s]Normalizing amplitudes:   7%|▋         | 1103/16384 [00:00<00:02, 5645.32probe position/s]Normalizing amplitudes:  10%|█         | 1698/16384 [00:00<00:02, 5782.41probe position/s]Normalizing amplitudes:  14%|█▍        | 2348/16384 [00:00<00:02, 6062.59probe position/s]Normalizing amplitudes:  18%|█▊        | 2986/16384 [00:00<00:02, 6176.41probe position/s]Normalizing amplitudes:  22%|██▏       | 3625/16384 [00:00<00:02, 6248.02probe position/s]Normalizing amplitudes:  26%|██▌       | 4250/16384 [00:00<00:01, 6211.80probe position/s]Normalizing amplitudes:  30%|██▉       | 4872/16384 [00:00<00:01, 6034.40probe position/s]Normalizing amplitudes:  33%|███▎      | 5477/16384 [00:00<00:01, 5989.44probe position/s]Normalizing amplitudes:  37%|███▋      | 6077/16384 [00:01<00:01, 5843.06probe position/s]Normalizing amplitudes:  41%|████      | 6663/16384 [00:01<00:01, 5593.49probe position/s]Normalizing amplitudes:  44%|████▍     | 7285/16384 [00:01<00:01, 5772.05probe position/s]Normalizing amplitudes:  48%|████▊     | 7921/16384 [00:01<00:01, 5941.55probe position/s]Normalizing amplitudes:  52%|█████▏    | 8564/16384 [00:01<00:01, 6083.29probe position/s]Normalizing amplitudes:  56%|█████▌    | 9191/16384 [00:01<00:01, 6136.18probe position/s]Normalizing amplitudes:  60%|█████▉    | 9824/16384 [00:01<00:01, 6192.34probe position/s]Normalizing amplitudes:  64%|██████▍   | 10465/16384 [00:01<00:00, 6255.57probe position/s]Normalizing amplitudes:  68%|██████▊   | 11104/16384 [00:01<00:00, 6295.40probe position/s]Normalizing amplitudes:  72%|███████▏  | 11735/16384 [00:01<00:00, 6255.22probe position/s]Normalizing amplitudes:  75%|███████▌  | 12362/16384 [00:02<00:00, 6188.02probe position/s]Normalizing amplitudes:  79%|███████▉  | 13006/16384 [00:02<00:00, 6259.57probe position/s]Normalizing amplitudes:  83%|████████▎ | 13633/16384 [00:02<00:00, 6134.80probe position/s]Normalizing amplitudes:  87%|████████▋ | 14251/16384 [00:02<00:00, 6145.53probe position/s]Normalizing amplitudes:  91%|█████████ | 14867/16384 [00:02<00:00, 6005.90probe position/s]Normalizing amplitudes:  95%|█████████▍| 15505/16384 [00:02<00:00, 6114.85probe position/s]Normalizing amplitudes:  99%|█████████▊| 16156/16384 [00:02<00:00, 6229.75probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6081.34probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random256_p12_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random256_p12_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.141 in 5.480 sec
Iter: 2, Total Loss: 0.006701 in 5.909 sec
Iter: 3, Total Loss: 0.006471 in 5.590 sec
Iter: 4, Total Loss: 0.006368 in 5.600 sec
Iter: 5, Total Loss: 0.006301 in 5.925 sec
Iter: 6, Total Loss: 0.006248 in 5.437 sec
Iter: 7, Total Loss: 0.006202 in 5.607 sec
Iter: 8, Total Loss: 0.006158 in 5.598 sec
Iter: 9, Total Loss: 0.006117 in 5.496 sec
Iter: 10, Total Loss: 0.006078 in 5.467 sec
Iter: 11, Total Loss: 0.006039 in 5.406 sec
Iter: 12, Total Loss: 0.006001 in 5.507 sec
Iter: 13, Total Loss: 0.005963 in 5.581 sec
Iter: 14, Total Loss: 0.005926 in 5.499 sec
Iter: 15, Total Loss: 0.005889 in 5.407 sec
Iter: 16, Total Loss: 0.005854 in 5.724 sec
Iter: 17, Total Loss: 0.005819 in 5.543 sec
Iter: 18, Total Loss: 0.005785 in 5.692 sec
Iter: 19, Total Loss: 0.005752 in 6.011 sec
Iter: 20, Total Loss: 0.005721 in 5.495 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 5.599 with std = 0.169 sec ###
### py4DSTEM ptycho solver is finished in 1 min 54.540 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 900.49 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 256, 12, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 532/16384 [00:00<00:02, 5311.77probe position/s]Normalizing amplitudes:   7%|▋         | 1122/16384 [00:00<00:02, 5653.70probe position/s]Normalizing amplitudes:  11%|█         | 1770/16384 [00:00<00:02, 6029.89probe position/s]Normalizing amplitudes:  14%|█▍        | 2374/16384 [00:00<00:02, 5718.59probe position/s]Normalizing amplitudes:  18%|█▊        | 3026/16384 [00:00<00:02, 5995.31probe position/s]Normalizing amplitudes:  22%|██▏       | 3628/16384 [00:00<00:02, 5885.51probe position/s]Normalizing amplitudes:  26%|██▌       | 4245/16384 [00:00<00:02, 5975.47probe position/s]Normalizing amplitudes:  30%|██▉       | 4861/16384 [00:00<00:01, 6028.03probe position/s]Normalizing amplitudes:  33%|███▎      | 5465/16384 [00:00<00:01, 5967.18probe position/s]Normalizing amplitudes:  37%|███▋      | 6063/16384 [00:01<00:01, 5913.37probe position/s]Normalizing amplitudes:  41%|████      | 6655/16384 [00:01<00:01, 5873.73probe position/s]Normalizing amplitudes:  44%|████▍     | 7261/16384 [00:01<00:01, 5927.82probe position/s]Normalizing amplitudes:  48%|████▊     | 7855/16384 [00:01<00:01, 5792.85probe position/s]Normalizing amplitudes:  51%|█████▏    | 8436/16384 [00:01<00:01, 5581.10probe position/s]Normalizing amplitudes:  55%|█████▌    | 9058/16384 [00:01<00:01, 5763.76probe position/s]Normalizing amplitudes:  59%|█████▉    | 9659/16384 [00:01<00:01, 5834.46probe position/s]Normalizing amplitudes:  63%|██████▎   | 10251/16384 [00:01<00:01, 5857.52probe position/s]Normalizing amplitudes:  66%|██████▋   | 10885/16384 [00:01<00:00, 5997.72probe position/s]Normalizing amplitudes:  70%|███████   | 11486/16384 [00:01<00:00, 5991.54probe position/s]Normalizing amplitudes:  74%|███████▍  | 12108/16384 [00:02<00:00, 6058.40probe position/s]Normalizing amplitudes:  78%|███████▊  | 12759/16384 [00:02<00:00, 6191.91probe position/s]Normalizing amplitudes:  82%|████████▏ | 13379/16384 [00:02<00:00, 6007.53probe position/s]Normalizing amplitudes:  85%|████████▌ | 13982/16384 [00:02<00:00, 5925.72probe position/s]Normalizing amplitudes:  89%|████████▉ | 14577/16384 [00:02<00:00, 5932.33probe position/s]Normalizing amplitudes:  93%|█████████▎| 15172/16384 [00:02<00:00, 5523.43probe position/s]Normalizing amplitudes:  96%|█████████▌| 15731/16384 [00:02<00:00, 5494.99probe position/s]Normalizing amplitudes: 100%|█████████▉| 16334/16384 [00:02<00:00, 5647.27probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5842.35probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random256_p12_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random256_p12_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.1417 in 15.804 sec
Iter: 2, Total Loss: 0.006893 in 15.715 sec
Iter: 3, Total Loss: 0.006454 in 15.763 sec
Iter: 4, Total Loss: 0.006316 in 15.817 sec
Iter: 5, Total Loss: 0.00623 in 15.864 sec
Iter: 6, Total Loss: 0.006163 in 15.885 sec
Iter: 7, Total Loss: 0.006106 in 15.818 sec
Iter: 8, Total Loss: 0.006055 in 15.902 sec
Iter: 9, Total Loss: 0.006007 in 16.739 sec
Iter: 10, Total Loss: 0.005961 in 15.509 sec
Iter: 11, Total Loss: 0.005918 in 15.623 sec
Iter: 12, Total Loss: 0.005875 in 15.713 sec
Iter: 13, Total Loss: 0.005833 in 15.672 sec
Iter: 14, Total Loss: 0.005792 in 15.800 sec
Iter: 15, Total Loss: 0.005753 in 15.647 sec
Iter: 16, Total Loss: 0.005715 in 15.629 sec
Iter: 17, Total Loss: 0.005677 in 15.821 sec
Iter: 18, Total Loss: 0.005641 in 15.473 sec
Iter: 19, Total Loss: 0.005606 in 15.494 sec
Iter: 20, Total Loss: 0.005572 in 15.427 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 15.756 with std = 0.265 sec ###
### py4DSTEM ptycho solver is finished in 5 min 18.324 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 905.79 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 256, 12, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 654/16384 [00:00<00:02, 6534.24probe position/s]Normalizing amplitudes:   8%|▊         | 1308/16384 [00:00<00:02, 6500.05probe position/s]Normalizing amplitudes:  12%|█▏        | 1959/16384 [00:00<00:02, 6381.17probe position/s]Normalizing amplitudes:  16%|█▌        | 2598/16384 [00:00<00:02, 6276.29probe position/s]Normalizing amplitudes:  20%|█▉        | 3226/16384 [00:00<00:02, 6266.03probe position/s]Normalizing amplitudes:  24%|██▎       | 3853/16384 [00:00<00:02, 6170.68probe position/s]Normalizing amplitudes:  27%|██▋       | 4485/16384 [00:00<00:01, 6216.34probe position/s]Normalizing amplitudes:  31%|███▏      | 5123/16384 [00:00<00:01, 6267.12probe position/s]Normalizing amplitudes:  35%|███▌      | 5772/16384 [00:00<00:01, 6334.19probe position/s]Normalizing amplitudes:  39%|███▉      | 6406/16384 [00:01<00:01, 6289.93probe position/s]Normalizing amplitudes:  43%|████▎     | 7036/16384 [00:01<00:01, 6279.05probe position/s]Normalizing amplitudes:  47%|████▋     | 7665/16384 [00:01<00:01, 6217.47probe position/s]Normalizing amplitudes:  51%|█████     | 8324/16384 [00:01<00:01, 6326.50probe position/s]Normalizing amplitudes:  55%|█████▍    | 8957/16384 [00:01<00:01, 6309.58probe position/s]Normalizing amplitudes:  59%|█████▊    | 9589/16384 [00:01<00:01, 6312.32probe position/s]Normalizing amplitudes:  62%|██████▏   | 10221/16384 [00:01<00:00, 6309.96probe position/s]Normalizing amplitudes:  66%|██████▋   | 10868/16384 [00:01<00:00, 6355.21probe position/s]Normalizing amplitudes:  71%|███████   | 11565/16384 [00:01<00:00, 6537.74probe position/s]Normalizing amplitudes:  75%|███████▍  | 12219/16384 [00:01<00:00, 6429.07probe position/s]Normalizing amplitudes:  79%|███████▊  | 12863/16384 [00:02<00:00, 6367.19probe position/s]Normalizing amplitudes:  82%|████████▏ | 13501/16384 [00:02<00:00, 6310.79probe position/s]Normalizing amplitudes:  86%|████████▋ | 14133/16384 [00:02<00:00, 6107.43probe position/s]Normalizing amplitudes:  90%|█████████ | 14746/16384 [00:02<00:00, 6022.58probe position/s]Normalizing amplitudes:  94%|█████████▎| 15350/16384 [00:02<00:00, 6026.63probe position/s]Normalizing amplitudes:  98%|█████████▊| 16014/16384 [00:02<00:00, 6205.17probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6270.16probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random256_p12_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random256_p12_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.1432 in 30.639 sec
Iter: 2, Total Loss: 0.007387 in 30.398 sec
Iter: 3, Total Loss: 0.006448 in 30.805 sec
Iter: 4, Total Loss: 0.006206 in 30.860 sec
Iter: 5, Total Loss: 0.006079 in 31.057 sec
Iter: 6, Total Loss: 0.005984 in 31.207 sec
Iter: 7, Total Loss: 0.005908 in 31.873 sec
Iter: 8, Total Loss: 0.005842 in 30.457 sec
Iter: 9, Total Loss: 0.005784 in 30.553 sec
Iter: 10, Total Loss: 0.00573 in 30.547 sec
Iter: 11, Total Loss: 0.005681 in 30.667 sec
Iter: 12, Total Loss: 0.005634 in 30.311 sec
Iter: 13, Total Loss: 0.00559 in 30.329 sec
Iter: 14, Total Loss: 0.00555 in 30.695 sec
Iter: 15, Total Loss: 0.005511 in 30.424 sec
Iter: 16, Total Loss: 0.005475 in 31.309 sec
Iter: 17, Total Loss: 0.00544 in 30.574 sec
Iter: 18, Total Loss: 0.005408 in 30.528 sec
Iter: 19, Total Loss: 0.005376 in 30.812 sec
Iter: 20, Total Loss: 0.005347 in 31.132 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 30.759 with std = 0.381 sec ###
### py4DSTEM ptycho solver is finished in 10 min 17.974 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 899.08 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 128, 1, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 626/16384 [00:00<00:02, 6253.36probe position/s]Normalizing amplitudes:   8%|▊         | 1261/16384 [00:00<00:02, 6308.12probe position/s]Normalizing amplitudes:  12%|█▏        | 1892/16384 [00:00<00:02, 5964.56probe position/s]Normalizing amplitudes:  15%|█▌        | 2491/16384 [00:00<00:02, 5836.11probe position/s]Normalizing amplitudes:  19%|█▉        | 3076/16384 [00:00<00:02, 5800.15probe position/s]Normalizing amplitudes:  22%|██▏       | 3657/16384 [00:00<00:02, 5708.58probe position/s]Normalizing amplitudes:  26%|██▋       | 4302/16384 [00:00<00:02, 5942.82probe position/s]Normalizing amplitudes:  30%|███       | 4923/16384 [00:00<00:01, 6023.68probe position/s]Normalizing amplitudes:  34%|███▎      | 5527/16384 [00:00<00:01, 5966.92probe position/s]Normalizing amplitudes:  37%|███▋      | 6125/16384 [00:01<00:01, 5852.78probe position/s]Normalizing amplitudes:  41%|████      | 6738/16384 [00:01<00:01, 5932.79probe position/s]Normalizing amplitudes:  45%|████▍     | 7339/16384 [00:01<00:01, 5955.66probe position/s]Normalizing amplitudes:  48%|████▊     | 7946/16384 [00:01<00:01, 5988.81probe position/s]Normalizing amplitudes:  52%|█████▏    | 8556/16384 [00:01<00:01, 6019.21probe position/s]Normalizing amplitudes:  56%|█████▌    | 9185/16384 [00:01<00:01, 6097.49probe position/s]Normalizing amplitudes:  60%|█████▉    | 9824/16384 [00:01<00:01, 6183.09probe position/s]Normalizing amplitudes:  64%|██████▎   | 10443/16384 [00:01<00:00, 6079.09probe position/s]Normalizing amplitudes:  68%|██████▊   | 11090/16384 [00:01<00:00, 6192.06probe position/s]Normalizing amplitudes:  71%|███████▏  | 11710/16384 [00:01<00:00, 6132.36probe position/s]Normalizing amplitudes:  75%|███████▌  | 12329/16384 [00:02<00:00, 6146.57probe position/s]Normalizing amplitudes:  79%|███████▉  | 12944/16384 [00:02<00:00, 6086.27probe position/s]Normalizing amplitudes:  83%|████████▎ | 13553/16384 [00:02<00:00, 6032.41probe position/s]Normalizing amplitudes:  86%|████████▋ | 14157/16384 [00:02<00:00, 5995.71probe position/s]Normalizing amplitudes:  90%|█████████ | 14817/16384 [00:02<00:00, 6173.40probe position/s]Normalizing amplitudes:  94%|█████████▍| 15439/16384 [00:02<00:00, 6186.41probe position/s]Normalizing amplitudes:  98%|█████████▊| 16075/16384 [00:02<00:00, 6237.74probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6050.54probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random128_p1_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random128_p1_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.008508 in 1.274 sec
Iter: 2, Total Loss: 0.006513 in 1.242 sec
Iter: 3, Total Loss: 0.00649 in 1.142 sec
Iter: 4, Total Loss: 0.006473 in 1.143 sec
Iter: 5, Total Loss: 0.006458 in 1.110 sec
Iter: 6, Total Loss: 0.006446 in 1.161 sec
Iter: 7, Total Loss: 0.006433 in 1.163 sec
Iter: 8, Total Loss: 0.006419 in 1.123 sec
Iter: 9, Total Loss: 0.006404 in 1.172 sec
Iter: 10, Total Loss: 0.00639 in 1.185 sec
Iter: 11, Total Loss: 0.006373 in 1.113 sec
Iter: 12, Total Loss: 0.006358 in 1.208 sec
Iter: 13, Total Loss: 0.006343 in 1.176 sec
Iter: 14, Total Loss: 0.006328 in 1.199 sec
Iter: 15, Total Loss: 0.006313 in 1.176 sec
Iter: 16, Total Loss: 0.006299 in 1.151 sec
Iter: 17, Total Loss: 0.006284 in 1.191 sec
Iter: 18, Total Loss: 0.006271 in 1.103 sec
Iter: 19, Total Loss: 0.006258 in 1.111 sec
Iter: 20, Total Loss: 0.006245 in 1.219 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 1.168 with std = 0.045 sec ###
### py4DSTEM ptycho solver is finished in 25.792 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 899.07 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 128, 1, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 592/16384 [00:00<00:02, 5911.73probe position/s]Normalizing amplitudes:   7%|▋         | 1213/16384 [00:00<00:02, 6083.49probe position/s]Normalizing amplitudes:  11%|█▏        | 1876/16384 [00:00<00:02, 6329.39probe position/s]Normalizing amplitudes:  15%|█▌        | 2509/16384 [00:00<00:02, 6022.08probe position/s]Normalizing amplitudes:  19%|█▉        | 3114/16384 [00:00<00:02, 5801.44probe position/s]Normalizing amplitudes:  23%|██▎       | 3697/16384 [00:00<00:02, 5678.70probe position/s]Normalizing amplitudes:  26%|██▋       | 4304/16384 [00:00<00:02, 5797.76probe position/s]Normalizing amplitudes:  30%|██▉       | 4911/16384 [00:00<00:01, 5879.49probe position/s]Normalizing amplitudes:  34%|███▎      | 5501/16384 [00:00<00:01, 5812.54probe position/s]Normalizing amplitudes:  37%|███▋      | 6110/16384 [00:01<00:01, 5893.62probe position/s]Normalizing amplitudes:  41%|████      | 6748/16384 [00:01<00:01, 6039.16probe position/s]Normalizing amplitudes:  45%|████▌     | 7393/16384 [00:01<00:01, 6160.36probe position/s]Normalizing amplitudes:  49%|████▉     | 8028/16384 [00:01<00:01, 6216.26probe position/s]Normalizing amplitudes:  53%|█████▎    | 8651/16384 [00:01<00:01, 5916.78probe position/s]Normalizing amplitudes:  56%|█████▋    | 9246/16384 [00:01<00:01, 5896.77probe position/s]Normalizing amplitudes:  60%|██████    | 9838/16384 [00:01<00:01, 5850.39probe position/s]Normalizing amplitudes:  64%|██████▎   | 10436/16384 [00:01<00:01, 5886.44probe position/s]Normalizing amplitudes:  67%|██████▋   | 11057/16384 [00:01<00:00, 5978.90probe position/s]Normalizing amplitudes:  71%|███████   | 11671/16384 [00:01<00:00, 6025.44probe position/s]Normalizing amplitudes:  75%|███████▍  | 12275/16384 [00:02<00:00, 6006.78probe position/s]Normalizing amplitudes:  79%|███████▊  | 12885/16384 [00:02<00:00, 6032.79probe position/s]Normalizing amplitudes:  82%|████████▏ | 13489/16384 [00:02<00:00, 5980.99probe position/s]Normalizing amplitudes:  86%|████████▌ | 14096/16384 [00:02<00:00, 6006.56probe position/s]Normalizing amplitudes:  90%|████████▉ | 14721/16384 [00:02<00:00, 6077.62probe position/s]Normalizing amplitudes:  94%|█████████▎| 15330/16384 [00:02<00:00, 6009.97probe position/s]Normalizing amplitudes:  97%|█████████▋| 15952/16384 [00:02<00:00, 6070.27probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5991.15probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random128_p1_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random128_p1_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.008581 in 2.605 sec
Iter: 2, Total Loss: 0.006518 in 2.514 sec
Iter: 3, Total Loss: 0.006492 in 2.555 sec
Iter: 4, Total Loss: 0.006472 in 2.464 sec
Iter: 5, Total Loss: 0.006452 in 2.564 sec
Iter: 6, Total Loss: 0.006433 in 2.496 sec
Iter: 7, Total Loss: 0.006414 in 2.526 sec
Iter: 8, Total Loss: 0.006394 in 2.521 sec
Iter: 9, Total Loss: 0.006376 in 2.539 sec
Iter: 10, Total Loss: 0.006357 in 2.500 sec
Iter: 11, Total Loss: 0.006341 in 2.566 sec
Iter: 12, Total Loss: 0.006323 in 2.505 sec
Iter: 13, Total Loss: 0.006306 in 2.530 sec
Iter: 14, Total Loss: 0.006289 in 2.524 sec
Iter: 15, Total Loss: 0.006274 in 2.585 sec
Iter: 16, Total Loss: 0.006257 in 2.670 sec
Iter: 17, Total Loss: 0.006243 in 2.698 sec
Iter: 18, Total Loss: 0.006229 in 2.541 sec
Iter: 19, Total Loss: 0.006216 in 2.498 sec
Iter: 20, Total Loss: 0.006203 in 2.560 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 2.548 with std = 0.056 sec ###
### py4DSTEM ptycho solver is finished in 53.705 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 899.07 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 128, 1, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 637/16384 [00:00<00:02, 6365.76probe position/s]Normalizing amplitudes:   8%|▊         | 1274/16384 [00:00<00:02, 6237.37probe position/s]Normalizing amplitudes:  12%|█▏        | 1898/16384 [00:00<00:02, 6127.66probe position/s]Normalizing amplitudes:  16%|█▌        | 2546/16384 [00:00<00:02, 6261.96probe position/s]Normalizing amplitudes:  19%|█▉        | 3173/16384 [00:00<00:02, 6080.78probe position/s]Normalizing amplitudes:  23%|██▎       | 3783/16384 [00:00<00:02, 6023.71probe position/s]Normalizing amplitudes:  27%|██▋       | 4386/16384 [00:00<00:01, 6024.48probe position/s]Normalizing amplitudes:  31%|███       | 5007/16384 [00:00<00:01, 6082.05probe position/s]Normalizing amplitudes:  34%|███▍      | 5629/16384 [00:00<00:01, 6124.23probe position/s]Normalizing amplitudes:  38%|███▊      | 6242/16384 [00:01<00:01, 5927.43probe position/s]Normalizing amplitudes:  42%|████▏     | 6837/16384 [00:01<00:01, 5836.63probe position/s]Normalizing amplitudes:  46%|████▌     | 7476/16384 [00:01<00:01, 5997.56probe position/s]Normalizing amplitudes:  49%|████▉     | 8077/16384 [00:01<00:01, 5943.00probe position/s]Normalizing amplitudes:  53%|█████▎    | 8673/16384 [00:01<00:01, 5870.89probe position/s]Normalizing amplitudes:  57%|█████▋    | 9261/16384 [00:01<00:01, 5803.21probe position/s]Normalizing amplitudes:  60%|██████    | 9842/16384 [00:01<00:01, 5794.33probe position/s]Normalizing amplitudes:  64%|██████▎   | 10440/16384 [00:01<00:01, 5848.02probe position/s]Normalizing amplitudes:  67%|██████▋   | 11026/16384 [00:01<00:00, 5662.01probe position/s]Normalizing amplitudes:  71%|███████   | 11659/16384 [00:01<00:00, 5853.62probe position/s]Normalizing amplitudes:  75%|███████▍  | 12272/16384 [00:02<00:00, 5934.55probe position/s]Normalizing amplitudes:  79%|███████▊  | 12868/16384 [00:02<00:00, 5940.42probe position/s]Normalizing amplitudes:  82%|████████▏ | 13467/16384 [00:02<00:00, 5953.25probe position/s]Normalizing amplitudes:  86%|████████▌ | 14063/16384 [00:02<00:00, 5823.54probe position/s]Normalizing amplitudes:  89%|████████▉ | 14647/16384 [00:02<00:00, 5727.15probe position/s]Normalizing amplitudes:  93%|█████████▎| 15221/16384 [00:02<00:00, 5592.73probe position/s]Normalizing amplitudes:  97%|█████████▋| 15846/16384 [00:02<00:00, 5780.68probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5910.04probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random128_p1_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random128_p1_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.008777 in 4.727 sec
Iter: 2, Total Loss: 0.006563 in 4.643 sec
Iter: 3, Total Loss: 0.006529 in 4.542 sec
Iter: 4, Total Loss: 0.0065 in 4.571 sec
Iter: 5, Total Loss: 0.006471 in 4.535 sec
Iter: 6, Total Loss: 0.006445 in 4.670 sec
Iter: 7, Total Loss: 0.006423 in 4.651 sec
Iter: 8, Total Loss: 0.0064 in 4.661 sec
Iter: 9, Total Loss: 0.006376 in 4.593 sec
Iter: 10, Total Loss: 0.006357 in 4.555 sec
Iter: 11, Total Loss: 0.006335 in 4.579 sec
Iter: 12, Total Loss: 0.006315 in 4.574 sec
Iter: 13, Total Loss: 0.006296 in 4.414 sec
Iter: 14, Total Loss: 0.006276 in 4.557 sec
Iter: 15, Total Loss: 0.006257 in 4.546 sec
Iter: 16, Total Loss: 0.006239 in 4.449 sec
Iter: 17, Total Loss: 0.006224 in 4.534 sec
Iter: 18, Total Loss: 0.006207 in 4.688 sec
Iter: 19, Total Loss: 0.006188 in 4.627 sec
Iter: 20, Total Loss: 0.006173 in 4.657 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 4.589 with std = 0.076 sec ###
### py4DSTEM ptycho solver is finished in 1 min 34.338 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 902.32 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 128, 3, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 604/16384 [00:00<00:02, 6036.81probe position/s]Normalizing amplitudes:   8%|▊         | 1230/16384 [00:00<00:02, 6166.49probe position/s]Normalizing amplitudes:  11%|█▏        | 1868/16384 [00:00<00:02, 6259.21probe position/s]Normalizing amplitudes:  15%|█▌        | 2494/16384 [00:00<00:02, 5719.33probe position/s]Normalizing amplitudes:  19%|█▉        | 3128/16384 [00:00<00:02, 5928.20probe position/s]Normalizing amplitudes:  23%|██▎       | 3778/16384 [00:00<00:02, 6113.70probe position/s]Normalizing amplitudes:  27%|██▋       | 4394/16384 [00:00<00:01, 6029.71probe position/s]Normalizing amplitudes:  31%|███       | 5006/16384 [00:00<00:01, 6055.93probe position/s]Normalizing amplitudes:  34%|███▍      | 5617/16384 [00:00<00:01, 6070.31probe position/s]Normalizing amplitudes:  38%|███▊      | 6226/16384 [00:01<00:01, 6059.83probe position/s]Normalizing amplitudes:  42%|████▏     | 6852/16384 [00:01<00:01, 6118.03probe position/s]Normalizing amplitudes:  46%|████▌     | 7498/16384 [00:01<00:01, 6220.68probe position/s]Normalizing amplitudes:  50%|████▉     | 8160/16384 [00:01<00:01, 6340.80probe position/s]Normalizing amplitudes:  54%|█████▎    | 8795/16384 [00:01<00:01, 6337.75probe position/s]Normalizing amplitudes:  58%|█████▊    | 9430/16384 [00:01<00:01, 6057.24probe position/s]Normalizing amplitudes:  61%|██████▏   | 10063/16384 [00:01<00:01, 6134.85probe position/s]Normalizing amplitudes:  65%|██████▌   | 10679/16384 [00:01<00:00, 6140.25probe position/s]Normalizing amplitudes:  69%|██████▉   | 11326/16384 [00:01<00:00, 6235.51probe position/s]Normalizing amplitudes:  73%|███████▎  | 11956/16384 [00:01<00:00, 6250.28probe position/s]Normalizing amplitudes:  77%|███████▋  | 12582/16384 [00:02<00:00, 6158.44probe position/s]Normalizing amplitudes:  81%|████████  | 13199/16384 [00:02<00:00, 6147.49probe position/s]Normalizing amplitudes:  84%|████████▍ | 13831/16384 [00:02<00:00, 6194.59probe position/s]Normalizing amplitudes:  88%|████████▊ | 14458/16384 [00:02<00:00, 6213.97probe position/s]Normalizing amplitudes:  92%|█████████▏| 15080/16384 [00:02<00:00, 5986.32probe position/s]Normalizing amplitudes:  96%|█████████▌| 15681/16384 [00:02<00:00, 5940.81probe position/s]Normalizing amplitudes:  99%|█████████▉| 16277/16384 [00:02<00:00, 5923.67probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6094.89probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random128_p3_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random128_p3_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.01469 in 2.400 sec
Iter: 2, Total Loss: 0.006475 in 2.361 sec
Iter: 3, Total Loss: 0.006396 in 2.348 sec
Iter: 4, Total Loss: 0.006343 in 2.321 sec
Iter: 5, Total Loss: 0.006296 in 2.366 sec
Iter: 6, Total Loss: 0.006249 in 2.347 sec
Iter: 7, Total Loss: 0.006197 in 2.450 sec
Iter: 8, Total Loss: 0.006148 in 2.367 sec
Iter: 9, Total Loss: 0.006095 in 2.401 sec
Iter: 10, Total Loss: 0.006047 in 2.459 sec
Iter: 11, Total Loss: 0.005998 in 2.439 sec
Iter: 12, Total Loss: 0.005954 in 2.351 sec
Iter: 13, Total Loss: 0.005911 in 2.358 sec
Iter: 14, Total Loss: 0.005871 in 2.311 sec
Iter: 15, Total Loss: 0.005834 in 2.345 sec
Iter: 16, Total Loss: 0.005799 in 2.344 sec
Iter: 17, Total Loss: 0.005767 in 2.300 sec
Iter: 18, Total Loss: 0.005736 in 2.285 sec
Iter: 19, Total Loss: 0.005707 in 2.346 sec
Iter: 20, Total Loss: 0.00568 in 2.318 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 2.361 with std = 0.047 sec ###
### py4DSTEM ptycho solver is finished in 49.574 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 904.22 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 128, 3, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 660/16384 [00:00<00:02, 6598.20probe position/s]Normalizing amplitudes:   9%|▊         | 1432/16384 [00:00<00:02, 7256.21probe position/s]Normalizing amplitudes:  13%|█▎        | 2166/16384 [00:00<00:01, 7292.05probe position/s]Normalizing amplitudes:  18%|█▊        | 2896/16384 [00:00<00:01, 6905.47probe position/s]Normalizing amplitudes:  22%|██▏       | 3590/16384 [00:00<00:01, 6789.92probe position/s]Normalizing amplitudes:  26%|██▌       | 4271/16384 [00:00<00:01, 6732.39probe position/s]Normalizing amplitudes:  31%|███       | 5017/16384 [00:00<00:01, 6960.58probe position/s]Normalizing amplitudes:  35%|███▍      | 5715/16384 [00:00<00:02, 4974.93probe position/s]Normalizing amplitudes:  38%|███▊      | 6288/16384 [00:01<00:01, 5116.63probe position/s]Normalizing amplitudes:  42%|████▏     | 6858/16384 [00:01<00:01, 5264.91probe position/s]Normalizing amplitudes:  46%|████▌     | 7570/16384 [00:01<00:01, 5758.22probe position/s]Normalizing amplitudes:  50%|████▉     | 8182/16384 [00:01<00:01, 5722.57probe position/s]Normalizing amplitudes:  54%|█████▍    | 8816/16384 [00:01<00:01, 5891.66probe position/s]Normalizing amplitudes:  58%|█████▊    | 9457/16384 [00:01<00:01, 6038.11probe position/s]Normalizing amplitudes:  62%|██████▏   | 10121/16384 [00:01<00:01, 6211.38probe position/s]Normalizing amplitudes:  66%|██████▌   | 10818/16384 [00:01<00:00, 6432.20probe position/s]Normalizing amplitudes:  70%|███████   | 11496/16384 [00:01<00:00, 6534.36probe position/s]Normalizing amplitudes:  74%|███████▍  | 12156/16384 [00:01<00:00, 6523.94probe position/s]Normalizing amplitudes:  78%|███████▊  | 12820/16384 [00:02<00:00, 6558.12probe position/s]Normalizing amplitudes:  82%|████████▏ | 13479/16384 [00:02<00:00, 6524.24probe position/s]Normalizing amplitudes:  86%|████████▋ | 14136/16384 [00:02<00:00, 6536.22probe position/s]Normalizing amplitudes:  90%|█████████ | 14805/16384 [00:02<00:00, 6579.70probe position/s]Normalizing amplitudes:  95%|█████████▍| 15558/16384 [00:02<00:00, 6862.01probe position/s]Normalizing amplitudes:  99%|█████████▉| 16246/16384 [00:02<00:00, 6439.29probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6264.27probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random128_p3_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random128_p3_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.01536 in 6.192 sec
Iter: 2, Total Loss: 0.006433 in 6.207 sec
Iter: 3, Total Loss: 0.006296 in 6.245 sec
Iter: 4, Total Loss: 0.006216 in 6.297 sec
Iter: 5, Total Loss: 0.006145 in 6.461 sec
Iter: 6, Total Loss: 0.006078 in 6.251 sec
Iter: 7, Total Loss: 0.006016 in 6.172 sec
Iter: 8, Total Loss: 0.005956 in 6.400 sec
Iter: 9, Total Loss: 0.005898 in 6.567 sec
Iter: 10, Total Loss: 0.005842 in 6.366 sec
Iter: 11, Total Loss: 0.005791 in 6.397 sec
Iter: 12, Total Loss: 0.005743 in 6.288 sec
Iter: 13, Total Loss: 0.005699 in 6.361 sec
Iter: 14, Total Loss: 0.005658 in 6.447 sec
Iter: 15, Total Loss: 0.00562 in 6.530 sec
Iter: 16, Total Loss: 0.005585 in 7.767 sec
Iter: 17, Total Loss: 0.005553 in 6.385 sec
Iter: 18, Total Loss: 0.005524 in 6.347 sec
Iter: 19, Total Loss: 0.005497 in 6.548 sec
Iter: 20, Total Loss: 0.005473 in 6.469 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 6.435 with std = 0.326 sec ###
### py4DSTEM ptycho solver is finished in 2 min 11.214 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 906.38 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 128, 3, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 617/16384 [00:00<00:02, 6167.77probe position/s]Normalizing amplitudes:   8%|▊         | 1234/16384 [00:00<00:02, 5723.57probe position/s]Normalizing amplitudes:  11%|█         | 1825/16384 [00:00<00:02, 5802.73probe position/s]Normalizing amplitudes:  15%|█▌        | 2459/16384 [00:00<00:02, 6005.85probe position/s]Normalizing amplitudes:  19%|█▊        | 3061/16384 [00:00<00:02, 5917.69probe position/s]Normalizing amplitudes:  22%|██▏       | 3654/16384 [00:00<00:02, 5841.01probe position/s]Normalizing amplitudes:  26%|██▌       | 4252/16384 [00:00<00:02, 5884.00probe position/s]Normalizing amplitudes:  30%|██▉       | 4864/16384 [00:00<00:01, 5954.47probe position/s]Normalizing amplitudes:  33%|███▎      | 5460/16384 [00:00<00:01, 5829.90probe position/s]Normalizing amplitudes:  37%|███▋      | 6044/16384 [00:01<00:01, 5730.50probe position/s]Normalizing amplitudes:  40%|████      | 6618/16384 [00:01<00:01, 5666.70probe position/s]Normalizing amplitudes:  44%|████▍     | 7186/16384 [00:01<00:01, 5609.28probe position/s]Normalizing amplitudes:  47%|████▋     | 7772/16384 [00:01<00:01, 5682.23probe position/s]Normalizing amplitudes:  51%|█████▏    | 8409/16384 [00:01<00:01, 5884.92probe position/s]Normalizing amplitudes:  55%|█████▌    | 9024/16384 [00:01<00:01, 5963.58probe position/s]Normalizing amplitudes:  59%|█████▊    | 9621/16384 [00:01<00:01, 5926.22probe position/s]Normalizing amplitudes:  62%|██████▏   | 10220/16384 [00:01<00:01, 5942.41probe position/s]Normalizing amplitudes:  66%|██████▌   | 10815/16384 [00:01<00:00, 5847.56probe position/s]Normalizing amplitudes:  70%|██████▉   | 11401/16384 [00:01<00:00, 5826.17probe position/s]Normalizing amplitudes:  73%|███████▎  | 11984/16384 [00:02<00:00, 5688.28probe position/s]Normalizing amplitudes:  77%|███████▋  | 12554/16384 [00:02<00:00, 5601.73probe position/s]Normalizing amplitudes:  80%|████████  | 13160/16384 [00:02<00:00, 5733.91probe position/s]Normalizing amplitudes:  84%|████████▍ | 13780/16384 [00:02<00:00, 5869.86probe position/s]Normalizing amplitudes:  88%|████████▊ | 14387/16384 [00:02<00:00, 5926.54probe position/s]Normalizing amplitudes:  92%|█████████▏| 15015/16384 [00:02<00:00, 6030.66probe position/s]Normalizing amplitudes:  96%|█████████▌| 15681/16384 [00:02<00:00, 6217.91probe position/s]Normalizing amplitudes: 100%|█████████▉| 16304/16384 [00:02<00:00, 6160.41probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5885.75probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random128_p3_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random128_p3_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.01586 in 12.940 sec
Iter: 2, Total Loss: 0.006374 in 12.209 sec
Iter: 3, Total Loss: 0.0062 in 12.220 sec
Iter: 4, Total Loss: 0.006101 in 12.085 sec
Iter: 5, Total Loss: 0.006016 in 12.228 sec
Iter: 6, Total Loss: 0.00594 in 12.306 sec
Iter: 7, Total Loss: 0.005869 in 12.684 sec
Iter: 8, Total Loss: 0.005806 in 11.955 sec
Iter: 9, Total Loss: 0.005746 in 12.187 sec
Iter: 10, Total Loss: 0.005692 in 12.074 sec
Iter: 11, Total Loss: 0.005642 in 11.996 sec
Iter: 12, Total Loss: 0.005596 in 12.202 sec
Iter: 13, Total Loss: 0.005555 in 12.064 sec
Iter: 14, Total Loss: 0.005516 in 12.273 sec
Iter: 15, Total Loss: 0.005481 in 12.734 sec
Iter: 16, Total Loss: 0.00545 in 11.971 sec
Iter: 17, Total Loss: 0.005421 in 12.003 sec
Iter: 18, Total Loss: 0.005395 in 12.102 sec
Iter: 19, Total Loss: 0.005372 in 12.367 sec
Iter: 20, Total Loss: 0.00535 in 12.954 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 12.278 with std = 0.301 sec ###
### py4DSTEM ptycho solver is finished in 4 min 8.136 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 903.44 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 128, 6, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 621/16384 [00:00<00:02, 6207.03probe position/s]Normalizing amplitudes:   8%|▊         | 1242/16384 [00:00<00:02, 6105.96probe position/s]Normalizing amplitudes:  11%|█▏        | 1869/16384 [00:00<00:02, 6177.22probe position/s]Normalizing amplitudes:  15%|█▌        | 2494/16384 [00:00<00:02, 6204.95probe position/s]Normalizing amplitudes:  19%|█▉        | 3136/16384 [00:00<00:02, 6279.10probe position/s]Normalizing amplitudes:  23%|██▎       | 3780/16384 [00:00<00:01, 6332.62probe position/s]Normalizing amplitudes:  27%|██▋       | 4414/16384 [00:00<00:01, 6276.44probe position/s]Normalizing amplitudes:  31%|███       | 5052/16384 [00:00<00:01, 6307.23probe position/s]Normalizing amplitudes:  35%|███▍      | 5683/16384 [00:00<00:01, 6246.71probe position/s]Normalizing amplitudes:  39%|███▊      | 6308/16384 [00:01<00:01, 6229.50probe position/s]Normalizing amplitudes:  42%|████▏     | 6932/16384 [00:01<00:01, 6219.00probe position/s]Normalizing amplitudes:  46%|████▌     | 7554/16384 [00:01<00:01, 6190.38probe position/s]Normalizing amplitudes:  50%|█████     | 8206/16384 [00:01<00:01, 6288.36probe position/s]Normalizing amplitudes:  54%|█████▍    | 8835/16384 [00:01<00:01, 6177.40probe position/s]Normalizing amplitudes:  58%|█████▊    | 9479/16384 [00:01<00:01, 6254.96probe position/s]Normalizing amplitudes:  62%|██████▏   | 10139/16384 [00:01<00:00, 6355.75probe position/s]Normalizing amplitudes:  66%|██████▌   | 10776/16384 [00:01<00:00, 6251.24probe position/s]Normalizing amplitudes:  70%|██████▉   | 11402/16384 [00:01<00:00, 6095.37probe position/s]Normalizing amplitudes:  73%|███████▎  | 12013/16384 [00:01<00:00, 5764.60probe position/s]Normalizing amplitudes:  77%|███████▋  | 12649/16384 [00:02<00:00, 5931.06probe position/s]Normalizing amplitudes:  81%|████████  | 13246/16384 [00:02<00:00, 5699.18probe position/s]Normalizing amplitudes:  84%|████████▍ | 13820/16384 [00:02<00:00, 5601.22probe position/s]Normalizing amplitudes:  89%|████████▊ | 14501/16384 [00:02<00:00, 5943.80probe position/s]Normalizing amplitudes:  92%|█████████▏| 15100/16384 [00:02<00:00, 5799.23probe position/s]Normalizing amplitudes:  96%|█████████▌| 15683/16384 [00:02<00:00, 5669.75probe position/s]Normalizing amplitudes:  99%|█████████▉| 16255/16384 [00:02<00:00, 5682.17probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6036.06probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random128_p6_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random128_p6_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.03183 in 4.369 sec
Iter: 2, Total Loss: 0.006507 in 4.267 sec
Iter: 3, Total Loss: 0.006377 in 4.284 sec
Iter: 4, Total Loss: 0.006295 in 4.348 sec
Iter: 5, Total Loss: 0.006227 in 4.269 sec
Iter: 6, Total Loss: 0.006165 in 4.247 sec
Iter: 7, Total Loss: 0.006107 in 4.230 sec
Iter: 8, Total Loss: 0.006049 in 4.327 sec
Iter: 9, Total Loss: 0.005992 in 4.211 sec
Iter: 10, Total Loss: 0.005937 in 4.270 sec
Iter: 11, Total Loss: 0.005882 in 4.197 sec
Iter: 12, Total Loss: 0.00583 in 4.235 sec
Iter: 13, Total Loss: 0.00578 in 4.240 sec
Iter: 14, Total Loss: 0.005734 in 4.256 sec
Iter: 15, Total Loss: 0.005691 in 4.182 sec
Iter: 16, Total Loss: 0.005651 in 4.296 sec
Iter: 17, Total Loss: 0.005615 in 4.610 sec
Iter: 18, Total Loss: 0.00558 in 4.351 sec
Iter: 19, Total Loss: 0.005549 in 4.328 sec
Iter: 20, Total Loss: 0.005518 in 4.305 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 4.291 with std = 0.089 sec ###
### py4DSTEM ptycho solver is finished in 1 min 28.274 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 907.66 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 128, 6, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 615/16384 [00:00<00:02, 6143.91probe position/s]Normalizing amplitudes:   8%|▊         | 1233/16384 [00:00<00:02, 6162.40probe position/s]Normalizing amplitudes:  11%|█▏        | 1856/16384 [00:00<00:02, 6191.04probe position/s]Normalizing amplitudes:  15%|█▌        | 2529/16384 [00:00<00:02, 6400.73probe position/s]Normalizing amplitudes:  19%|█▉        | 3170/16384 [00:00<00:02, 6402.30probe position/s]Normalizing amplitudes:  23%|██▎       | 3811/16384 [00:00<00:02, 5997.65probe position/s]Normalizing amplitudes:  27%|██▋       | 4416/16384 [00:00<00:02, 5943.46probe position/s]Normalizing amplitudes:  31%|███       | 5016/16384 [00:00<00:01, 5960.14probe position/s]Normalizing amplitudes:  34%|███▍      | 5615/16384 [00:00<00:01, 5967.98probe position/s]Normalizing amplitudes:  38%|███▊      | 6238/16384 [00:01<00:01, 6047.15probe position/s]Normalizing amplitudes:  42%|████▏     | 6875/16384 [00:01<00:01, 6142.93probe position/s]Normalizing amplitudes:  46%|████▌     | 7543/16384 [00:01<00:01, 6303.20probe position/s]Normalizing amplitudes:  50%|████▉     | 8179/16384 [00:01<00:01, 6318.36probe position/s]Normalizing amplitudes:  54%|█████▍    | 8812/16384 [00:01<00:01, 5995.37probe position/s]Normalizing amplitudes:  58%|█████▊    | 9447/16384 [00:01<00:01, 6097.51probe position/s]Normalizing amplitudes:  61%|██████▏   | 10060/16384 [00:01<00:01, 5875.06probe position/s]Normalizing amplitudes:  65%|██████▌   | 10651/16384 [00:01<00:01, 5718.21probe position/s]Normalizing amplitudes:  69%|██████▉   | 11274/16384 [00:01<00:00, 5863.39probe position/s]Normalizing amplitudes:  73%|███████▎  | 11925/16384 [00:01<00:00, 6049.51probe position/s]Normalizing amplitudes:  76%|███████▋  | 12533/16384 [00:02<00:00, 5851.19probe position/s]Normalizing amplitudes:  80%|████████  | 13121/16384 [00:02<00:00, 5565.90probe position/s]Normalizing amplitudes:  84%|████████▎ | 13682/16384 [00:02<00:00, 5530.59probe position/s]Normalizing amplitudes:  87%|████████▋ | 14282/16384 [00:02<00:00, 5663.48probe position/s]Normalizing amplitudes:  91%|█████████ | 14851/16384 [00:02<00:00, 5661.28probe position/s]Normalizing amplitudes:  94%|█████████▍| 15434/16384 [00:02<00:00, 5707.24probe position/s]Normalizing amplitudes:  98%|█████████▊| 16063/16384 [00:02<00:00, 5877.38probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5939.84probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random128_p6_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random128_p6_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.03253 in 12.159 sec
Iter: 2, Total Loss: 0.00648 in 12.207 sec
Iter: 3, Total Loss: 0.006281 in 12.265 sec
Iter: 4, Total Loss: 0.006188 in 12.340 sec
Iter: 5, Total Loss: 0.006111 in 12.286 sec
Iter: 6, Total Loss: 0.00604 in 12.081 sec
Iter: 7, Total Loss: 0.00597 in 11.920 sec
Iter: 8, Total Loss: 0.005903 in 12.287 sec
Iter: 9, Total Loss: 0.005838 in 12.084 sec
Iter: 10, Total Loss: 0.005776 in 12.106 sec
Iter: 11, Total Loss: 0.005717 in 12.163 sec
Iter: 12, Total Loss: 0.005661 in 12.065 sec
Iter: 13, Total Loss: 0.005608 in 12.180 sec
Iter: 14, Total Loss: 0.005559 in 12.479 sec
Iter: 15, Total Loss: 0.005511 in 12.764 sec
Iter: 16, Total Loss: 0.005467 in 12.485 sec
Iter: 17, Total Loss: 0.005426 in 12.240 sec
Iter: 18, Total Loss: 0.005388 in 12.016 sec
Iter: 19, Total Loss: 0.005352 in 12.389 sec
Iter: 20, Total Loss: 0.005319 in 12.231 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 12.237 with std = 0.187 sec ###
### py4DSTEM ptycho solver is finished in 4 min 7.777 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 903.69 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 128, 6, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 570/16384 [00:00<00:02, 5680.56probe position/s]Normalizing amplitudes:   7%|▋         | 1139/16384 [00:00<00:02, 5644.82probe position/s]Normalizing amplitudes:  11%|█         | 1724/16384 [00:00<00:02, 5734.01probe position/s]Normalizing amplitudes:  14%|█▍        | 2321/16384 [00:00<00:02, 5825.73probe position/s]Normalizing amplitudes:  18%|█▊        | 2919/16384 [00:00<00:02, 5877.11probe position/s]Normalizing amplitudes:  22%|██▏       | 3530/16384 [00:00<00:02, 5949.96probe position/s]Normalizing amplitudes:  25%|██▌       | 4155/16384 [00:00<00:02, 6044.25probe position/s]Normalizing amplitudes:  29%|██▉       | 4760/16384 [00:00<00:01, 6008.16probe position/s]Normalizing amplitudes:  33%|███▎      | 5361/16384 [00:00<00:01, 5962.68probe position/s]Normalizing amplitudes:  36%|███▋      | 5968/16384 [00:01<00:01, 5994.52probe position/s]Normalizing amplitudes:  40%|████      | 6568/16384 [00:01<00:01, 5896.93probe position/s]Normalizing amplitudes:  44%|████▍     | 7185/16384 [00:01<00:01, 5977.02probe position/s]Normalizing amplitudes:  48%|████▊     | 7804/16384 [00:01<00:01, 6039.71probe position/s]Normalizing amplitudes:  51%|█████▏    | 8409/16384 [00:01<00:01, 5989.46probe position/s]Normalizing amplitudes:  55%|█████▍    | 9009/16384 [00:01<00:01, 5794.40probe position/s]Normalizing amplitudes:  59%|█████▊    | 9590/16384 [00:01<00:01, 5595.14probe position/s]Normalizing amplitudes:  62%|██████▏   | 10155/16384 [00:01<00:01, 5610.26probe position/s]Normalizing amplitudes:  66%|██████▌   | 10760/16384 [00:01<00:00, 5736.55probe position/s]Normalizing amplitudes:  69%|██████▉   | 11383/16384 [00:01<00:00, 5881.00probe position/s]Normalizing amplitudes:  73%|███████▎  | 11973/16384 [00:02<00:00, 5794.72probe position/s]Normalizing amplitudes:  77%|███████▋  | 12584/16384 [00:02<00:00, 5886.23probe position/s]Normalizing amplitudes:  81%|████████  | 13220/16384 [00:02<00:00, 6024.08probe position/s]Normalizing amplitudes:  84%|████████▍ | 13840/16384 [00:02<00:00, 6072.94probe position/s]Normalizing amplitudes:  88%|████████▊ | 14448/16384 [00:02<00:00, 6005.62probe position/s]Normalizing amplitudes:  92%|█████████▏| 15050/16384 [00:02<00:00, 5958.93probe position/s]Normalizing amplitudes:  96%|█████████▌| 15664/16384 [00:02<00:00, 6012.26probe position/s]Normalizing amplitudes:  99%|█████████▉| 16267/16384 [00:02<00:00, 6014.74probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5911.25probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random128_p6_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random128_p6_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.03399 in 24.477 sec
Iter: 2, Total Loss: 0.006532 in 23.632 sec
Iter: 3, Total Loss: 0.006208 in 23.837 sec
Iter: 4, Total Loss: 0.006085 in 23.541 sec
Iter: 5, Total Loss: 0.00599 in 23.843 sec
Iter: 6, Total Loss: 0.005904 in 23.521 sec
Iter: 7, Total Loss: 0.005824 in 23.560 sec
Iter: 8, Total Loss: 0.005751 in 24.124 sec
Iter: 9, Total Loss: 0.005681 in 23.115 sec
Iter: 10, Total Loss: 0.005616 in 23.448 sec
Iter: 11, Total Loss: 0.005557 in 23.486 sec
Iter: 12, Total Loss: 0.005502 in 23.508 sec
Iter: 13, Total Loss: 0.005451 in 23.849 sec
Iter: 14, Total Loss: 0.005404 in 23.624 sec
Iter: 15, Total Loss: 0.005363 in 23.279 sec
Iter: 16, Total Loss: 0.005324 in 23.278 sec
Iter: 17, Total Loss: 0.005288 in 23.229 sec
Iter: 18, Total Loss: 0.005254 in 23.517 sec
Iter: 19, Total Loss: 0.005223 in 23.569 sec
Iter: 20, Total Loss: 0.005194 in 23.450 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 23.594 with std = 0.307 sec ###
### py4DSTEM ptycho solver is finished in 7 min 54.607 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 903.60 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 128, 12, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 596/16384 [00:00<00:02, 5951.75probe position/s]Normalizing amplitudes:   7%|▋         | 1192/16384 [00:00<00:02, 5917.50probe position/s]Normalizing amplitudes:  11%|█         | 1784/16384 [00:00<00:02, 5796.99probe position/s]Normalizing amplitudes:  14%|█▍        | 2373/16384 [00:00<00:02, 5832.17probe position/s]Normalizing amplitudes:  18%|█▊        | 2957/16384 [00:00<00:02, 5827.41probe position/s]Normalizing amplitudes:  22%|██▏       | 3597/16384 [00:00<00:02, 6018.37probe position/s]Normalizing amplitudes:  26%|██▌       | 4200/16384 [00:00<00:02, 5864.39probe position/s]Normalizing amplitudes:  29%|██▉       | 4809/16384 [00:00<00:01, 5932.75probe position/s]Normalizing amplitudes:  33%|███▎      | 5404/16384 [00:00<00:01, 5895.83probe position/s]Normalizing amplitudes:  37%|███▋      | 5995/16384 [00:01<00:01, 5888.24probe position/s]Normalizing amplitudes:  40%|████      | 6585/16384 [00:01<00:02, 4262.12probe position/s]Normalizing amplitudes:  44%|████▍     | 7180/16384 [00:01<00:01, 4661.68probe position/s]Normalizing amplitudes:  48%|████▊     | 7802/16384 [00:01<00:01, 5056.32probe position/s]Normalizing amplitudes:  52%|█████▏    | 8440/16384 [00:01<00:01, 5402.20probe position/s]Normalizing amplitudes:  55%|█████▌    | 9017/16384 [00:01<00:01, 5498.85probe position/s]Normalizing amplitudes:  59%|█████▊    | 9612/16384 [00:01<00:01, 5624.23probe position/s]Normalizing amplitudes:  62%|██████▏   | 10198/16384 [00:01<00:01, 5690.21probe position/s]Normalizing amplitudes:  66%|██████▌   | 10800/16384 [00:01<00:00, 5784.22probe position/s]Normalizing amplitudes:  70%|██████▉   | 11395/16384 [00:02<00:00, 5830.47probe position/s]Normalizing amplitudes:  73%|███████▎  | 12010/16384 [00:02<00:00, 5924.50probe position/s]Normalizing amplitudes:  77%|███████▋  | 12632/16384 [00:02<00:00, 6010.04probe position/s]Normalizing amplitudes:  81%|████████  | 13237/16384 [00:02<00:00, 6002.62probe position/s]Normalizing amplitudes:  84%|████████▍ | 13840/16384 [00:02<00:00, 5965.26probe position/s]Normalizing amplitudes:  88%|████████▊ | 14477/16384 [00:02<00:00, 6084.87probe position/s]Normalizing amplitudes:  92%|█████████▏| 15096/16384 [00:02<00:00, 6115.39probe position/s]Normalizing amplitudes:  96%|█████████▌| 15709/16384 [00:02<00:00, 5920.53probe position/s]Normalizing amplitudes: 100%|█████████▉| 16304/16384 [00:02<00:00, 5721.55probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5675.43probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random128_p12_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random128_p12_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.0747 in 8.581 sec
Iter: 2, Total Loss: 0.006554 in 8.443 sec
Iter: 3, Total Loss: 0.006401 in 8.121 sec
Iter: 4, Total Loss: 0.006323 in 8.249 sec
Iter: 5, Total Loss: 0.006262 in 8.228 sec
Iter: 6, Total Loss: 0.006204 in 8.064 sec
Iter: 7, Total Loss: 0.00615 in 8.029 sec
Iter: 8, Total Loss: 0.006096 in 8.067 sec
Iter: 9, Total Loss: 0.006042 in 8.218 sec
Iter: 10, Total Loss: 0.005989 in 8.094 sec
Iter: 11, Total Loss: 0.005938 in 8.203 sec
Iter: 12, Total Loss: 0.005889 in 8.157 sec
Iter: 13, Total Loss: 0.005841 in 8.248 sec
Iter: 14, Total Loss: 0.005796 in 8.024 sec
Iter: 15, Total Loss: 0.005753 in 8.118 sec
Iter: 16, Total Loss: 0.005711 in 8.585 sec
Iter: 17, Total Loss: 0.005672 in 8.569 sec
Iter: 18, Total Loss: 0.005635 in 7.994 sec
Iter: 19, Total Loss: 0.005599 in 7.800 sec
Iter: 20, Total Loss: 0.005565 in 8.121 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 8.196 with std = 0.203 sec ###
### py4DSTEM ptycho solver is finished in 2 min 48.651 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 910.76 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 128, 12, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 608/16384 [00:00<00:02, 6078.54probe position/s]Normalizing amplitudes:   8%|▊         | 1254/16384 [00:00<00:02, 6298.77probe position/s]Normalizing amplitudes:  11%|█▏        | 1884/16384 [00:00<00:02, 6276.31probe position/s]Normalizing amplitudes:  15%|█▌        | 2512/16384 [00:00<00:02, 6117.26probe position/s]Normalizing amplitudes:  19%|█▉        | 3147/16384 [00:00<00:02, 6197.52probe position/s]Normalizing amplitudes:  23%|██▎       | 3793/16384 [00:00<00:02, 6282.63probe position/s]Normalizing amplitudes:  27%|██▋       | 4422/16384 [00:00<00:01, 6256.25probe position/s]Normalizing amplitudes:  31%|███       | 5048/16384 [00:00<00:02, 5421.16probe position/s]Normalizing amplitudes:  35%|███▍      | 5729/16384 [00:00<00:01, 5810.47probe position/s]Normalizing amplitudes:  39%|███▊      | 6328/16384 [00:01<00:01, 5825.19probe position/s]Normalizing amplitudes:  43%|████▎     | 6965/16384 [00:01<00:01, 5980.76probe position/s]Normalizing amplitudes:  46%|████▋     | 7578/16384 [00:01<00:01, 6021.63probe position/s]Normalizing amplitudes:  50%|█████     | 8194/16384 [00:01<00:01, 6059.49probe position/s]Normalizing amplitudes:  54%|█████▍    | 8817/16384 [00:01<00:01, 6108.48probe position/s]Normalizing amplitudes:  58%|█████▊    | 9436/16384 [00:01<00:01, 6130.52probe position/s]Normalizing amplitudes:  62%|██████▏   | 10091/16384 [00:01<00:01, 6254.16probe position/s]Normalizing amplitudes:  66%|██████▌   | 10765/16384 [00:01<00:00, 6398.35probe position/s]Normalizing amplitudes:  70%|██████▉   | 11440/16384 [00:01<00:00, 6501.91probe position/s]Normalizing amplitudes:  74%|███████▍  | 12092/16384 [00:01<00:00, 6419.68probe position/s]Normalizing amplitudes:  78%|███████▊  | 12735/16384 [00:02<00:00, 6291.70probe position/s]Normalizing amplitudes:  82%|████████▏ | 13366/16384 [00:02<00:00, 6247.81probe position/s]Normalizing amplitudes:  85%|████████▌ | 14005/16384 [00:02<00:00, 6286.63probe position/s]Normalizing amplitudes:  90%|████████▉ | 14687/16384 [00:02<00:00, 6443.56probe position/s]Normalizing amplitudes:  94%|█████████▎| 15351/16384 [00:02<00:00, 6499.62probe position/s]Normalizing amplitudes:  98%|█████████▊| 16021/16384 [00:02<00:00, 6558.27probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6217.80probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random128_p12_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random128_p12_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.07549 in 23.322 sec
Iter: 2, Total Loss: 0.006591 in 23.655 sec
Iter: 3, Total Loss: 0.006305 in 23.781 sec
Iter: 4, Total Loss: 0.00619 in 24.122 sec
Iter: 5, Total Loss: 0.006105 in 23.577 sec
Iter: 6, Total Loss: 0.006029 in 23.456 sec
Iter: 7, Total Loss: 0.005958 in 23.823 sec
Iter: 8, Total Loss: 0.005891 in 23.531 sec
Iter: 9, Total Loss: 0.005827 in 23.673 sec
Iter: 10, Total Loss: 0.005766 in 23.471 sec
Iter: 11, Total Loss: 0.005708 in 24.396 sec
Iter: 12, Total Loss: 0.005651 in 23.776 sec
Iter: 13, Total Loss: 0.005597 in 23.398 sec
Iter: 14, Total Loss: 0.005546 in 23.220 sec
Iter: 15, Total Loss: 0.005496 in 23.586 sec
Iter: 16, Total Loss: 0.005451 in 23.249 sec
Iter: 17, Total Loss: 0.005408 in 23.232 sec
Iter: 18, Total Loss: 0.005368 in 23.020 sec
Iter: 19, Total Loss: 0.00533 in 22.543 sec
Iter: 20, Total Loss: 0.005295 in 22.731 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 23.478 with std = 0.419 sec ###
### py4DSTEM ptycho solver is finished in 7 min 52.344 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 907.96 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 128, 12, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 603/16384 [00:00<00:02, 6018.10probe position/s]Normalizing amplitudes:   8%|▊         | 1245/16384 [00:00<00:02, 6245.95probe position/s]Normalizing amplitudes:  11%|█▏        | 1870/16384 [00:00<00:02, 5773.39probe position/s]Normalizing amplitudes:  15%|█▍        | 2452/16384 [00:00<00:02, 5697.59probe position/s]Normalizing amplitudes:  19%|█▉        | 3138/16384 [00:00<00:02, 6098.65probe position/s]Normalizing amplitudes:  23%|██▎       | 3829/16384 [00:00<00:01, 6364.10probe position/s]Normalizing amplitudes:  27%|██▋       | 4469/16384 [00:00<00:01, 6285.65probe position/s]Normalizing amplitudes:  31%|███       | 5100/16384 [00:00<00:01, 6287.87probe position/s]Normalizing amplitudes:  35%|███▌      | 5754/16384 [00:00<00:01, 6363.36probe position/s]Normalizing amplitudes:  39%|███▉      | 6431/16384 [00:01<00:01, 6484.46probe position/s]Normalizing amplitudes:  43%|████▎     | 7098/16384 [00:01<00:01, 6539.17probe position/s]Normalizing amplitudes:  47%|████▋     | 7753/16384 [00:01<00:01, 6500.64probe position/s]Normalizing amplitudes:  51%|█████▏    | 8404/16384 [00:01<00:01, 6427.45probe position/s]Normalizing amplitudes:  55%|█████▌    | 9048/16384 [00:01<00:01, 6407.22probe position/s]Normalizing amplitudes:  59%|█████▉    | 9697/16384 [00:01<00:01, 6430.48probe position/s]Normalizing amplitudes:  63%|██████▎   | 10347/16384 [00:01<00:00, 6450.37probe position/s]Normalizing amplitudes:  67%|██████▋   | 10993/16384 [00:01<00:00, 6008.14probe position/s]Normalizing amplitudes:  71%|███████   | 11631/16384 [00:01<00:00, 6112.51probe position/s]Normalizing amplitudes:  75%|███████▌  | 12290/16384 [00:01<00:00, 6250.09probe position/s]Normalizing amplitudes:  79%|███████▉  | 12951/16384 [00:02<00:00, 6352.90probe position/s]Normalizing amplitudes:  83%|████████▎ | 13590/16384 [00:02<00:00, 6337.45probe position/s]Normalizing amplitudes:  87%|████████▋ | 14239/16384 [00:02<00:00, 6381.39probe position/s]Normalizing amplitudes:  91%|█████████ | 14894/16384 [00:02<00:00, 6428.71probe position/s]Normalizing amplitudes:  95%|█████████▍| 15538/16384 [00:02<00:00, 6425.33probe position/s]Normalizing amplitudes:  99%|█████████▉| 16216/16384 [00:02<00:00, 6530.34probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6333.89probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random128_p12_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random128_p12_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.07823 in 46.280 sec
Iter: 2, Total Loss: 0.006854 in 46.404 sec
Iter: 3, Total Loss: 0.006252 in 46.219 sec
Iter: 4, Total Loss: 0.006078 in 46.196 sec
Iter: 5, Total Loss: 0.00596 in 45.907 sec
Iter: 6, Total Loss: 0.005862 in 45.882 sec
Iter: 7, Total Loss: 0.005772 in 46.104 sec
Iter: 8, Total Loss: 0.005691 in 47.099 sec
Iter: 9, Total Loss: 0.005617 in 45.938 sec
Iter: 10, Total Loss: 0.005548 in 44.583 sec
Iter: 11, Total Loss: 0.005485 in 45.940 sec
Iter: 12, Total Loss: 0.005426 in 46.052 sec
Iter: 13, Total Loss: 0.005373 in 47.010 sec
Iter: 14, Total Loss: 0.005324 in 46.417 sec
Iter: 15, Total Loss: 0.005279 in 46.603 sec
Iter: 16, Total Loss: 0.005237 in 45.781 sec
Iter: 17, Total Loss: 0.005198 in 45.949 sec
Iter: 18, Total Loss: 0.005162 in 46.914 sec
Iter: 19, Total Loss: 0.005127 in 45.140 sec
Iter: 20, Total Loss: 0.005096 in 44.937 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 46.068 with std = 0.625 sec ###
### py4DSTEM ptycho solver is finished in 15 min 23.790 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 909.06 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 64, 1, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 575/16384 [00:00<00:02, 5715.53probe position/s]Normalizing amplitudes:   7%|▋         | 1147/16384 [00:00<00:02, 5697.08probe position/s]Normalizing amplitudes:  12%|█▏        | 1894/16384 [00:00<00:02, 6502.30probe position/s]Normalizing amplitudes:  16%|█▌        | 2545/16384 [00:00<00:02, 6429.86probe position/s]Normalizing amplitudes:  19%|█▉        | 3189/16384 [00:00<00:02, 6169.73probe position/s]Normalizing amplitudes:  23%|██▎       | 3808/16384 [00:00<00:02, 6006.02probe position/s]Normalizing amplitudes:  27%|██▋       | 4419/16384 [00:00<00:01, 6037.66probe position/s]Normalizing amplitudes:  31%|███       | 5094/16384 [00:00<00:01, 6256.01probe position/s]Normalizing amplitudes:  35%|███▌      | 5806/16384 [00:00<00:01, 6518.02probe position/s]Normalizing amplitudes:  39%|███▉      | 6460/16384 [00:01<00:01, 6508.85probe position/s]Normalizing amplitudes:  43%|████▎     | 7112/16384 [00:01<00:01, 6454.19probe position/s]Normalizing amplitudes:  47%|████▋     | 7769/16384 [00:01<00:01, 6485.25probe position/s]Normalizing amplitudes:  51%|█████▏    | 8434/16384 [00:01<00:01, 6533.10probe position/s]Normalizing amplitudes:  55%|█████▌    | 9088/16384 [00:01<00:01, 6503.73probe position/s]Normalizing amplitudes:  59%|█████▉    | 9739/16384 [00:01<00:01, 6416.17probe position/s]Normalizing amplitudes:  63%|██████▎   | 10382/16384 [00:01<00:00, 6248.17probe position/s]Normalizing amplitudes:  67%|██████▋   | 11018/16384 [00:01<00:00, 6279.28probe position/s]Normalizing amplitudes:  71%|███████   | 11650/16384 [00:01<00:00, 6288.75probe position/s]Normalizing amplitudes:  75%|███████▍  | 12280/16384 [00:01<00:00, 6263.65probe position/s]Normalizing amplitudes:  79%|███████▉  | 12918/16384 [00:02<00:00, 6295.54probe position/s]Normalizing amplitudes:  83%|████████▎ | 13572/16384 [00:02<00:00, 6365.29probe position/s]Normalizing amplitudes:  87%|████████▋ | 14244/16384 [00:02<00:00, 6470.52probe position/s]Normalizing amplitudes:  91%|█████████ | 14892/16384 [00:02<00:00, 6471.97probe position/s]Normalizing amplitudes:  95%|█████████▍| 15540/16384 [00:02<00:00, 6325.62probe position/s]Normalizing amplitudes:  99%|█████████▊| 16174/16384 [00:02<00:00, 6203.70probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6304.26probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random64_p1_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random64_p1_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.007558 in 1.824 sec
Iter: 2, Total Loss: 0.00652 in 1.772 sec
Iter: 3, Total Loss: 0.006488 in 1.778 sec
Iter: 4, Total Loss: 0.006461 in 1.799 sec
Iter: 5, Total Loss: 0.006435 in 1.809 sec
Iter: 6, Total Loss: 0.006406 in 1.841 sec
Iter: 7, Total Loss: 0.006376 in 1.788 sec
Iter: 8, Total Loss: 0.006347 in 1.962 sec
Iter: 9, Total Loss: 0.006319 in 1.970 sec
Iter: 10, Total Loss: 0.006294 in 1.902 sec
Iter: 11, Total Loss: 0.006268 in 1.779 sec
Iter: 12, Total Loss: 0.006246 in 1.858 sec
Iter: 13, Total Loss: 0.006226 in 1.795 sec
Iter: 14, Total Loss: 0.006206 in 1.809 sec
Iter: 15, Total Loss: 0.006189 in 2.104 sec
Iter: 16, Total Loss: 0.006173 in 1.868 sec
Iter: 17, Total Loss: 0.006159 in 1.837 sec
Iter: 18, Total Loss: 0.006147 in 1.807 sec
Iter: 19, Total Loss: 0.006134 in 1.799 sec
Iter: 20, Total Loss: 0.006123 in 1.786 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 1.844 with std = 0.081 sec ###
### py4DSTEM ptycho solver is finished in 39.437 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 904.07 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 64, 1, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 620/16384 [00:00<00:02, 6194.75probe position/s]Normalizing amplitudes:   8%|▊         | 1262/16384 [00:00<00:02, 6326.03probe position/s]Normalizing amplitudes:  12%|█▏        | 1920/16384 [00:00<00:02, 6439.87probe position/s]Normalizing amplitudes:  16%|█▌        | 2564/16384 [00:00<00:02, 6362.01probe position/s]Normalizing amplitudes:  20%|█▉        | 3219/16384 [00:00<00:02, 6426.67probe position/s]Normalizing amplitudes:  24%|██▎       | 3862/16384 [00:00<00:01, 6407.17probe position/s]Normalizing amplitudes:  27%|██▋       | 4503/16384 [00:00<00:01, 6342.50probe position/s]Normalizing amplitudes:  32%|███▏      | 5167/16384 [00:00<00:01, 6435.81probe position/s]Normalizing amplitudes:  35%|███▌      | 5811/16384 [00:00<00:01, 6430.66probe position/s]Normalizing amplitudes:  39%|███▉      | 6455/16384 [00:01<00:01, 6330.85probe position/s]Normalizing amplitudes:  43%|████▎     | 7098/16384 [00:01<00:01, 6356.97probe position/s]Normalizing amplitudes:  47%|████▋     | 7735/16384 [00:01<00:01, 6255.89probe position/s]Normalizing amplitudes:  51%|█████▏    | 8410/16384 [00:01<00:01, 6398.69probe position/s]Normalizing amplitudes:  55%|█████▌    | 9051/16384 [00:01<00:01, 6369.24probe position/s]Normalizing amplitudes:  59%|█████▉    | 9691/16384 [00:01<00:01, 6375.96probe position/s]Normalizing amplitudes:  63%|██████▎   | 10329/16384 [00:01<00:00, 6292.47probe position/s]Normalizing amplitudes:  67%|██████▋   | 10959/16384 [00:01<00:00, 5609.59probe position/s]Normalizing amplitudes:  70%|███████   | 11534/16384 [00:01<00:00, 5325.37probe position/s]Normalizing amplitudes:  74%|███████▍  | 12153/16384 [00:01<00:00, 5558.01probe position/s]Normalizing amplitudes:  78%|███████▊  | 12769/16384 [00:02<00:00, 5723.09probe position/s]Normalizing amplitudes:  82%|████████▏ | 13366/16384 [00:02<00:00, 5793.08probe position/s]Normalizing amplitudes:  85%|████████▌ | 13992/16384 [00:02<00:00, 5919.98probe position/s]Normalizing amplitudes:  89%|████████▉ | 14630/16384 [00:02<00:00, 6051.32probe position/s]Normalizing amplitudes:  93%|█████████▎| 15251/16384 [00:02<00:00, 6097.27probe position/s]Normalizing amplitudes:  97%|█████████▋| 15880/16384 [00:02<00:00, 6152.54probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6116.52probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random64_p1_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random64_p1_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.007611 in 4.321 sec
Iter: 2, Total Loss: 0.006526 in 4.223 sec
Iter: 3, Total Loss: 0.006486 in 4.283 sec
Iter: 4, Total Loss: 0.006446 in 4.274 sec
Iter: 5, Total Loss: 0.006411 in 4.398 sec
Iter: 6, Total Loss: 0.006375 in 4.384 sec
Iter: 7, Total Loss: 0.00634 in 4.596 sec
Iter: 8, Total Loss: 0.006312 in 4.422 sec
Iter: 9, Total Loss: 0.006283 in 4.313 sec
Iter: 10, Total Loss: 0.006255 in 4.970 sec
Iter: 11, Total Loss: 0.006233 in 4.562 sec
Iter: 12, Total Loss: 0.00621 in 4.383 sec
Iter: 13, Total Loss: 0.00619 in 4.288 sec
Iter: 14, Total Loss: 0.00617 in 4.238 sec
Iter: 15, Total Loss: 0.006154 in 4.334 sec
Iter: 16, Total Loss: 0.006136 in 4.235 sec
Iter: 17, Total Loss: 0.006123 in 4.237 sec
Iter: 18, Total Loss: 0.00611 in 4.312 sec
Iter: 19, Total Loss: 0.006096 in 4.352 sec
Iter: 20, Total Loss: 0.006086 in 4.325 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 4.373 with std = 0.168 sec ###
### py4DSTEM ptycho solver is finished in 1 min 30.063 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 899.22 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 64, 1, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 589/16384 [00:00<00:02, 5874.60probe position/s]Normalizing amplitudes:   7%|▋         | 1178/16384 [00:00<00:02, 5880.89probe position/s]Normalizing amplitudes:  11%|█         | 1767/16384 [00:00<00:02, 5854.81probe position/s]Normalizing amplitudes:  14%|█▍        | 2353/16384 [00:00<00:02, 5816.04probe position/s]Normalizing amplitudes:  18%|█▊        | 2951/16384 [00:00<00:02, 5874.54probe position/s]Normalizing amplitudes:  22%|██▏       | 3551/16384 [00:00<00:02, 5915.58probe position/s]Normalizing amplitudes:  25%|██▌       | 4156/16384 [00:00<00:02, 5958.53probe position/s]Normalizing amplitudes:  29%|██▉       | 4769/16384 [00:00<00:01, 6012.32probe position/s]Normalizing amplitudes:  33%|███▎      | 5380/16384 [00:00<00:01, 6039.76probe position/s]Normalizing amplitudes:  37%|███▋      | 5999/16384 [00:01<00:01, 6084.14probe position/s]Normalizing amplitudes:  40%|████      | 6608/16384 [00:01<00:01, 6068.98probe position/s]Normalizing amplitudes:  44%|████▍     | 7215/16384 [00:01<00:01, 6061.60probe position/s]Normalizing amplitudes:  48%|████▊     | 7855/16384 [00:01<00:01, 6162.82probe position/s]Normalizing amplitudes:  52%|█████▏    | 8472/16384 [00:01<00:01, 6157.26probe position/s]Normalizing amplitudes:  55%|█████▌    | 9088/16384 [00:01<00:01, 6105.09probe position/s]Normalizing amplitudes:  59%|█████▉    | 9702/16384 [00:01<00:01, 6113.69probe position/s]Normalizing amplitudes:  63%|██████▎   | 10314/16384 [00:01<00:00, 6071.01probe position/s]Normalizing amplitudes:  67%|██████▋   | 10922/16384 [00:01<00:00, 6034.52probe position/s]Normalizing amplitudes:  70%|███████   | 11531/16384 [00:01<00:00, 6048.69probe position/s]Normalizing amplitudes:  74%|███████▍  | 12162/16384 [00:02<00:00, 6125.90probe position/s]Normalizing amplitudes:  78%|███████▊  | 12791/16384 [00:02<00:00, 6174.55probe position/s]Normalizing amplitudes:  82%|████████▏ | 13415/16384 [00:02<00:00, 6192.54probe position/s]Normalizing amplitudes:  86%|████████▌ | 14035/16384 [00:02<00:00, 6149.12probe position/s]Normalizing amplitudes:  89%|████████▉ | 14651/16384 [00:02<00:00, 5925.42probe position/s]Normalizing amplitudes:  93%|█████████▎| 15246/16384 [00:02<00:00, 5846.82probe position/s]Normalizing amplitudes:  97%|█████████▋| 15883/16384 [00:02<00:00, 5998.14probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6039.99probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random64_p1_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random64_p1_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.007726 in 7.978 sec
Iter: 2, Total Loss: 0.00658 in 7.975 sec
Iter: 3, Total Loss: 0.00652 in 8.045 sec
Iter: 4, Total Loss: 0.006472 in 8.051 sec
Iter: 5, Total Loss: 0.006432 in 8.180 sec
Iter: 6, Total Loss: 0.006389 in 8.842 sec
Iter: 7, Total Loss: 0.006354 in 8.115 sec
Iter: 8, Total Loss: 0.006323 in 7.926 sec
Iter: 9, Total Loss: 0.006291 in 7.992 sec
Iter: 10, Total Loss: 0.006259 in 7.908 sec
Iter: 11, Total Loss: 0.006234 in 8.036 sec
Iter: 12, Total Loss: 0.006207 in 7.907 sec
Iter: 13, Total Loss: 0.006182 in 7.901 sec
Iter: 14, Total Loss: 0.006159 in 7.924 sec
Iter: 15, Total Loss: 0.006137 in 7.846 sec
Iter: 16, Total Loss: 0.006116 in 7.776 sec
Iter: 17, Total Loss: 0.006095 in 7.920 sec
Iter: 18, Total Loss: 0.006074 in 7.881 sec
Iter: 19, Total Loss: 0.00606 in 7.946 sec
Iter: 20, Total Loss: 0.006041 in 7.968 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 8.006 with std = 0.212 sec ###
### py4DSTEM ptycho solver is finished in 2 min 42.724 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 899.00 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 64, 3, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 603/16384 [00:00<00:02, 6003.37probe position/s]Normalizing amplitudes:   7%|▋         | 1204/16384 [00:00<00:02, 5948.10probe position/s]Normalizing amplitudes:  11%|█         | 1811/16384 [00:00<00:02, 5998.20probe position/s]Normalizing amplitudes:  15%|█▍        | 2420/16384 [00:00<00:02, 6030.69probe position/s]Normalizing amplitudes:  19%|█▊        | 3070/16384 [00:00<00:02, 6197.27probe position/s]Normalizing amplitudes:  23%|██▎       | 3690/16384 [00:00<00:02, 6049.56probe position/s]Normalizing amplitudes:  26%|██▋       | 4311/16384 [00:00<00:01, 6097.68probe position/s]Normalizing amplitudes:  30%|███       | 4922/16384 [00:00<00:01, 6090.00probe position/s]Normalizing amplitudes:  34%|███▍      | 5535/16384 [00:00<00:01, 6100.88probe position/s]Normalizing amplitudes:  38%|███▊      | 6146/16384 [00:01<00:01, 6049.86probe position/s]Normalizing amplitudes:  41%|████▏     | 6768/16384 [00:01<00:01, 6099.86probe position/s]Normalizing amplitudes:  45%|████▌     | 7379/16384 [00:01<00:01, 5983.52probe position/s]Normalizing amplitudes:  49%|████▊     | 7978/16384 [00:01<00:01, 5959.60probe position/s]Normalizing amplitudes:  53%|█████▎    | 8617/16384 [00:01<00:01, 6085.44probe position/s]Normalizing amplitudes:  56%|█████▋    | 9227/16384 [00:01<00:01, 6089.16probe position/s]Normalizing amplitudes:  60%|██████    | 9837/16384 [00:01<00:01, 6023.84probe position/s]Normalizing amplitudes:  64%|██████▎   | 10440/16384 [00:01<00:00, 5957.21probe position/s]Normalizing amplitudes:  67%|██████▋   | 11037/16384 [00:01<00:00, 5924.89probe position/s]Normalizing amplitudes:  71%|███████   | 11651/16384 [00:01<00:00, 5987.23probe position/s]Normalizing amplitudes:  75%|███████▍  | 12256/16384 [00:02<00:00, 6003.83probe position/s]Normalizing amplitudes:  78%|███████▊  | 12857/16384 [00:02<00:00, 5996.86probe position/s]Normalizing amplitudes:  82%|████████▏ | 13457/16384 [00:02<00:00, 5935.14probe position/s]Normalizing amplitudes:  86%|████████▌ | 14087/16384 [00:02<00:00, 6043.23probe position/s]Normalizing amplitudes:  90%|████████▉ | 14696/16384 [00:02<00:00, 6054.19probe position/s]Normalizing amplitudes:  93%|█████████▎| 15308/16384 [00:02<00:00, 6072.10probe position/s]Normalizing amplitudes:  97%|█████████▋| 15939/16384 [00:02<00:00, 6140.25probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6046.64probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random64_p3_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random64_p3_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.01071 in 3.953 sec
Iter: 2, Total Loss: 0.006444 in 3.883 sec
Iter: 3, Total Loss: 0.00636 in 3.930 sec
Iter: 4, Total Loss: 0.006284 in 3.854 sec
Iter: 5, Total Loss: 0.006207 in 3.932 sec
Iter: 6, Total Loss: 0.00613 in 3.914 sec
Iter: 7, Total Loss: 0.006057 in 3.921 sec
Iter: 8, Total Loss: 0.005989 in 3.953 sec
Iter: 9, Total Loss: 0.005925 in 3.900 sec
Iter: 10, Total Loss: 0.005864 in 3.863 sec
Iter: 11, Total Loss: 0.005808 in 3.874 sec
Iter: 12, Total Loss: 0.005757 in 3.876 sec
Iter: 13, Total Loss: 0.005709 in 3.880 sec
Iter: 14, Total Loss: 0.005665 in 4.073 sec
Iter: 15, Total Loss: 0.005625 in 3.922 sec
Iter: 16, Total Loss: 0.005589 in 3.937 sec
Iter: 17, Total Loss: 0.005556 in 3.816 sec
Iter: 18, Total Loss: 0.005526 in 3.744 sec
Iter: 19, Total Loss: 0.005499 in 3.794 sec
Iter: 20, Total Loss: 0.005474 in 3.745 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 3.888 with std = 0.074 sec ###
### py4DSTEM ptycho solver is finished in 1 min 20.351 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 910.45 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 64, 3, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 581/16384 [00:00<00:02, 5786.19probe position/s]Normalizing amplitudes:   7%|▋         | 1160/16384 [00:00<00:02, 5521.61probe position/s]Normalizing amplitudes:  10%|█         | 1717/16384 [00:00<00:02, 5536.93probe position/s]Normalizing amplitudes:  14%|█▍        | 2325/16384 [00:00<00:02, 5743.71probe position/s]Normalizing amplitudes:  18%|█▊        | 2903/16384 [00:00<00:02, 5755.57probe position/s]Normalizing amplitudes:  21%|██        | 3479/16384 [00:00<00:02, 5756.98probe position/s]Normalizing amplitudes:  25%|██▍       | 4066/16384 [00:00<00:02, 5793.68probe position/s]Normalizing amplitudes:  28%|██▊       | 4655/16384 [00:00<00:02, 5823.93probe position/s]Normalizing amplitudes:  32%|███▏      | 5265/16384 [00:00<00:01, 5909.66probe position/s]Normalizing amplitudes:  36%|███▌      | 5857/16384 [00:01<00:01, 5831.13probe position/s]Normalizing amplitudes:  39%|███▉      | 6467/16384 [00:01<00:01, 5912.25probe position/s]Normalizing amplitudes:  43%|████▎     | 7072/16384 [00:01<00:01, 5949.11probe position/s]Normalizing amplitudes:  47%|████▋     | 7682/16384 [00:01<00:01, 5994.10probe position/s]Normalizing amplitudes:  51%|█████     | 8332/16384 [00:01<00:01, 6144.43probe position/s]Normalizing amplitudes:  55%|█████▍    | 8998/16384 [00:01<00:01, 6298.46probe position/s]Normalizing amplitudes:  59%|█████▉    | 9629/16384 [00:01<00:01, 6296.44probe position/s]Normalizing amplitudes:  63%|██████▎   | 10280/16384 [00:01<00:00, 6358.26probe position/s]Normalizing amplitudes:  67%|██████▋   | 10916/16384 [00:01<00:00, 6285.46probe position/s]Normalizing amplitudes:  70%|███████   | 11545/16384 [00:01<00:00, 6228.34probe position/s]Normalizing amplitudes:  74%|███████▍  | 12180/16384 [00:02<00:00, 6263.33probe position/s]Normalizing amplitudes:  78%|███████▊  | 12839/16384 [00:02<00:00, 6360.24probe position/s]Normalizing amplitudes:  82%|████████▏ | 13511/16384 [00:02<00:00, 6465.65probe position/s]Normalizing amplitudes:  87%|████████▋ | 14190/16384 [00:02<00:00, 6561.94probe position/s]Normalizing amplitudes:  91%|█████████ | 14847/16384 [00:02<00:00, 6527.48probe position/s]Normalizing amplitudes:  95%|█████████▍| 15500/16384 [00:02<00:00, 6433.54probe position/s]Normalizing amplitudes:  99%|█████████▊| 16144/16384 [00:02<00:00, 6422.28probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6145.96probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random64_p3_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random64_p3_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.01118 in 10.605 sec
Iter: 2, Total Loss: 0.00635 in 10.171 sec
Iter: 3, Total Loss: 0.006194 in 10.118 sec
Iter: 4, Total Loss: 0.00608 in 10.192 sec
Iter: 5, Total Loss: 0.005974 in 10.363 sec
Iter: 6, Total Loss: 0.005879 in 10.397 sec
Iter: 7, Total Loss: 0.005796 in 11.053 sec
Iter: 8, Total Loss: 0.005722 in 10.533 sec
Iter: 9, Total Loss: 0.005656 in 10.500 sec
Iter: 10, Total Loss: 0.005597 in 10.476 sec
Iter: 11, Total Loss: 0.005547 in 10.503 sec
Iter: 12, Total Loss: 0.005504 in 10.552 sec
Iter: 13, Total Loss: 0.005467 in 10.361 sec
Iter: 14, Total Loss: 0.005435 in 10.513 sec
Iter: 15, Total Loss: 0.005408 in 10.366 sec
Iter: 16, Total Loss: 0.005384 in 10.480 sec
Iter: 17, Total Loss: 0.005365 in 10.459 sec
Iter: 18, Total Loss: 0.005346 in 10.590 sec
Iter: 19, Total Loss: 0.00533 in 10.478 sec
Iter: 20, Total Loss: 0.005314 in 10.575 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 10.464 with std = 0.191 sec ###
### py4DSTEM ptycho solver is finished in 3 min 31.859 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 899.22 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 64, 3, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 593/16384 [00:00<00:02, 5927.90probe position/s]Normalizing amplitudes:   7%|▋         | 1205/16384 [00:00<00:02, 6034.92probe position/s]Normalizing amplitudes:  11%|█         | 1809/16384 [00:00<00:02, 6016.04probe position/s]Normalizing amplitudes:  15%|█▍        | 2411/16384 [00:00<00:02, 6011.09probe position/s]Normalizing amplitudes:  19%|█▊        | 3032/16384 [00:00<00:02, 6079.43probe position/s]Normalizing amplitudes:  22%|██▏       | 3650/16384 [00:00<00:02, 6109.47probe position/s]Normalizing amplitudes:  26%|██▌       | 4283/16384 [00:00<00:01, 6179.46probe position/s]Normalizing amplitudes:  30%|██▉       | 4901/16384 [00:00<00:01, 6138.09probe position/s]Normalizing amplitudes:  34%|███▎      | 5529/16384 [00:00<00:01, 6178.02probe position/s]Normalizing amplitudes:  38%|███▊      | 6147/16384 [00:01<00:01, 6101.82probe position/s]Normalizing amplitudes:  41%|████      | 6758/16384 [00:01<00:01, 5989.48probe position/s]Normalizing amplitudes:  45%|████▍     | 7363/16384 [00:01<00:01, 6005.15probe position/s]Normalizing amplitudes:  49%|████▊     | 7971/16384 [00:01<00:01, 6026.71probe position/s]Normalizing amplitudes:  52%|█████▏    | 8580/16384 [00:01<00:01, 6045.35probe position/s]Normalizing amplitudes:  56%|█████▌    | 9185/16384 [00:01<00:01, 5966.97probe position/s]Normalizing amplitudes:  60%|█████▉    | 9783/16384 [00:01<00:01, 5939.34probe position/s]Normalizing amplitudes:  63%|██████▎   | 10378/16384 [00:01<00:01, 5866.26probe position/s]Normalizing amplitudes:  67%|██████▋   | 10984/16384 [00:01<00:00, 5922.51probe position/s]Normalizing amplitudes:  71%|███████   | 11623/16384 [00:01<00:00, 6058.44probe position/s]Normalizing amplitudes:  75%|███████▍  | 12250/16384 [00:02<00:00, 6118.45probe position/s]Normalizing amplitudes:  79%|███████▊  | 12863/16384 [00:02<00:00, 6069.56probe position/s]Normalizing amplitudes:  82%|████████▏ | 13471/16384 [00:02<00:00, 6018.33probe position/s]Normalizing amplitudes:  86%|████████▌ | 14074/16384 [00:02<00:00, 5967.24probe position/s]Normalizing amplitudes:  90%|████████▉ | 14687/16384 [00:02<00:00, 6013.82probe position/s]Normalizing amplitudes:  93%|█████████▎| 15301/16384 [00:02<00:00, 6050.25probe position/s]Normalizing amplitudes:  97%|█████████▋| 15920/16384 [00:02<00:00, 6090.34probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6041.39probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random64_p3_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random64_p3_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.01157 in 20.522 sec
Iter: 2, Total Loss: 0.006313 in 20.392 sec
Iter: 3, Total Loss: 0.006162 in 20.393 sec
Iter: 4, Total Loss: 0.006036 in 20.335 sec
Iter: 5, Total Loss: 0.005919 in 20.395 sec
Iter: 6, Total Loss: 0.005815 in 20.291 sec
Iter: 7, Total Loss: 0.00572 in 20.140 sec
Iter: 8, Total Loss: 0.005638 in 20.458 sec
Iter: 9, Total Loss: 0.005568 in 21.757 sec
Iter: 10, Total Loss: 0.005508 in 20.908 sec
Iter: 11, Total Loss: 0.005457 in 19.842 sec
Iter: 12, Total Loss: 0.005413 in 19.540 sec
Iter: 13, Total Loss: 0.005376 in 19.840 sec
Iter: 14, Total Loss: 0.005343 in 19.638 sec
Iter: 15, Total Loss: 0.005313 in 19.145 sec
Iter: 16, Total Loss: 0.005285 in 20.791 sec
Iter: 17, Total Loss: 0.005259 in 22.415 sec
Iter: 18, Total Loss: 0.005235 in 21.103 sec
Iter: 19, Total Loss: 0.005211 in 21.049 sec
Iter: 20, Total Loss: 0.005189 in 21.001 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 20.498 with std = 0.742 sec ###
### py4DSTEM ptycho solver is finished in 6 min 52.629 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 899.16 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 64, 6, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 612/16384 [00:00<00:02, 6118.85probe position/s]Normalizing amplitudes:   7%|▋         | 1224/16384 [00:00<00:02, 6048.96probe position/s]Normalizing amplitudes:  11%|█         | 1840/16384 [00:00<00:02, 6097.03probe position/s]Normalizing amplitudes:  15%|█▍        | 2450/16384 [00:00<00:02, 6055.11probe position/s]Normalizing amplitudes:  19%|█▊        | 3056/16384 [00:00<00:02, 5831.00probe position/s]Normalizing amplitudes:  22%|██▏       | 3641/16384 [00:00<00:02, 5687.70probe position/s]Normalizing amplitudes:  26%|██▌       | 4264/16384 [00:00<00:02, 5857.85probe position/s]Normalizing amplitudes:  30%|███       | 4944/16384 [00:00<00:01, 6149.71probe position/s]Normalizing amplitudes:  34%|███▍      | 5561/16384 [00:00<00:01, 6001.81probe position/s]Normalizing amplitudes:  38%|███▊      | 6163/16384 [00:01<00:01, 5819.96probe position/s]Normalizing amplitudes:  41%|████      | 6747/16384 [00:01<00:01, 5745.10probe position/s]Normalizing amplitudes:  45%|████▍     | 7323/16384 [00:01<00:01, 5666.75probe position/s]Normalizing amplitudes:  48%|████▊     | 7944/16384 [00:01<00:01, 5824.88probe position/s]Normalizing amplitudes:  52%|█████▏    | 8535/16384 [00:01<00:01, 5849.41probe position/s]Normalizing amplitudes:  56%|█████▌    | 9157/16384 [00:01<00:01, 5958.17probe position/s]Normalizing amplitudes:  60%|█████▉    | 9766/16384 [00:01<00:01, 5996.65probe position/s]Normalizing amplitudes:  63%|██████▎   | 10367/16384 [00:01<00:01, 5924.59probe position/s]Normalizing amplitudes:  67%|██████▋   | 11020/16384 [00:01<00:00, 6102.57probe position/s]Normalizing amplitudes:  71%|███████   | 11631/16384 [00:01<00:00, 6056.23probe position/s]Normalizing amplitudes:  75%|███████▍  | 12264/16384 [00:02<00:00, 6133.70probe position/s]Normalizing amplitudes:  79%|███████▊  | 12878/16384 [00:02<00:00, 6005.11probe position/s]Normalizing amplitudes:  82%|████████▏ | 13480/16384 [00:02<00:00, 5921.72probe position/s]Normalizing amplitudes:  86%|████████▌ | 14075/16384 [00:02<00:00, 5928.69probe position/s]Normalizing amplitudes:  90%|████████▉ | 14691/16384 [00:02<00:00, 5995.31probe position/s]Normalizing amplitudes:  93%|█████████▎| 15295/16384 [00:02<00:00, 6006.19probe position/s]Normalizing amplitudes:  97%|█████████▋| 15922/16384 [00:02<00:00, 6083.35probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5963.43probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random64_p6_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random64_p6_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.0194 in 7.625 sec
Iter: 2, Total Loss: 0.006458 in 7.523 sec
Iter: 3, Total Loss: 0.006312 in 7.455 sec
Iter: 4, Total Loss: 0.006204 in 7.424 sec
Iter: 5, Total Loss: 0.006104 in 7.284 sec
Iter: 6, Total Loss: 0.006008 in 7.371 sec
Iter: 7, Total Loss: 0.005916 in 7.446 sec
Iter: 8, Total Loss: 0.005831 in 7.325 sec
Iter: 9, Total Loss: 0.005755 in 7.460 sec
Iter: 10, Total Loss: 0.005685 in 7.356 sec
Iter: 11, Total Loss: 0.005623 in 7.471 sec
Iter: 12, Total Loss: 0.005565 in 7.283 sec
Iter: 13, Total Loss: 0.005512 in 7.459 sec
Iter: 14, Total Loss: 0.005461 in 7.411 sec
Iter: 15, Total Loss: 0.005414 in 7.380 sec
Iter: 16, Total Loss: 0.005368 in 7.426 sec
Iter: 17, Total Loss: 0.005325 in 7.364 sec
Iter: 18, Total Loss: 0.005283 in 7.353 sec
Iter: 19, Total Loss: 0.005242 in 7.555 sec
Iter: 20, Total Loss: 0.005202 in 7.467 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 7.422 with std = 0.085 sec ###
### py4DSTEM ptycho solver is finished in 2 min 31.199 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 899.04 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 64, 6, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 557/16384 [00:00<00:02, 5566.21probe position/s]Normalizing amplitudes:   7%|▋         | 1156/16384 [00:00<00:02, 5810.22probe position/s]Normalizing amplitudes:  11%|█         | 1738/16384 [00:00<00:02, 5718.34probe position/s]Normalizing amplitudes:  14%|█▍        | 2311/16384 [00:00<00:02, 5510.81probe position/s]Normalizing amplitudes:  18%|█▊        | 2890/16384 [00:00<00:02, 5606.90probe position/s]Normalizing amplitudes:  21%|██▏       | 3497/16384 [00:00<00:02, 5759.36probe position/s]Normalizing amplitudes:  25%|██▌       | 4105/16384 [00:00<00:02, 5860.49probe position/s]Normalizing amplitudes:  29%|██▊       | 4692/16384 [00:00<00:02, 5842.29probe position/s]Normalizing amplitudes:  32%|███▏      | 5277/16384 [00:00<00:01, 5820.57probe position/s]Normalizing amplitudes:  36%|███▌      | 5877/16384 [00:01<00:01, 5874.04probe position/s]Normalizing amplitudes:  39%|███▉      | 6465/16384 [00:01<00:01, 5747.13probe position/s]Normalizing amplitudes:  43%|████▎     | 7041/16384 [00:01<00:01, 5724.05probe position/s]Normalizing amplitudes:  47%|████▋     | 7642/16384 [00:01<00:01, 5807.47probe position/s]Normalizing amplitudes:  50%|█████     | 8224/16384 [00:01<00:01, 5788.98probe position/s]Normalizing amplitudes:  54%|█████▎    | 8804/16384 [00:01<00:01, 5675.38probe position/s]Normalizing amplitudes:  57%|█████▋    | 9373/16384 [00:01<00:01, 5626.67probe position/s]Normalizing amplitudes:  61%|██████    | 9956/16384 [00:01<00:01, 5683.38probe position/s]Normalizing amplitudes:  64%|██████▍   | 10543/16384 [00:01<00:01, 5737.48probe position/s]Normalizing amplitudes:  68%|██████▊   | 11163/16384 [00:01<00:00, 5873.80probe position/s]Normalizing amplitudes:  72%|███████▏  | 11751/16384 [00:02<00:00, 5830.96probe position/s]Normalizing amplitudes:  75%|███████▌  | 12335/16384 [00:02<00:00, 5823.25probe position/s]Normalizing amplitudes:  79%|███████▉  | 12927/16384 [00:02<00:00, 5848.94probe position/s]Normalizing amplitudes:  82%|████████▏ | 13513/16384 [00:02<00:00, 5834.81probe position/s]Normalizing amplitudes:  86%|████████▌ | 14108/16384 [00:02<00:00, 5867.90probe position/s]Normalizing amplitudes:  90%|████████▉ | 14699/16384 [00:02<00:00, 5878.18probe position/s]Normalizing amplitudes:  93%|█████████▎| 15316/16384 [00:02<00:00, 5964.65probe position/s]Normalizing amplitudes:  97%|█████████▋| 15913/16384 [00:02<00:00, 5795.41probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5773.12probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random64_p6_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random64_p6_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.0203 in 21.031 sec
Iter: 2, Total Loss: 0.006383 in 21.057 sec
Iter: 3, Total Loss: 0.006148 in 20.969 sec
Iter: 4, Total Loss: 0.006001 in 20.925 sec
Iter: 5, Total Loss: 0.00587 in 20.658 sec
Iter: 6, Total Loss: 0.005751 in 19.801 sec
Iter: 7, Total Loss: 0.005651 in 19.873 sec
Iter: 8, Total Loss: 0.005564 in 20.816 sec
Iter: 9, Total Loss: 0.00549 in 20.207 sec
Iter: 10, Total Loss: 0.005423 in 19.638 sec
Iter: 11, Total Loss: 0.005359 in 19.890 sec
Iter: 12, Total Loss: 0.0053 in 20.327 sec
Iter: 13, Total Loss: 0.005244 in 20.626 sec
Iter: 14, Total Loss: 0.005191 in 20.606 sec
Iter: 15, Total Loss: 0.00514 in 20.250 sec
Iter: 16, Total Loss: 0.005091 in 20.460 sec
Iter: 17, Total Loss: 0.005043 in 20.385 sec
Iter: 18, Total Loss: 0.004997 in 20.553 sec
Iter: 19, Total Loss: 0.004956 in 20.998 sec
Iter: 20, Total Loss: 0.004917 in 20.306 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 20.469 with std = 0.424 sec ###
### py4DSTEM ptycho solver is finished in 6 min 52.137 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 899.26 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 64, 6, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 636/16384 [00:00<00:02, 6353.64probe position/s]Normalizing amplitudes:   8%|▊         | 1272/16384 [00:00<00:02, 6263.41probe position/s]Normalizing amplitudes:  12%|█▏        | 1899/16384 [00:00<00:02, 6159.40probe position/s]Normalizing amplitudes:  15%|█▌        | 2516/16384 [00:00<00:02, 6113.65probe position/s]Normalizing amplitudes:  19%|█▉        | 3152/16384 [00:00<00:02, 6199.62probe position/s]Normalizing amplitudes:  23%|██▎       | 3784/16384 [00:00<00:02, 6239.68probe position/s]Normalizing amplitudes:  27%|██▋       | 4409/16384 [00:00<00:01, 6204.05probe position/s]Normalizing amplitudes:  31%|███       | 5031/16384 [00:00<00:01, 6207.69probe position/s]Normalizing amplitudes:  35%|███▍      | 5671/16384 [00:00<00:01, 6263.88probe position/s]Normalizing amplitudes:  38%|███▊      | 6301/16384 [00:01<00:01, 6271.98probe position/s]Normalizing amplitudes:  42%|████▏     | 6935/16384 [00:01<00:01, 6292.29probe position/s]Normalizing amplitudes:  46%|████▌     | 7565/16384 [00:01<00:01, 6134.95probe position/s]Normalizing amplitudes:  50%|████▉     | 8182/16384 [00:01<00:01, 6143.60probe position/s]Normalizing amplitudes:  54%|█████▍    | 8811/16384 [00:01<00:01, 6185.32probe position/s]Normalizing amplitudes:  58%|█████▊    | 9431/16384 [00:01<00:01, 6117.18probe position/s]Normalizing amplitudes:  61%|██████▏   | 10052/16384 [00:01<00:01, 6142.90probe position/s]Normalizing amplitudes:  65%|██████▌   | 10667/16384 [00:01<00:00, 6122.65probe position/s]Normalizing amplitudes:  69%|██████▉   | 11280/16384 [00:01<00:00, 6115.68probe position/s]Normalizing amplitudes:  73%|███████▎  | 11908/16384 [00:01<00:00, 6163.77probe position/s]Normalizing amplitudes:  76%|███████▋  | 12525/16384 [00:02<00:00, 6121.36probe position/s]Normalizing amplitudes:  80%|████████  | 13151/16384 [00:02<00:00, 6160.90probe position/s]Normalizing amplitudes:  84%|████████▍ | 13772/16384 [00:02<00:00, 6166.96probe position/s]Normalizing amplitudes:  88%|████████▊ | 14389/16384 [00:02<00:00, 6117.67probe position/s]Normalizing amplitudes:  92%|█████████▏| 15031/16384 [00:02<00:00, 6206.53probe position/s]Normalizing amplitudes:  96%|█████████▌| 15652/16384 [00:02<00:00, 6188.15probe position/s]Normalizing amplitudes:  99%|█████████▉| 16298/16384 [00:02<00:00, 6266.71probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6188.43probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random64_p6_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random64_p6_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.02048 in 40.081 sec
Iter: 2, Total Loss: 0.006289 in 39.969 sec
Iter: 3, Total Loss: 0.006052 in 39.908 sec
Iter: 4, Total Loss: 0.005894 in 40.094 sec
Iter: 5, Total Loss: 0.005754 in 38.794 sec
Iter: 6, Total Loss: 0.005632 in 38.331 sec
Iter: 7, Total Loss: 0.005526 in 39.159 sec
Iter: 8, Total Loss: 0.005438 in 39.694 sec
Iter: 9, Total Loss: 0.005361 in 40.105 sec
Iter: 10, Total Loss: 0.005292 in 40.413 sec
Iter: 11, Total Loss: 0.005231 in 40.392 sec
Iter: 12, Total Loss: 0.005175 in 40.250 sec
Iter: 13, Total Loss: 0.005125 in 41.710 sec
Iter: 14, Total Loss: 0.005079 in 40.720 sec
Iter: 15, Total Loss: 0.005034 in 41.193 sec
Iter: 16, Total Loss: 0.004992 in 39.931 sec
Iter: 17, Total Loss: 0.004953 in 39.641 sec
Iter: 18, Total Loss: 0.004915 in 38.903 sec
Iter: 19, Total Loss: 0.00488 in 39.173 sec
Iter: 20, Total Loss: 0.004847 in 39.740 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 39.910 with std = 0.783 sec ###
### py4DSTEM ptycho solver is finished in 13 min 21.018 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 900.34 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 64, 12, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 642/16384 [00:00<00:02, 6417.63probe position/s]Normalizing amplitudes:   8%|▊         | 1284/16384 [00:00<00:02, 6388.45probe position/s]Normalizing amplitudes:  12%|█▏        | 1968/16384 [00:00<00:02, 6592.17probe position/s]Normalizing amplitudes:  16%|█▌        | 2628/16384 [00:00<00:02, 6405.89probe position/s]Normalizing amplitudes:  20%|█▉        | 3270/16384 [00:00<00:02, 6367.86probe position/s]Normalizing amplitudes:  24%|██▍       | 3908/16384 [00:00<00:02, 6182.51probe position/s]Normalizing amplitudes:  28%|██▊       | 4528/16384 [00:00<00:01, 6025.93probe position/s]Normalizing amplitudes:  31%|███▏      | 5143/16384 [00:00<00:01, 6060.83probe position/s]Normalizing amplitudes:  35%|███▌      | 5762/16384 [00:00<00:01, 6098.86probe position/s]Normalizing amplitudes:  39%|███▉      | 6433/16384 [00:01<00:01, 6283.08probe position/s]Normalizing amplitudes:  43%|████▎     | 7084/16384 [00:01<00:01, 6350.70probe position/s]Normalizing amplitudes:  47%|████▋     | 7720/16384 [00:01<00:01, 6234.66probe position/s]Normalizing amplitudes:  51%|█████     | 8345/16384 [00:01<00:01, 6159.81probe position/s]Normalizing amplitudes:  55%|█████▍    | 8962/16384 [00:01<00:01, 4589.99probe position/s]Normalizing amplitudes:  58%|█████▊    | 9572/16384 [00:01<00:01, 4948.79probe position/s]Normalizing amplitudes:  62%|██████▏   | 10152/16384 [00:01<00:01, 5164.03probe position/s]Normalizing amplitudes:  65%|██████▌   | 10710/16384 [00:01<00:01, 5274.42probe position/s]Normalizing amplitudes:  69%|██████▉   | 11315/16384 [00:01<00:00, 5486.37probe position/s]Normalizing amplitudes:  73%|███████▎  | 11948/16384 [00:02<00:00, 5721.88probe position/s]Normalizing amplitudes:  77%|███████▋  | 12614/16384 [00:02<00:00, 5991.25probe position/s]Normalizing amplitudes:  81%|████████  | 13241/16384 [00:02<00:00, 6069.83probe position/s]Normalizing amplitudes:  85%|████████▍ | 13858/16384 [00:02<00:00, 6020.34probe position/s]Normalizing amplitudes:  88%|████████▊ | 14467/16384 [00:02<00:00, 5666.99probe position/s]Normalizing amplitudes:  92%|█████████▏| 15104/16384 [00:02<00:00, 5862.51probe position/s]Normalizing amplitudes:  96%|█████████▌| 15702/16384 [00:02<00:00, 5895.17probe position/s]Normalizing amplitudes: 100%|█████████▉| 16336/16384 [00:02<00:00, 6024.39probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5870.06probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random64_p12_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random64_p12_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.0407 in 14.854 sec
Iter: 2, Total Loss: 0.006461 in 13.930 sec
Iter: 3, Total Loss: 0.006319 in 13.726 sec
Iter: 4, Total Loss: 0.006214 in 13.831 sec
Iter: 5, Total Loss: 0.006113 in 13.680 sec
Iter: 6, Total Loss: 0.006016 in 13.613 sec
Iter: 7, Total Loss: 0.00592 in 13.704 sec
Iter: 8, Total Loss: 0.005831 in 14.649 sec
Iter: 9, Total Loss: 0.005748 in 14.596 sec
Iter: 10, Total Loss: 0.005672 in 13.959 sec
Iter: 11, Total Loss: 0.005602 in 13.997 sec
Iter: 12, Total Loss: 0.005541 in 13.762 sec
Iter: 13, Total Loss: 0.005483 in 13.673 sec
Iter: 14, Total Loss: 0.00543 in 13.925 sec
Iter: 15, Total Loss: 0.005381 in 13.807 sec
Iter: 16, Total Loss: 0.005333 in 14.069 sec
Iter: 17, Total Loss: 0.005287 in 13.798 sec
Iter: 18, Total Loss: 0.005241 in 14.038 sec
Iter: 19, Total Loss: 0.005194 in 13.868 sec
Iter: 20, Total Loss: 0.005148 in 13.676 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 13.958 with std = 0.339 sec ###
### py4DSTEM ptycho solver is finished in 4 min 41.895 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 911.62 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 64, 12, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 507/16384 [00:00<00:03, 5061.92probe position/s]Normalizing amplitudes:   6%|▌         | 1014/16384 [00:00<00:05, 2862.12probe position/s]Normalizing amplitudes:  10%|▉         | 1633/16384 [00:00<00:03, 3931.83probe position/s]Normalizing amplitudes:  14%|█▎        | 2230/16384 [00:00<00:03, 4571.22probe position/s]Normalizing amplitudes:  17%|█▋        | 2770/16384 [00:00<00:02, 4827.45probe position/s]Normalizing amplitudes:  21%|██        | 3360/16384 [00:00<00:02, 5156.42probe position/s]Normalizing amplitudes:  25%|██▍       | 4023/16384 [00:00<00:02, 5603.09probe position/s]Normalizing amplitudes:  28%|██▊       | 4632/16384 [00:00<00:02, 5746.23probe position/s]Normalizing amplitudes:  32%|███▏      | 5224/16384 [00:01<00:01, 5633.76probe position/s]Normalizing amplitudes:  35%|███▌      | 5800/16384 [00:01<00:01, 5477.40probe position/s]Normalizing amplitudes:  39%|███▉      | 6357/16384 [00:01<00:01, 5479.81probe position/s]Normalizing amplitudes:  42%|████▏     | 6912/16384 [00:01<00:01, 5499.60probe position/s]Normalizing amplitudes:  46%|████▌     | 7513/16384 [00:01<00:01, 5649.10probe position/s]Normalizing amplitudes:  50%|████▉     | 8127/16384 [00:01<00:01, 5793.65probe position/s]Normalizing amplitudes:  53%|█████▎    | 8763/16384 [00:01<00:01, 5958.80probe position/s]Normalizing amplitudes:  57%|█████▋    | 9407/16384 [00:01<00:01, 6099.60probe position/s]Normalizing amplitudes:  61%|██████    | 10019/16384 [00:01<00:01, 6099.82probe position/s]Normalizing amplitudes:  65%|██████▍   | 10631/16384 [00:01<00:00, 5916.77probe position/s]Normalizing amplitudes:  69%|██████▊   | 11225/16384 [00:02<00:00, 5331.96probe position/s]Normalizing amplitudes:  72%|███████▏  | 11790/16384 [00:02<00:00, 5417.59probe position/s]Normalizing amplitudes:  76%|███████▌  | 12405/16384 [00:02<00:00, 5622.78probe position/s]Normalizing amplitudes:  80%|███████▉  | 13030/16384 [00:02<00:00, 5801.83probe position/s]Normalizing amplitudes:  83%|████████▎ | 13673/16384 [00:02<00:00, 5983.96probe position/s]Normalizing amplitudes:  87%|████████▋ | 14312/16384 [00:02<00:00, 6101.84probe position/s]Normalizing amplitudes:  91%|█████████ | 14939/16384 [00:02<00:00, 6148.87probe position/s]Normalizing amplitudes:  95%|█████████▍| 15557/16384 [00:02<00:00, 6063.24probe position/s]Normalizing amplitudes:  99%|█████████▊| 16166/16384 [00:02<00:00, 6026.09probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5556.62probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random64_p12_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random64_p12_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.04128 in 39.277 sec
Iter: 2, Total Loss: 0.00635 in 38.241 sec
Iter: 3, Total Loss: 0.006126 in 37.915 sec
Iter: 4, Total Loss: 0.005971 in 37.466 sec
Iter: 5, Total Loss: 0.005828 in 37.806 sec
Iter: 6, Total Loss: 0.0057 in 37.778 sec
Iter: 7, Total Loss: 0.005587 in 39.430 sec
Iter: 8, Total Loss: 0.005491 in 41.287 sec
Iter: 9, Total Loss: 0.00541 in 39.640 sec
Iter: 10, Total Loss: 0.005339 in 39.989 sec
Iter: 11, Total Loss: 0.005276 in 39.353 sec
Iter: 12, Total Loss: 0.005218 in 40.619 sec
Iter: 13, Total Loss: 0.005162 in 39.776 sec
Iter: 14, Total Loss: 0.00511 in 39.637 sec
Iter: 15, Total Loss: 0.00506 in 39.764 sec
Iter: 16, Total Loss: 0.005011 in 38.867 sec
Iter: 17, Total Loss: 0.004964 in 38.594 sec
Iter: 18, Total Loss: 0.004918 in 38.573 sec
Iter: 19, Total Loss: 0.004875 in 39.846 sec
Iter: 20, Total Loss: 0.004837 in 40.722 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 39.229 with std = 1.030 sec ###
### py4DSTEM ptycho solver is finished in 13 min 7.298 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 899.04 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 64, 12, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 563/16384 [00:00<00:02, 5623.11probe position/s]Normalizing amplitudes:   7%|▋         | 1196/16384 [00:00<00:02, 6034.65probe position/s]Normalizing amplitudes:  11%|█         | 1821/16384 [00:00<00:02, 6131.90probe position/s]Normalizing amplitudes:  15%|█▍        | 2435/16384 [00:00<00:02, 6029.55probe position/s]Normalizing amplitudes:  19%|█▊        | 3057/16384 [00:00<00:02, 6094.11probe position/s]Normalizing amplitudes:  22%|██▏       | 3679/16384 [00:00<00:02, 6136.33probe position/s]Normalizing amplitudes:  26%|██▌       | 4300/16384 [00:00<00:01, 6159.98probe position/s]Normalizing amplitudes:  30%|███       | 4925/16384 [00:00<00:01, 6188.35probe position/s]Normalizing amplitudes:  34%|███▍      | 5544/16384 [00:00<00:01, 6090.12probe position/s]Normalizing amplitudes:  38%|███▊      | 6154/16384 [00:01<00:01, 6048.97probe position/s]Normalizing amplitudes:  41%|████▏     | 6790/16384 [00:01<00:01, 6141.71probe position/s]Normalizing amplitudes:  45%|████▌     | 7405/16384 [00:01<00:01, 6120.30probe position/s]Normalizing amplitudes:  49%|████▉     | 8018/16384 [00:01<00:01, 5903.95probe position/s]Normalizing amplitudes:  53%|█████▎    | 8611/16384 [00:01<00:01, 5696.90probe position/s]Normalizing amplitudes:  56%|█████▋    | 9220/16384 [00:01<00:01, 5809.10probe position/s]Normalizing amplitudes:  60%|█████▉    | 9824/16384 [00:01<00:01, 5874.82probe position/s]Normalizing amplitudes:  64%|██████▎   | 10427/16384 [00:01<00:01, 5918.00probe position/s]Normalizing amplitudes:  67%|██████▋   | 11042/16384 [00:01<00:00, 5984.35probe position/s]Normalizing amplitudes:  71%|███████▏  | 11683/16384 [00:01<00:00, 6109.56probe position/s]Normalizing amplitudes:  75%|███████▌  | 12321/16384 [00:02<00:00, 6189.52probe position/s]Normalizing amplitudes:  79%|███████▉  | 12941/16384 [00:02<00:00, 6107.61probe position/s]Normalizing amplitudes:  83%|████████▎ | 13579/16384 [00:02<00:00, 6185.43probe position/s]Normalizing amplitudes:  87%|████████▋ | 14199/16384 [00:02<00:00, 6187.65probe position/s]Normalizing amplitudes:  90%|█████████ | 14819/16384 [00:02<00:00, 6058.76probe position/s]Normalizing amplitudes:  94%|█████████▍| 15426/16384 [00:02<00:00, 5839.44probe position/s]Normalizing amplitudes:  98%|█████████▊| 16012/16384 [00:02<00:00, 5789.37probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5995.66probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random64_p12_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random64_p12_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.04358 in 80.138 sec
Iter: 2, Total Loss: 0.00647 in 81.215 sec
Iter: 3, Total Loss: 0.006037 in 79.213 sec
Iter: 4, Total Loss: 0.005842 in 78.305 sec
Iter: 5, Total Loss: 0.005684 in 78.158 sec
Iter: 6, Total Loss: 0.005551 in 79.293 sec
Iter: 7, Total Loss: 0.005442 in 79.779 sec
Iter: 8, Total Loss: 0.005355 in 78.933 sec
Iter: 9, Total Loss: 0.005279 in 80.065 sec
Iter: 10, Total Loss: 0.00521 in 78.863 sec
Iter: 11, Total Loss: 0.005147 in 77.967 sec
Iter: 12, Total Loss: 0.005088 in 79.297 sec
Iter: 13, Total Loss: 0.005032 in 78.579 sec
Iter: 14, Total Loss: 0.004978 in 79.624 sec
Iter: 15, Total Loss: 0.004925 in 78.977 sec
Iter: 16, Total Loss: 0.004875 in 76.533 sec
Iter: 17, Total Loss: 0.004829 in 78.182 sec
Iter: 18, Total Loss: 0.004788 in 77.157 sec
Iter: 19, Total Loss: 0.004752 in 78.077 sec
Iter: 20, Total Loss: 0.00472 in 77.211 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 78.778 with std = 1.101 sec ###
### py4DSTEM ptycho solver is finished in 26 min 18.254 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 899.03 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 32, 1, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 615/16384 [00:00<00:02, 6140.31probe position/s]Normalizing amplitudes:   8%|▊         | 1232/16384 [00:00<00:02, 6153.14probe position/s]Normalizing amplitudes:  11%|█▏        | 1866/16384 [00:00<00:02, 6233.83probe position/s]Normalizing amplitudes:  15%|█▌        | 2490/16384 [00:00<00:02, 6164.51probe position/s]Normalizing amplitudes:  19%|█▉        | 3122/16384 [00:00<00:02, 6218.61probe position/s]Normalizing amplitudes:  23%|██▎       | 3744/16384 [00:00<00:02, 6208.78probe position/s]Normalizing amplitudes:  27%|██▋       | 4365/16384 [00:00<00:01, 6159.41probe position/s]Normalizing amplitudes:  30%|███       | 4986/16384 [00:00<00:01, 6173.04probe position/s]Normalizing amplitudes:  34%|███▍      | 5604/16384 [00:00<00:01, 5941.70probe position/s]Normalizing amplitudes:  38%|███▊      | 6247/16384 [00:01<00:01, 6086.42probe position/s]Normalizing amplitudes:  42%|████▏     | 6885/16384 [00:01<00:01, 6173.65probe position/s]Normalizing amplitudes:  46%|████▌     | 7504/16384 [00:01<00:01, 5884.22probe position/s]Normalizing amplitudes:  49%|████▉     | 8096/16384 [00:01<00:01, 5532.71probe position/s]Normalizing amplitudes:  53%|█████▎    | 8655/16384 [00:01<00:01, 5131.17probe position/s]Normalizing amplitudes:  57%|█████▋    | 9278/16384 [00:01<00:01, 5426.51probe position/s]Normalizing amplitudes:  60%|██████    | 9905/16384 [00:01<00:01, 5660.01probe position/s]Normalizing amplitudes:  64%|██████▍   | 10523/16384 [00:01<00:01, 5805.59probe position/s]Normalizing amplitudes:  68%|██████▊   | 11160/16384 [00:01<00:00, 5967.38probe position/s]Normalizing amplitudes:  72%|███████▏  | 11790/16384 [00:01<00:00, 6063.58probe position/s]Normalizing amplitudes:  76%|███████▌  | 12429/16384 [00:02<00:00, 6159.05probe position/s]Normalizing amplitudes:  80%|███████▉  | 13053/16384 [00:02<00:00, 6181.34probe position/s]Normalizing amplitudes:  83%|████████▎ | 13680/16384 [00:02<00:00, 6205.90probe position/s]Normalizing amplitudes:  87%|████████▋ | 14303/16384 [00:02<00:00, 6160.93probe position/s]Normalizing amplitudes:  91%|█████████ | 14921/16384 [00:02<00:00, 6150.99probe position/s]Normalizing amplitudes:  95%|█████████▍| 15537/16384 [00:02<00:00, 6140.72probe position/s]Normalizing amplitudes:  99%|█████████▉| 16191/16384 [00:02<00:00, 6257.58probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6018.41probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random32_p1_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random32_p1_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.00709 in 3.644 sec
Iter: 2, Total Loss: 0.006533 in 3.611 sec
Iter: 3, Total Loss: 0.006481 in 3.604 sec
Iter: 4, Total Loss: 0.006427 in 3.568 sec
Iter: 5, Total Loss: 0.006375 in 3.585 sec
Iter: 6, Total Loss: 0.006322 in 3.585 sec
Iter: 7, Total Loss: 0.00628 in 3.698 sec
Iter: 8, Total Loss: 0.00624 in 3.525 sec
Iter: 9, Total Loss: 0.006208 in 3.521 sec
Iter: 10, Total Loss: 0.006182 in 3.495 sec
Iter: 11, Total Loss: 0.006159 in 3.565 sec
Iter: 12, Total Loss: 0.006142 in 3.552 sec
Iter: 13, Total Loss: 0.006127 in 3.658 sec
Iter: 14, Total Loss: 0.006115 in 3.569 sec
Iter: 15, Total Loss: 0.006107 in 3.508 sec
Iter: 16, Total Loss: 0.006098 in 3.475 sec
Iter: 17, Total Loss: 0.006092 in 3.592 sec
Iter: 18, Total Loss: 0.006087 in 3.521 sec
Iter: 19, Total Loss: 0.006081 in 3.578 sec
Iter: 20, Total Loss: 0.006079 in 3.532 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 3.569 with std = 0.055 sec ###
### py4DSTEM ptycho solver is finished in 1 min 13.881 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 904.49 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 32, 1, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 629/16384 [00:00<00:02, 6285.23probe position/s]Normalizing amplitudes:   8%|▊         | 1266/16384 [00:00<00:02, 6332.20probe position/s]Normalizing amplitudes:  12%|█▏        | 1919/16384 [00:00<00:02, 6417.18probe position/s]Normalizing amplitudes:  16%|█▌        | 2561/16384 [00:00<00:02, 6327.66probe position/s]Normalizing amplitudes:  19%|█▉        | 3194/16384 [00:00<00:02, 6264.18probe position/s]Normalizing amplitudes:  23%|██▎       | 3821/16384 [00:00<00:02, 6094.83probe position/s]Normalizing amplitudes:  27%|██▋       | 4432/16384 [00:00<00:01, 6028.69probe position/s]Normalizing amplitudes:  31%|███       | 5036/16384 [00:00<00:01, 5958.70probe position/s]Normalizing amplitudes:  35%|███▍      | 5704/16384 [00:00<00:01, 6175.38probe position/s]Normalizing amplitudes:  39%|███▊      | 6323/16384 [00:01<00:01, 6117.30probe position/s]Normalizing amplitudes:  42%|████▏     | 6936/16384 [00:01<00:01, 6082.34probe position/s]Normalizing amplitudes:  46%|████▌     | 7545/16384 [00:01<00:01, 6028.99probe position/s]Normalizing amplitudes:  50%|████▉     | 8149/16384 [00:01<00:01, 6030.28probe position/s]Normalizing amplitudes:  54%|█████▎    | 8774/16384 [00:01<00:01, 6093.08probe position/s]Normalizing amplitudes:  57%|█████▋    | 9416/16384 [00:01<00:01, 6189.16probe position/s]Normalizing amplitudes:  61%|██████▏   | 10068/16384 [00:01<00:01, 6285.35probe position/s]Normalizing amplitudes:  65%|██████▌   | 10719/16384 [00:01<00:00, 6350.69probe position/s]Normalizing amplitudes:  69%|██████▉   | 11355/16384 [00:01<00:00, 6328.27probe position/s]Normalizing amplitudes:  73%|███████▎  | 11988/16384 [00:01<00:00, 6295.24probe position/s]Normalizing amplitudes:  77%|███████▋  | 12636/16384 [00:02<00:00, 6349.34probe position/s]Normalizing amplitudes:  81%|████████  | 13272/16384 [00:02<00:00, 6270.45probe position/s]Normalizing amplitudes:  85%|████████▍ | 13900/16384 [00:02<00:00, 6248.40probe position/s]Normalizing amplitudes:  89%|████████▊ | 14526/16384 [00:02<00:00, 6221.58probe position/s]Normalizing amplitudes:  93%|█████████▎| 15173/16384 [00:02<00:00, 6294.10probe position/s]Normalizing amplitudes:  97%|█████████▋| 15815/16384 [00:02<00:00, 6326.98probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6223.75probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random32_p1_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random32_p1_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.007136 in 8.444 sec
Iter: 2, Total Loss: 0.006529 in 8.221 sec
Iter: 3, Total Loss: 0.006456 in 8.225 sec
Iter: 4, Total Loss: 0.006391 in 8.063 sec
Iter: 5, Total Loss: 0.006334 in 8.061 sec
Iter: 6, Total Loss: 0.006284 in 7.983 sec
Iter: 7, Total Loss: 0.006242 in 7.918 sec
Iter: 8, Total Loss: 0.006206 in 8.072 sec
Iter: 9, Total Loss: 0.006177 in 7.986 sec
Iter: 10, Total Loss: 0.006153 in 7.935 sec
Iter: 11, Total Loss: 0.006132 in 8.369 sec
Iter: 12, Total Loss: 0.006116 in 7.993 sec
Iter: 13, Total Loss: 0.0061 in 7.994 sec
Iter: 14, Total Loss: 0.00609 in 8.224 sec
Iter: 15, Total Loss: 0.006079 in 8.191 sec
Iter: 16, Total Loss: 0.006071 in 8.221 sec
Iter: 17, Total Loss: 0.006063 in 8.292 sec
Iter: 18, Total Loss: 0.006054 in 8.747 sec
Iter: 19, Total Loss: 0.006049 in 8.099 sec
Iter: 20, Total Loss: 0.006042 in 8.317 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 8.168 with std = 0.198 sec ###
### py4DSTEM ptycho solver is finished in 2 min 46.192 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 900.29 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 32, 1, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 591/16384 [00:00<00:02, 5905.15probe position/s]Normalizing amplitudes:   7%|▋         | 1215/16384 [00:00<00:02, 6101.93probe position/s]Normalizing amplitudes:  11%|█         | 1826/16384 [00:00<00:02, 6017.40probe position/s]Normalizing amplitudes:  15%|█▍        | 2428/16384 [00:00<00:02, 5997.63probe position/s]Normalizing amplitudes:  19%|█▊        | 3067/16384 [00:00<00:02, 6136.89probe position/s]Normalizing amplitudes:  22%|██▏       | 3681/16384 [00:00<00:02, 6035.54probe position/s]Normalizing amplitudes:  26%|██▌       | 4288/16384 [00:00<00:02, 6039.86probe position/s]Normalizing amplitudes:  30%|███       | 4916/16384 [00:00<00:01, 6112.60probe position/s]Normalizing amplitudes:  34%|███▎      | 5528/16384 [00:00<00:01, 6087.08probe position/s]Normalizing amplitudes:  38%|███▊      | 6146/16384 [00:01<00:01, 6115.21probe position/s]Normalizing amplitudes:  41%|████▏     | 6779/16384 [00:01<00:01, 6179.89probe position/s]Normalizing amplitudes:  45%|████▌     | 7401/16384 [00:01<00:01, 6191.94probe position/s]Normalizing amplitudes:  49%|████▉     | 8021/16384 [00:01<00:01, 6168.19probe position/s]Normalizing amplitudes:  53%|█████▎    | 8638/16384 [00:01<00:01, 6136.94probe position/s]Normalizing amplitudes:  57%|█████▋    | 9258/16384 [00:01<00:01, 6154.52probe position/s]Normalizing amplitudes:  60%|██████    | 9895/16384 [00:01<00:01, 6218.49probe position/s]Normalizing amplitudes:  64%|██████▍   | 10517/16384 [00:01<00:00, 6033.47probe position/s]Normalizing amplitudes:  68%|██████▊   | 11122/16384 [00:01<00:00, 5959.35probe position/s]Normalizing amplitudes:  72%|███████▏  | 11751/16384 [00:01<00:00, 6052.10probe position/s]Normalizing amplitudes:  75%|███████▌  | 12358/16384 [00:02<00:00, 5978.87probe position/s]Normalizing amplitudes:  79%|███████▉  | 12957/16384 [00:02<00:00, 5737.98probe position/s]Normalizing amplitudes:  83%|████████▎ | 13538/16384 [00:02<00:00, 5757.38probe position/s]Normalizing amplitudes:  86%|████████▌ | 14116/16384 [00:02<00:00, 5734.73probe position/s]Normalizing amplitudes:  90%|████████▉ | 14739/16384 [00:02<00:00, 5877.73probe position/s]Normalizing amplitudes:  94%|█████████▍| 15383/16384 [00:02<00:00, 6040.37probe position/s]Normalizing amplitudes:  98%|█████████▊| 15992/16384 [00:02<00:00, 6054.04probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6037.26probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random32_p1_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random32_p1_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.007238 in 15.384 sec
Iter: 2, Total Loss: 0.006565 in 15.256 sec
Iter: 3, Total Loss: 0.006481 in 15.629 sec
Iter: 4, Total Loss: 0.00641 in 15.668 sec
Iter: 5, Total Loss: 0.006355 in 15.437 sec
Iter: 6, Total Loss: 0.006305 in 15.616 sec
Iter: 7, Total Loss: 0.006259 in 15.858 sec
Iter: 8, Total Loss: 0.006222 in 15.621 sec
Iter: 9, Total Loss: 0.006189 in 15.592 sec
Iter: 10, Total Loss: 0.00616 in 15.666 sec
Iter: 11, Total Loss: 0.006136 in 15.706 sec
Iter: 12, Total Loss: 0.006116 in 15.712 sec
Iter: 13, Total Loss: 0.006092 in 15.721 sec
Iter: 14, Total Loss: 0.006073 in 15.733 sec
Iter: 15, Total Loss: 0.006054 in 15.736 sec
Iter: 16, Total Loss: 0.006037 in 15.695 sec
Iter: 17, Total Loss: 0.006018 in 15.993 sec
Iter: 18, Total Loss: 0.005999 in 15.648 sec
Iter: 19, Total Loss: 0.005984 in 15.684 sec
Iter: 20, Total Loss: 0.005972 in 15.269 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 15.631 with std = 0.174 sec ###
### py4DSTEM ptycho solver is finished in 5 min 15.370 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 902.13 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 32, 3, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 600/16384 [00:00<00:02, 5998.40probe position/s]Normalizing amplitudes:   7%|▋         | 1203/16384 [00:00<00:02, 6015.57probe position/s]Normalizing amplitudes:  11%|█         | 1806/16384 [00:00<00:02, 6019.81probe position/s]Normalizing amplitudes:  15%|█▍        | 2427/16384 [00:00<00:02, 6093.86probe position/s]Normalizing amplitudes:  19%|█▊        | 3041/16384 [00:00<00:02, 6109.71probe position/s]Normalizing amplitudes:  22%|██▏       | 3652/16384 [00:00<00:02, 6010.68probe position/s]Normalizing amplitudes:  26%|██▌       | 4254/16384 [00:00<00:02, 5887.10probe position/s]Normalizing amplitudes:  30%|██▉       | 4861/16384 [00:00<00:01, 5943.16probe position/s]Normalizing amplitudes:  33%|███▎      | 5456/16384 [00:00<00:01, 5920.91probe position/s]Normalizing amplitudes:  37%|███▋      | 6055/16384 [00:01<00:01, 5939.19probe position/s]Normalizing amplitudes:  41%|████      | 6650/16384 [00:01<00:01, 5938.86probe position/s]Normalizing amplitudes:  44%|████▍     | 7245/16384 [00:01<00:01, 5865.03probe position/s]Normalizing amplitudes:  48%|████▊     | 7838/16384 [00:01<00:01, 5882.68probe position/s]Normalizing amplitudes:  52%|█████▏    | 8442/16384 [00:01<00:01, 5927.92probe position/s]Normalizing amplitudes:  55%|█████▌    | 9035/16384 [00:01<00:01, 5903.23probe position/s]Normalizing amplitudes:  59%|█████▉    | 9631/16384 [00:01<00:01, 5918.28probe position/s]Normalizing amplitudes:  62%|██████▏   | 10232/16384 [00:01<00:01, 5943.51probe position/s]Normalizing amplitudes:  66%|██████▋   | 10865/16384 [00:01<00:00, 6057.46probe position/s]Normalizing amplitudes:  70%|███████   | 11473/16384 [00:01<00:00, 6063.97probe position/s]Normalizing amplitudes:  74%|███████▎  | 12082/16384 [00:02<00:00, 6069.19probe position/s]Normalizing amplitudes:  78%|███████▊  | 12708/16384 [00:02<00:00, 6124.45probe position/s]Normalizing amplitudes:  81%|████████▏ | 13321/16384 [00:02<00:00, 6124.78probe position/s]Normalizing amplitudes:  85%|████████▌ | 13971/16384 [00:02<00:00, 6236.33probe position/s]Normalizing amplitudes:  89%|████████▉ | 14595/16384 [00:02<00:00, 6212.59probe position/s]Normalizing amplitudes:  93%|█████████▎| 15217/16384 [00:02<00:00, 6152.99probe position/s]Normalizing amplitudes:  97%|█████████▋| 15861/16384 [00:02<00:00, 6236.66probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6038.73probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random32_p3_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random32_p3_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.008638 in 7.335 sec
Iter: 2, Total Loss: 0.006401 in 7.224 sec
Iter: 3, Total Loss: 0.006249 in 7.270 sec
Iter: 4, Total Loss: 0.006102 in 7.166 sec
Iter: 5, Total Loss: 0.005963 in 7.050 sec
Iter: 6, Total Loss: 0.005845 in 7.101 sec
Iter: 7, Total Loss: 0.005748 in 7.222 sec
Iter: 8, Total Loss: 0.005671 in 7.047 sec
Iter: 9, Total Loss: 0.005608 in 7.272 sec
Iter: 10, Total Loss: 0.005553 in 7.001 sec
Iter: 11, Total Loss: 0.005507 in 7.125 sec
Iter: 12, Total Loss: 0.005466 in 7.179 sec
Iter: 13, Total Loss: 0.005429 in 7.094 sec
Iter: 14, Total Loss: 0.005395 in 7.183 sec
Iter: 15, Total Loss: 0.005363 in 7.036 sec
Iter: 16, Total Loss: 0.005333 in 7.640 sec
Iter: 17, Total Loss: 0.005308 in 7.262 sec
Iter: 18, Total Loss: 0.005287 in 7.092 sec
Iter: 19, Total Loss: 0.005269 in 7.292 sec
Iter: 20, Total Loss: 0.005253 in 7.602 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 7.210 with std = 0.165 sec ###
### py4DSTEM ptycho solver is finished in 2 min 26.781 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 900.16 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 32, 3, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 616/16384 [00:00<00:02, 6132.74probe position/s]Normalizing amplitudes:   8%|▊         | 1230/16384 [00:00<00:02, 6091.24probe position/s]Normalizing amplitudes:  11%|█▏        | 1868/16384 [00:00<00:02, 6221.90probe position/s]Normalizing amplitudes:  15%|█▌        | 2491/16384 [00:00<00:02, 5676.74probe position/s]Normalizing amplitudes:  19%|█▉        | 3110/16384 [00:00<00:02, 5846.86probe position/s]Normalizing amplitudes:  23%|██▎       | 3700/16384 [00:00<00:02, 5837.96probe position/s]Normalizing amplitudes:  27%|██▋       | 4375/16384 [00:00<00:01, 6124.70probe position/s]Normalizing amplitudes:  30%|███       | 4991/16384 [00:00<00:01, 6051.90probe position/s]Normalizing amplitudes:  34%|███▍      | 5601/16384 [00:00<00:01, 6065.91probe position/s]Normalizing amplitudes:  38%|███▊      | 6241/16384 [00:01<00:01, 6163.81probe position/s]Normalizing amplitudes:  42%|████▏     | 6859/16384 [00:01<00:01, 6093.87probe position/s]Normalizing amplitudes:  46%|████▌     | 7480/16384 [00:01<00:01, 6125.93probe position/s]Normalizing amplitudes:  49%|████▉     | 8094/16384 [00:01<00:01, 5872.92probe position/s]Normalizing amplitudes:  53%|█████▎    | 8717/16384 [00:01<00:01, 5976.04probe position/s]Normalizing amplitudes:  57%|█████▋    | 9335/16384 [00:01<00:01, 6032.85probe position/s]Normalizing amplitudes:  61%|██████    | 9951/16384 [00:01<00:01, 6067.58probe position/s]Normalizing amplitudes:  64%|██████▍   | 10561/16384 [00:01<00:00, 6075.23probe position/s]Normalizing amplitudes:  68%|██████▊   | 11170/16384 [00:01<00:00, 5889.32probe position/s]Normalizing amplitudes:  72%|███████▏  | 11816/16384 [00:01<00:00, 6052.50probe position/s]Normalizing amplitudes:  76%|███████▌  | 12423/16384 [00:02<00:00, 5907.15probe position/s]Normalizing amplitudes:  79%|███████▉  | 13016/16384 [00:02<00:00, 5827.74probe position/s]Normalizing amplitudes:  83%|████████▎ | 13652/16384 [00:02<00:00, 5980.43probe position/s]Normalizing amplitudes:  87%|████████▋ | 14287/16384 [00:02<00:00, 6086.60probe position/s]Normalizing amplitudes:  91%|█████████ | 14897/16384 [00:02<00:00, 6085.22probe position/s]Normalizing amplitudes:  95%|█████████▍| 15507/16384 [00:02<00:00, 5665.26probe position/s]Normalizing amplitudes:  98%|█████████▊| 16080/16384 [00:02<00:00, 5545.35probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5932.07probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random32_p3_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random32_p3_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.00886 in 19.730 sec
Iter: 2, Total Loss: 0.006262 in 20.026 sec
Iter: 3, Total Loss: 0.00607 in 21.113 sec
Iter: 4, Total Loss: 0.005906 in 19.904 sec
Iter: 5, Total Loss: 0.005764 in 20.009 sec
Iter: 6, Total Loss: 0.00565 in 20.027 sec
Iter: 7, Total Loss: 0.005561 in 20.202 sec
Iter: 8, Total Loss: 0.005492 in 20.614 sec
Iter: 9, Total Loss: 0.005435 in 19.907 sec
Iter: 10, Total Loss: 0.005387 in 19.844 sec
Iter: 11, Total Loss: 0.005344 in 19.622 sec
Iter: 12, Total Loss: 0.005304 in 19.888 sec
Iter: 13, Total Loss: 0.005267 in 19.633 sec
Iter: 14, Total Loss: 0.005231 in 19.493 sec
Iter: 15, Total Loss: 0.0052 in 20.118 sec
Iter: 16, Total Loss: 0.005172 in 19.870 sec
Iter: 17, Total Loss: 0.005148 in 19.359 sec
Iter: 18, Total Loss: 0.005129 in 19.158 sec
Iter: 19, Total Loss: 0.005113 in 19.347 sec
Iter: 20, Total Loss: 0.005099 in 19.178 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 19.852 with std = 0.455 sec ###
### py4DSTEM ptycho solver is finished in 6 min 39.514 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 906.00 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 32, 3, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 592/16384 [00:00<00:02, 5918.62probe position/s]Normalizing amplitudes:   7%|▋         | 1220/16384 [00:00<00:02, 6128.87probe position/s]Normalizing amplitudes:  11%|█▏        | 1871/16384 [00:00<00:02, 6300.74probe position/s]Normalizing amplitudes:  15%|█▌        | 2502/16384 [00:00<00:02, 6302.06probe position/s]Normalizing amplitudes:  20%|█▉        | 3203/16384 [00:00<00:02, 6556.71probe position/s]Normalizing amplitudes:  24%|██▎       | 3859/16384 [00:00<00:01, 6350.95probe position/s]Normalizing amplitudes:  27%|██▋       | 4496/16384 [00:00<00:01, 6225.36probe position/s]Normalizing amplitudes:  31%|███▏      | 5120/16384 [00:00<00:01, 6186.47probe position/s]Normalizing amplitudes:  35%|███▌      | 5771/16384 [00:00<00:01, 6282.62probe position/s]Normalizing amplitudes:  39%|███▉      | 6413/16384 [00:01<00:01, 6322.13probe position/s]Normalizing amplitudes:  43%|████▎     | 7046/16384 [00:01<00:01, 6313.94probe position/s]Normalizing amplitudes:  47%|████▋     | 7684/16384 [00:01<00:01, 6330.71probe position/s]Normalizing amplitudes:  51%|█████     | 8319/16384 [00:01<00:01, 6334.58probe position/s]Normalizing amplitudes:  55%|█████▍    | 8970/16384 [00:01<00:01, 6384.00probe position/s]Normalizing amplitudes:  59%|█████▊    | 9612/16384 [00:01<00:01, 6392.67probe position/s]Normalizing amplitudes:  63%|██████▎   | 10260/16384 [00:01<00:00, 6418.64probe position/s]Normalizing amplitudes:  67%|██████▋   | 10902/16384 [00:01<00:00, 6305.86probe position/s]Normalizing amplitudes:  70%|███████   | 11534/16384 [00:01<00:00, 6281.98probe position/s]Normalizing amplitudes:  74%|███████▍  | 12185/16384 [00:01<00:00, 6347.48probe position/s]Normalizing amplitudes:  78%|███████▊  | 12821/16384 [00:02<00:00, 6295.53probe position/s]Normalizing amplitudes:  82%|████████▏ | 13480/16384 [00:02<00:00, 6382.27probe position/s]Normalizing amplitudes:  86%|████████▌ | 14119/16384 [00:02<00:00, 6341.47probe position/s]Normalizing amplitudes:  90%|█████████ | 14760/16384 [00:02<00:00, 6361.66probe position/s]Normalizing amplitudes:  94%|█████████▍| 15397/16384 [00:02<00:00, 6242.90probe position/s]Normalizing amplitudes:  98%|█████████▊| 16047/16384 [00:02<00:00, 6315.48probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6319.17probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random32_p3_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random32_p3_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.008956 in 37.723 sec
Iter: 2, Total Loss: 0.006146 in 38.734 sec
Iter: 3, Total Loss: 0.005897 in 39.387 sec
Iter: 4, Total Loss: 0.005706 in 41.043 sec
Iter: 5, Total Loss: 0.005571 in 39.455 sec
Iter: 6, Total Loss: 0.005477 in 38.419 sec
Iter: 7, Total Loss: 0.00541 in 38.555 sec
Iter: 8, Total Loss: 0.005354 in 39.597 sec
Iter: 9, Total Loss: 0.005306 in 38.344 sec
Iter: 10, Total Loss: 0.005265 in 38.113 sec
Iter: 11, Total Loss: 0.005227 in 37.415 sec
Iter: 12, Total Loss: 0.005192 in 37.323 sec
Iter: 13, Total Loss: 0.00516 in 36.987 sec
Iter: 14, Total Loss: 0.005132 in 39.033 sec
Iter: 15, Total Loss: 0.005106 in 38.582 sec
Iter: 16, Total Loss: 0.005085 in 39.111 sec
Iter: 17, Total Loss: 0.005067 in 38.690 sec
Iter: 18, Total Loss: 0.005051 in 38.863 sec
Iter: 19, Total Loss: 0.005037 in 39.021 sec
Iter: 20, Total Loss: 0.005023 in 39.225 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 38.681 with std = 0.895 sec ###
### py4DSTEM ptycho solver is finished in 12 min 56.399 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 897.84 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 32, 6, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 578/16384 [00:00<00:02, 5769.02probe position/s]Normalizing amplitudes:   7%|▋         | 1181/16384 [00:00<00:02, 5921.15probe position/s]Normalizing amplitudes:  11%|█         | 1792/16384 [00:00<00:02, 6007.14probe position/s]Normalizing amplitudes:  15%|█▍        | 2394/16384 [00:00<00:02, 6009.65probe position/s]Normalizing amplitudes:  18%|█▊        | 2995/16384 [00:00<00:02, 5882.87probe position/s]Normalizing amplitudes:  22%|██▏       | 3598/16384 [00:00<00:02, 5929.89probe position/s]Normalizing amplitudes:  26%|██▌       | 4234/16384 [00:00<00:02, 6068.02probe position/s]Normalizing amplitudes:  30%|██▉       | 4866/16384 [00:00<00:01, 6146.43probe position/s]Normalizing amplitudes:  33%|███▎      | 5481/16384 [00:00<00:01, 6055.44probe position/s]Normalizing amplitudes:  37%|███▋      | 6088/16384 [00:01<00:01, 5965.84probe position/s]Normalizing amplitudes:  41%|████      | 6686/16384 [00:01<00:01, 5844.44probe position/s]Normalizing amplitudes:  44%|████▍     | 7278/16384 [00:01<00:01, 5866.37probe position/s]Normalizing amplitudes:  48%|████▊     | 7883/16384 [00:01<00:01, 5919.84probe position/s]Normalizing amplitudes:  52%|█████▏    | 8522/16384 [00:01<00:01, 6059.38probe position/s]Normalizing amplitudes:  56%|█████▌    | 9129/16384 [00:01<00:01, 5992.38probe position/s]Normalizing amplitudes:  59%|█████▉    | 9729/16384 [00:01<00:01, 5902.40probe position/s]Normalizing amplitudes:  63%|██████▎   | 10343/16384 [00:01<00:01, 5972.19probe position/s]Normalizing amplitudes:  67%|██████▋   | 10941/16384 [00:01<00:00, 5714.28probe position/s]Normalizing amplitudes:  70%|███████   | 11515/16384 [00:01<00:00, 5456.39probe position/s]Normalizing amplitudes:  74%|███████▍  | 12137/16384 [00:02<00:00, 5668.38probe position/s]Normalizing amplitudes:  78%|███████▊  | 12708/16384 [00:02<00:00, 5663.39probe position/s]Normalizing amplitudes:  81%|████████  | 13301/16384 [00:02<00:00, 5739.75probe position/s]Normalizing amplitudes:  85%|████████▍ | 13898/16384 [00:02<00:00, 5804.45probe position/s]Normalizing amplitudes:  89%|████████▊ | 14505/16384 [00:02<00:00, 5879.87probe position/s]Normalizing amplitudes:  92%|█████████▏| 15101/16384 [00:02<00:00, 5902.34probe position/s]Normalizing amplitudes:  96%|█████████▌| 15693/16384 [00:02<00:00, 5886.49probe position/s]Normalizing amplitudes: 100%|█████████▉| 16342/16384 [00:02<00:00, 6065.11probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5902.31probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random32_p6_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random32_p6_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.01297 in 13.762 sec
Iter: 2, Total Loss: 0.006402 in 13.853 sec
Iter: 3, Total Loss: 0.006225 in 13.432 sec
Iter: 4, Total Loss: 0.006061 in 13.326 sec
Iter: 5, Total Loss: 0.005903 in 13.273 sec
Iter: 6, Total Loss: 0.005763 in 13.106 sec
Iter: 7, Total Loss: 0.005642 in 12.953 sec
Iter: 8, Total Loss: 0.00554 in 13.140 sec
Iter: 9, Total Loss: 0.005453 in 12.812 sec
Iter: 10, Total Loss: 0.005373 in 13.253 sec
Iter: 11, Total Loss: 0.005298 in 13.336 sec
Iter: 12, Total Loss: 0.005227 in 13.221 sec
Iter: 13, Total Loss: 0.005161 in 13.129 sec
Iter: 14, Total Loss: 0.005106 in 13.021 sec
Iter: 15, Total Loss: 0.005063 in 13.317 sec
Iter: 16, Total Loss: 0.005029 in 13.205 sec
Iter: 17, Total Loss: 0.005002 in 13.469 sec
Iter: 18, Total Loss: 0.004979 in 13.586 sec
Iter: 19, Total Loss: 0.00496 in 13.413 sec
Iter: 20, Total Loss: 0.004944 in 13.290 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 13.295 with std = 0.246 sec ###
### py4DSTEM ptycho solver is finished in 4 min 28.717 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 899.04 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 32, 6, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 568/16384 [00:00<00:02, 5671.41probe position/s]Normalizing amplitudes:   7%|▋         | 1180/16384 [00:00<00:02, 5934.63probe position/s]Normalizing amplitudes:  11%|█         | 1796/16384 [00:00<00:02, 6035.11probe position/s]Normalizing amplitudes:  15%|█▍        | 2400/16384 [00:00<00:02, 6016.71probe position/s]Normalizing amplitudes:  18%|█▊        | 3002/16384 [00:00<00:02, 5909.68probe position/s]Normalizing amplitudes:  22%|██▏       | 3594/16384 [00:00<00:02, 5876.30probe position/s]Normalizing amplitudes:  26%|██▌       | 4193/16384 [00:00<00:02, 5910.65probe position/s]Normalizing amplitudes:  29%|██▉       | 4824/16384 [00:00<00:01, 6035.34probe position/s]Normalizing amplitudes:  33%|███▎      | 5436/16384 [00:00<00:01, 6060.42probe position/s]Normalizing amplitudes:  37%|███▋      | 6056/16384 [00:01<00:01, 6102.52probe position/s]Normalizing amplitudes:  41%|████      | 6690/16384 [00:01<00:01, 6171.75probe position/s]Normalizing amplitudes:  45%|████▍     | 7308/16384 [00:01<00:01, 6143.15probe position/s]Normalizing amplitudes:  48%|████▊     | 7934/16384 [00:01<00:01, 6177.51probe position/s]Normalizing amplitudes:  52%|█████▏    | 8552/16384 [00:01<00:01, 5960.66probe position/s]Normalizing amplitudes:  56%|█████▌    | 9150/16384 [00:01<00:01, 5893.31probe position/s]Normalizing amplitudes:  59%|█████▉    | 9741/16384 [00:01<00:01, 5767.46probe position/s]Normalizing amplitudes:  63%|██████▎   | 10330/16384 [00:01<00:01, 5800.89probe position/s]Normalizing amplitudes:  67%|██████▋   | 10964/16384 [00:01<00:00, 5955.82probe position/s]Normalizing amplitudes:  71%|███████   | 11561/16384 [00:01<00:00, 5884.54probe position/s]Normalizing amplitudes:  74%|███████▍  | 12151/16384 [00:02<00:00, 5796.74probe position/s]Normalizing amplitudes:  78%|███████▊  | 12732/16384 [00:02<00:00, 5799.60probe position/s]Normalizing amplitudes:  81%|████████▏ | 13313/16384 [00:02<00:00, 5791.57probe position/s]Normalizing amplitudes:  85%|████████▍ | 13914/16384 [00:02<00:00, 5855.64probe position/s]Normalizing amplitudes:  89%|████████▊ | 14500/16384 [00:02<00:00, 5848.79probe position/s]Normalizing amplitudes:  92%|█████████▏| 15086/16384 [00:02<00:00, 5830.51probe position/s]Normalizing amplitudes:  96%|█████████▌| 15702/16384 [00:02<00:00, 5925.62probe position/s]Normalizing amplitudes: 100%|█████████▉| 16318/16384 [00:02<00:00, 5994.71probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5937.30probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random32_p6_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random32_p6_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.01336 in 37.851 sec
Iter: 2, Total Loss: 0.006224 in 37.468 sec
Iter: 3, Total Loss: 0.005964 in 39.004 sec
Iter: 4, Total Loss: 0.00576 in 38.607 sec
Iter: 5, Total Loss: 0.005597 in 37.717 sec
Iter: 6, Total Loss: 0.005466 in 37.648 sec
Iter: 7, Total Loss: 0.005356 in 37.821 sec
Iter: 8, Total Loss: 0.005257 in 36.762 sec
Iter: 9, Total Loss: 0.005163 in 37.156 sec
Iter: 10, Total Loss: 0.005071 in 38.195 sec
Iter: 11, Total Loss: 0.004993 in 37.426 sec
Iter: 12, Total Loss: 0.004932 in 37.264 sec
Iter: 13, Total Loss: 0.004887 in 37.056 sec
Iter: 14, Total Loss: 0.004853 in 37.241 sec
Iter: 15, Total Loss: 0.004826 in 37.630 sec
Iter: 16, Total Loss: 0.004804 in 37.410 sec
Iter: 17, Total Loss: 0.004784 in 36.875 sec
Iter: 18, Total Loss: 0.004767 in 36.536 sec
Iter: 19, Total Loss: 0.004752 in 36.515 sec
Iter: 20, Total Loss: 0.004738 in 36.054 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 37.412 with std = 0.689 sec ###
### py4DSTEM ptycho solver is finished in 12 min 30.932 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 905.69 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 32, 6, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 629/16384 [00:00<00:02, 6287.55probe position/s]Normalizing amplitudes:   8%|▊         | 1282/16384 [00:00<00:02, 6428.99probe position/s]Normalizing amplitudes:  12%|█▏        | 1925/16384 [00:00<00:02, 6356.32probe position/s]Normalizing amplitudes:  16%|█▌        | 2561/16384 [00:00<00:02, 6071.24probe position/s]Normalizing amplitudes:  20%|█▉        | 3210/16384 [00:00<00:02, 6214.22probe position/s]Normalizing amplitudes:  24%|██▎       | 3866/16384 [00:00<00:01, 6328.36probe position/s]Normalizing amplitudes:  28%|██▊       | 4520/16384 [00:00<00:01, 6396.17probe position/s]Normalizing amplitudes:  32%|███▏      | 5161/16384 [00:00<00:01, 6342.30probe position/s]Normalizing amplitudes:  35%|███▌      | 5811/16384 [00:00<00:01, 6389.88probe position/s]Normalizing amplitudes:  40%|███▉      | 6472/16384 [00:01<00:01, 6454.41probe position/s]Normalizing amplitudes:  43%|████▎     | 7118/16384 [00:01<00:01, 6383.56probe position/s]Normalizing amplitudes:  47%|████▋     | 7757/16384 [00:01<00:01, 6309.42probe position/s]Normalizing amplitudes:  51%|█████     | 8389/16384 [00:01<00:01, 6205.03probe position/s]Normalizing amplitudes:  55%|█████▌    | 9022/16384 [00:01<00:01, 6240.29probe position/s]Normalizing amplitudes:  59%|█████▉    | 9677/16384 [00:01<00:01, 6329.52probe position/s]Normalizing amplitudes:  63%|██████▎   | 10317/16384 [00:01<00:00, 6349.44probe position/s]Normalizing amplitudes:  67%|██████▋   | 10999/16384 [00:01<00:00, 6487.07probe position/s]Normalizing amplitudes:  71%|███████   | 11649/16384 [00:01<00:00, 6449.23probe position/s]Normalizing amplitudes:  75%|███████▌  | 12295/16384 [00:01<00:00, 6371.10probe position/s]Normalizing amplitudes:  79%|███████▉  | 12942/16384 [00:02<00:00, 6398.74probe position/s]Normalizing amplitudes:  83%|████████▎ | 13583/16384 [00:02<00:00, 6261.85probe position/s]Normalizing amplitudes:  87%|████████▋ | 14235/16384 [00:02<00:00, 6335.02probe position/s]Normalizing amplitudes:  91%|█████████ | 14896/16384 [00:02<00:00, 6414.92probe position/s]Normalizing amplitudes:  95%|█████████▍| 15564/16384 [00:02<00:00, 6490.75probe position/s]Normalizing amplitudes:  99%|█████████▉| 16214/16384 [00:02<00:00, 6477.69probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6359.76probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random32_p6_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random32_p6_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.01417 in 72.094 sec
Iter: 2, Total Loss: 0.006082 in 73.885 sec
Iter: 3, Total Loss: 0.005711 in 73.335 sec
Iter: 4, Total Loss: 0.00549 in 73.908 sec
Iter: 5, Total Loss: 0.005336 in 73.915 sec
Iter: 6, Total Loss: 0.005215 in 71.162 sec
Iter: 7, Total Loss: 0.005113 in 68.836 sec
Iter: 8, Total Loss: 0.005023 in 70.218 sec
Iter: 9, Total Loss: 0.004947 in 73.763 sec
Iter: 10, Total Loss: 0.004885 in 72.652 sec
Iter: 11, Total Loss: 0.004836 in 73.345 sec
Iter: 12, Total Loss: 0.004798 in 73.914 sec
Iter: 13, Total Loss: 0.004768 in 70.561 sec
Iter: 14, Total Loss: 0.004743 in 72.160 sec
Iter: 15, Total Loss: 0.004723 in 74.306 sec
Iter: 16, Total Loss: 0.004705 in 75.165 sec
Iter: 17, Total Loss: 0.00469 in 74.403 sec
Iter: 18, Total Loss: 0.004676 in 73.880 sec
Iter: 19, Total Loss: 0.004664 in 72.957 sec
Iter: 20, Total Loss: 0.004653 in 71.842 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 72.815 with std = 1.580 sec ###
### py4DSTEM ptycho solver is finished in 24 min 18.973 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 903.37 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 32, 12, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 654/16384 [00:00<00:02, 6528.29probe position/s]Normalizing amplitudes:   8%|▊         | 1307/16384 [00:00<00:02, 6345.25probe position/s]Normalizing amplitudes:  12%|█▏        | 1961/16384 [00:00<00:02, 6432.50probe position/s]Normalizing amplitudes:  16%|█▌        | 2615/16384 [00:00<00:02, 6469.40probe position/s]Normalizing amplitudes:  20%|█▉        | 3263/16384 [00:00<00:02, 6370.40probe position/s]Normalizing amplitudes:  24%|██▍       | 3901/16384 [00:00<00:01, 6306.07probe position/s]Normalizing amplitudes:  28%|██▊       | 4532/16384 [00:00<00:01, 6114.35probe position/s]Normalizing amplitudes:  32%|███▏      | 5161/16384 [00:00<00:01, 6167.52probe position/s]Normalizing amplitudes:  35%|███▌      | 5805/16384 [00:00<00:01, 6249.67probe position/s]Normalizing amplitudes:  39%|███▉      | 6431/16384 [00:01<00:01, 6126.73probe position/s]Normalizing amplitudes:  43%|████▎     | 7045/16384 [00:01<00:01, 6095.62probe position/s]Normalizing amplitudes:  47%|████▋     | 7664/16384 [00:01<00:01, 6121.52probe position/s]Normalizing amplitudes:  51%|█████     | 8277/16384 [00:01<00:01, 6005.87probe position/s]Normalizing amplitudes:  54%|█████▍    | 8886/16384 [00:01<00:01, 6027.95probe position/s]Normalizing amplitudes:  58%|█████▊    | 9524/16384 [00:01<00:01, 6129.35probe position/s]Normalizing amplitudes:  62%|██████▏   | 10175/16384 [00:01<00:00, 6238.86probe position/s]Normalizing amplitudes:  66%|██████▌   | 10800/16384 [00:01<00:00, 6103.16probe position/s]Normalizing amplitudes:  70%|██████▉   | 11412/16384 [00:01<00:00, 6048.61probe position/s]Normalizing amplitudes:  73%|███████▎  | 12034/16384 [00:01<00:00, 6095.91probe position/s]Normalizing amplitudes:  77%|███████▋  | 12674/16384 [00:02<00:00, 6183.10probe position/s]Normalizing amplitudes:  81%|████████▏ | 13326/16384 [00:02<00:00, 6279.94probe position/s]Normalizing amplitudes:  85%|████████▌ | 13962/16384 [00:02<00:00, 6302.67probe position/s]Normalizing amplitudes:  89%|████████▉ | 14597/16384 [00:02<00:00, 6315.79probe position/s]Normalizing amplitudes:  93%|█████████▎| 15252/16384 [00:02<00:00, 6384.48probe position/s]Normalizing amplitudes:  97%|█████████▋| 15891/16384 [00:02<00:00, 6198.77probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6207.48probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random32_p12_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random32_p12_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.02384 in 25.100 sec
Iter: 2, Total Loss: 0.00641 in 26.072 sec
Iter: 3, Total Loss: 0.006224 in 25.206 sec
Iter: 4, Total Loss: 0.006063 in 25.294 sec
Iter: 5, Total Loss: 0.005912 in 25.361 sec
Iter: 6, Total Loss: 0.005774 in 25.533 sec
Iter: 7, Total Loss: 0.005656 in 25.232 sec
Iter: 8, Total Loss: 0.005556 in 25.248 sec
Iter: 9, Total Loss: 0.005467 in 24.874 sec
Iter: 10, Total Loss: 0.005384 in 24.971 sec
Iter: 11, Total Loss: 0.005301 in 25.000 sec
Iter: 12, Total Loss: 0.00522 in 25.064 sec
Iter: 13, Total Loss: 0.005142 in 24.949 sec
Iter: 14, Total Loss: 0.005075 in 24.755 sec
Iter: 15, Total Loss: 0.00502 in 24.391 sec
Iter: 16, Total Loss: 0.004974 in 24.255 sec
Iter: 17, Total Loss: 0.004936 in 23.846 sec
Iter: 18, Total Loss: 0.004904 in 24.458 sec
Iter: 19, Total Loss: 0.004874 in 24.674 sec
Iter: 20, Total Loss: 0.004849 in 24.932 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 24.961 with std = 0.476 sec ###
### py4DSTEM ptycho solver is finished in 8 min 22.019 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 900.10 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 32, 12, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 631/16384 [00:00<00:02, 6299.78probe position/s]Normalizing amplitudes:   8%|▊         | 1261/16384 [00:00<00:02, 6255.15probe position/s]Normalizing amplitudes:  12%|█▏        | 1889/16384 [00:00<00:02, 6265.76probe position/s]Normalizing amplitudes:  15%|█▌        | 2516/16384 [00:00<00:02, 6209.40probe position/s]Normalizing amplitudes:  19%|█▉        | 3143/16384 [00:00<00:02, 6228.61probe position/s]Normalizing amplitudes:  23%|██▎       | 3766/16384 [00:00<00:02, 6216.31probe position/s]Normalizing amplitudes:  27%|██▋       | 4388/16384 [00:00<00:01, 6116.17probe position/s]Normalizing amplitudes:  31%|███       | 5000/16384 [00:00<00:01, 6086.84probe position/s]Normalizing amplitudes:  34%|███▍      | 5624/16384 [00:00<00:01, 6131.84probe position/s]Normalizing amplitudes:  38%|███▊      | 6238/16384 [00:01<00:01, 6065.77probe position/s]Normalizing amplitudes:  42%|████▏     | 6845/16384 [00:01<00:01, 6055.14probe position/s]Normalizing amplitudes:  45%|████▌     | 7451/16384 [00:01<00:01, 5999.89probe position/s]Normalizing amplitudes:  49%|████▉     | 8073/16384 [00:01<00:01, 6064.79probe position/s]Normalizing amplitudes:  53%|█████▎    | 8703/16384 [00:01<00:01, 6134.84probe position/s]Normalizing amplitudes:  57%|█████▋    | 9324/16384 [00:01<00:01, 6157.15probe position/s]Normalizing amplitudes:  61%|██████    | 9940/16384 [00:01<00:01, 6147.26probe position/s]Normalizing amplitudes:  65%|██████▍   | 10579/16384 [00:01<00:00, 6219.37probe position/s]Normalizing amplitudes:  68%|██████▊   | 11202/16384 [00:01<00:00, 6092.85probe position/s]Normalizing amplitudes:  72%|███████▏  | 11812/16384 [00:01<00:00, 6049.23probe position/s]Normalizing amplitudes:  76%|███████▌  | 12442/16384 [00:02<00:00, 6122.37probe position/s]Normalizing amplitudes:  80%|███████▉  | 13055/16384 [00:02<00:00, 6120.26probe position/s]Normalizing amplitudes:  84%|████████▎ | 13688/16384 [00:02<00:00, 6181.05probe position/s]Normalizing amplitudes:  87%|████████▋ | 14307/16384 [00:02<00:00, 6160.07probe position/s]Normalizing amplitudes:  91%|█████████ | 14924/16384 [00:02<00:00, 6048.71probe position/s]Normalizing amplitudes:  95%|█████████▌| 15567/16384 [00:02<00:00, 6159.29probe position/s]Normalizing amplitudes:  99%|█████████▉| 16184/16384 [00:02<00:00, 6141.87probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6128.45probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random32_p12_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random32_p12_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.024 in 73.126 sec
Iter: 2, Total Loss: 0.006214 in 72.992 sec
Iter: 3, Total Loss: 0.005948 in 72.941 sec
Iter: 4, Total Loss: 0.005728 in 73.099 sec
Iter: 5, Total Loss: 0.005551 in 70.758 sec
Iter: 6, Total Loss: 0.005409 in 69.189 sec
Iter: 7, Total Loss: 0.005292 in 75.711 sec
Iter: 8, Total Loss: 0.005185 in 72.309 sec
Iter: 9, Total Loss: 0.005083 in 74.365 sec
Iter: 10, Total Loss: 0.004991 in 72.355 sec
Iter: 11, Total Loss: 0.004914 in 69.980 sec
Iter: 12, Total Loss: 0.004854 in 69.059 sec
Iter: 13, Total Loss: 0.004807 in 72.343 sec
Iter: 14, Total Loss: 0.004768 in 76.719 sec
Iter: 15, Total Loss: 0.004735 in 72.645 sec
Iter: 16, Total Loss: 0.004707 in 73.078 sec
Iter: 17, Total Loss: 0.004682 in 72.179 sec
Iter: 18, Total Loss: 0.00466 in 70.478 sec
Iter: 19, Total Loss: 0.004641 in 71.433 sec
Iter: 20, Total Loss: 0.004623 in 73.233 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 72.400 with std = 1.885 sec ###
### py4DSTEM ptycho solver is finished in 24 min 10.844 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 898.57 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 32, 12, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 584/16384 [00:00<00:02, 5835.11probe position/s]Normalizing amplitudes:   7%|▋         | 1204/16384 [00:00<00:02, 6046.53probe position/s]Normalizing amplitudes:  11%|█         | 1811/16384 [00:00<00:02, 6056.15probe position/s]Normalizing amplitudes:  15%|█▍        | 2431/16384 [00:00<00:02, 6108.48probe position/s]Normalizing amplitudes:  19%|█▉        | 3078/16384 [00:00<00:02, 6235.89probe position/s]Normalizing amplitudes:  23%|██▎       | 3704/16384 [00:00<00:02, 6243.60probe position/s]Normalizing amplitudes:  26%|██▋       | 4329/16384 [00:00<00:01, 6161.48probe position/s]Normalizing amplitudes:  30%|███       | 4946/16384 [00:00<00:01, 6021.60probe position/s]Normalizing amplitudes:  34%|███▍      | 5549/16384 [00:00<00:01, 5947.87probe position/s]Normalizing amplitudes:  38%|███▊      | 6167/16384 [00:01<00:01, 6016.56probe position/s]Normalizing amplitudes:  41%|████▏     | 6779/16384 [00:01<00:01, 6047.55probe position/s]Normalizing amplitudes:  45%|████▌     | 7385/16384 [00:01<00:01, 6046.70probe position/s]Normalizing amplitudes:  49%|████▉     | 8012/16384 [00:01<00:01, 6112.87probe position/s]Normalizing amplitudes:  53%|█████▎    | 8624/16384 [00:01<00:01, 6053.61probe position/s]Normalizing amplitudes:  56%|█████▋    | 9230/16384 [00:01<00:01, 5993.47probe position/s]Normalizing amplitudes:  60%|█████▉    | 9830/16384 [00:01<00:01, 5941.54probe position/s]Normalizing amplitudes:  64%|██████▎   | 10425/16384 [00:01<00:01, 5910.83probe position/s]Normalizing amplitudes:  67%|██████▋   | 11047/16384 [00:01<00:00, 5999.27probe position/s]Normalizing amplitudes:  71%|███████▏  | 11685/16384 [00:01<00:00, 6109.82probe position/s]Normalizing amplitudes:  75%|███████▌  | 12331/16384 [00:02<00:00, 6213.04probe position/s]Normalizing amplitudes:  79%|███████▉  | 12953/16384 [00:02<00:00, 6210.21probe position/s]Normalizing amplitudes:  83%|████████▎ | 13575/16384 [00:02<00:00, 6149.37probe position/s]Normalizing amplitudes:  87%|████████▋ | 14200/16384 [00:02<00:00, 6155.50probe position/s]Normalizing amplitudes:  90%|█████████ | 14816/16384 [00:02<00:00, 5855.99probe position/s]Normalizing amplitudes:  94%|█████████▍| 15438/16384 [00:02<00:00, 5959.82probe position/s]Normalizing amplitudes:  98%|█████████▊| 16048/16384 [00:02<00:00, 5999.85probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6051.07probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random32_p12_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random32_p12_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.02568 in 145.269 sec
Iter: 2, Total Loss: 0.006175 in 144.243 sec
Iter: 3, Total Loss: 0.005697 in 145.640 sec
Iter: 4, Total Loss: 0.005471 in 146.147 sec
Iter: 5, Total Loss: 0.005309 in 145.320 sec
Iter: 6, Total Loss: 0.005166 in 144.549 sec
Iter: 7, Total Loss: 0.005034 in 148.263 sec
Iter: 8, Total Loss: 0.00492 in 147.327 sec
Iter: 9, Total Loss: 0.004833 in 145.160 sec
Iter: 10, Total Loss: 0.00477 in 144.743 sec
Iter: 11, Total Loss: 0.004721 in 142.527 sec
Iter: 12, Total Loss: 0.004683 in 138.571 sec
Iter: 13, Total Loss: 0.004652 in 145.861 sec
Iter: 14, Total Loss: 0.004625 in 145.473 sec
Iter: 15, Total Loss: 0.004602 in 144.258 sec
Iter: 16, Total Loss: 0.004582 in 141.642 sec
Iter: 17, Total Loss: 0.004565 in 144.238 sec
Iter: 18, Total Loss: 0.00455 in 142.307 sec
Iter: 19, Total Loss: 0.004536 in 143.073 sec
Iter: 20, Total Loss: 0.004524 in 144.873 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 144.474 with std = 2.063 sec ###
### py4DSTEM ptycho solver is finished in 48 min 12.144 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 898.74 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 16, 1, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 604/16384 [00:00<00:02, 6037.76probe position/s]Normalizing amplitudes:   8%|▊         | 1229/16384 [00:00<00:02, 6157.60probe position/s]Normalizing amplitudes:  11%|█▏        | 1845/16384 [00:00<00:02, 6126.14probe position/s]Normalizing amplitudes:  15%|█▌        | 2473/16384 [00:00<00:02, 6186.48probe position/s]Normalizing amplitudes:  19%|█▉        | 3092/16384 [00:00<00:02, 6020.66probe position/s]Normalizing amplitudes:  23%|██▎       | 3695/16384 [00:00<00:02, 5923.64probe position/s]Normalizing amplitudes:  26%|██▌       | 4288/16384 [00:00<00:02, 5851.51probe position/s]Normalizing amplitudes:  30%|██▉       | 4874/16384 [00:00<00:01, 5828.44probe position/s]Normalizing amplitudes:  33%|███▎      | 5464/16384 [00:00<00:01, 5849.34probe position/s]Normalizing amplitudes:  37%|███▋      | 6068/16384 [00:01<00:01, 5905.35probe position/s]Normalizing amplitudes:  41%|████      | 6706/16384 [00:01<00:01, 6047.13probe position/s]Normalizing amplitudes:  45%|████▍     | 7333/16384 [00:01<00:01, 6112.02probe position/s]Normalizing amplitudes:  49%|████▊     | 7960/16384 [00:01<00:01, 6158.90probe position/s]Normalizing amplitudes:  53%|█████▎    | 8609/16384 [00:01<00:01, 6256.21probe position/s]Normalizing amplitudes:  56%|█████▋    | 9253/16384 [00:01<00:01, 6308.66probe position/s]Normalizing amplitudes:  60%|██████    | 9901/16384 [00:01<00:01, 6357.35probe position/s]Normalizing amplitudes:  64%|██████▍   | 10537/16384 [00:01<00:00, 6202.39probe position/s]Normalizing amplitudes:  68%|██████▊   | 11166/16384 [00:01<00:00, 6224.94probe position/s]Normalizing amplitudes:  72%|███████▏  | 11822/16384 [00:01<00:00, 6323.80probe position/s]Normalizing amplitudes:  76%|███████▌  | 12455/16384 [00:02<00:00, 6125.67probe position/s]Normalizing amplitudes:  80%|███████▉  | 13070/16384 [00:02<00:00, 6094.12probe position/s]Normalizing amplitudes:  84%|████████▎ | 13681/16384 [00:02<00:00, 6097.60probe position/s]Normalizing amplitudes:  87%|████████▋ | 14292/16384 [00:02<00:00, 6090.69probe position/s]Normalizing amplitudes:  91%|█████████ | 14902/16384 [00:02<00:00, 5988.09probe position/s]Normalizing amplitudes:  95%|█████████▍| 15528/16384 [00:02<00:00, 6065.50probe position/s]Normalizing amplitudes:  99%|█████████▊| 16151/16384 [00:02<00:00, 6113.65probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6094.60probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random16_p1_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random16_p1_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.006896 in 6.959 sec
Iter: 2, Total Loss: 0.006558 in 6.918 sec
Iter: 3, Total Loss: 0.006461 in 6.873 sec
Iter: 4, Total Loss: 0.006372 in 6.735 sec
Iter: 5, Total Loss: 0.006298 in 6.782 sec
Iter: 6, Total Loss: 0.00624 in 6.954 sec
Iter: 7, Total Loss: 0.006204 in 6.828 sec
Iter: 8, Total Loss: 0.006177 in 6.810 sec
Iter: 9, Total Loss: 0.00616 in 6.999 sec
Iter: 10, Total Loss: 0.006148 in 6.966 sec
Iter: 11, Total Loss: 0.00614 in 6.940 sec
Iter: 12, Total Loss: 0.006132 in 6.851 sec
Iter: 13, Total Loss: 0.006127 in 6.866 sec
Iter: 14, Total Loss: 0.006123 in 6.820 sec
Iter: 15, Total Loss: 0.00612 in 6.852 sec
Iter: 16, Total Loss: 0.006117 in 6.892 sec
Iter: 17, Total Loss: 0.006114 in 6.895 sec
Iter: 18, Total Loss: 0.006111 in 6.823 sec
Iter: 19, Total Loss: 0.00611 in 7.017 sec
Iter: 20, Total Loss: 0.006109 in 6.651 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 6.871 with std = 0.088 sec ###
### py4DSTEM ptycho solver is finished in 2 min 20.135 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 898.28 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 16, 1, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 704/16384 [00:00<00:02, 7031.69probe position/s]Normalizing amplitudes:   9%|▊         | 1408/16384 [00:00<00:02, 6596.24probe position/s]Normalizing amplitudes:  13%|█▎        | 2070/16384 [00:00<00:02, 6459.96probe position/s]Normalizing amplitudes:  17%|█▋        | 2717/16384 [00:00<00:02, 6441.42probe position/s]Normalizing amplitudes:  21%|██        | 3368/16384 [00:00<00:02, 6464.17probe position/s]Normalizing amplitudes:  25%|██▍       | 4050/16384 [00:00<00:01, 6582.91probe position/s]Normalizing amplitudes:  29%|██▉       | 4745/16384 [00:00<00:01, 6698.95probe position/s]Normalizing amplitudes:  33%|███▎      | 5416/16384 [00:00<00:01, 6644.42probe position/s]Normalizing amplitudes:  37%|███▋      | 6081/16384 [00:00<00:01, 6533.32probe position/s]Normalizing amplitudes:  41%|████      | 6737/16384 [00:01<00:01, 6539.39probe position/s]Normalizing amplitudes:  45%|████▌     | 7407/16384 [00:01<00:01, 6585.78probe position/s]Normalizing amplitudes:  49%|████▉     | 8066/16384 [00:01<00:01, 6541.87probe position/s]Normalizing amplitudes:  53%|█████▎    | 8721/16384 [00:01<00:01, 6534.84probe position/s]Normalizing amplitudes:  57%|█████▋    | 9375/16384 [00:01<00:01, 6504.61probe position/s]Normalizing amplitudes:  61%|██████    | 10026/16384 [00:01<00:00, 6463.58probe position/s]Normalizing amplitudes:  65%|██████▌   | 10687/16384 [00:01<00:00, 6506.44probe position/s]Normalizing amplitudes:  69%|██████▉   | 11338/16384 [00:01<00:00, 6437.40probe position/s]Normalizing amplitudes:  73%|███████▎  | 11995/16384 [00:01<00:00, 6476.04probe position/s]Normalizing amplitudes:  77%|███████▋  | 12643/16384 [00:01<00:00, 6305.26probe position/s]Normalizing amplitudes:  81%|████████  | 13275/16384 [00:02<00:00, 6277.02probe position/s]Normalizing amplitudes:  85%|████████▌ | 13954/16384 [00:02<00:00, 6425.72probe position/s]Normalizing amplitudes:  89%|████████▉ | 14598/16384 [00:02<00:00, 6258.85probe position/s]Normalizing amplitudes:  93%|█████████▎| 15226/16384 [00:02<00:00, 6238.00probe position/s]Normalizing amplitudes:  97%|█████████▋| 15851/16384 [00:02<00:00, 6182.80probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6423.37probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random16_p1_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random16_p1_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.006922 in 15.894 sec
Iter: 2, Total Loss: 0.006518 in 15.640 sec
Iter: 3, Total Loss: 0.006408 in 15.784 sec
Iter: 4, Total Loss: 0.006318 in 16.051 sec
Iter: 5, Total Loss: 0.006255 in 15.869 sec
Iter: 6, Total Loss: 0.006211 in 16.427 sec
Iter: 7, Total Loss: 0.006183 in 15.929 sec
Iter: 8, Total Loss: 0.006159 in 16.685 sec
Iter: 9, Total Loss: 0.006144 in 16.033 sec
Iter: 10, Total Loss: 0.00613 in 16.196 sec
Iter: 11, Total Loss: 0.006119 in 16.434 sec
Iter: 12, Total Loss: 0.006107 in 16.251 sec
Iter: 13, Total Loss: 0.006101 in 16.394 sec
Iter: 14, Total Loss: 0.006093 in 16.719 sec
Iter: 15, Total Loss: 0.006086 in 16.606 sec
Iter: 16, Total Loss: 0.00608 in 16.638 sec
Iter: 17, Total Loss: 0.006074 in 16.513 sec
Iter: 18, Total Loss: 0.006067 in 16.558 sec
Iter: 19, Total Loss: 0.006063 in 16.545 sec
Iter: 20, Total Loss: 0.006057 in 16.494 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 16.283 with std = 0.325 sec ###
### py4DSTEM ptycho solver is finished in 5 min 28.379 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 897.43 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 16, 1, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 603/16384 [00:00<00:02, 6024.72probe position/s]Normalizing amplitudes:   7%|▋         | 1228/16384 [00:00<00:02, 6156.14probe position/s]Normalizing amplitudes:  11%|█▏        | 1869/16384 [00:00<00:02, 6269.97probe position/s]Normalizing amplitudes:  15%|█▌        | 2496/16384 [00:00<00:02, 6230.42probe position/s]Normalizing amplitudes:  19%|█▉        | 3120/16384 [00:00<00:02, 6226.87probe position/s]Normalizing amplitudes:  23%|██▎       | 3743/16384 [00:00<00:02, 6200.91probe position/s]Normalizing amplitudes:  27%|██▋       | 4364/16384 [00:00<00:01, 6113.61probe position/s]Normalizing amplitudes:  30%|███       | 4987/16384 [00:00<00:01, 6148.60probe position/s]Normalizing amplitudes:  34%|███▍      | 5603/16384 [00:00<00:01, 6149.22probe position/s]Normalizing amplitudes:  38%|███▊      | 6225/16384 [00:01<00:01, 6170.67probe position/s]Normalizing amplitudes:  42%|████▏     | 6863/16384 [00:01<00:01, 6232.73probe position/s]Normalizing amplitudes:  46%|████▌     | 7487/16384 [00:01<00:01, 6215.73probe position/s]Normalizing amplitudes:  49%|████▉     | 8109/16384 [00:01<00:01, 6195.64probe position/s]Normalizing amplitudes:  53%|█████▎    | 8729/16384 [00:01<00:01, 6045.40probe position/s]Normalizing amplitudes:  57%|█████▋    | 9335/16384 [00:01<00:01, 5931.27probe position/s]Normalizing amplitudes:  61%|██████    | 9952/16384 [00:01<00:01, 6000.76probe position/s]Normalizing amplitudes:  65%|██████▍   | 10570/16384 [00:01<00:00, 6051.54probe position/s]Normalizing amplitudes:  68%|██████▊   | 11195/16384 [00:01<00:00, 6109.12probe position/s]Normalizing amplitudes:  72%|███████▏  | 11811/16384 [00:01<00:00, 6122.57probe position/s]Normalizing amplitudes:  76%|███████▌  | 12437/16384 [00:02<00:00, 6161.46probe position/s]Normalizing amplitudes:  80%|███████▉  | 13054/16384 [00:02<00:00, 6149.05probe position/s]Normalizing amplitudes:  83%|████████▎ | 13670/16384 [00:02<00:00, 6130.14probe position/s]Normalizing amplitudes:  87%|████████▋ | 14300/16384 [00:02<00:00, 6178.69probe position/s]Normalizing amplitudes:  91%|█████████ | 14919/16384 [00:02<00:00, 6167.06probe position/s]Normalizing amplitudes:  95%|█████████▍| 15536/16384 [00:02<00:00, 6160.01probe position/s]Normalizing amplitudes:  99%|█████████▊| 16158/16384 [00:02<00:00, 6177.62probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6147.51probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random16_p1_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random16_p1_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.006998 in 30.261 sec
Iter: 2, Total Loss: 0.006554 in 30.199 sec
Iter: 3, Total Loss: 0.006438 in 30.375 sec
Iter: 4, Total Loss: 0.006358 in 29.963 sec
Iter: 5, Total Loss: 0.006296 in 29.227 sec
Iter: 6, Total Loss: 0.006254 in 28.886 sec
Iter: 7, Total Loss: 0.006225 in 29.065 sec
Iter: 8, Total Loss: 0.006199 in 29.764 sec
Iter: 9, Total Loss: 0.006171 in 29.949 sec
Iter: 10, Total Loss: 0.006151 in 30.356 sec
Iter: 11, Total Loss: 0.006128 in 30.298 sec
Iter: 12, Total Loss: 0.006103 in 31.049 sec
Iter: 13, Total Loss: 0.00608 in 30.783 sec
Iter: 14, Total Loss: 0.00606 in 30.573 sec
Iter: 15, Total Loss: 0.006041 in 30.459 sec
Iter: 16, Total Loss: 0.006022 in 29.643 sec
Iter: 17, Total Loss: 0.006003 in 29.549 sec
Iter: 18, Total Loss: 0.005986 in 29.237 sec
Iter: 19, Total Loss: 0.005971 in 29.348 sec
Iter: 20, Total Loss: 0.005956 in 27.959 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 29.847 with std = 0.725 sec ###
### py4DSTEM ptycho solver is finished in 9 min 59.460 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 928.55 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 16, 3, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 669/16384 [00:00<00:02, 6671.17probe position/s]Normalizing amplitudes:   8%|▊         | 1374/16384 [00:00<00:02, 6889.70probe position/s]Normalizing amplitudes:  13%|█▎        | 2075/16384 [00:00<00:02, 6942.41probe position/s]Normalizing amplitudes:  17%|█▋        | 2770/16384 [00:00<00:01, 6944.27probe position/s]Normalizing amplitudes:  21%|██        | 3465/16384 [00:00<00:01, 6917.84probe position/s]Normalizing amplitudes:  25%|██▌       | 4157/16384 [00:00<00:01, 6801.87probe position/s]Normalizing amplitudes:  30%|██▉       | 4840/16384 [00:00<00:01, 6808.59probe position/s]Normalizing amplitudes:  34%|███▎      | 5522/16384 [00:00<00:01, 6641.57probe position/s]Normalizing amplitudes:  38%|███▊      | 6237/16384 [00:00<00:01, 6794.05probe position/s]Normalizing amplitudes:  42%|████▏     | 6925/16384 [00:01<00:01, 6818.73probe position/s]Normalizing amplitudes:  47%|████▋     | 7635/16384 [00:01<00:01, 6902.17probe position/s]Normalizing amplitudes:  51%|█████     | 8326/16384 [00:01<00:01, 6859.77probe position/s]Normalizing amplitudes:  55%|█████▌    | 9013/16384 [00:01<00:01, 6715.81probe position/s]Normalizing amplitudes:  59%|█████▉    | 9689/16384 [00:01<00:00, 6728.47probe position/s]Normalizing amplitudes:  63%|██████▎   | 10363/16384 [00:01<00:00, 6685.77probe position/s]Normalizing amplitudes:  67%|██████▋   | 11057/16384 [00:01<00:00, 6760.09probe position/s]Normalizing amplitudes:  72%|███████▏  | 11734/16384 [00:01<00:00, 6744.71probe position/s]Normalizing amplitudes:  76%|███████▌  | 12409/16384 [00:01<00:00, 6712.91probe position/s]Normalizing amplitudes:  80%|████████  | 13114/16384 [00:01<00:00, 6811.63probe position/s]Normalizing amplitudes:  84%|████████▍ | 13818/16384 [00:02<00:00, 6876.38probe position/s]Normalizing amplitudes:  89%|████████▊ | 14531/16384 [00:02<00:00, 6950.35probe position/s]Normalizing amplitudes:  93%|█████████▎| 15227/16384 [00:02<00:00, 6851.91probe position/s]Normalizing amplitudes:  97%|█████████▋| 15913/16384 [00:02<00:00, 6742.38probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6798.58probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random16_p3_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random16_p3_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.007647 in 12.825 sec
Iter: 2, Total Loss: 0.006428 in 12.863 sec
Iter: 3, Total Loss: 0.006221 in 12.673 sec
Iter: 4, Total Loss: 0.00602 in 12.660 sec
Iter: 5, Total Loss: 0.005858 in 12.744 sec
Iter: 6, Total Loss: 0.005737 in 12.875 sec
Iter: 7, Total Loss: 0.005641 in 12.794 sec
Iter: 8, Total Loss: 0.00556 in 12.834 sec
Iter: 9, Total Loss: 0.005485 in 13.482 sec
Iter: 10, Total Loss: 0.005424 in 14.683 sec
Iter: 11, Total Loss: 0.005378 in 14.190 sec
Iter: 12, Total Loss: 0.005345 in 13.256 sec
Iter: 13, Total Loss: 0.005322 in 13.266 sec
Iter: 14, Total Loss: 0.005303 in 14.018 sec
Iter: 15, Total Loss: 0.005289 in 13.236 sec
Iter: 16, Total Loss: 0.005277 in 13.712 sec
Iter: 17, Total Loss: 0.005267 in 13.911 sec
Iter: 18, Total Loss: 0.00526 in 14.012 sec
Iter: 19, Total Loss: 0.005252 in 14.687 sec
Iter: 20, Total Loss: 0.005245 in 13.950 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 13.433 with std = 0.651 sec ###
### py4DSTEM ptycho solver is finished in 4 min 31.565 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 900.81 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 16, 3, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 622/16384 [00:00<00:02, 6217.03probe position/s]Normalizing amplitudes:   8%|▊         | 1244/16384 [00:00<00:02, 6212.77probe position/s]Normalizing amplitudes:  11%|█▏        | 1866/16384 [00:00<00:02, 6208.56probe position/s]Normalizing amplitudes:  15%|█▌        | 2515/16384 [00:00<00:02, 6317.26probe position/s]Normalizing amplitudes:  19%|█▉        | 3183/16384 [00:00<00:02, 6446.01probe position/s]Normalizing amplitudes:  23%|██▎       | 3828/16384 [00:00<00:02, 6187.64probe position/s]Normalizing amplitudes:  27%|██▋       | 4449/16384 [00:00<00:01, 6032.48probe position/s]Normalizing amplitudes:  31%|███       | 5092/16384 [00:00<00:01, 6152.39probe position/s]Normalizing amplitudes:  35%|███▌      | 5748/16384 [00:00<00:01, 6274.11probe position/s]Normalizing amplitudes:  39%|███▉      | 6391/16384 [00:01<00:01, 6319.06probe position/s]Normalizing amplitudes:  43%|████▎     | 7024/16384 [00:01<00:01, 6190.04probe position/s]Normalizing amplitudes:  47%|████▋     | 7679/16384 [00:01<00:01, 6295.45probe position/s]Normalizing amplitudes:  51%|█████     | 8334/16384 [00:01<00:01, 6370.92probe position/s]Normalizing amplitudes:  55%|█████▍    | 8972/16384 [00:01<00:01, 6337.23probe position/s]Normalizing amplitudes:  59%|█████▊    | 9621/16384 [00:01<00:01, 6380.86probe position/s]Normalizing amplitudes:  63%|██████▎   | 10260/16384 [00:01<00:00, 6317.89probe position/s]Normalizing amplitudes:  66%|██████▋   | 10893/16384 [00:01<00:00, 6277.95probe position/s]Normalizing amplitudes:  70%|███████   | 11522/16384 [00:01<00:00, 6219.74probe position/s]Normalizing amplitudes:  74%|███████▍  | 12164/16384 [00:01<00:00, 6276.30probe position/s]Normalizing amplitudes:  78%|███████▊  | 12792/16384 [00:02<00:00, 6050.73probe position/s]Normalizing amplitudes:  82%|████████▏ | 13399/16384 [00:02<00:00, 5931.17probe position/s]Normalizing amplitudes:  86%|████████▌ | 14030/16384 [00:02<00:00, 6040.05probe position/s]Normalizing amplitudes:  90%|████████▉ | 14694/16384 [00:02<00:00, 6214.19probe position/s]Normalizing amplitudes:  94%|█████████▎| 15332/16384 [00:02<00:00, 6260.61probe position/s]Normalizing amplitudes:  97%|█████████▋| 15960/16384 [00:02<00:00, 6188.41probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6226.53probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random16_p3_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random16_p3_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.007692 in 38.236 sec
Iter: 2, Total Loss: 0.006178 in 38.504 sec
Iter: 3, Total Loss: 0.005877 in 38.657 sec
Iter: 4, Total Loss: 0.005672 in 38.650 sec
Iter: 5, Total Loss: 0.005544 in 39.121 sec
Iter: 6, Total Loss: 0.005445 in 39.210 sec
Iter: 7, Total Loss: 0.005361 in 39.048 sec
Iter: 8, Total Loss: 0.005285 in 38.966 sec
Iter: 9, Total Loss: 0.005226 in 38.220 sec
Iter: 10, Total Loss: 0.005185 in 37.788 sec
Iter: 11, Total Loss: 0.005157 in 37.732 sec
Iter: 12, Total Loss: 0.005135 in 38.059 sec
Iter: 13, Total Loss: 0.005117 in 38.109 sec
Iter: 14, Total Loss: 0.005103 in 38.481 sec
Iter: 15, Total Loss: 0.00509 in 38.472 sec
Iter: 16, Total Loss: 0.005079 in 38.186 sec
Iter: 17, Total Loss: 0.005069 in 38.341 sec
Iter: 18, Total Loss: 0.005061 in 38.618 sec
Iter: 19, Total Loss: 0.005052 in 39.016 sec
Iter: 20, Total Loss: 0.005045 in 38.480 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 38.495 with std = 0.415 sec ###
### py4DSTEM ptycho solver is finished in 12 min 52.752 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 899.18 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 16, 3, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 627/16384 [00:00<00:02, 6266.94probe position/s]Normalizing amplitudes:   8%|▊         | 1269/16384 [00:00<00:02, 6351.24probe position/s]Normalizing amplitudes:  12%|█▏        | 1905/16384 [00:00<00:02, 5846.26probe position/s]Normalizing amplitudes:  15%|█▌        | 2494/16384 [00:00<00:02, 5683.40probe position/s]Normalizing amplitudes:  19%|█▉        | 3138/16384 [00:00<00:02, 5939.45probe position/s]Normalizing amplitudes:  23%|██▎       | 3736/16384 [00:00<00:02, 5893.83probe position/s]Normalizing amplitudes:  26%|██▋       | 4329/16384 [00:00<00:02, 5904.75probe position/s]Normalizing amplitudes:  30%|███       | 4933/16384 [00:00<00:01, 5944.45probe position/s]Normalizing amplitudes:  34%|███▎      | 5529/16384 [00:00<00:01, 5920.60probe position/s]Normalizing amplitudes:  38%|███▊      | 6162/16384 [00:01<00:01, 6044.99probe position/s]Normalizing amplitudes:  42%|████▏     | 6801/16384 [00:01<00:01, 6147.71probe position/s]Normalizing amplitudes:  45%|████▌     | 7426/16384 [00:01<00:01, 6176.04probe position/s]Normalizing amplitudes:  49%|████▉     | 8044/16384 [00:01<00:01, 6082.47probe position/s]Normalizing amplitudes:  53%|█████▎    | 8653/16384 [00:01<00:01, 6026.94probe position/s]Normalizing amplitudes:  57%|█████▋    | 9257/16384 [00:01<00:01, 5991.01probe position/s]Normalizing amplitudes:  60%|██████    | 9894/16384 [00:01<00:01, 6100.93probe position/s]Normalizing amplitudes:  64%|██████▍   | 10544/16384 [00:01<00:00, 6218.64probe position/s]Normalizing amplitudes:  68%|██████▊   | 11181/16384 [00:01<00:00, 6263.63probe position/s]Normalizing amplitudes:  72%|███████▏  | 11808/16384 [00:01<00:00, 6127.65probe position/s]Normalizing amplitudes:  76%|███████▌  | 12436/16384 [00:02<00:00, 6171.01probe position/s]Normalizing amplitudes:  80%|███████▉  | 13094/16384 [00:02<00:00, 6290.50probe position/s]Normalizing amplitudes:  84%|████████▍ | 13725/16384 [00:02<00:00, 6294.84probe position/s]Normalizing amplitudes:  88%|████████▊ | 14355/16384 [00:02<00:00, 6244.76probe position/s]Normalizing amplitudes:  91%|█████████▏| 14980/16384 [00:02<00:00, 6242.77probe position/s]Normalizing amplitudes:  95%|█████████▌| 15622/16384 [00:02<00:00, 6295.46probe position/s]Normalizing amplitudes:  99%|█████████▉| 16294/16384 [00:02<00:00, 6421.64probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6139.74probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random16_p3_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random16_p3_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.007852 in 75.529 sec
Iter: 2, Total Loss: 0.005957 in 72.810 sec
Iter: 3, Total Loss: 0.005671 in 74.753 sec
Iter: 4, Total Loss: 0.005513 in 75.664 sec
Iter: 5, Total Loss: 0.0054 in 75.715 sec
Iter: 6, Total Loss: 0.005304 in 74.519 sec
Iter: 7, Total Loss: 0.005227 in 71.543 sec
Iter: 8, Total Loss: 0.005174 in 71.803 sec
Iter: 9, Total Loss: 0.005134 in 72.556 sec
Iter: 10, Total Loss: 0.005103 in 71.741 sec
Iter: 11, Total Loss: 0.005078 in 72.022 sec
Iter: 12, Total Loss: 0.005055 in 68.686 sec
Iter: 13, Total Loss: 0.005035 in 68.032 sec
Iter: 14, Total Loss: 0.005016 in 67.439 sec
Iter: 15, Total Loss: 0.005 in 67.559 sec
Iter: 16, Total Loss: 0.004986 in 67.480 sec
Iter: 17, Total Loss: 0.004972 in 67.871 sec
Iter: 18, Total Loss: 0.00496 in 67.871 sec
Iter: 19, Total Loss: 0.004948 in 67.667 sec
Iter: 20, Total Loss: 0.004938 in 68.176 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 70.972 with std = 3.073 sec ###
### py4DSTEM ptycho solver is finished in 23 min 42.560 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 921.96 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 16, 6, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 692/16384 [00:00<00:02, 6912.62probe position/s]Normalizing amplitudes:   8%|▊         | 1384/16384 [00:00<00:02, 6805.55probe position/s]Normalizing amplitudes:  13%|█▎        | 2075/16384 [00:00<00:02, 6848.68probe position/s]Normalizing amplitudes:  17%|█▋        | 2760/16384 [00:00<00:01, 6845.39probe position/s]Normalizing amplitudes:  21%|██        | 3465/16384 [00:00<00:01, 6917.52probe position/s]Normalizing amplitudes:  25%|██▌       | 4160/16384 [00:00<00:01, 6925.37probe position/s]Normalizing amplitudes:  30%|██▉       | 4853/16384 [00:00<00:01, 6767.49probe position/s]Normalizing amplitudes:  34%|███▍      | 5579/16384 [00:00<00:01, 6918.00probe position/s]Normalizing amplitudes:  38%|███▊      | 6272/16384 [00:00<00:01, 6859.57probe position/s]Normalizing amplitudes:  42%|████▏     | 6963/16384 [00:01<00:01, 6873.27probe position/s]Normalizing amplitudes:  47%|████▋     | 7658/16384 [00:01<00:01, 6894.05probe position/s]Normalizing amplitudes:  51%|█████     | 8362/16384 [00:01<00:01, 6937.92probe position/s]Normalizing amplitudes:  55%|█████▌    | 9057/16384 [00:01<00:01, 6925.46probe position/s]Normalizing amplitudes:  60%|█████▉    | 9754/16384 [00:01<00:00, 6937.12probe position/s]Normalizing amplitudes:  64%|██████▍   | 10453/16384 [00:01<00:00, 6951.12probe position/s]Normalizing amplitudes:  68%|██████▊   | 11149/16384 [00:01<00:00, 6942.44probe position/s]Normalizing amplitudes:  72%|███████▏  | 11844/16384 [00:01<00:00, 6919.05probe position/s]Normalizing amplitudes:  77%|███████▋  | 12536/16384 [00:01<00:00, 6719.36probe position/s]Normalizing amplitudes:  81%|████████  | 13231/16384 [00:01<00:00, 6784.00probe position/s]Normalizing amplitudes:  85%|████████▍ | 13912/16384 [00:02<00:00, 6789.78probe position/s]Normalizing amplitudes:  89%|████████▉ | 14592/16384 [00:02<00:00, 6776.74probe position/s]Normalizing amplitudes:  93%|█████████▎| 15271/16384 [00:02<00:00, 6133.33probe position/s]Normalizing amplitudes:  97%|█████████▋| 15896/16384 [00:02<00:00, 5472.52probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6504.57probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random16_p6_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random16_p6_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.009838 in 24.463 sec
Iter: 2, Total Loss: 0.006428 in 24.333 sec
Iter: 3, Total Loss: 0.006202 in 24.532 sec
Iter: 4, Total Loss: 0.005975 in 24.853 sec
Iter: 5, Total Loss: 0.005791 in 24.727 sec
Iter: 6, Total Loss: 0.005652 in 24.876 sec
Iter: 7, Total Loss: 0.00553 in 24.799 sec
Iter: 8, Total Loss: 0.005403 in 24.363 sec
Iter: 9, Total Loss: 0.005279 in 24.871 sec
Iter: 10, Total Loss: 0.00518 in 24.633 sec
Iter: 11, Total Loss: 0.005111 in 24.781 sec
Iter: 12, Total Loss: 0.005061 in 24.692 sec
Iter: 13, Total Loss: 0.005024 in 24.737 sec
Iter: 14, Total Loss: 0.004994 in 24.733 sec
Iter: 15, Total Loss: 0.004968 in 24.354 sec
Iter: 16, Total Loss: 0.004947 in 25.152 sec
Iter: 17, Total Loss: 0.004928 in 24.630 sec
Iter: 18, Total Loss: 0.004911 in 24.030 sec
Iter: 19, Total Loss: 0.004896 in 24.490 sec
Iter: 20, Total Loss: 0.004882 in 24.469 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 24.626 with std = 0.246 sec ###
### py4DSTEM ptycho solver is finished in 8 min 16.426 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 917.25 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 16, 6, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 647/16384 [00:00<00:02, 6468.08probe position/s]Normalizing amplitudes:   8%|▊         | 1316/16384 [00:00<00:02, 6596.97probe position/s]Normalizing amplitudes:  12%|█▏        | 1985/16384 [00:00<00:02, 6633.96probe position/s]Normalizing amplitudes:  16%|█▌        | 2649/16384 [00:00<00:02, 6526.29probe position/s]Normalizing amplitudes:  20%|██        | 3302/16384 [00:00<00:02, 6447.23probe position/s]Normalizing amplitudes:  24%|██▍       | 3947/16384 [00:00<00:01, 6394.46probe position/s]Normalizing amplitudes:  28%|██▊       | 4603/16384 [00:00<00:01, 6446.68probe position/s]Normalizing amplitudes:  32%|███▏      | 5294/16384 [00:00<00:01, 6589.04probe position/s]Normalizing amplitudes:  36%|███▋      | 5954/16384 [00:00<00:01, 6523.76probe position/s]Normalizing amplitudes:  40%|████      | 6607/16384 [00:01<00:01, 6478.16probe position/s]Normalizing amplitudes:  44%|████▍     | 7256/16384 [00:01<00:01, 6392.99probe position/s]Normalizing amplitudes:  48%|████▊     | 7906/16384 [00:01<00:01, 6422.76probe position/s]Normalizing amplitudes:  52%|█████▏    | 8549/16384 [00:01<00:01, 6333.63probe position/s]Normalizing amplitudes:  56%|█████▌    | 9183/16384 [00:01<00:01, 6199.37probe position/s]Normalizing amplitudes:  60%|█████▉    | 9822/16384 [00:01<00:01, 6252.65probe position/s]Normalizing amplitudes:  64%|██████▍   | 10473/16384 [00:01<00:00, 6327.28probe position/s]Normalizing amplitudes:  68%|██████▊   | 11115/16384 [00:01<00:00, 6354.22probe position/s]Normalizing amplitudes:  72%|███████▏  | 11766/16384 [00:01<00:00, 6400.01probe position/s]Normalizing amplitudes:  76%|███████▌  | 12417/16384 [00:01<00:00, 6432.32probe position/s]Normalizing amplitudes:  80%|███████▉  | 13061/16384 [00:02<00:00, 6341.16probe position/s]Normalizing amplitudes:  84%|████████▎ | 13696/16384 [00:02<00:00, 6329.80probe position/s]Normalizing amplitudes:  88%|████████▊ | 14341/16384 [00:02<00:00, 6363.99probe position/s]Normalizing amplitudes:  91%|█████████▏| 14978/16384 [00:02<00:00, 6348.70probe position/s]Normalizing amplitudes:  95%|█████████▌| 15635/16384 [00:02<00:00, 6412.06probe position/s]Normalizing amplitudes:  99%|█████████▉| 16290/16384 [00:02<00:00, 6451.67probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6410.62probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random16_p6_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random16_p6_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.00995 in 70.167 sec
Iter: 2, Total Loss: 0.006127 in 69.696 sec
Iter: 3, Total Loss: 0.0058 in 68.777 sec
Iter: 4, Total Loss: 0.005573 in 68.820 sec
Iter: 5, Total Loss: 0.00539 in 69.480 sec
Iter: 6, Total Loss: 0.005211 in 69.556 sec
Iter: 7, Total Loss: 0.005059 in 69.180 sec
Iter: 8, Total Loss: 0.004965 in 69.161 sec
Iter: 9, Total Loss: 0.004905 in 69.392 sec
Iter: 10, Total Loss: 0.004863 in 68.749 sec
Iter: 11, Total Loss: 0.00483 in 68.392 sec
Iter: 12, Total Loss: 0.004803 in 69.525 sec
Iter: 13, Total Loss: 0.00478 in 69.250 sec
Iter: 14, Total Loss: 0.00476 in 69.319 sec
Iter: 15, Total Loss: 0.004743 in 68.869 sec
Iter: 16, Total Loss: 0.004728 in 69.290 sec
Iter: 17, Total Loss: 0.004715 in 68.320 sec
Iter: 18, Total Loss: 0.004703 in 66.579 sec
Iter: 19, Total Loss: 0.004692 in 65.654 sec
Iter: 20, Total Loss: 0.004682 in 66.237 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 68.721 with std = 1.167 sec ###
### py4DSTEM ptycho solver is finished in 22 min 56.742 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.89 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 16, 6, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 686/16384 [00:00<00:02, 6849.55probe position/s]Normalizing amplitudes:   8%|▊         | 1389/16384 [00:00<00:02, 6948.79probe position/s]Normalizing amplitudes:  13%|█▎        | 2098/16384 [00:00<00:02, 7010.36probe position/s]Normalizing amplitudes:  17%|█▋        | 2800/16384 [00:00<00:01, 6936.95probe position/s]Normalizing amplitudes:  21%|██▏       | 3501/16384 [00:00<00:01, 6958.99probe position/s]Normalizing amplitudes:  26%|██▌       | 4197/16384 [00:00<00:01, 6881.75probe position/s]Normalizing amplitudes:  30%|██▉       | 4899/16384 [00:00<00:01, 6923.73probe position/s]Normalizing amplitudes:  34%|███▍      | 5608/16384 [00:00<00:01, 6973.82probe position/s]Normalizing amplitudes:  38%|███▊      | 6306/16384 [00:00<00:01, 6967.64probe position/s]Normalizing amplitudes:  43%|████▎     | 7011/16384 [00:01<00:01, 6991.32probe position/s]Normalizing amplitudes:  47%|████▋     | 7711/16384 [00:01<00:01, 6971.13probe position/s]Normalizing amplitudes:  51%|█████▏    | 8413/16384 [00:01<00:01, 6983.91probe position/s]Normalizing amplitudes:  56%|█████▌    | 9123/16384 [00:01<00:01, 7017.55probe position/s]Normalizing amplitudes:  60%|█████▉    | 9830/16384 [00:01<00:00, 7032.88probe position/s]Normalizing amplitudes:  64%|██████▍   | 10534/16384 [00:01<00:00, 7032.09probe position/s]Normalizing amplitudes:  69%|██████▊   | 11255/16384 [00:01<00:00, 7083.62probe position/s]Normalizing amplitudes:  73%|███████▎  | 11964/16384 [00:01<00:00, 7079.70probe position/s]Normalizing amplitudes:  77%|███████▋  | 12672/16384 [00:01<00:00, 7048.95probe position/s]Normalizing amplitudes:  82%|████████▏ | 13382/16384 [00:01<00:00, 7062.34probe position/s]Normalizing amplitudes:  86%|████████▌ | 14091/16384 [00:02<00:00, 7068.90probe position/s]Normalizing amplitudes:  90%|█████████ | 14798/16384 [00:02<00:00, 7048.14probe position/s]Normalizing amplitudes:  95%|█████████▍| 15503/16384 [00:02<00:00, 6941.78probe position/s]Normalizing amplitudes:  99%|█████████▉| 16216/16384 [00:02<00:00, 6997.11probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6996.63probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random16_p6_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random16_p6_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.01034 in 129.282 sec
Iter: 2, Total Loss: 0.005832 in 135.675 sec
Iter: 3, Total Loss: 0.005483 in 136.625 sec
Iter: 4, Total Loss: 0.005231 in 134.651 sec
Iter: 5, Total Loss: 0.005042 in 135.867 sec
Iter: 6, Total Loss: 0.004926 in 135.260 sec
Iter: 7, Total Loss: 0.004856 in 136.504 sec
Iter: 8, Total Loss: 0.004809 in 134.666 sec
Iter: 9, Total Loss: 0.004775 in 134.516 sec
Iter: 10, Total Loss: 0.004748 in 134.785 sec
Iter: 11, Total Loss: 0.004726 in 135.374 sec
Iter: 12, Total Loss: 0.004707 in 134.913 sec
Iter: 13, Total Loss: 0.004691 in 134.240 sec
Iter: 14, Total Loss: 0.004678 in 133.173 sec
Iter: 15, Total Loss: 0.004666 in 129.151 sec
Iter: 16, Total Loss: 0.004655 in 128.321 sec
Iter: 17, Total Loss: 0.004645 in 132.205 sec
Iter: 18, Total Loss: 0.004636 in 135.395 sec
Iter: 19, Total Loss: 0.004628 in 135.713 sec
Iter: 20, Total Loss: 0.004621 in 134.990 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 134.065 with std = 2.380 sec ###
### py4DSTEM ptycho solver is finished in 44 min 43.841 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 917.21 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 16, 12, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 646/16384 [00:00<00:02, 6457.76probe position/s]Normalizing amplitudes:   8%|▊         | 1324/16384 [00:00<00:02, 6645.36probe position/s]Normalizing amplitudes:  12%|█▏        | 1989/16384 [00:00<00:02, 6585.69probe position/s]Normalizing amplitudes:  16%|█▌        | 2648/16384 [00:00<00:02, 6516.88probe position/s]Normalizing amplitudes:  20%|██        | 3300/16384 [00:00<00:02, 6474.95probe position/s]Normalizing amplitudes:  24%|██▍       | 3967/16384 [00:00<00:01, 6538.53probe position/s]Normalizing amplitudes:  28%|██▊       | 4641/16384 [00:00<00:01, 6602.51probe position/s]Normalizing amplitudes:  32%|███▏      | 5302/16384 [00:00<00:01, 6568.87probe position/s]Normalizing amplitudes:  36%|███▋      | 5959/16384 [00:00<00:01, 6533.25probe position/s]Normalizing amplitudes:  40%|████      | 6613/16384 [00:01<00:01, 6490.45probe position/s]Normalizing amplitudes:  44%|████▍     | 7263/16384 [00:01<00:01, 6466.28probe position/s]Normalizing amplitudes:  48%|████▊     | 7919/16384 [00:01<00:01, 6493.31probe position/s]Normalizing amplitudes:  52%|█████▏    | 8569/16384 [00:01<00:01, 6491.71probe position/s]Normalizing amplitudes:  56%|█████▋    | 9219/16384 [00:01<00:01, 6351.28probe position/s]Normalizing amplitudes:  60%|██████    | 9864/16384 [00:01<00:01, 6378.59probe position/s]Normalizing amplitudes:  64%|██████▍   | 10503/16384 [00:01<00:00, 6354.44probe position/s]Normalizing amplitudes:  68%|██████▊   | 11159/16384 [00:01<00:00, 6413.92probe position/s]Normalizing amplitudes:  72%|███████▏  | 11801/16384 [00:01<00:00, 6408.75probe position/s]Normalizing amplitudes:  76%|███████▌  | 12452/16384 [00:01<00:00, 6436.77probe position/s]Normalizing amplitudes:  80%|████████  | 13112/16384 [00:02<00:00, 6483.19probe position/s]Normalizing amplitudes:  84%|████████▍ | 13761/16384 [00:02<00:00, 6453.00probe position/s]Normalizing amplitudes:  88%|████████▊ | 14421/16384 [00:02<00:00, 6495.74probe position/s]Normalizing amplitudes:  92%|█████████▏| 15071/16384 [00:02<00:00, 6434.26probe position/s]Normalizing amplitudes:  96%|█████████▌| 15715/16384 [00:02<00:00, 6423.66probe position/s]Normalizing amplitudes: 100%|█████████▉| 16367/16384 [00:02<00:00, 6450.30probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6469.16probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random16_p12_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random16_p12_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.01524 in 46.222 sec
Iter: 2, Total Loss: 0.006386 in 46.105 sec
Iter: 3, Total Loss: 0.006133 in 45.827 sec
Iter: 4, Total Loss: 0.005906 in 46.035 sec
Iter: 5, Total Loss: 0.005734 in 45.979 sec
Iter: 6, Total Loss: 0.005592 in 46.257 sec
Iter: 7, Total Loss: 0.005454 in 46.065 sec
Iter: 8, Total Loss: 0.005312 in 45.918 sec
Iter: 9, Total Loss: 0.005187 in 46.155 sec
Iter: 10, Total Loss: 0.005092 in 46.217 sec
Iter: 11, Total Loss: 0.005022 in 46.569 sec
Iter: 12, Total Loss: 0.004966 in 45.954 sec
Iter: 13, Total Loss: 0.00492 in 45.905 sec
Iter: 14, Total Loss: 0.00488 in 46.162 sec
Iter: 15, Total Loss: 0.004845 in 45.826 sec
Iter: 16, Total Loss: 0.004814 in 46.237 sec
Iter: 17, Total Loss: 0.004785 in 46.369 sec
Iter: 18, Total Loss: 0.004759 in 46.511 sec
Iter: 19, Total Loss: 0.004734 in 46.271 sec
Iter: 20, Total Loss: 0.004711 in 46.117 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 46.135 with std = 0.201 sec ###
### py4DSTEM ptycho solver is finished in 15 min 25.281 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 917.09 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 16, 12, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 657/16384 [00:00<00:02, 6558.70probe position/s]Normalizing amplitudes:   8%|▊         | 1315/16384 [00:00<00:02, 6568.12probe position/s]Normalizing amplitudes:  12%|█▏        | 1972/16384 [00:00<00:02, 6497.36probe position/s]Normalizing amplitudes:  16%|█▌        | 2633/16384 [00:00<00:02, 6537.64probe position/s]Normalizing amplitudes:  20%|██        | 3299/16384 [00:00<00:01, 6578.99probe position/s]Normalizing amplitudes:  24%|██▍       | 3957/16384 [00:00<00:01, 6481.56probe position/s]Normalizing amplitudes:  28%|██▊       | 4621/16384 [00:00<00:01, 6531.48probe position/s]Normalizing amplitudes:  32%|███▏      | 5275/16384 [00:00<00:01, 6502.01probe position/s]Normalizing amplitudes:  36%|███▌      | 5926/16384 [00:00<00:01, 6477.25probe position/s]Normalizing amplitudes:  40%|████      | 6574/16384 [00:01<00:01, 6424.26probe position/s]Normalizing amplitudes:  44%|████▍     | 7261/16384 [00:01<00:01, 6557.16probe position/s]Normalizing amplitudes:  49%|████▊     | 7962/16384 [00:01<00:01, 6692.21probe position/s]Normalizing amplitudes:  53%|█████▎    | 8645/16384 [00:01<00:01, 6732.63probe position/s]Normalizing amplitudes:  57%|█████▋    | 9321/16384 [00:01<00:01, 6740.79probe position/s]Normalizing amplitudes:  61%|██████    | 9996/16384 [00:01<00:00, 6634.61probe position/s]Normalizing amplitudes:  65%|██████▌   | 10660/16384 [00:01<00:00, 6599.64probe position/s]Normalizing amplitudes:  69%|██████▉   | 11337/16384 [00:01<00:00, 6649.99probe position/s]Normalizing amplitudes:  73%|███████▎  | 12003/16384 [00:01<00:00, 6613.54probe position/s]Normalizing amplitudes:  77%|███████▋  | 12665/16384 [00:01<00:00, 6580.15probe position/s]Normalizing amplitudes:  81%|████████▏ | 13324/16384 [00:02<00:00, 6568.53probe position/s]Normalizing amplitudes:  85%|████████▌ | 13999/16384 [00:02<00:00, 6622.12probe position/s]Normalizing amplitudes:  89%|████████▉ | 14663/16384 [00:02<00:00, 6626.81probe position/s]Normalizing amplitudes:  94%|█████████▎| 15326/16384 [00:02<00:00, 6548.79probe position/s]Normalizing amplitudes:  98%|█████████▊| 15982/16384 [00:02<00:00, 6508.00probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6553.27probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random16_p12_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random16_p12_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.01547 in 135.306 sec
Iter: 2, Total Loss: 0.006104 in 134.117 sec
Iter: 3, Total Loss: 0.005743 in 126.651 sec
Iter: 4, Total Loss: 0.005502 in 125.895 sec
Iter: 5, Total Loss: 0.005307 in 130.314 sec
Iter: 6, Total Loss: 0.005124 in 137.356 sec
Iter: 7, Total Loss: 0.004986 in 139.050 sec
Iter: 8, Total Loss: 0.004894 in 137.970 sec
Iter: 9, Total Loss: 0.004828 in 138.175 sec
Iter: 10, Total Loss: 0.004776 in 137.614 sec
Iter: 11, Total Loss: 0.004733 in 138.353 sec
Iter: 12, Total Loss: 0.004697 in 139.129 sec
Iter: 13, Total Loss: 0.004666 in 138.003 sec
Iter: 14, Total Loss: 0.004639 in 140.138 sec
Iter: 15, Total Loss: 0.004615 in 138.981 sec
Iter: 16, Total Loss: 0.004593 in 137.570 sec
Iter: 17, Total Loss: 0.004574 in 139.481 sec
Iter: 18, Total Loss: 0.004557 in 139.535 sec
Iter: 19, Total Loss: 0.004542 in 134.637 sec
Iter: 20, Total Loss: 0.004528 in 137.884 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 136.308 with std = 4.026 sec ###
### py4DSTEM ptycho solver is finished in 45 min 28.659 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 913.90 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (4, 16, 12, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 594/16384 [00:00<00:02, 5938.65probe position/s]Normalizing amplitudes:   7%|▋         | 1188/16384 [00:00<00:02, 5758.10probe position/s]Normalizing amplitudes:  11%|█         | 1765/16384 [00:00<00:02, 5742.82probe position/s]Normalizing amplitudes:  15%|█▍        | 2401/16384 [00:00<00:02, 5981.78probe position/s]Normalizing amplitudes:  18%|█▊        | 3030/16384 [00:00<00:02, 6091.82probe position/s]Normalizing amplitudes:  22%|██▏       | 3640/16384 [00:00<00:02, 6037.17probe position/s]Normalizing amplitudes:  26%|██▌       | 4266/16384 [00:00<00:01, 6107.48probe position/s]Normalizing amplitudes:  30%|██▉       | 4890/16384 [00:00<00:01, 6147.04probe position/s]Normalizing amplitudes:  34%|███▎      | 5510/16384 [00:00<00:01, 6163.06probe position/s]Normalizing amplitudes:  37%|███▋      | 6127/16384 [00:01<00:01, 6161.64probe position/s]Normalizing amplitudes:  41%|████      | 6744/16384 [00:01<00:01, 6153.59probe position/s]Normalizing amplitudes:  45%|████▌     | 7380/16384 [00:01<00:01, 6214.51probe position/s]Normalizing amplitudes:  49%|████▉     | 8010/16384 [00:01<00:01, 6238.35probe position/s]Normalizing amplitudes:  53%|█████▎    | 8685/16384 [00:01<00:01, 6392.05probe position/s]Normalizing amplitudes:  57%|█████▋    | 9325/16384 [00:01<00:01, 6349.39probe position/s]Normalizing amplitudes:  61%|██████    | 9961/16384 [00:01<00:01, 6224.16probe position/s]Normalizing amplitudes:  65%|██████▍   | 10584/16384 [00:01<00:00, 6096.71probe position/s]Normalizing amplitudes:  68%|██████▊   | 11220/16384 [00:01<00:00, 6172.71probe position/s]Normalizing amplitudes:  72%|███████▏  | 11862/16384 [00:01<00:00, 6242.22probe position/s]Normalizing amplitudes:  76%|███████▌  | 12487/16384 [00:02<00:00, 6131.07probe position/s]Normalizing amplitudes:  80%|███████▉  | 13101/16384 [00:02<00:00, 6023.12probe position/s]Normalizing amplitudes:  84%|████████▎ | 13705/16384 [00:02<00:00, 5484.42probe position/s]Normalizing amplitudes:  87%|████████▋ | 14263/16384 [00:02<00:00, 5433.51probe position/s]Normalizing amplitudes:  91%|█████████ | 14879/16384 [00:02<00:00, 5634.20probe position/s]Normalizing amplitudes:  95%|█████████▍| 15488/16384 [00:02<00:00, 5762.31probe position/s]Normalizing amplitudes:  98%|█████████▊| 16117/16384 [00:02<00:00, 5914.81probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6017.62probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random16_p12_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r4/N16384_dp128_flipT100_random16_p12_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.01613 in 278.026 sec
Iter: 2, Total Loss: 0.005868 in 274.815 sec
Iter: 3, Total Loss: 0.005427 in 275.967 sec
Iter: 4, Total Loss: 0.005165 in 276.396 sec
Iter: 5, Total Loss: 0.004972 in 276.783 sec
Iter: 6, Total Loss: 0.004852 in 276.103 sec
Iter: 7, Total Loss: 0.004773 in 274.102 sec
Iter: 8, Total Loss: 0.004716 in 277.508 sec
Iter: 9, Total Loss: 0.004673 in 272.551 sec
Iter: 10, Total Loss: 0.004638 in 274.917 sec
Iter: 11, Total Loss: 0.004609 in 274.231 sec
Iter: 12, Total Loss: 0.004584 in 273.776 sec
Iter: 13, Total Loss: 0.004562 in 270.711 sec
Iter: 14, Total Loss: 0.004543 in 270.063 sec
Iter: 15, Total Loss: 0.004526 in 272.063 sec
Iter: 16, Total Loss: 0.004512 in 268.176 sec
Iter: 17, Total Loss: 0.004499 in 272.097 sec
Iter: 18, Total Loss: 0.004488 in 272.285 sec
Iter: 19, Total Loss: 0.004478 in 270.194 sec
Iter: 20, Total Loss: 0.004469 in 270.939 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 273.585 with std = 2.692 sec ###
### py4DSTEM ptycho solver is finished in 1 hr 31 min 14.289 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 913.69 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 1024, 1, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 655/16384 [00:00<00:02, 6546.03probe position/s]Normalizing amplitudes:   8%|▊         | 1310/16384 [00:00<00:02, 6468.70probe position/s]Normalizing amplitudes:  12%|█▏        | 1957/16384 [00:00<00:02, 6400.12probe position/s]Normalizing amplitudes:  16%|█▌        | 2598/16384 [00:00<00:02, 6118.49probe position/s]Normalizing amplitudes:  20%|█▉        | 3219/16384 [00:00<00:02, 6148.56probe position/s]Normalizing amplitudes:  24%|██▎       | 3863/16384 [00:00<00:02, 6242.59probe position/s]Normalizing amplitudes:  27%|██▋       | 4489/16384 [00:00<00:01, 6240.62probe position/s]Normalizing amplitudes:  31%|███       | 5114/16384 [00:00<00:01, 6238.70probe position/s]Normalizing amplitudes:  35%|███▌      | 5758/16384 [00:00<00:01, 6299.01probe position/s]Normalizing amplitudes:  39%|███▉      | 6391/16384 [00:01<00:01, 6308.07probe position/s]Normalizing amplitudes:  43%|████▎     | 7030/16384 [00:01<00:01, 6329.62probe position/s]Normalizing amplitudes:  47%|████▋     | 7664/16384 [00:01<00:01, 6233.25probe position/s]Normalizing amplitudes:  51%|█████     | 8288/16384 [00:01<00:01, 6229.07probe position/s]Normalizing amplitudes:  54%|█████▍    | 8920/16384 [00:01<00:01, 6254.22probe position/s]Normalizing amplitudes:  58%|█████▊    | 9546/16384 [00:01<00:01, 6220.55probe position/s]Normalizing amplitudes:  62%|██████▏   | 10183/16384 [00:01<00:00, 6263.70probe position/s]Normalizing amplitudes:  66%|██████▌   | 10814/16384 [00:01<00:00, 6275.08probe position/s]Normalizing amplitudes:  70%|██████▉   | 11442/16384 [00:01<00:00, 6210.18probe position/s]Normalizing amplitudes:  74%|███████▎  | 12065/16384 [00:01<00:00, 6215.15probe position/s]Normalizing amplitudes:  77%|███████▋  | 12697/16384 [00:02<00:00, 6244.33probe position/s]Normalizing amplitudes:  81%|████████▏ | 13330/16384 [00:02<00:00, 6266.82probe position/s]Normalizing amplitudes:  85%|████████▌ | 13957/16384 [00:02<00:00, 6245.99probe position/s]Normalizing amplitudes:  89%|████████▉ | 14582/16384 [00:02<00:00, 6159.54probe position/s]Normalizing amplitudes:  93%|█████████▎| 15199/16384 [00:02<00:00, 6152.23probe position/s]Normalizing amplitudes:  97%|█████████▋| 15826/16384 [00:02<00:00, 6185.28probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6235.81probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random1024_p1_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random1024_p1_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.0222 in 0.759 sec
Iter: 2, Total Loss: 0.006518 in 0.726 sec
Iter: 3, Total Loss: 0.00649 in 0.717 sec
Iter: 4, Total Loss: 0.006476 in 0.722 sec
Iter: 5, Total Loss: 0.006469 in 0.714 sec
Iter: 6, Total Loss: 0.006464 in 0.705 sec
Iter: 7, Total Loss: 0.006461 in 0.707 sec
Iter: 8, Total Loss: 0.006458 in 0.704 sec
Iter: 9, Total Loss: 0.006456 in 0.705 sec
Iter: 10, Total Loss: 0.006454 in 0.707 sec
Iter: 11, Total Loss: 0.006453 in 0.731 sec
Iter: 12, Total Loss: 0.006451 in 0.706 sec
Iter: 13, Total Loss: 0.00645 in 0.731 sec
Iter: 14, Total Loss: 0.006447 in 0.714 sec
Iter: 15, Total Loss: 0.006446 in 0.749 sec
Iter: 16, Total Loss: 0.006444 in 0.728 sec
Iter: 17, Total Loss: 0.006443 in 0.718 sec
Iter: 18, Total Loss: 0.006441 in 0.730 sec
Iter: 19, Total Loss: 0.006439 in 0.709 sec
Iter: 20, Total Loss: 0.006438 in 0.713 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 0.720 with std = 0.015 sec ###
### py4DSTEM ptycho solver is finished in 16.910 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 913.71 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 1024, 1, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 613/16384 [00:00<00:02, 6119.28probe position/s]Normalizing amplitudes:   8%|▊         | 1242/16384 [00:00<00:02, 6217.27probe position/s]Normalizing amplitudes:  11%|█▏        | 1870/16384 [00:00<00:02, 6245.11probe position/s]Normalizing amplitudes:  15%|█▌        | 2495/16384 [00:00<00:02, 6221.25probe position/s]Normalizing amplitudes:  19%|█▉        | 3154/16384 [00:00<00:02, 6350.85probe position/s]Normalizing amplitudes:  23%|██▎       | 3790/16384 [00:00<00:02, 5989.57probe position/s]Normalizing amplitudes:  27%|██▋       | 4420/16384 [00:00<00:01, 6085.82probe position/s]Normalizing amplitudes:  31%|███       | 5059/16384 [00:00<00:01, 6178.83probe position/s]Normalizing amplitudes:  35%|███▍      | 5696/16384 [00:00<00:01, 6236.66probe position/s]Normalizing amplitudes:  39%|███▊      | 6332/16384 [00:01<00:01, 6270.95probe position/s]Normalizing amplitudes:  43%|████▎     | 6979/16384 [00:01<00:01, 6326.48probe position/s]Normalizing amplitudes:  46%|████▋     | 7613/16384 [00:01<00:01, 6074.07probe position/s]Normalizing amplitudes:  50%|█████     | 8223/16384 [00:01<00:01, 6067.20probe position/s]Normalizing amplitudes:  54%|█████▍    | 8832/16384 [00:01<00:01, 6034.55probe position/s]Normalizing amplitudes:  58%|█████▊    | 9450/16384 [00:01<00:01, 6076.09probe position/s]Normalizing amplitudes:  61%|██████▏   | 10063/16384 [00:01<00:01, 6091.50probe position/s]Normalizing amplitudes:  65%|██████▌   | 10708/16384 [00:01<00:00, 6197.94probe position/s]Normalizing amplitudes:  69%|██████▉   | 11350/16384 [00:01<00:00, 6261.91probe position/s]Normalizing amplitudes:  73%|███████▎  | 12002/16384 [00:01<00:00, 6338.20probe position/s]Normalizing amplitudes:  77%|███████▋  | 12637/16384 [00:02<00:00, 6304.18probe position/s]Normalizing amplitudes:  81%|████████  | 13268/16384 [00:02<00:00, 6254.27probe position/s]Normalizing amplitudes:  85%|████████▍ | 13919/16384 [00:02<00:00, 6328.11probe position/s]Normalizing amplitudes:  89%|████████▉ | 14553/16384 [00:02<00:00, 6324.94probe position/s]Normalizing amplitudes:  93%|█████████▎| 15211/16384 [00:02<00:00, 6400.00probe position/s]Normalizing amplitudes:  97%|█████████▋| 15872/16384 [00:02<00:00, 6459.73probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6242.99probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random1024_p1_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random1024_p1_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.02283 in 1.508 sec
Iter: 2, Total Loss: 0.006513 in 1.416 sec
Iter: 3, Total Loss: 0.006482 in 1.419 sec
Iter: 4, Total Loss: 0.006472 in 1.392 sec
Iter: 5, Total Loss: 0.006467 in 1.407 sec
Iter: 6, Total Loss: 0.006461 in 1.409 sec
Iter: 7, Total Loss: 0.006456 in 1.387 sec
Iter: 8, Total Loss: 0.006451 in 1.395 sec
Iter: 9, Total Loss: 0.006447 in 1.390 sec
Iter: 10, Total Loss: 0.006443 in 1.397 sec
Iter: 11, Total Loss: 0.00644 in 1.418 sec
Iter: 12, Total Loss: 0.006437 in 1.449 sec
Iter: 13, Total Loss: 0.006433 in 1.397 sec
Iter: 14, Total Loss: 0.00643 in 1.412 sec
Iter: 15, Total Loss: 0.006426 in 1.456 sec
Iter: 16, Total Loss: 0.006424 in 1.395 sec
Iter: 17, Total Loss: 0.006421 in 1.410 sec
Iter: 18, Total Loss: 0.006418 in 1.425 sec
Iter: 19, Total Loss: 0.006414 in 1.454 sec
Iter: 20, Total Loss: 0.006413 in 1.445 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 1.419 with std = 0.029 sec ###
### py4DSTEM ptycho solver is finished in 31.196 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 913.69 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 1024, 1, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 529/16384 [00:00<00:02, 5285.73probe position/s]Normalizing amplitudes:   7%|▋         | 1117/16384 [00:00<00:02, 5632.01probe position/s]Normalizing amplitudes:  11%|█         | 1742/16384 [00:00<00:02, 5913.50probe position/s]Normalizing amplitudes:  14%|█▍        | 2334/16384 [00:00<00:02, 5757.56probe position/s]Normalizing amplitudes:  18%|█▊        | 2911/16384 [00:00<00:02, 5620.84probe position/s]Normalizing amplitudes:  21%|██        | 3474/16384 [00:00<00:02, 5442.71probe position/s]Normalizing amplitudes:  25%|██▍       | 4020/16384 [00:00<00:02, 5441.25probe position/s]Normalizing amplitudes:  28%|██▊       | 4566/16384 [00:00<00:02, 5444.09probe position/s]Normalizing amplitudes:  31%|███▏      | 5154/16384 [00:00<00:02, 5576.72probe position/s]Normalizing amplitudes:  35%|███▌      | 5782/16384 [00:01<00:01, 5788.43probe position/s]Normalizing amplitudes:  39%|███▉      | 6363/16384 [00:01<00:01, 5793.74probe position/s]Normalizing amplitudes:  42%|████▏     | 6943/16384 [00:01<00:01, 5682.77probe position/s]Normalizing amplitudes:  46%|████▌     | 7513/16384 [00:01<00:01, 5531.47probe position/s]Normalizing amplitudes:  49%|████▉     | 8069/16384 [00:01<00:01, 5538.07probe position/s]Normalizing amplitudes:  53%|█████▎    | 8636/16384 [00:01<00:01, 5574.32probe position/s]Normalizing amplitudes:  56%|█████▌    | 9195/16384 [00:01<00:01, 5519.93probe position/s]Normalizing amplitudes:  60%|█████▉    | 9799/16384 [00:01<00:01, 5670.95probe position/s]Normalizing amplitudes:  63%|██████▎   | 10394/16384 [00:01<00:01, 5751.06probe position/s]Normalizing amplitudes:  67%|██████▋   | 10970/16384 [00:01<00:00, 5650.48probe position/s]Normalizing amplitudes:  71%|███████   | 11585/16384 [00:02<00:00, 5796.94probe position/s]Normalizing amplitudes:  75%|███████▍  | 12207/16384 [00:02<00:00, 5919.91probe position/s]Normalizing amplitudes:  78%|███████▊  | 12800/16384 [00:02<00:00, 5918.79probe position/s]Normalizing amplitudes:  82%|████████▏ | 13393/16384 [00:02<00:00, 5739.53probe position/s]Normalizing amplitudes:  85%|████████▌ | 13969/16384 [00:02<00:00, 5647.70probe position/s]Normalizing amplitudes:  89%|████████▊ | 14535/16384 [00:02<00:00, 5646.20probe position/s]Normalizing amplitudes:  92%|█████████▏| 15101/16384 [00:02<00:00, 5601.53probe position/s]Normalizing amplitudes:  96%|█████████▌| 15703/16384 [00:02<00:00, 5722.24probe position/s]Normalizing amplitudes: 100%|█████████▉| 16344/16384 [00:02<00:00, 5925.13probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5692.12probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random1024_p1_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random1024_p1_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.02402 in 2.492 sec
Iter: 2, Total Loss: 0.006569 in 2.428 sec
Iter: 3, Total Loss: 0.006504 in 2.524 sec
Iter: 4, Total Loss: 0.00649 in 2.421 sec
Iter: 5, Total Loss: 0.00648 in 2.401 sec
Iter: 6, Total Loss: 0.006472 in 2.398 sec
Iter: 7, Total Loss: 0.006463 in 2.388 sec
Iter: 8, Total Loss: 0.006457 in 2.432 sec
Iter: 9, Total Loss: 0.006449 in 2.395 sec
Iter: 10, Total Loss: 0.006446 in 2.399 sec
Iter: 11, Total Loss: 0.006441 in 2.394 sec
Iter: 12, Total Loss: 0.006434 in 2.398 sec
Iter: 13, Total Loss: 0.00643 in 2.407 sec
Iter: 14, Total Loss: 0.006425 in 2.405 sec
Iter: 15, Total Loss: 0.006423 in 2.406 sec
Iter: 16, Total Loss: 0.006418 in 2.403 sec
Iter: 17, Total Loss: 0.006413 in 2.423 sec
Iter: 18, Total Loss: 0.006408 in 2.399 sec
Iter: 19, Total Loss: 0.006407 in 2.395 sec
Iter: 20, Total Loss: 0.006401 in 2.391 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 2.415 with std = 0.034 sec ###
### py4DSTEM ptycho solver is finished in 50.984 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 917.84 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 1024, 3, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 634/16384 [00:00<00:02, 6336.47probe position/s]Normalizing amplitudes:   8%|▊         | 1268/16384 [00:00<00:02, 6137.24probe position/s]Normalizing amplitudes:  11%|█▏        | 1883/16384 [00:00<00:02, 5996.07probe position/s]Normalizing amplitudes:  15%|█▌        | 2483/16384 [00:00<00:02, 5829.19probe position/s]Normalizing amplitudes:  19%|█▊        | 3067/16384 [00:00<00:02, 5699.47probe position/s]Normalizing amplitudes:  23%|██▎       | 3693/16384 [00:00<00:02, 5879.66probe position/s]Normalizing amplitudes:  26%|██▋       | 4330/16384 [00:00<00:01, 6035.47probe position/s]Normalizing amplitudes:  30%|███       | 4953/16384 [00:00<00:01, 6096.20probe position/s]Normalizing amplitudes:  34%|███▍      | 5564/16384 [00:00<00:01, 5946.72probe position/s]Normalizing amplitudes:  38%|███▊      | 6211/16384 [00:01<00:01, 6100.37probe position/s]Normalizing amplitudes:  42%|████▏     | 6863/16384 [00:01<00:01, 6226.05probe position/s]Normalizing amplitudes:  46%|████▌     | 7500/16384 [00:01<00:01, 6267.25probe position/s]Normalizing amplitudes:  50%|████▉     | 8152/16384 [00:01<00:01, 6342.51probe position/s]Normalizing amplitudes:  54%|█████▍    | 8808/16384 [00:01<00:01, 6407.16probe position/s]Normalizing amplitudes:  58%|█████▊    | 9450/16384 [00:01<00:01, 6408.08probe position/s]Normalizing amplitudes:  62%|██████▏   | 10120/16384 [00:01<00:00, 6493.14probe position/s]Normalizing amplitudes:  66%|██████▌   | 10782/16384 [00:01<00:00, 6528.02probe position/s]Normalizing amplitudes:  70%|██████▉   | 11435/16384 [00:01<00:00, 6433.24probe position/s]Normalizing amplitudes:  74%|███████▎  | 12079/16384 [00:01<00:00, 6304.65probe position/s]Normalizing amplitudes:  78%|███████▊  | 12738/16384 [00:02<00:00, 6386.05probe position/s]Normalizing amplitudes:  82%|████████▏ | 13384/16384 [00:02<00:00, 6406.54probe position/s]Normalizing amplitudes:  86%|████████▌ | 14026/16384 [00:02<00:00, 6410.10probe position/s]Normalizing amplitudes:  90%|████████▉ | 14668/16384 [00:02<00:00, 6371.70probe position/s]Normalizing amplitudes:  93%|█████████▎| 15317/16384 [00:02<00:00, 6404.97probe position/s]Normalizing amplitudes:  97%|█████████▋| 15958/16384 [00:02<00:00, 6295.42probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6237.57probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random1024_p3_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random1024_p3_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.07014 in 1.370 sec
Iter: 2, Total Loss: 0.00674 in 1.311 sec
Iter: 3, Total Loss: 0.006562 in 1.305 sec
Iter: 4, Total Loss: 0.006489 in 1.309 sec
Iter: 5, Total Loss: 0.006456 in 1.315 sec
Iter: 6, Total Loss: 0.006436 in 1.323 sec
Iter: 7, Total Loss: 0.006424 in 1.316 sec
Iter: 8, Total Loss: 0.006412 in 1.335 sec
Iter: 9, Total Loss: 0.006403 in 1.310 sec
Iter: 10, Total Loss: 0.006394 in 1.314 sec
Iter: 11, Total Loss: 0.006387 in 1.314 sec
Iter: 12, Total Loss: 0.006378 in 1.304 sec
Iter: 13, Total Loss: 0.006371 in 1.317 sec
Iter: 14, Total Loss: 0.006363 in 1.302 sec
Iter: 15, Total Loss: 0.006355 in 1.332 sec
Iter: 16, Total Loss: 0.006347 in 1.323 sec
Iter: 17, Total Loss: 0.006339 in 1.298 sec
Iter: 18, Total Loss: 0.006331 in 1.315 sec
Iter: 19, Total Loss: 0.006323 in 1.315 sec
Iter: 20, Total Loss: 0.006315 in 1.309 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 1.317 with std = 0.015 sec ###
### py4DSTEM ptycho solver is finished in 29.348 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 933.96 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 1024, 3, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 680/16384 [00:00<00:02, 6794.26probe position/s]Normalizing amplitudes:   8%|▊         | 1364/16384 [00:00<00:02, 6816.22probe position/s]Normalizing amplitudes:  12%|█▏        | 2046/16384 [00:00<00:02, 6731.59probe position/s]Normalizing amplitudes:  17%|█▋        | 2742/16384 [00:00<00:02, 6817.27probe position/s]Normalizing amplitudes:  21%|██        | 3424/16384 [00:00<00:01, 6743.02probe position/s]Normalizing amplitudes:  25%|██▌       | 4110/16384 [00:00<00:01, 6780.05probe position/s]Normalizing amplitudes:  29%|██▉       | 4789/16384 [00:00<00:01, 6738.44probe position/s]Normalizing amplitudes:  33%|███▎      | 5464/16384 [00:00<00:01, 6738.80probe position/s]Normalizing amplitudes:  37%|███▋      | 6138/16384 [00:00<00:01, 6678.98probe position/s]Normalizing amplitudes:  42%|████▏     | 6807/16384 [00:01<00:01, 6571.59probe position/s]Normalizing amplitudes:  46%|████▌     | 7465/16384 [00:01<00:01, 6435.44probe position/s]Normalizing amplitudes:  50%|████▉     | 8134/16384 [00:01<00:01, 6510.43probe position/s]Normalizing amplitudes:  54%|█████▍    | 8834/16384 [00:01<00:01, 6653.79probe position/s]Normalizing amplitudes:  58%|█████▊    | 9516/16384 [00:01<00:01, 6701.26probe position/s]Normalizing amplitudes:  62%|██████▏   | 10229/16384 [00:01<00:00, 6828.40probe position/s]Normalizing amplitudes:  67%|██████▋   | 10913/16384 [00:01<00:00, 6736.55probe position/s]Normalizing amplitudes:  71%|███████   | 11588/16384 [00:01<00:00, 6682.58probe position/s]Normalizing amplitudes:  75%|███████▍  | 12272/16384 [00:01<00:00, 6726.63probe position/s]Normalizing amplitudes:  79%|███████▉  | 12946/16384 [00:01<00:00, 6646.01probe position/s]Normalizing amplitudes:  83%|████████▎ | 13615/16384 [00:02<00:00, 6657.17probe position/s]Normalizing amplitudes:  87%|████████▋ | 14313/16384 [00:02<00:00, 6752.49probe position/s]Normalizing amplitudes:  91%|█████████▏| 14989/16384 [00:02<00:00, 6702.75probe position/s]Normalizing amplitudes:  96%|█████████▌| 15662/16384 [00:02<00:00, 6708.86probe position/s]Normalizing amplitudes: 100%|█████████▉| 16345/16384 [00:02<00:00, 6743.52probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6701.41probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random1024_p3_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random1024_p3_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.06822 in 3.231 sec
Iter: 2, Total Loss: 0.006963 in 3.169 sec
Iter: 3, Total Loss: 0.006613 in 3.187 sec
Iter: 4, Total Loss: 0.006527 in 3.198 sec
Iter: 5, Total Loss: 0.006485 in 3.200 sec
Iter: 6, Total Loss: 0.006452 in 3.193 sec
Iter: 7, Total Loss: 0.006428 in 3.181 sec
Iter: 8, Total Loss: 0.006402 in 3.209 sec
Iter: 9, Total Loss: 0.006383 in 3.183 sec
Iter: 10, Total Loss: 0.006362 in 3.190 sec
Iter: 11, Total Loss: 0.006345 in 3.207 sec
Iter: 12, Total Loss: 0.006327 in 3.161 sec
Iter: 13, Total Loss: 0.006312 in 3.172 sec
Iter: 14, Total Loss: 0.006295 in 3.204 sec
Iter: 15, Total Loss: 0.006281 in 3.254 sec
Iter: 16, Total Loss: 0.006266 in 3.299 sec
Iter: 17, Total Loss: 0.006253 in 3.263 sec
Iter: 18, Total Loss: 0.006239 in 3.301 sec
Iter: 19, Total Loss: 0.006227 in 3.224 sec
Iter: 20, Total Loss: 0.006215 in 3.222 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 3.212 with std = 0.039 sec ###
### py4DSTEM ptycho solver is finished in 1 min 6.833 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 938.33 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 1024, 3, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   5%|▍         | 758/16384 [00:00<00:02, 7571.09probe position/s]Normalizing amplitudes:   9%|▉         | 1516/16384 [00:00<00:02, 7343.82probe position/s]Normalizing amplitudes:  14%|█▎        | 2251/16384 [00:00<00:02, 6966.82probe position/s]Normalizing amplitudes:  18%|█▊        | 2950/16384 [00:00<00:01, 6920.11probe position/s]Normalizing amplitudes:  22%|██▏       | 3648/16384 [00:00<00:01, 6938.96probe position/s]Normalizing amplitudes:  27%|██▋       | 4367/16384 [00:00<00:01, 7022.21probe position/s]Normalizing amplitudes:  31%|███▏      | 5125/16384 [00:00<00:01, 7199.17probe position/s]Normalizing amplitudes:  36%|███▌      | 5873/16384 [00:00<00:01, 7286.66probe position/s]Normalizing amplitudes:  40%|████      | 6603/16384 [00:00<00:01, 7103.95probe position/s]Normalizing amplitudes:  45%|████▍     | 7315/16384 [00:01<00:01, 6984.13probe position/s]Normalizing amplitudes:  49%|████▉     | 8015/16384 [00:01<00:01, 6910.77probe position/s]Normalizing amplitudes:  53%|█████▎    | 8707/16384 [00:01<00:01, 6876.57probe position/s]Normalizing amplitudes:  58%|█████▊    | 9485/16384 [00:01<00:00, 7143.38probe position/s]Normalizing amplitudes:  63%|██████▎   | 10276/16384 [00:01<00:00, 7371.13probe position/s]Normalizing amplitudes:  67%|██████▋   | 11015/16384 [00:01<00:00, 7297.43probe position/s]Normalizing amplitudes:  72%|███████▏  | 11746/16384 [00:01<00:00, 7085.88probe position/s]Normalizing amplitudes:  76%|███████▌  | 12457/16384 [00:01<00:00, 6991.35probe position/s]Normalizing amplitudes:  80%|████████  | 13170/16384 [00:01<00:00, 7029.11probe position/s]Normalizing amplitudes:  85%|████████▌ | 13963/16384 [00:01<00:00, 7292.68probe position/s]Normalizing amplitudes:  90%|████████▉ | 14711/16384 [00:02<00:00, 7347.50probe position/s]Normalizing amplitudes:  94%|█████████▍| 15447/16384 [00:02<00:00, 7167.07probe position/s]Normalizing amplitudes:  99%|█████████▊| 16166/16384 [00:02<00:00, 7039.30probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 7106.09probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random1024_p3_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random1024_p3_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.07065 in 6.062 sec
Iter: 2, Total Loss: 0.007932 in 6.168 sec
Iter: 3, Total Loss: 0.006905 in 6.156 sec
Iter: 4, Total Loss: 0.006679 in 6.079 sec
Iter: 5, Total Loss: 0.006564 in 5.973 sec
Iter: 6, Total Loss: 0.006485 in 6.042 sec
Iter: 7, Total Loss: 0.006428 in 6.022 sec
Iter: 8, Total Loss: 0.00638 in 6.095 sec
Iter: 9, Total Loss: 0.006345 in 5.987 sec
Iter: 10, Total Loss: 0.006311 in 6.020 sec
Iter: 11, Total Loss: 0.006286 in 6.218 sec
Iter: 12, Total Loss: 0.006261 in 6.457 sec
Iter: 13, Total Loss: 0.006242 in 6.044 sec
Iter: 14, Total Loss: 0.006222 in 6.000 sec
Iter: 15, Total Loss: 0.006205 in 6.022 sec
Iter: 16, Total Loss: 0.006189 in 5.999 sec
Iter: 17, Total Loss: 0.006173 in 6.020 sec
Iter: 18, Total Loss: 0.006158 in 6.022 sec
Iter: 19, Total Loss: 0.006145 in 6.016 sec
Iter: 20, Total Loss: 0.006133 in 6.038 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 6.072 with std = 0.108 sec ###
### py4DSTEM ptycho solver is finished in 2 min 4.289 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 923.62 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 1024, 6, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 628/16384 [00:00<00:02, 6277.09probe position/s]Normalizing amplitudes:   8%|▊         | 1256/16384 [00:00<00:02, 6250.63probe position/s]Normalizing amplitudes:  12%|█▏        | 1931/16384 [00:00<00:02, 6472.67probe position/s]Normalizing amplitudes:  16%|█▌        | 2579/16384 [00:00<00:02, 6326.19probe position/s]Normalizing amplitudes:  20%|█▉        | 3213/16384 [00:00<00:02, 6299.11probe position/s]Normalizing amplitudes:  23%|██▎       | 3848/16384 [00:00<00:01, 6313.62probe position/s]Normalizing amplitudes:  27%|██▋       | 4485/16384 [00:00<00:01, 6331.50probe position/s]Normalizing amplitudes:  31%|███▏      | 5134/16384 [00:00<00:01, 6379.16probe position/s]Normalizing amplitudes:  35%|███▌      | 5773/16384 [00:00<00:01, 6353.20probe position/s]Normalizing amplitudes:  39%|███▉      | 6409/16384 [00:01<00:01, 6230.37probe position/s]Normalizing amplitudes:  43%|████▎     | 7043/16384 [00:01<00:01, 6261.45probe position/s]Normalizing amplitudes:  47%|████▋     | 7679/16384 [00:01<00:01, 6288.91probe position/s]Normalizing amplitudes:  51%|█████     | 8333/16384 [00:01<00:01, 6364.08probe position/s]Normalizing amplitudes:  55%|█████▍    | 8972/16384 [00:01<00:01, 6371.09probe position/s]Normalizing amplitudes:  59%|█████▊    | 9625/16384 [00:01<00:01, 6417.25probe position/s]Normalizing amplitudes:  63%|██████▎   | 10267/16384 [00:01<00:00, 6352.03probe position/s]Normalizing amplitudes:  67%|██████▋   | 10928/16384 [00:01<00:00, 6426.10probe position/s]Normalizing amplitudes:  71%|███████   | 11601/16384 [00:01<00:00, 6516.64probe position/s]Normalizing amplitudes:  75%|███████▍  | 12253/16384 [00:01<00:00, 6448.07probe position/s]Normalizing amplitudes:  79%|███████▊  | 12899/16384 [00:02<00:00, 6428.96probe position/s]Normalizing amplitudes:  83%|████████▎ | 13543/16384 [00:02<00:00, 6265.11probe position/s]Normalizing amplitudes:  86%|████████▋ | 14171/16384 [00:02<00:00, 6198.11probe position/s]Normalizing amplitudes:  91%|█████████ | 14844/16384 [00:02<00:00, 6353.12probe position/s]Normalizing amplitudes:  95%|█████████▍| 15500/16384 [00:02<00:00, 6412.85probe position/s]Normalizing amplitudes:  99%|█████████▊| 16143/16384 [00:02<00:00, 6327.71probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6347.06probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random1024_p6_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random1024_p6_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.2046 in 2.267 sec
Iter: 2, Total Loss: 0.007021 in 2.234 sec
Iter: 3, Total Loss: 0.006704 in 2.224 sec
Iter: 4, Total Loss: 0.006564 in 2.223 sec
Iter: 5, Total Loss: 0.006487 in 2.222 sec
Iter: 6, Total Loss: 0.006439 in 2.206 sec
Iter: 7, Total Loss: 0.006402 in 2.230 sec
Iter: 8, Total Loss: 0.006373 in 2.220 sec
Iter: 9, Total Loss: 0.006348 in 2.240 sec
Iter: 10, Total Loss: 0.006327 in 2.256 sec
Iter: 11, Total Loss: 0.006306 in 2.220 sec
Iter: 12, Total Loss: 0.006288 in 2.217 sec
Iter: 13, Total Loss: 0.00627 in 2.220 sec
Iter: 14, Total Loss: 0.006252 in 2.250 sec
Iter: 15, Total Loss: 0.006237 in 2.226 sec
Iter: 16, Total Loss: 0.006221 in 2.212 sec
Iter: 17, Total Loss: 0.006206 in 2.209 sec
Iter: 18, Total Loss: 0.006192 in 2.221 sec
Iter: 19, Total Loss: 0.006179 in 2.229 sec
Iter: 20, Total Loss: 0.006165 in 2.240 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 2.228 with std = 0.015 sec ###
### py4DSTEM ptycho solver is finished in 47.360 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 920.14 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 1024, 6, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 633/16384 [00:00<00:02, 6323.91probe position/s]Normalizing amplitudes:   8%|▊         | 1272/16384 [00:00<00:02, 6359.50probe position/s]Normalizing amplitudes:  12%|█▏        | 1908/16384 [00:00<00:02, 6308.13probe position/s]Normalizing amplitudes:  15%|█▌        | 2539/16384 [00:00<00:02, 5549.27probe position/s]Normalizing amplitudes:  19%|█▉        | 3177/16384 [00:00<00:02, 5820.85probe position/s]Normalizing amplitudes:  23%|██▎       | 3769/16384 [00:00<00:02, 5817.69probe position/s]Normalizing amplitudes:  27%|██▋       | 4358/16384 [00:00<00:02, 5750.64probe position/s]Normalizing amplitudes:  30%|███       | 4938/16384 [00:00<00:02, 5674.00probe position/s]Normalizing amplitudes:  34%|███▍      | 5624/16384 [00:00<00:01, 6029.13probe position/s]Normalizing amplitudes:  39%|███▊      | 6327/16384 [00:01<00:01, 6327.55probe position/s]Normalizing amplitudes:  42%|████▏     | 6963/16384 [00:01<00:01, 6297.66probe position/s]Normalizing amplitudes:  46%|████▋     | 7595/16384 [00:01<00:01, 6216.06probe position/s]Normalizing amplitudes:  50%|█████     | 8219/16384 [00:01<00:01, 6106.60probe position/s]Normalizing amplitudes:  54%|█████▍    | 8859/16384 [00:01<00:01, 6190.78probe position/s]Normalizing amplitudes:  58%|█████▊    | 9498/16384 [00:01<00:01, 6248.78probe position/s]Normalizing amplitudes:  62%|██████▏   | 10154/16384 [00:01<00:00, 6338.62probe position/s]Normalizing amplitudes:  66%|██████▌   | 10792/16384 [00:01<00:00, 6350.24probe position/s]Normalizing amplitudes:  70%|██████▉   | 11436/16384 [00:01<00:00, 6374.19probe position/s]Normalizing amplitudes:  74%|███████▎  | 12081/16384 [00:01<00:00, 6396.23probe position/s]Normalizing amplitudes:  78%|███████▊  | 12721/16384 [00:02<00:00, 6324.92probe position/s]Normalizing amplitudes:  82%|████████▏ | 13354/16384 [00:02<00:00, 5953.26probe position/s]Normalizing amplitudes:  85%|████████▌ | 13969/16384 [00:02<00:00, 6007.27probe position/s]Normalizing amplitudes:  89%|████████▉ | 14617/16384 [00:02<00:00, 6142.98probe position/s]Normalizing amplitudes:  93%|█████████▎| 15293/16384 [00:02<00:00, 6322.28probe position/s]Normalizing amplitudes:  97%|█████████▋| 15948/16384 [00:02<00:00, 6388.29probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6166.00probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random1024_p6_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random1024_p6_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.1969 in 5.979 sec
Iter: 2, Total Loss: 0.008061 in 5.990 sec
Iter: 3, Total Loss: 0.007085 in 5.960 sec
Iter: 4, Total Loss: 0.006802 in 5.958 sec
Iter: 5, Total Loss: 0.006664 in 5.940 sec
Iter: 6, Total Loss: 0.006572 in 5.961 sec
Iter: 7, Total Loss: 0.006502 in 5.946 sec
Iter: 8, Total Loss: 0.006445 in 5.956 sec
Iter: 9, Total Loss: 0.006397 in 5.946 sec
Iter: 10, Total Loss: 0.006355 in 5.963 sec
Iter: 11, Total Loss: 0.006319 in 5.959 sec
Iter: 12, Total Loss: 0.006286 in 5.954 sec
Iter: 13, Total Loss: 0.006257 in 5.964 sec
Iter: 14, Total Loss: 0.00623 in 5.946 sec
Iter: 15, Total Loss: 0.006206 in 5.972 sec
Iter: 16, Total Loss: 0.006183 in 5.983 sec
Iter: 17, Total Loss: 0.006162 in 5.957 sec
Iter: 18, Total Loss: 0.006142 in 5.963 sec
Iter: 19, Total Loss: 0.006123 in 5.991 sec
Iter: 20, Total Loss: 0.006105 in 6.004 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 5.965 with std = 0.017 sec ###
### py4DSTEM ptycho solver is finished in 2 min 1.953 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 913.77 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 1024, 6, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 519/16384 [00:00<00:03, 5187.69probe position/s]Normalizing amplitudes:   7%|▋         | 1151/16384 [00:00<00:02, 5851.53probe position/s]Normalizing amplitudes:  11%|█         | 1737/16384 [00:00<00:02, 5834.79probe position/s]Normalizing amplitudes:  14%|█▍        | 2364/16384 [00:00<00:02, 6005.68probe position/s]Normalizing amplitudes:  18%|█▊        | 2987/16384 [00:00<00:02, 6084.12probe position/s]Normalizing amplitudes:  22%|██▏       | 3610/16384 [00:00<00:02, 6132.12probe position/s]Normalizing amplitudes:  26%|██▌       | 4230/16384 [00:00<00:01, 6153.94probe position/s]Normalizing amplitudes:  30%|██▉       | 4849/16384 [00:00<00:01, 6164.18probe position/s]Normalizing amplitudes:  33%|███▎      | 5466/16384 [00:00<00:01, 6090.97probe position/s]Normalizing amplitudes:  37%|███▋      | 6076/16384 [00:01<00:01, 6044.05probe position/s]Normalizing amplitudes:  41%|████      | 6703/16384 [00:01<00:01, 6111.48probe position/s]Normalizing amplitudes:  45%|████▍     | 7328/16384 [00:01<00:01, 6151.15probe position/s]Normalizing amplitudes:  49%|████▊     | 7967/16384 [00:01<00:01, 6222.13probe position/s]Normalizing amplitudes:  52%|█████▏    | 8600/16384 [00:01<00:01, 6251.59probe position/s]Normalizing amplitudes:  56%|█████▋    | 9226/16384 [00:01<00:01, 6044.32probe position/s]Normalizing amplitudes:  60%|██████    | 9832/16384 [00:01<00:01, 6025.98probe position/s]Normalizing amplitudes:  64%|██████▍   | 10453/16384 [00:01<00:00, 6079.70probe position/s]Normalizing amplitudes:  68%|██████▊   | 11085/16384 [00:01<00:00, 6148.72probe position/s]Normalizing amplitudes:  71%|███████▏  | 11708/16384 [00:01<00:00, 6169.55probe position/s]Normalizing amplitudes:  75%|███████▌  | 12334/16384 [00:02<00:00, 6194.22probe position/s]Normalizing amplitudes:  79%|███████▉  | 12954/16384 [00:02<00:00, 6184.68probe position/s]Normalizing amplitudes:  83%|████████▎ | 13595/16384 [00:02<00:00, 6249.71probe position/s]Normalizing amplitudes:  87%|████████▋ | 14221/16384 [00:02<00:00, 6102.10probe position/s]Normalizing amplitudes:  91%|█████████ | 14833/16384 [00:02<00:00, 6082.63probe position/s]Normalizing amplitudes:  94%|█████████▍| 15462/16384 [00:02<00:00, 6140.42probe position/s]Normalizing amplitudes:  98%|█████████▊| 16077/16384 [00:02<00:00, 6134.29probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6111.65probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random1024_p6_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random1024_p6_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.196 in 11.512 sec
Iter: 2, Total Loss: 0.009713 in 11.450 sec
Iter: 3, Total Loss: 0.007722 in 11.459 sec
Iter: 4, Total Loss: 0.007134 in 11.453 sec
Iter: 5, Total Loss: 0.006843 in 11.444 sec
Iter: 6, Total Loss: 0.006663 in 11.460 sec
Iter: 7, Total Loss: 0.006531 in 11.432 sec
Iter: 8, Total Loss: 0.00643 in 11.462 sec
Iter: 9, Total Loss: 0.006352 in 11.476 sec
Iter: 10, Total Loss: 0.00629 in 11.437 sec
Iter: 11, Total Loss: 0.00624 in 11.463 sec
Iter: 12, Total Loss: 0.006197 in 11.470 sec
Iter: 13, Total Loss: 0.006162 in 11.445 sec
Iter: 14, Total Loss: 0.00613 in 11.419 sec
Iter: 15, Total Loss: 0.006104 in 11.441 sec
Iter: 16, Total Loss: 0.006079 in 11.450 sec
Iter: 17, Total Loss: 0.006057 in 11.452 sec
Iter: 18, Total Loss: 0.006038 in 11.478 sec
Iter: 19, Total Loss: 0.006019 in 11.433 sec
Iter: 20, Total Loss: 0.006001 in 11.473 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 11.456 with std = 0.020 sec ###
### py4DSTEM ptycho solver is finished in 3 min 51.853 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 913.60 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 1024, 12, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 616/16384 [00:00<00:02, 6159.43probe position/s]Normalizing amplitudes:   8%|▊         | 1232/16384 [00:00<00:02, 6072.66probe position/s]Normalizing amplitudes:  11%|█▏        | 1848/16384 [00:00<00:02, 6110.44probe position/s]Normalizing amplitudes:  15%|█▌        | 2460/16384 [00:00<00:02, 6076.52probe position/s]Normalizing amplitudes:  19%|█▉        | 3111/16384 [00:00<00:02, 6228.68probe position/s]Normalizing amplitudes:  23%|██▎       | 3760/16384 [00:00<00:01, 6316.24probe position/s]Normalizing amplitudes:  27%|██▋       | 4404/16384 [00:00<00:01, 6353.61probe position/s]Normalizing amplitudes:  31%|███       | 5040/16384 [00:00<00:01, 6163.86probe position/s]Normalizing amplitudes:  35%|███▍      | 5658/16384 [00:00<00:01, 6137.17probe position/s]Normalizing amplitudes:  38%|███▊      | 6273/16384 [00:01<00:01, 6042.63probe position/s]Normalizing amplitudes:  42%|████▏     | 6878/16384 [00:01<00:01, 6031.61probe position/s]Normalizing amplitudes:  46%|████▌     | 7512/16384 [00:01<00:01, 6120.83probe position/s]Normalizing amplitudes:  50%|████▉     | 8164/16384 [00:01<00:01, 6237.73probe position/s]Normalizing amplitudes:  54%|█████▎    | 8805/16384 [00:01<00:01, 6287.50probe position/s]Normalizing amplitudes:  58%|█████▊    | 9435/16384 [00:01<00:01, 6270.31probe position/s]Normalizing amplitudes:  61%|██████▏   | 10063/16384 [00:01<00:01, 6267.17probe position/s]Normalizing amplitudes:  65%|██████▌   | 10690/16384 [00:01<00:00, 6086.00probe position/s]Normalizing amplitudes:  69%|██████▉   | 11300/16384 [00:01<00:00, 6075.71probe position/s]Normalizing amplitudes:  73%|███████▎  | 11949/16384 [00:01<00:00, 6197.44probe position/s]Normalizing amplitudes:  77%|███████▋  | 12606/16384 [00:02<00:00, 6305.64probe position/s]Normalizing amplitudes:  81%|████████  | 13238/16384 [00:02<00:00, 6216.55probe position/s]Normalizing amplitudes:  85%|████████▍ | 13861/16384 [00:02<00:00, 5998.47probe position/s]Normalizing amplitudes:  88%|████████▊ | 14463/16384 [00:02<00:00, 5959.97probe position/s]Normalizing amplitudes:  92%|█████████▏| 15061/16384 [00:02<00:00, 5759.59probe position/s]Normalizing amplitudes:  96%|█████████▌| 15649/16384 [00:02<00:00, 5791.17probe position/s]Normalizing amplitudes:  99%|█████████▉| 16262/16384 [00:02<00:00, 5886.61probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6096.65probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random1024_p12_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random1024_p12_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
Iter: 1, Total Loss: 0.54 in 4.042 sec
Iter: 2, Total Loss: 0.007354 in 4.004 sec
Iter: 3, Total Loss: 0.006864 in 4.083 sec
Iter: 4, Total Loss: 0.006665 in 4.032 sec
Iter: 5, Total Loss: 0.006558 in 4.019 sec
Iter: 6, Total Loss: 0.006492 in 4.049 sec
Iter: 7, Total Loss: 0.006444 in 4.018 sec
Iter: 8, Total Loss: 0.006405 in 4.022 sec
Iter: 9, Total Loss: 0.006373 in 4.010 sec
Iter: 10, Total Loss: 0.006344 in 3.996 sec
Iter: 11, Total Loss: 0.006316 in 4.021 sec
Iter: 12, Total Loss: 0.00629 in 4.029 sec
Iter: 13, Total Loss: 0.006267 in 4.058 sec
Iter: 14, Total Loss: 0.006243 in 4.031 sec
Iter: 15, Total Loss: 0.006222 in 4.039 sec
Iter: 16, Total Loss: 0.006201 in 4.019 sec
Iter: 17, Total Loss: 0.006182 in 4.028 sec
Iter: 18, Total Loss: 0.006163 in 4.026 sec
Iter: 19, Total Loss: 0.006145 in 4.017 sec
Iter: 20, Total Loss: 0.006128 in 4.038 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 4.029 with std = 0.019 sec ###
### py4DSTEM ptycho solver is finished in 1 min 23.274 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 913.58 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 1024, 12, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 575/16384 [00:00<00:02, 5748.00probe position/s]Normalizing amplitudes:   7%|▋         | 1212/16384 [00:00<00:02, 6108.73probe position/s]Normalizing amplitudes:  11%|█         | 1823/16384 [00:00<00:02, 5847.42probe position/s]Normalizing amplitudes:  15%|█▍        | 2453/16384 [00:00<00:02, 6019.62probe position/s]Normalizing amplitudes:  19%|█▊        | 3057/16384 [00:00<00:02, 5963.00probe position/s]Normalizing amplitudes:  22%|██▏       | 3676/16384 [00:00<00:02, 6038.06probe position/s]Normalizing amplitudes:  26%|██▋       | 4327/16384 [00:00<00:01, 6187.29probe position/s]Normalizing amplitudes:  30%|███       | 4964/16384 [00:00<00:01, 6241.63probe position/s]Normalizing amplitudes:  34%|███▍      | 5589/16384 [00:00<00:01, 6179.74probe position/s]Normalizing amplitudes:  38%|███▊      | 6224/16384 [00:01<00:01, 6231.15probe position/s]Normalizing amplitudes:  42%|████▏     | 6848/16384 [00:01<00:01, 6223.81probe position/s]Normalizing amplitudes:  46%|████▌     | 7498/16384 [00:01<00:01, 6306.85probe position/s]Normalizing amplitudes:  50%|████▉     | 8146/16384 [00:01<00:01, 6355.80probe position/s]Normalizing amplitudes:  54%|█████▎    | 8782/16384 [00:01<00:01, 6100.38probe position/s]Normalizing amplitudes:  58%|█████▊    | 9426/16384 [00:01<00:01, 6199.20probe position/s]Normalizing amplitudes:  61%|██████▏   | 10059/16384 [00:01<00:01, 6234.54probe position/s]Normalizing amplitudes:  65%|██████▌   | 10687/16384 [00:01<00:00, 6246.79probe position/s]Normalizing amplitudes:  69%|██████▉   | 11313/16384 [00:01<00:00, 6129.86probe position/s]Normalizing amplitudes:  73%|███████▎  | 11929/16384 [00:01<00:00, 6137.17probe position/s]Normalizing amplitudes:  77%|███████▋  | 12556/16384 [00:02<00:00, 6174.85probe position/s]Normalizing amplitudes:  80%|████████  | 13175/16384 [00:02<00:00, 5992.06probe position/s]Normalizing amplitudes:  84%|████████▍ | 13791/16384 [00:02<00:00, 6038.63probe position/s]Normalizing amplitudes:  88%|████████▊ | 14425/16384 [00:02<00:00, 6125.65probe position/s]Normalizing amplitudes:  92%|█████████▏| 15039/16384 [00:02<00:00, 5717.99probe position/s]Normalizing amplitudes:  96%|█████████▌| 15681/16384 [00:02<00:00, 5914.16probe position/s]Normalizing amplitudes: 100%|█████████▉| 16309/16384 [00:02<00:00, 6018.71probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6097.57probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random1024_p12_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random1024_p12_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
An error occurred for (round, batch, pmode, slice) = (5, 1024, 12, 3): Out of memory allocating 1,610,612,736 bytes (allocated so far: 18,790,481,920 bytes).
### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 913.51 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 1024, 12, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 610/16384 [00:00<00:02, 6093.25probe position/s]Normalizing amplitudes:   7%|▋         | 1220/16384 [00:00<00:02, 5992.11probe position/s]Normalizing amplitudes:  11%|█         | 1820/16384 [00:00<00:02, 5942.84probe position/s]Normalizing amplitudes:  15%|█▌        | 2460/16384 [00:00<00:02, 6119.97probe position/s]Normalizing amplitudes:  19%|█▉        | 3073/16384 [00:00<00:02, 6067.30probe position/s]Normalizing amplitudes:  22%|██▏       | 3680/16384 [00:00<00:02, 5850.60probe position/s]Normalizing amplitudes:  26%|██▌       | 4267/16384 [00:00<00:02, 5720.50probe position/s]Normalizing amplitudes:  30%|██▉       | 4841/16384 [00:00<00:02, 5710.82probe position/s]Normalizing amplitudes:  33%|███▎      | 5481/16384 [00:00<00:01, 5919.61probe position/s]Normalizing amplitudes:  37%|███▋      | 6133/16384 [00:01<00:01, 6099.95probe position/s]Normalizing amplitudes:  41%|████▏     | 6769/16384 [00:01<00:01, 6175.82probe position/s]Normalizing amplitudes:  45%|████▌     | 7403/16384 [00:01<00:01, 6222.77probe position/s]Normalizing amplitudes:  49%|████▉     | 8035/16384 [00:01<00:01, 6250.21probe position/s]Normalizing amplitudes:  53%|█████▎    | 8664/16384 [00:01<00:01, 6261.65probe position/s]Normalizing amplitudes:  57%|█████▋    | 9291/16384 [00:01<00:01, 6226.21probe position/s]Normalizing amplitudes:  61%|██████    | 9944/16384 [00:01<00:01, 6315.30probe position/s]Normalizing amplitudes:  65%|██████▍   | 10583/16384 [00:01<00:00, 6336.18probe position/s]Normalizing amplitudes:  68%|██████▊   | 11217/16384 [00:01<00:00, 6293.01probe position/s]Normalizing amplitudes:  72%|███████▏  | 11847/16384 [00:01<00:00, 6244.21probe position/s]Normalizing amplitudes:  76%|███████▌  | 12472/16384 [00:02<00:00, 6224.75probe position/s]Normalizing amplitudes:  80%|████████  | 13134/16384 [00:02<00:00, 6342.12probe position/s]Normalizing amplitudes:  84%|████████▍ | 13813/16384 [00:02<00:00, 6474.62probe position/s]Normalizing amplitudes:  88%|████████▊ | 14461/16384 [00:02<00:00, 6372.14probe position/s]Normalizing amplitudes:  92%|█████████▏| 15099/16384 [00:02<00:00, 6152.54probe position/s]Normalizing amplitudes:  96%|█████████▌| 15716/16384 [00:02<00:00, 6116.33probe position/s]Normalizing amplitudes: 100%|█████████▉| 16343/16384 [00:02<00:00, 6158.82probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6152.16probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random1024_p12_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 1024, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random1024_p12_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 1024 measurements.
An error occurred for (round, batch, pmode, slice) = (5, 1024, 12, 6): Out of memory allocating 1,610,612,736 bytes (allocated so far: 18,790,481,920 bytes).
### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 913.50 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 512, 1, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 576/16384 [00:00<00:02, 5746.29probe position/s]Normalizing amplitudes:   7%|▋         | 1157/16384 [00:00<00:02, 5779.95probe position/s]Normalizing amplitudes:  11%|█         | 1781/16384 [00:00<00:02, 5989.25probe position/s]Normalizing amplitudes:  15%|█▍        | 2435/16384 [00:00<00:02, 6205.40probe position/s]Normalizing amplitudes:  19%|█▊        | 3056/16384 [00:00<00:02, 6180.81probe position/s]Normalizing amplitudes:  23%|██▎       | 3691/16384 [00:00<00:02, 6237.35probe position/s]Normalizing amplitudes:  26%|██▋       | 4326/16384 [00:00<00:01, 6273.43probe position/s]Normalizing amplitudes:  30%|███       | 4954/16384 [00:00<00:01, 6240.08probe position/s]Normalizing amplitudes:  34%|███▍      | 5593/16384 [00:00<00:01, 6286.56probe position/s]Normalizing amplitudes:  38%|███▊      | 6230/16384 [00:01<00:01, 6310.24probe position/s]Normalizing amplitudes:  42%|████▏     | 6862/16384 [00:01<00:01, 6248.75probe position/s]Normalizing amplitudes:  46%|████▌     | 7488/16384 [00:01<00:01, 6206.41probe position/s]Normalizing amplitudes:  49%|████▉     | 8110/16384 [00:01<00:01, 6209.83probe position/s]Normalizing amplitudes:  54%|█████▎    | 8783/16384 [00:01<00:01, 6364.50probe position/s]Normalizing amplitudes:  57%|█████▋    | 9420/16384 [00:01<00:01, 6350.50probe position/s]Normalizing amplitudes:  61%|██████▏   | 10056/16384 [00:01<00:01, 6190.74probe position/s]Normalizing amplitudes:  65%|██████▌   | 10685/16384 [00:01<00:00, 6218.71probe position/s]Normalizing amplitudes:  69%|██████▉   | 11308/16384 [00:01<00:00, 6209.15probe position/s]Normalizing amplitudes:  73%|███████▎  | 11969/16384 [00:01<00:00, 6326.40probe position/s]Normalizing amplitudes:  77%|███████▋  | 12609/16384 [00:02<00:00, 6346.80probe position/s]Normalizing amplitudes:  81%|████████  | 13245/16384 [00:02<00:00, 6280.66probe position/s]Normalizing amplitudes:  85%|████████▍ | 13874/16384 [00:02<00:00, 6241.04probe position/s]Normalizing amplitudes:  88%|████████▊ | 14499/16384 [00:02<00:00, 6206.09probe position/s]Normalizing amplitudes:  92%|█████████▏| 15142/16384 [00:02<00:00, 6271.43probe position/s]Normalizing amplitudes:  96%|█████████▋| 15792/16384 [00:02<00:00, 6338.54probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6254.89probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random512_p1_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random512_p1_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.01435 in 0.812 sec
Iter: 2, Total Loss: 0.00651 in 0.756 sec
Iter: 3, Total Loss: 0.006486 in 0.767 sec
Iter: 4, Total Loss: 0.006474 in 0.760 sec
Iter: 5, Total Loss: 0.006468 in 0.738 sec
Iter: 6, Total Loss: 0.006462 in 0.761 sec
Iter: 7, Total Loss: 0.006458 in 0.797 sec
Iter: 8, Total Loss: 0.006455 in 0.755 sec
Iter: 9, Total Loss: 0.006452 in 0.748 sec
Iter: 10, Total Loss: 0.006448 in 0.749 sec
Iter: 11, Total Loss: 0.006445 in 0.751 sec
Iter: 12, Total Loss: 0.006441 in 0.786 sec
Iter: 13, Total Loss: 0.006438 in 0.754 sec
Iter: 14, Total Loss: 0.006434 in 0.756 sec
Iter: 15, Total Loss: 0.006431 in 0.756 sec
Iter: 16, Total Loss: 0.006428 in 0.767 sec
Iter: 17, Total Loss: 0.006425 in 0.764 sec
Iter: 18, Total Loss: 0.006421 in 0.780 sec
Iter: 19, Total Loss: 0.006417 in 0.788 sec
Iter: 20, Total Loss: 0.006413 in 0.766 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 0.766 with std = 0.018 sec ###
### py4DSTEM ptycho solver is finished in 17.841 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 913.58 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 512, 1, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 634/16384 [00:00<00:02, 6331.36probe position/s]Normalizing amplitudes:   8%|▊         | 1268/16384 [00:00<00:02, 6225.37probe position/s]Normalizing amplitudes:  12%|█▏        | 1891/16384 [00:00<00:02, 6137.27probe position/s]Normalizing amplitudes:  15%|█▌        | 2505/16384 [00:00<00:02, 6124.84probe position/s]Normalizing amplitudes:  19%|█▉        | 3127/16384 [00:00<00:02, 6156.75probe position/s]Normalizing amplitudes:  23%|██▎       | 3743/16384 [00:00<00:02, 6065.50probe position/s]Normalizing amplitudes:  27%|██▋       | 4365/16384 [00:00<00:01, 6113.12probe position/s]Normalizing amplitudes:  30%|███       | 4977/16384 [00:00<00:01, 6102.35probe position/s]Normalizing amplitudes:  34%|███▍      | 5607/16384 [00:00<00:01, 6161.86probe position/s]Normalizing amplitudes:  38%|███▊      | 6229/16384 [00:01<00:01, 6177.19probe position/s]Normalizing amplitudes:  42%|████▏     | 6847/16384 [00:01<00:01, 6135.49probe position/s]Normalizing amplitudes:  46%|████▌     | 7461/16384 [00:01<00:01, 5769.43probe position/s]Normalizing amplitudes:  49%|████▉     | 8100/16384 [00:01<00:01, 5947.66probe position/s]Normalizing amplitudes:  53%|█████▎    | 8715/16384 [00:01<00:01, 6006.23probe position/s]Normalizing amplitudes:  57%|█████▋    | 9319/16384 [00:01<00:01, 5917.81probe position/s]Normalizing amplitudes:  61%|██████    | 9946/16384 [00:01<00:01, 6020.74probe position/s]Normalizing amplitudes:  65%|██████▍   | 10568/16384 [00:01<00:00, 6078.03probe position/s]Normalizing amplitudes:  68%|██████▊   | 11181/16384 [00:01<00:00, 6091.48probe position/s]Normalizing amplitudes:  72%|███████▏  | 11804/16384 [00:01<00:00, 6131.20probe position/s]Normalizing amplitudes:  76%|███████▌  | 12418/16384 [00:02<00:00, 6095.34probe position/s]Normalizing amplitudes:  80%|███████▉  | 13029/16384 [00:02<00:00, 6098.07probe position/s]Normalizing amplitudes:  83%|████████▎ | 13647/16384 [00:02<00:00, 6120.79probe position/s]Normalizing amplitudes:  87%|████████▋ | 14260/16384 [00:02<00:00, 6025.67probe position/s]Normalizing amplitudes:  91%|█████████ | 14878/16384 [00:02<00:00, 6071.02probe position/s]Normalizing amplitudes:  95%|█████████▍| 15491/16384 [00:02<00:00, 6085.88probe position/s]Normalizing amplitudes:  98%|█████████▊| 16138/16384 [00:02<00:00, 6197.28probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6096.78probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random512_p1_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random512_p1_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.01468 in 1.553 sec
Iter: 2, Total Loss: 0.006506 in 1.515 sec
Iter: 3, Total Loss: 0.006484 in 1.509 sec
Iter: 4, Total Loss: 0.006472 in 1.510 sec
Iter: 5, Total Loss: 0.006465 in 1.512 sec
Iter: 6, Total Loss: 0.006458 in 1.498 sec
Iter: 7, Total Loss: 0.006453 in 1.523 sec
Iter: 8, Total Loss: 0.006446 in 1.522 sec
Iter: 9, Total Loss: 0.00644 in 1.507 sec
Iter: 10, Total Loss: 0.006434 in 1.554 sec
Iter: 11, Total Loss: 0.006428 in 1.507 sec
Iter: 12, Total Loss: 0.006423 in 1.565 sec
Iter: 13, Total Loss: 0.006417 in 1.499 sec
Iter: 14, Total Loss: 0.006412 in 1.525 sec
Iter: 15, Total Loss: 0.006407 in 1.526 sec
Iter: 16, Total Loss: 0.006402 in 1.545 sec
Iter: 17, Total Loss: 0.006396 in 1.534 sec
Iter: 18, Total Loss: 0.006392 in 1.518 sec
Iter: 19, Total Loss: 0.006387 in 1.517 sec
Iter: 20, Total Loss: 0.006382 in 1.529 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 1.523 with std = 0.018 sec ###
### py4DSTEM ptycho solver is finished in 33.438 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 914.10 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 512, 1, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 616/16384 [00:00<00:02, 6150.09probe position/s]Normalizing amplitudes:   8%|▊         | 1232/16384 [00:00<00:02, 6099.18probe position/s]Normalizing amplitudes:  11%|█         | 1842/16384 [00:00<00:02, 6092.57probe position/s]Normalizing amplitudes:  15%|█▌        | 2481/16384 [00:00<00:02, 6209.15probe position/s]Normalizing amplitudes:  19%|█▉        | 3134/16384 [00:00<00:02, 6323.69probe position/s]Normalizing amplitudes:  23%|██▎       | 3767/16384 [00:00<00:02, 6189.04probe position/s]Normalizing amplitudes:  27%|██▋       | 4387/16384 [00:00<00:01, 6176.13probe position/s]Normalizing amplitudes:  31%|███       | 5005/16384 [00:00<00:01, 6037.66probe position/s]Normalizing amplitudes:  34%|███▍      | 5638/16384 [00:00<00:01, 6124.73probe position/s]Normalizing amplitudes:  38%|███▊      | 6300/16384 [00:01<00:01, 6273.29probe position/s]Normalizing amplitudes:  42%|████▏     | 6929/16384 [00:01<00:01, 6253.16probe position/s]Normalizing amplitudes:  46%|████▌     | 7555/16384 [00:01<00:01, 6136.02probe position/s]Normalizing amplitudes:  50%|█████     | 8193/16384 [00:01<00:01, 6205.75probe position/s]Normalizing amplitudes:  54%|█████▍    | 8816/16384 [00:01<00:01, 6211.01probe position/s]Normalizing amplitudes:  58%|█████▊    | 9438/16384 [00:01<00:01, 6171.75probe position/s]Normalizing amplitudes:  62%|██████▏   | 10078/16384 [00:01<00:01, 6237.12probe position/s]Normalizing amplitudes:  65%|██████▌   | 10720/16384 [00:01<00:00, 6290.33probe position/s]Normalizing amplitudes:  69%|██████▉   | 11364/16384 [00:01<00:00, 6331.87probe position/s]Normalizing amplitudes:  73%|███████▎  | 11998/16384 [00:01<00:00, 6296.33probe position/s]Normalizing amplitudes:  77%|███████▋  | 12628/16384 [00:02<00:00, 6254.51probe position/s]Normalizing amplitudes:  81%|████████  | 13259/16384 [00:02<00:00, 6268.45probe position/s]Normalizing amplitudes:  85%|████████▍ | 13886/16384 [00:02<00:00, 6220.97probe position/s]Normalizing amplitudes:  89%|████████▊ | 14524/16384 [00:02<00:00, 6266.24probe position/s]Normalizing amplitudes:  92%|█████████▏| 15151/16384 [00:02<00:00, 6226.95probe position/s]Normalizing amplitudes:  96%|█████████▋| 15782/16384 [00:02<00:00, 6249.83probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6224.75probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random512_p1_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random512_p1_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.01513 in 2.677 sec
Iter: 2, Total Loss: 0.006535 in 2.618 sec
Iter: 3, Total Loss: 0.006507 in 2.623 sec
Iter: 4, Total Loss: 0.006493 in 2.597 sec
Iter: 5, Total Loss: 0.00648 in 2.616 sec
Iter: 6, Total Loss: 0.006469 in 2.607 sec
Iter: 7, Total Loss: 0.00646 in 2.621 sec
Iter: 8, Total Loss: 0.006452 in 2.668 sec
Iter: 9, Total Loss: 0.006445 in 2.635 sec
Iter: 10, Total Loss: 0.006437 in 2.651 sec
Iter: 11, Total Loss: 0.006428 in 2.616 sec
Iter: 12, Total Loss: 0.00642 in 2.610 sec
Iter: 13, Total Loss: 0.006414 in 2.615 sec
Iter: 14, Total Loss: 0.006407 in 2.625 sec
Iter: 15, Total Loss: 0.0064 in 2.646 sec
Iter: 16, Total Loss: 0.006394 in 2.636 sec
Iter: 17, Total Loss: 0.006388 in 2.621 sec
Iter: 18, Total Loss: 0.006379 in 2.618 sec
Iter: 19, Total Loss: 0.006374 in 2.638 sec
Iter: 20, Total Loss: 0.006368 in 2.612 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 2.628 with std = 0.020 sec ###
### py4DSTEM ptycho solver is finished in 55.376 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 923.27 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 512, 3, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 633/16384 [00:00<00:02, 6327.95probe position/s]Normalizing amplitudes:   8%|▊         | 1284/16384 [00:00<00:02, 6429.30probe position/s]Normalizing amplitudes:  12%|█▏        | 1927/16384 [00:00<00:02, 6267.03probe position/s]Normalizing amplitudes:  16%|█▌        | 2555/16384 [00:00<00:02, 6200.39probe position/s]Normalizing amplitudes:  20%|█▉        | 3206/16384 [00:00<00:02, 6309.30probe position/s]Normalizing amplitudes:  24%|██▎       | 3861/16384 [00:00<00:01, 6387.29probe position/s]Normalizing amplitudes:  27%|██▋       | 4501/16384 [00:00<00:01, 6184.66probe position/s]Normalizing amplitudes:  31%|███▏      | 5121/16384 [00:00<00:01, 6183.01probe position/s]Normalizing amplitudes:  35%|███▌      | 5744/16384 [00:00<00:01, 6195.96probe position/s]Normalizing amplitudes:  39%|███▉      | 6377/16384 [00:01<00:01, 6236.17probe position/s]Normalizing amplitudes:  43%|████▎     | 7023/16384 [00:01<00:01, 6303.61probe position/s]Normalizing amplitudes:  47%|████▋     | 7682/16384 [00:01<00:01, 6386.98probe position/s]Normalizing amplitudes:  51%|█████     | 8343/16384 [00:01<00:01, 6451.30probe position/s]Normalizing amplitudes:  55%|█████▍    | 8989/16384 [00:01<00:01, 6408.00probe position/s]Normalizing amplitudes:  59%|█████▉    | 9631/16384 [00:01<00:01, 6322.25probe position/s]Normalizing amplitudes:  63%|██████▎   | 10286/16384 [00:01<00:00, 6389.52probe position/s]Normalizing amplitudes:  67%|██████▋   | 10940/16384 [00:01<00:00, 6433.95probe position/s]Normalizing amplitudes:  71%|███████   | 11584/16384 [00:01<00:00, 6364.08probe position/s]Normalizing amplitudes:  75%|███████▍  | 12232/16384 [00:01<00:00, 6397.95probe position/s]Normalizing amplitudes:  79%|███████▊  | 12890/16384 [00:02<00:00, 6450.69probe position/s]Normalizing amplitudes:  83%|████████▎ | 13551/16384 [00:02<00:00, 6496.47probe position/s]Normalizing amplitudes:  87%|████████▋ | 14231/16384 [00:02<00:00, 6585.31probe position/s]Normalizing amplitudes:  91%|█████████ | 14890/16384 [00:02<00:00, 6454.07probe position/s]Normalizing amplitudes:  95%|█████████▍| 15544/16384 [00:02<00:00, 6478.48probe position/s]Normalizing amplitudes:  99%|█████████▉| 16193/16384 [00:02<00:00, 6457.44probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6376.51probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random512_p3_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random512_p3_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.03868 in 1.484 sec
Iter: 2, Total Loss: 0.006603 in 1.419 sec
Iter: 3, Total Loss: 0.006475 in 1.412 sec
Iter: 4, Total Loss: 0.006425 in 1.446 sec
Iter: 5, Total Loss: 0.006397 in 1.450 sec
Iter: 6, Total Loss: 0.006378 in 1.430 sec
Iter: 7, Total Loss: 0.006362 in 1.460 sec
Iter: 8, Total Loss: 0.006347 in 1.457 sec
Iter: 9, Total Loss: 0.006332 in 1.408 sec
Iter: 10, Total Loss: 0.006318 in 1.418 sec
Iter: 11, Total Loss: 0.006303 in 1.456 sec
Iter: 12, Total Loss: 0.006288 in 1.451 sec
Iter: 13, Total Loss: 0.006272 in 1.411 sec
Iter: 14, Total Loss: 0.006258 in 1.435 sec
Iter: 15, Total Loss: 0.00624 in 1.432 sec
Iter: 16, Total Loss: 0.006225 in 1.421 sec
Iter: 17, Total Loss: 0.006208 in 1.471 sec
Iter: 18, Total Loss: 0.006194 in 1.469 sec
Iter: 19, Total Loss: 0.006176 in 1.416 sec
Iter: 20, Total Loss: 0.006161 in 1.421 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 1.438 with std = 0.022 sec ###
### py4DSTEM ptycho solver is finished in 31.468 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 919.78 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 512, 3, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 627/16384 [00:00<00:02, 6259.35probe position/s]Normalizing amplitudes:   8%|▊         | 1253/16384 [00:00<00:02, 5906.99probe position/s]Normalizing amplitudes:  12%|█▏        | 1906/16384 [00:00<00:02, 6180.27probe position/s]Normalizing amplitudes:  16%|█▌        | 2600/16384 [00:00<00:02, 6474.08probe position/s]Normalizing amplitudes:  20%|█▉        | 3249/16384 [00:00<00:02, 6398.20probe position/s]Normalizing amplitudes:  24%|██▎       | 3890/16384 [00:00<00:01, 6290.53probe position/s]Normalizing amplitudes:  28%|██▊       | 4520/16384 [00:00<00:01, 6216.82probe position/s]Normalizing amplitudes:  31%|███▏      | 5143/16384 [00:00<00:01, 6126.84probe position/s]Normalizing amplitudes:  35%|███▌      | 5757/16384 [00:00<00:01, 5974.68probe position/s]Normalizing amplitudes:  39%|███▉      | 6356/16384 [00:01<00:01, 5975.54probe position/s]Normalizing amplitudes:  43%|████▎     | 7032/16384 [00:01<00:01, 6209.22probe position/s]Normalizing amplitudes:  47%|████▋     | 7664/16384 [00:01<00:01, 6241.60probe position/s]Normalizing amplitudes:  51%|█████     | 8298/16384 [00:01<00:01, 6268.73probe position/s]Normalizing amplitudes:  54%|█████▍    | 8926/16384 [00:01<00:01, 6225.58probe position/s]Normalizing amplitudes:  58%|█████▊    | 9552/16384 [00:01<00:01, 6234.23probe position/s]Normalizing amplitudes:  62%|██████▏   | 10188/16384 [00:01<00:00, 6269.38probe position/s]Normalizing amplitudes:  66%|██████▌   | 10816/16384 [00:01<00:00, 6252.89probe position/s]Normalizing amplitudes:  70%|██████▉   | 11442/16384 [00:01<00:00, 6249.07probe position/s]Normalizing amplitudes:  74%|███████▎  | 12072/16384 [00:01<00:00, 6262.57probe position/s]Normalizing amplitudes:  78%|███████▊  | 12711/16384 [00:02<00:00, 6299.28probe position/s]Normalizing amplitudes:  81%|████████▏ | 13342/16384 [00:02<00:00, 6227.20probe position/s]Normalizing amplitudes:  85%|████████▌ | 13970/16384 [00:02<00:00, 6239.63probe position/s]Normalizing amplitudes:  89%|████████▉ | 14595/16384 [00:02<00:00, 6229.55probe position/s]Normalizing amplitudes:  93%|█████████▎| 15219/16384 [00:02<00:00, 6174.74probe position/s]Normalizing amplitudes:  97%|█████████▋| 15848/16384 [00:02<00:00, 6205.54probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6220.68probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random512_p3_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random512_p3_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.03947 in 3.585 sec
Iter: 2, Total Loss: 0.006718 in 3.434 sec
Iter: 3, Total Loss: 0.006474 in 3.438 sec
Iter: 4, Total Loss: 0.00641 in 3.437 sec
Iter: 5, Total Loss: 0.00637 in 3.441 sec
Iter: 6, Total Loss: 0.006336 in 3.432 sec
Iter: 7, Total Loss: 0.006305 in 3.439 sec
Iter: 8, Total Loss: 0.006275 in 3.490 sec
Iter: 9, Total Loss: 0.006248 in 3.443 sec
Iter: 10, Total Loss: 0.00622 in 3.460 sec
Iter: 11, Total Loss: 0.006195 in 3.472 sec
Iter: 12, Total Loss: 0.00617 in 3.487 sec
Iter: 13, Total Loss: 0.006147 in 3.474 sec
Iter: 14, Total Loss: 0.006126 in 3.461 sec
Iter: 15, Total Loss: 0.006103 in 3.459 sec
Iter: 16, Total Loss: 0.006082 in 3.462 sec
Iter: 17, Total Loss: 0.006061 in 3.454 sec
Iter: 18, Total Loss: 0.00604 in 3.448 sec
Iter: 19, Total Loss: 0.006021 in 3.464 sec
Iter: 20, Total Loss: 0.006001 in 3.458 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 3.462 with std = 0.033 sec ###
### py4DSTEM ptycho solver is finished in 1 min 11.948 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 913.57 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 512, 3, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 597/16384 [00:00<00:02, 5968.37probe position/s]Normalizing amplitudes:   8%|▊         | 1232/16384 [00:00<00:02, 6191.01probe position/s]Normalizing amplitudes:  11%|█▏        | 1852/16384 [00:00<00:02, 6002.48probe position/s]Normalizing amplitudes:  15%|█▍        | 2453/16384 [00:00<00:02, 5806.29probe position/s]Normalizing amplitudes:  19%|█▉        | 3075/16384 [00:00<00:02, 5949.62probe position/s]Normalizing amplitudes:  23%|██▎       | 3699/16384 [00:00<00:02, 6045.82probe position/s]Normalizing amplitudes:  26%|██▋       | 4310/16384 [00:00<00:01, 6065.68probe position/s]Normalizing amplitudes:  30%|███       | 4936/16384 [00:00<00:01, 6126.31probe position/s]Normalizing amplitudes:  34%|███▍      | 5567/16384 [00:00<00:01, 6181.48probe position/s]Normalizing amplitudes:  38%|███▊      | 6187/16384 [00:01<00:01, 6185.52probe position/s]Normalizing amplitudes:  42%|████▏     | 6813/16384 [00:01<00:01, 6207.21probe position/s]Normalizing amplitudes:  45%|████▌     | 7440/16384 [00:01<00:01, 6223.85probe position/s]Normalizing amplitudes:  49%|████▉     | 8082/16384 [00:01<00:01, 6282.33probe position/s]Normalizing amplitudes:  53%|█████▎    | 8716/16384 [00:01<00:01, 6297.79probe position/s]Normalizing amplitudes:  57%|█████▋    | 9346/16384 [00:01<00:01, 6231.11probe position/s]Normalizing amplitudes:  61%|██████    | 9972/16384 [00:01<00:01, 6195.50probe position/s]Normalizing amplitudes:  65%|██████▍   | 10610/16384 [00:01<00:00, 6247.31probe position/s]Normalizing amplitudes:  69%|██████▊   | 11243/16384 [00:01<00:00, 6271.65probe position/s]Normalizing amplitudes:  73%|███████▎  | 11882/16384 [00:01<00:00, 6305.72probe position/s]Normalizing amplitudes:  76%|███████▋  | 12513/16384 [00:02<00:00, 6292.99probe position/s]Normalizing amplitudes:  80%|████████  | 13143/16384 [00:02<00:00, 6279.81probe position/s]Normalizing amplitudes:  84%|████████▍ | 13772/16384 [00:02<00:00, 6278.95probe position/s]Normalizing amplitudes:  88%|████████▊ | 14400/16384 [00:02<00:00, 6252.04probe position/s]Normalizing amplitudes:  92%|█████████▏| 15036/16384 [00:02<00:00, 6283.26probe position/s]Normalizing amplitudes:  96%|█████████▌| 15682/16384 [00:02<00:00, 6335.75probe position/s]Normalizing amplitudes: 100%|█████████▉| 16325/16384 [00:02<00:00, 6363.79probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6216.67probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random512_p3_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random512_p3_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.04034 in 6.521 sec
Iter: 2, Total Loss: 0.006936 in 6.467 sec
Iter: 3, Total Loss: 0.006489 in 6.461 sec
Iter: 4, Total Loss: 0.006364 in 6.461 sec
Iter: 5, Total Loss: 0.006287 in 6.442 sec
Iter: 6, Total Loss: 0.006227 in 6.463 sec
Iter: 7, Total Loss: 0.00618 in 6.458 sec
Iter: 8, Total Loss: 0.00614 in 6.464 sec
Iter: 9, Total Loss: 0.006105 in 6.470 sec
Iter: 10, Total Loss: 0.006073 in 6.459 sec
Iter: 11, Total Loss: 0.006044 in 6.506 sec
Iter: 12, Total Loss: 0.006016 in 6.468 sec
Iter: 13, Total Loss: 0.005992 in 6.451 sec
Iter: 14, Total Loss: 0.005969 in 6.427 sec
Iter: 15, Total Loss: 0.005946 in 6.473 sec
Iter: 16, Total Loss: 0.005925 in 6.428 sec
Iter: 17, Total Loss: 0.005905 in 6.462 sec
Iter: 18, Total Loss: 0.005886 in 6.484 sec
Iter: 19, Total Loss: 0.005866 in 6.446 sec
Iter: 20, Total Loss: 0.005848 in 6.438 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 6.462 with std = 0.022 sec ###
### py4DSTEM ptycho solver is finished in 2 min 12.071 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 913.55 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 512, 6, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 651/16384 [00:00<00:02, 6504.11probe position/s]Normalizing amplitudes:   8%|▊         | 1302/16384 [00:00<00:02, 6455.72probe position/s]Normalizing amplitudes:  12%|█▏        | 1948/16384 [00:00<00:02, 6349.14probe position/s]Normalizing amplitudes:  16%|█▌        | 2584/16384 [00:00<00:02, 6232.55probe position/s]Normalizing amplitudes:  20%|█▉        | 3228/16384 [00:00<00:02, 6303.92probe position/s]Normalizing amplitudes:  24%|██▎       | 3859/16384 [00:00<00:02, 6220.02probe position/s]Normalizing amplitudes:  27%|██▋       | 4489/16384 [00:00<00:01, 6243.99probe position/s]Normalizing amplitudes:  31%|███       | 5114/16384 [00:00<00:01, 6111.70probe position/s]Normalizing amplitudes:  35%|███▌      | 5738/16384 [00:00<00:01, 6150.64probe position/s]Normalizing amplitudes:  39%|███▉      | 6389/16384 [00:01<00:01, 6259.11probe position/s]Normalizing amplitudes:  43%|████▎     | 7016/16384 [00:01<00:01, 5976.97probe position/s]Normalizing amplitudes:  46%|████▋     | 7617/16384 [00:01<00:01, 5933.03probe position/s]Normalizing amplitudes:  50%|█████     | 8213/16384 [00:01<00:01, 5885.16probe position/s]Normalizing amplitudes:  54%|█████▍    | 8847/16384 [00:01<00:01, 6016.60probe position/s]Normalizing amplitudes:  58%|█████▊    | 9490/16384 [00:01<00:01, 6136.03probe position/s]Normalizing amplitudes:  62%|██████▏   | 10138/16384 [00:01<00:01, 6234.70probe position/s]Normalizing amplitudes:  66%|██████▌   | 10784/16384 [00:01<00:00, 6300.78probe position/s]Normalizing amplitudes:  70%|██████▉   | 11415/16384 [00:01<00:00, 6224.12probe position/s]Normalizing amplitudes:  74%|███████▎  | 12043/16384 [00:01<00:00, 6239.20probe position/s]Normalizing amplitudes:  77%|███████▋  | 12668/16384 [00:02<00:00, 6216.99probe position/s]Normalizing amplitudes:  81%|████████▏ | 13318/16384 [00:02<00:00, 6298.07probe position/s]Normalizing amplitudes:  86%|████████▌ | 14028/16384 [00:02<00:00, 6535.00probe position/s]Normalizing amplitudes:  90%|████████▉ | 14682/16384 [00:02<00:00, 6505.07probe position/s]Normalizing amplitudes:  94%|█████████▎| 15333/16384 [00:02<00:00, 6431.39probe position/s]Normalizing amplitudes:  98%|█████████▊| 15977/16384 [00:02<00:00, 6376.77probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6231.71probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random512_p6_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random512_p6_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.1059 in 2.470 sec
Iter: 2, Total Loss: 0.006776 in 2.390 sec
Iter: 3, Total Loss: 0.006543 in 2.357 sec
Iter: 4, Total Loss: 0.006448 in 2.387 sec
Iter: 5, Total Loss: 0.006397 in 2.356 sec
Iter: 6, Total Loss: 0.006362 in 2.372 sec
Iter: 7, Total Loss: 0.006333 in 2.405 sec
Iter: 8, Total Loss: 0.006308 in 2.400 sec
Iter: 9, Total Loss: 0.006284 in 2.386 sec
Iter: 10, Total Loss: 0.006261 in 2.372 sec
Iter: 11, Total Loss: 0.006239 in 2.411 sec
Iter: 12, Total Loss: 0.006218 in 2.389 sec
Iter: 13, Total Loss: 0.006197 in 2.364 sec
Iter: 14, Total Loss: 0.006176 in 2.382 sec
Iter: 15, Total Loss: 0.006155 in 2.385 sec
Iter: 16, Total Loss: 0.006135 in 2.351 sec
Iter: 17, Total Loss: 0.006115 in 2.369 sec
Iter: 18, Total Loss: 0.006096 in 2.377 sec
Iter: 19, Total Loss: 0.006077 in 2.379 sec
Iter: 20, Total Loss: 0.006059 in 2.392 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 2.385 with std = 0.025 sec ###
### py4DSTEM ptycho solver is finished in 50.453 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 914.86 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 512, 6, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 616/16384 [00:00<00:02, 6157.73probe position/s]Normalizing amplitudes:   8%|▊         | 1263/16384 [00:00<00:02, 6337.79probe position/s]Normalizing amplitudes:  12%|█▏        | 1897/16384 [00:00<00:02, 6288.99probe position/s]Normalizing amplitudes:  16%|█▌        | 2552/16384 [00:00<00:02, 6390.31probe position/s]Normalizing amplitudes:  19%|█▉        | 3192/16384 [00:00<00:02, 6040.33probe position/s]Normalizing amplitudes:  23%|██▎       | 3810/16384 [00:00<00:02, 6085.79probe position/s]Normalizing amplitudes:  27%|██▋       | 4447/16384 [00:00<00:01, 6174.29probe position/s]Normalizing amplitudes:  31%|███       | 5069/16384 [00:00<00:01, 6187.72probe position/s]Normalizing amplitudes:  35%|███▍      | 5702/16384 [00:00<00:01, 6229.40probe position/s]Normalizing amplitudes:  39%|███▊      | 6333/16384 [00:01<00:01, 6252.81probe position/s]Normalizing amplitudes:  43%|████▎     | 6974/16384 [00:01<00:01, 6298.91probe position/s]Normalizing amplitudes:  47%|████▋     | 7620/16384 [00:01<00:01, 6347.54probe position/s]Normalizing amplitudes:  50%|█████     | 8259/16384 [00:01<00:01, 6358.21probe position/s]Normalizing amplitudes:  54%|█████▍    | 8896/16384 [00:01<00:01, 6292.21probe position/s]Normalizing amplitudes:  58%|█████▊    | 9526/16384 [00:01<00:01, 6261.73probe position/s]Normalizing amplitudes:  62%|██████▏   | 10160/16384 [00:01<00:00, 6284.09probe position/s]Normalizing amplitudes:  66%|██████▌   | 10812/16384 [00:01<00:00, 6353.76probe position/s]Normalizing amplitudes:  70%|██████▉   | 11464/16384 [00:01<00:00, 6401.01probe position/s]Normalizing amplitudes:  74%|███████▍  | 12105/16384 [00:01<00:00, 6379.24probe position/s]Normalizing amplitudes:  78%|███████▊  | 12744/16384 [00:02<00:00, 6362.77probe position/s]Normalizing amplitudes:  82%|████████▏ | 13381/16384 [00:02<00:00, 6341.10probe position/s]Normalizing amplitudes:  86%|████████▌ | 14021/16384 [00:02<00:00, 6358.01probe position/s]Normalizing amplitudes:  89%|████████▉ | 14662/16384 [00:02<00:00, 6370.64probe position/s]Normalizing amplitudes:  93%|█████████▎| 15309/16384 [00:02<00:00, 6400.29probe position/s]Normalizing amplitudes:  97%|█████████▋| 15950/16384 [00:02<00:00, 6186.74probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6273.89probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random512_p6_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random512_p6_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.1067 in 6.401 sec
Iter: 2, Total Loss: 0.007159 in 6.396 sec
Iter: 3, Total Loss: 0.006633 in 6.399 sec
Iter: 4, Total Loss: 0.006489 in 6.385 sec
Iter: 5, Total Loss: 0.00641 in 6.397 sec
Iter: 6, Total Loss: 0.006351 in 6.388 sec
Iter: 7, Total Loss: 0.006303 in 6.379 sec
Iter: 8, Total Loss: 0.006261 in 6.378 sec
Iter: 9, Total Loss: 0.006224 in 6.445 sec
Iter: 10, Total Loss: 0.006191 in 6.363 sec
Iter: 11, Total Loss: 0.00616 in 6.401 sec
Iter: 12, Total Loss: 0.006132 in 6.391 sec
Iter: 13, Total Loss: 0.006106 in 6.415 sec
Iter: 14, Total Loss: 0.006081 in 6.398 sec
Iter: 15, Total Loss: 0.006057 in 6.395 sec
Iter: 16, Total Loss: 0.006035 in 6.420 sec
Iter: 17, Total Loss: 0.006013 in 6.385 sec
Iter: 18, Total Loss: 0.005992 in 6.381 sec
Iter: 19, Total Loss: 0.005973 in 6.408 sec
Iter: 20, Total Loss: 0.005952 in 6.386 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 6.396 with std = 0.017 sec ###
### py4DSTEM ptycho solver is finished in 2 min 10.803 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 913.63 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 512, 6, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 535/16384 [00:00<00:02, 5345.11probe position/s]Normalizing amplitudes:   7%|▋         | 1112/16384 [00:00<00:02, 5594.00probe position/s]Normalizing amplitudes:  10%|█         | 1707/16384 [00:00<00:02, 5755.62probe position/s]Normalizing amplitudes:  14%|█▍        | 2283/16384 [00:00<00:02, 5704.91probe position/s]Normalizing amplitudes:  17%|█▋        | 2854/16384 [00:00<00:02, 5573.84probe position/s]Normalizing amplitudes:  21%|██▏       | 3503/16384 [00:00<00:02, 5877.99probe position/s]Normalizing amplitudes:  25%|██▍       | 4092/16384 [00:00<00:02, 5832.21probe position/s]Normalizing amplitudes:  29%|██▉       | 4729/16384 [00:00<00:01, 5998.76probe position/s]Normalizing amplitudes:  33%|███▎      | 5369/16384 [00:00<00:01, 6122.51probe position/s]Normalizing amplitudes:  37%|███▋      | 6017/16384 [00:01<00:01, 6230.78probe position/s]Normalizing amplitudes:  41%|████      | 6641/16384 [00:01<00:01, 6114.80probe position/s]Normalizing amplitudes:  44%|████▍     | 7254/16384 [00:01<00:01, 6098.56probe position/s]Normalizing amplitudes:  48%|████▊     | 7885/16384 [00:01<00:01, 6161.34probe position/s]Normalizing amplitudes:  52%|█████▏    | 8530/16384 [00:01<00:01, 6247.23probe position/s]Normalizing amplitudes:  56%|█████▌    | 9173/16384 [00:01<00:01, 6301.25probe position/s]Normalizing amplitudes:  60%|█████▉    | 9804/16384 [00:01<00:01, 6244.86probe position/s]Normalizing amplitudes:  64%|██████▎   | 10429/16384 [00:01<00:00, 6222.65probe position/s]Normalizing amplitudes:  67%|██████▋   | 11052/16384 [00:01<00:00, 6034.24probe position/s]Normalizing amplitudes:  71%|███████   | 11657/16384 [00:01<00:00, 5423.81probe position/s]Normalizing amplitudes:  75%|███████▌  | 12319/16384 [00:02<00:00, 5747.94probe position/s]Normalizing amplitudes:  79%|███████▉  | 12940/16384 [00:02<00:00, 5875.88probe position/s]Normalizing amplitudes:  83%|████████▎ | 13557/16384 [00:02<00:00, 5958.67probe position/s]Normalizing amplitudes:  87%|████████▋ | 14209/16384 [00:02<00:00, 6119.34probe position/s]Normalizing amplitudes:  90%|█████████ | 14827/16384 [00:02<00:00, 6134.44probe position/s]Normalizing amplitudes:  94%|█████████▍| 15454/16384 [00:02<00:00, 6173.41probe position/s]Normalizing amplitudes:  98%|█████████▊| 16074/16384 [00:02<00:00, 6173.40probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6009.51probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random512_p6_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random512_p6_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.1059 in 12.390 sec
Iter: 2, Total Loss: 0.007706 in 12.378 sec
Iter: 3, Total Loss: 0.006703 in 12.342 sec
Iter: 4, Total Loss: 0.006443 in 12.519 sec
Iter: 5, Total Loss: 0.006309 in 12.383 sec
Iter: 6, Total Loss: 0.006218 in 12.305 sec
Iter: 7, Total Loss: 0.006151 in 12.311 sec
Iter: 8, Total Loss: 0.006099 in 12.356 sec
Iter: 9, Total Loss: 0.006053 in 12.335 sec
Iter: 10, Total Loss: 0.006014 in 12.299 sec
Iter: 11, Total Loss: 0.005979 in 12.364 sec
Iter: 12, Total Loss: 0.005949 in 12.335 sec
Iter: 13, Total Loss: 0.00592 in 12.400 sec
Iter: 14, Total Loss: 0.005895 in 12.333 sec
Iter: 15, Total Loss: 0.005868 in 12.367 sec
Iter: 16, Total Loss: 0.005845 in 12.255 sec
Iter: 17, Total Loss: 0.005823 in 12.291 sec
Iter: 18, Total Loss: 0.005801 in 12.327 sec
Iter: 19, Total Loss: 0.00578 in 12.331 sec
Iter: 20, Total Loss: 0.005759 in 12.399 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 12.351 with std = 0.054 sec ###
### py4DSTEM ptycho solver is finished in 4 min 10.608 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 923.38 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 512, 12, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 562/16384 [00:00<00:02, 5615.91probe position/s]Normalizing amplitudes:   7%|▋         | 1228/16384 [00:00<00:02, 6228.15probe position/s]Normalizing amplitudes:  12%|█▏        | 1893/16384 [00:00<00:02, 6417.76probe position/s]Normalizing amplitudes:  15%|█▌        | 2535/16384 [00:00<00:02, 6385.47probe position/s]Normalizing amplitudes:  19%|█▉        | 3174/16384 [00:00<00:02, 6340.32probe position/s]Normalizing amplitudes:  23%|██▎       | 3809/16384 [00:00<00:02, 6236.12probe position/s]Normalizing amplitudes:  27%|██▋       | 4491/16384 [00:00<00:01, 6423.39probe position/s]Normalizing amplitudes:  31%|███▏      | 5145/16384 [00:00<00:01, 6458.75probe position/s]Normalizing amplitudes:  35%|███▌      | 5792/16384 [00:00<00:01, 6396.61probe position/s]Normalizing amplitudes:  39%|███▉      | 6446/16384 [00:01<00:01, 6438.90probe position/s]Normalizing amplitudes:  43%|████▎     | 7116/16384 [00:01<00:01, 6516.29probe position/s]Normalizing amplitudes:  48%|████▊     | 7786/16384 [00:01<00:01, 6569.41probe position/s]Normalizing amplitudes:  52%|█████▏    | 8444/16384 [00:01<00:01, 6425.27probe position/s]Normalizing amplitudes:  55%|█████▌    | 9088/16384 [00:01<00:01, 6321.19probe position/s]Normalizing amplitudes:  59%|█████▉    | 9735/16384 [00:01<00:01, 6363.45probe position/s]Normalizing amplitudes:  63%|██████▎   | 10395/16384 [00:01<00:00, 6430.75probe position/s]Normalizing amplitudes:  68%|██████▊   | 11093/16384 [00:01<00:00, 6592.30probe position/s]Normalizing amplitudes:  72%|███████▏  | 11753/16384 [00:01<00:00, 6431.71probe position/s]Normalizing amplitudes:  76%|███████▌  | 12398/16384 [00:01<00:00, 6394.38probe position/s]Normalizing amplitudes:  80%|███████▉  | 13039/16384 [00:02<00:00, 6356.27probe position/s]Normalizing amplitudes:  84%|████████▎ | 13684/16384 [00:02<00:00, 6382.27probe position/s]Normalizing amplitudes:  88%|████████▊ | 14345/16384 [00:02<00:00, 6446.31probe position/s]Normalizing amplitudes:  92%|█████████▏| 14997/16384 [00:02<00:00, 6467.40probe position/s]Normalizing amplitudes:  95%|█████████▌| 15645/16384 [00:02<00:00, 6426.38probe position/s]Normalizing amplitudes:  99%|█████████▉| 16288/16384 [00:02<00:00, 6392.61probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6397.38probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random512_p12_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random512_p12_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.2739 in 4.430 sec
Iter: 2, Total Loss: 0.007005 in 4.382 sec
Iter: 3, Total Loss: 0.006645 in 4.398 sec
Iter: 4, Total Loss: 0.006507 in 4.349 sec
Iter: 5, Total Loss: 0.006434 in 4.364 sec
Iter: 6, Total Loss: 0.006387 in 4.296 sec
Iter: 7, Total Loss: 0.006351 in 4.306 sec
Iter: 8, Total Loss: 0.006321 in 4.333 sec
Iter: 9, Total Loss: 0.006294 in 4.421 sec
Iter: 10, Total Loss: 0.006268 in 4.481 sec
Iter: 11, Total Loss: 0.006244 in 4.334 sec
Iter: 12, Total Loss: 0.006221 in 4.368 sec
Iter: 13, Total Loss: 0.006197 in 4.358 sec
Iter: 14, Total Loss: 0.006175 in 4.373 sec
Iter: 15, Total Loss: 0.006153 in 4.350 sec
Iter: 16, Total Loss: 0.006132 in 4.370 sec
Iter: 17, Total Loss: 0.006111 in 4.341 sec
Iter: 18, Total Loss: 0.006091 in 4.405 sec
Iter: 19, Total Loss: 0.006071 in 4.389 sec
Iter: 20, Total Loss: 0.00605 in 4.370 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 4.371 with std = 0.042 sec ###
### py4DSTEM ptycho solver is finished in 1 min 30.175 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 913.60 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 512, 12, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 621/16384 [00:00<00:02, 6202.60probe position/s]Normalizing amplitudes:   8%|▊         | 1251/16384 [00:00<00:02, 6256.09probe position/s]Normalizing amplitudes:  12%|█▏        | 1889/16384 [00:00<00:02, 6312.34probe position/s]Normalizing amplitudes:  15%|█▌        | 2537/16384 [00:00<00:02, 6375.48probe position/s]Normalizing amplitudes:  19%|█▉        | 3175/16384 [00:00<00:02, 6298.17probe position/s]Normalizing amplitudes:  23%|██▎       | 3805/16384 [00:00<00:02, 6231.75probe position/s]Normalizing amplitudes:  27%|██▋       | 4429/16384 [00:00<00:01, 6203.47probe position/s]Normalizing amplitudes:  31%|███       | 5069/16384 [00:00<00:01, 6264.22probe position/s]Normalizing amplitudes:  35%|███▍      | 5698/16384 [00:00<00:01, 6271.15probe position/s]Normalizing amplitudes:  39%|███▊      | 6326/16384 [00:01<00:01, 6084.18probe position/s]Normalizing amplitudes:  42%|████▏     | 6936/16384 [00:01<00:01, 5969.68probe position/s]Normalizing amplitudes:  46%|████▌     | 7534/16384 [00:01<00:01, 5851.17probe position/s]Normalizing amplitudes:  50%|████▉     | 8121/16384 [00:01<00:01, 5829.55probe position/s]Normalizing amplitudes:  53%|█████▎    | 8705/16384 [00:01<00:01, 5757.85probe position/s]Normalizing amplitudes:  57%|█████▋    | 9348/16384 [00:01<00:01, 5953.39probe position/s]Normalizing amplitudes:  61%|██████    | 9949/16384 [00:01<00:01, 5968.67probe position/s]Normalizing amplitudes:  64%|██████▍   | 10547/16384 [00:01<00:00, 5906.47probe position/s]Normalizing amplitudes:  68%|██████▊   | 11139/16384 [00:01<00:00, 5757.72probe position/s]Normalizing amplitudes:  72%|███████▏  | 11716/16384 [00:01<00:00, 5648.98probe position/s]Normalizing amplitudes:  75%|███████▌  | 12337/16384 [00:02<00:00, 5809.75probe position/s]Normalizing amplitudes:  79%|███████▉  | 12976/16384 [00:02<00:00, 5979.09probe position/s]Normalizing amplitudes:  83%|████████▎ | 13576/16384 [00:02<00:00, 5970.18probe position/s]Normalizing amplitudes:  87%|████████▋ | 14210/16384 [00:02<00:00, 6079.37probe position/s]Normalizing amplitudes:  90%|█████████ | 14819/16384 [00:02<00:00, 6054.13probe position/s]Normalizing amplitudes:  94%|█████████▍| 15452/16384 [00:02<00:00, 6135.74probe position/s]Normalizing amplitudes:  98%|█████████▊| 16067/16384 [00:02<00:00, 5993.43probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6011.79probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random512_p12_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random512_p12_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.2714 in 12.331 sec
Iter: 2, Total Loss: 0.007556 in 12.263 sec
Iter: 3, Total Loss: 0.006795 in 12.243 sec
Iter: 4, Total Loss: 0.006546 in 12.234 sec
Iter: 5, Total Loss: 0.006416 in 12.269 sec
Iter: 6, Total Loss: 0.006326 in 12.255 sec
Iter: 7, Total Loss: 0.006259 in 12.257 sec
Iter: 8, Total Loss: 0.006205 in 12.227 sec
Iter: 9, Total Loss: 0.006158 in 12.228 sec
Iter: 10, Total Loss: 0.006118 in 12.297 sec
Iter: 11, Total Loss: 0.006081 in 12.290 sec
Iter: 12, Total Loss: 0.006049 in 12.251 sec
Iter: 13, Total Loss: 0.006018 in 12.186 sec
Iter: 14, Total Loss: 0.005989 in 12.231 sec
Iter: 15, Total Loss: 0.005961 in 12.231 sec
Iter: 16, Total Loss: 0.005936 in 12.229 sec
Iter: 17, Total Loss: 0.005911 in 12.192 sec
Iter: 18, Total Loss: 0.005887 in 12.227 sec
Iter: 19, Total Loss: 0.005864 in 12.196 sec
Iter: 20, Total Loss: 0.005842 in 12.141 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 12.239 with std = 0.041 sec ###
### py4DSTEM ptycho solver is finished in 4 min 7.464 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 926.91 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 512, 12, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 648/16384 [00:00<00:02, 6478.76probe position/s]Normalizing amplitudes:   8%|▊         | 1324/16384 [00:00<00:02, 6643.27probe position/s]Normalizing amplitudes:  12%|█▏        | 1993/16384 [00:00<00:02, 6662.38probe position/s]Normalizing amplitudes:  16%|█▌        | 2660/16384 [00:00<00:02, 6601.13probe position/s]Normalizing amplitudes:  20%|██        | 3321/16384 [00:00<00:01, 6598.99probe position/s]Normalizing amplitudes:  24%|██▍       | 3981/16384 [00:00<00:01, 6414.97probe position/s]Normalizing amplitudes:  28%|██▊       | 4638/16384 [00:00<00:01, 6463.57probe position/s]Normalizing amplitudes:  32%|███▏      | 5311/16384 [00:00<00:01, 6544.30probe position/s]Normalizing amplitudes:  36%|███▋      | 5976/16384 [00:00<00:01, 6574.50probe position/s]Normalizing amplitudes:  40%|████      | 6634/16384 [00:01<00:01, 6561.42probe position/s]Normalizing amplitudes:  45%|████▍     | 7294/16384 [00:01<00:01, 6572.40probe position/s]Normalizing amplitudes:  49%|████▊     | 7962/16384 [00:01<00:01, 6604.59probe position/s]Normalizing amplitudes:  53%|█████▎    | 8648/16384 [00:01<00:01, 6681.59probe position/s]Normalizing amplitudes:  57%|█████▋    | 9317/16384 [00:01<00:01, 6614.62probe position/s]Normalizing amplitudes:  61%|██████    | 9979/16384 [00:01<00:00, 6613.10probe position/s]Normalizing amplitudes:  65%|██████▍   | 10641/16384 [00:01<00:00, 6515.43probe position/s]Normalizing amplitudes:  69%|██████▉   | 11293/16384 [00:01<00:00, 6479.42probe position/s]Normalizing amplitudes:  73%|███████▎  | 11950/16384 [00:01<00:00, 6504.48probe position/s]Normalizing amplitudes:  77%|███████▋  | 12627/16384 [00:01<00:00, 6580.99probe position/s]Normalizing amplitudes:  81%|████████  | 13289/16384 [00:02<00:00, 6589.15probe position/s]Normalizing amplitudes:  85%|████████▌ | 13953/16384 [00:02<00:00, 6602.07probe position/s]Normalizing amplitudes:  89%|████████▉ | 14614/16384 [00:02<00:00, 6580.73probe position/s]Normalizing amplitudes:  93%|█████████▎| 15283/16384 [00:02<00:00, 6609.17probe position/s]Normalizing amplitudes:  97%|█████████▋| 15954/16384 [00:02<00:00, 6638.66probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6576.83probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random512_p12_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 512, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random512_p12_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 512 measurements.
Iter: 1, Total Loss: 0.2695 in 23.954 sec
Iter: 2, Total Loss: 0.008923 in 23.795 sec
Iter: 3, Total Loss: 0.007224 in 23.837 sec
Iter: 4, Total Loss: 0.006744 in 23.780 sec
Iter: 5, Total Loss: 0.006511 in 23.790 sec
Iter: 6, Total Loss: 0.006365 in 23.819 sec
Iter: 7, Total Loss: 0.006262 in 23.817 sec
Iter: 8, Total Loss: 0.006183 in 23.773 sec
Iter: 9, Total Loss: 0.006119 in 23.768 sec
Iter: 10, Total Loss: 0.006068 in 23.799 sec
Iter: 11, Total Loss: 0.006024 in 23.754 sec
Iter: 12, Total Loss: 0.005984 in 23.915 sec
Iter: 13, Total Loss: 0.005951 in 24.404 sec
Iter: 14, Total Loss: 0.005919 in 23.923 sec
Iter: 15, Total Loss: 0.00589 in 23.980 sec
Iter: 16, Total Loss: 0.005863 in 24.074 sec
Iter: 17, Total Loss: 0.005838 in 24.049 sec
Iter: 18, Total Loss: 0.005814 in 24.041 sec
Iter: 19, Total Loss: 0.005791 in 24.006 sec
Iter: 20, Total Loss: 0.00577 in 24.106 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 23.919 with std = 0.159 sec ###
### py4DSTEM ptycho solver is finished in 8 min 1.293 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 913.82 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 256, 1, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 626/16384 [00:00<00:02, 6259.69probe position/s]Normalizing amplitudes:   8%|▊         | 1252/16384 [00:00<00:02, 5921.93probe position/s]Normalizing amplitudes:  11%|█▏        | 1866/16384 [00:00<00:02, 6016.42probe position/s]Normalizing amplitudes:  15%|█▌        | 2485/16384 [00:00<00:02, 6081.37probe position/s]Normalizing amplitudes:  19%|█▉        | 3115/16384 [00:00<00:02, 6157.69probe position/s]Normalizing amplitudes:  23%|██▎       | 3732/16384 [00:00<00:02, 6052.31probe position/s]Normalizing amplitudes:  27%|██▋       | 4342/16384 [00:00<00:01, 6067.02probe position/s]Normalizing amplitudes:  30%|███       | 4984/16384 [00:00<00:01, 6176.53probe position/s]Normalizing amplitudes:  35%|███▍      | 5665/16384 [00:00<00:01, 6371.07probe position/s]Normalizing amplitudes:  38%|███▊      | 6303/16384 [00:01<00:01, 6289.91probe position/s]Normalizing amplitudes:  42%|████▏     | 6933/16384 [00:01<00:01, 6142.90probe position/s]Normalizing amplitudes:  46%|████▌     | 7549/16384 [00:01<00:01, 6090.18probe position/s]Normalizing amplitudes:  50%|████▉     | 8159/16384 [00:01<00:01, 6079.97probe position/s]Normalizing amplitudes:  54%|█████▍    | 8814/16384 [00:01<00:01, 6218.32probe position/s]Normalizing amplitudes:  58%|█████▊    | 9473/16384 [00:01<00:01, 6325.34probe position/s]Normalizing amplitudes:  62%|██████▏   | 10107/16384 [00:01<00:00, 6322.56probe position/s]Normalizing amplitudes:  66%|██████▌   | 10740/16384 [00:01<00:00, 6013.73probe position/s]Normalizing amplitudes:  69%|██████▉   | 11352/16384 [00:01<00:00, 6041.80probe position/s]Normalizing amplitudes:  73%|███████▎  | 11983/16384 [00:01<00:00, 6117.47probe position/s]Normalizing amplitudes:  77%|███████▋  | 12641/16384 [00:02<00:00, 6253.28probe position/s]Normalizing amplitudes:  81%|████████  | 13268/16384 [00:02<00:00, 6234.19probe position/s]Normalizing amplitudes:  85%|████████▍ | 13909/16384 [00:02<00:00, 6284.32probe position/s]Normalizing amplitudes:  89%|████████▊ | 14539/16384 [00:02<00:00, 6186.63probe position/s]Normalizing amplitudes:  93%|█████████▎| 15175/16384 [00:02<00:00, 6237.06probe position/s]Normalizing amplitudes:  97%|█████████▋| 15827/16384 [00:02<00:00, 6317.28probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6159.18probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random256_p1_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random256_p1_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.01046 in 0.939 sec
Iter: 2, Total Loss: 0.00651 in 0.892 sec
Iter: 3, Total Loss: 0.006487 in 0.934 sec
Iter: 4, Total Loss: 0.006474 in 0.889 sec
Iter: 5, Total Loss: 0.006466 in 0.891 sec
Iter: 6, Total Loss: 0.006459 in 0.926 sec
Iter: 7, Total Loss: 0.006452 in 0.894 sec
Iter: 8, Total Loss: 0.006445 in 0.912 sec
Iter: 9, Total Loss: 0.006438 in 0.904 sec
Iter: 10, Total Loss: 0.006432 in 0.886 sec
Iter: 11, Total Loss: 0.006425 in 0.912 sec
Iter: 12, Total Loss: 0.006417 in 0.867 sec
Iter: 13, Total Loss: 0.00641 in 0.888 sec
Iter: 14, Total Loss: 0.006402 in 0.890 sec
Iter: 15, Total Loss: 0.006395 in 0.909 sec
Iter: 16, Total Loss: 0.006387 in 0.929 sec
Iter: 17, Total Loss: 0.006379 in 0.887 sec
Iter: 18, Total Loss: 0.006372 in 0.914 sec
Iter: 19, Total Loss: 0.006363 in 0.921 sec
Iter: 20, Total Loss: 0.006356 in 0.905 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 0.904 with std = 0.019 sec ###
### py4DSTEM ptycho solver is finished in 20.753 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 913.82 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 256, 1, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 591/16384 [00:00<00:02, 5905.23probe position/s]Normalizing amplitudes:   7%|▋         | 1226/16384 [00:00<00:02, 6162.72probe position/s]Normalizing amplitudes:  11%|█▏        | 1853/16384 [00:00<00:02, 6209.55probe position/s]Normalizing amplitudes:  15%|█▌        | 2495/16384 [00:00<00:02, 6289.50probe position/s]Normalizing amplitudes:  19%|█▉        | 3138/16384 [00:00<00:02, 6336.46probe position/s]Normalizing amplitudes:  23%|██▎       | 3772/16384 [00:00<00:02, 6247.19probe position/s]Normalizing amplitudes:  27%|██▋       | 4413/16384 [00:00<00:01, 6299.81probe position/s]Normalizing amplitudes:  31%|███       | 5058/16384 [00:00<00:01, 6346.09probe position/s]Normalizing amplitudes:  35%|███▍      | 5699/16384 [00:00<00:01, 6364.93probe position/s]Normalizing amplitudes:  39%|███▊      | 6336/16384 [00:01<00:01, 6295.93probe position/s]Normalizing amplitudes:  43%|████▎     | 6972/16384 [00:01<00:01, 6314.98probe position/s]Normalizing amplitudes:  47%|████▋     | 7631/16384 [00:01<00:01, 6396.59probe position/s]Normalizing amplitudes:  50%|█████     | 8271/16384 [00:01<00:01, 6365.22probe position/s]Normalizing amplitudes:  54%|█████▍    | 8908/16384 [00:01<00:01, 6330.03probe position/s]Normalizing amplitudes:  58%|█████▊    | 9542/16384 [00:01<00:01, 6309.40probe position/s]Normalizing amplitudes:  62%|██████▏   | 10174/16384 [00:01<00:00, 6268.85probe position/s]Normalizing amplitudes:  66%|██████▌   | 10802/16384 [00:01<00:00, 6271.05probe position/s]Normalizing amplitudes:  70%|██████▉   | 11447/16384 [00:01<00:00, 6323.68probe position/s]Normalizing amplitudes:  74%|███████▍  | 12111/16384 [00:01<00:00, 6416.06probe position/s]Normalizing amplitudes:  78%|███████▊  | 12769/16384 [00:02<00:00, 6464.74probe position/s]Normalizing amplitudes:  82%|████████▏ | 13416/16384 [00:02<00:00, 6387.10probe position/s]Normalizing amplitudes:  86%|████████▌ | 14055/16384 [00:02<00:00, 6320.51probe position/s]Normalizing amplitudes:  90%|████████▉ | 14688/16384 [00:02<00:00, 6272.31probe position/s]Normalizing amplitudes:  93%|█████████▎| 15316/16384 [00:02<00:00, 6202.24probe position/s]Normalizing amplitudes:  97%|█████████▋| 15939/16384 [00:02<00:00, 6208.21probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6304.54probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random256_p1_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random256_p1_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.01067 in 1.948 sec
Iter: 2, Total Loss: 0.006516 in 1.791 sec
Iter: 3, Total Loss: 0.006495 in 1.794 sec
Iter: 4, Total Loss: 0.006481 in 1.821 sec
Iter: 5, Total Loss: 0.006469 in 1.801 sec
Iter: 6, Total Loss: 0.00646 in 1.887 sec
Iter: 7, Total Loss: 0.006449 in 1.785 sec
Iter: 8, Total Loss: 0.006438 in 1.799 sec
Iter: 9, Total Loss: 0.006429 in 1.835 sec
Iter: 10, Total Loss: 0.00642 in 1.791 sec
Iter: 11, Total Loss: 0.006409 in 1.794 sec
Iter: 12, Total Loss: 0.006398 in 1.813 sec
Iter: 13, Total Loss: 0.006389 in 1.795 sec
Iter: 14, Total Loss: 0.00638 in 1.802 sec
Iter: 15, Total Loss: 0.006369 in 1.789 sec
Iter: 16, Total Loss: 0.00636 in 1.784 sec
Iter: 17, Total Loss: 0.00635 in 1.810 sec
Iter: 18, Total Loss: 0.006342 in 1.808 sec
Iter: 19, Total Loss: 0.006331 in 1.804 sec
Iter: 20, Total Loss: 0.006323 in 1.828 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 1.814 with std = 0.038 sec ###
### py4DSTEM ptycho solver is finished in 39.224 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 913.80 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 256, 1, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 611/16384 [00:00<00:02, 6108.62probe position/s]Normalizing amplitudes:   8%|▊         | 1250/16384 [00:00<00:02, 6270.79probe position/s]Normalizing amplitudes:  12%|█▏        | 1890/16384 [00:00<00:02, 6326.24probe position/s]Normalizing amplitudes:  15%|█▌        | 2523/16384 [00:00<00:02, 6305.23probe position/s]Normalizing amplitudes:  19%|█▉        | 3155/16384 [00:00<00:02, 6309.13probe position/s]Normalizing amplitudes:  23%|██▎       | 3786/16384 [00:00<00:02, 6226.14probe position/s]Normalizing amplitudes:  27%|██▋       | 4414/16384 [00:00<00:01, 6241.36probe position/s]Normalizing amplitudes:  31%|███       | 5049/16384 [00:00<00:01, 6274.12probe position/s]Normalizing amplitudes:  35%|███▍      | 5677/16384 [00:00<00:01, 6206.87probe position/s]Normalizing amplitudes:  39%|███▊      | 6319/16384 [00:01<00:01, 6268.32probe position/s]Normalizing amplitudes:  42%|████▏     | 6953/16384 [00:01<00:01, 6289.86probe position/s]Normalizing amplitudes:  46%|████▋     | 7594/16384 [00:01<00:01, 6324.84probe position/s]Normalizing amplitudes:  50%|█████     | 8227/16384 [00:01<00:01, 6141.38probe position/s]Normalizing amplitudes:  54%|█████▍    | 8843/16384 [00:01<00:01, 5987.19probe position/s]Normalizing amplitudes:  58%|█████▊    | 9444/16384 [00:01<00:01, 5796.83probe position/s]Normalizing amplitudes:  61%|██████▏   | 10052/16384 [00:01<00:01, 5875.08probe position/s]Normalizing amplitudes:  65%|██████▍   | 10642/16384 [00:01<00:01, 5703.70probe position/s]Normalizing amplitudes:  69%|██████▊   | 11260/16384 [00:01<00:00, 5838.37probe position/s]Normalizing amplitudes:  73%|███████▎  | 11911/16384 [00:01<00:00, 6031.36probe position/s]Normalizing amplitudes:  76%|███████▋  | 12517/16384 [00:02<00:00, 6020.38probe position/s]Normalizing amplitudes:  80%|████████  | 13140/16384 [00:02<00:00, 6079.35probe position/s]Normalizing amplitudes:  84%|████████▍ | 13749/16384 [00:02<00:00, 6063.43probe position/s]Normalizing amplitudes:  88%|████████▊ | 14375/16384 [00:02<00:00, 6121.08probe position/s]Normalizing amplitudes:  92%|█████████▏| 15015/16384 [00:02<00:00, 6203.98probe position/s]Normalizing amplitudes:  95%|█████████▌| 15642/16384 [00:02<00:00, 6221.11probe position/s]Normalizing amplitudes:  99%|█████████▉| 16265/16384 [00:02<00:00, 6208.85probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6127.38probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random256_p1_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random256_p1_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.01097 in 3.084 sec
Iter: 2, Total Loss: 0.006561 in 3.054 sec
Iter: 3, Total Loss: 0.006534 in 3.069 sec
Iter: 4, Total Loss: 0.006514 in 3.033 sec
Iter: 5, Total Loss: 0.006498 in 3.091 sec
Iter: 6, Total Loss: 0.006483 in 3.080 sec
Iter: 7, Total Loss: 0.006469 in 3.076 sec
Iter: 8, Total Loss: 0.006453 in 3.030 sec
Iter: 9, Total Loss: 0.00644 in 3.078 sec
Iter: 10, Total Loss: 0.006425 in 3.024 sec
Iter: 11, Total Loss: 0.006414 in 3.066 sec
Iter: 12, Total Loss: 0.0064 in 3.018 sec
Iter: 13, Total Loss: 0.006387 in 3.050 sec
Iter: 14, Total Loss: 0.006375 in 3.052 sec
Iter: 15, Total Loss: 0.006363 in 3.001 sec
Iter: 16, Total Loss: 0.006351 in 2.977 sec
Iter: 17, Total Loss: 0.006338 in 2.992 sec
Iter: 18, Total Loss: 0.006327 in 3.002 sec
Iter: 19, Total Loss: 0.006313 in 3.023 sec
Iter: 20, Total Loss: 0.006302 in 3.031 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 3.042 with std = 0.032 sec ###
### py4DSTEM ptycho solver is finished in 1 min 3.662 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 913.64 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 256, 3, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 619/16384 [00:00<00:02, 6180.21probe position/s]Normalizing amplitudes:   8%|▊         | 1247/16384 [00:00<00:02, 6237.82probe position/s]Normalizing amplitudes:  11%|█▏        | 1871/16384 [00:00<00:02, 6190.85probe position/s]Normalizing amplitudes:  15%|█▌        | 2507/16384 [00:00<00:02, 6256.98probe position/s]Normalizing amplitudes:  19%|█▉        | 3169/16384 [00:00<00:02, 6385.93probe position/s]Normalizing amplitudes:  23%|██▎       | 3808/16384 [00:00<00:02, 6178.24probe position/s]Normalizing amplitudes:  27%|██▋       | 4437/16384 [00:00<00:01, 6212.38probe position/s]Normalizing amplitudes:  31%|███       | 5070/16384 [00:00<00:01, 6248.40probe position/s]Normalizing amplitudes:  35%|███▍      | 5711/16384 [00:00<00:01, 6297.87probe position/s]Normalizing amplitudes:  39%|███▊      | 6344/16384 [00:01<00:01, 6306.00probe position/s]Normalizing amplitudes:  43%|████▎     | 6975/16384 [00:01<00:01, 6288.34probe position/s]Normalizing amplitudes:  46%|████▋     | 7605/16384 [00:01<00:01, 6274.61probe position/s]Normalizing amplitudes:  50%|█████     | 8233/16384 [00:01<00:01, 6274.38probe position/s]Normalizing amplitudes:  54%|█████▍    | 8871/16384 [00:01<00:01, 6303.45probe position/s]Normalizing amplitudes:  58%|█████▊    | 9519/16384 [00:01<00:01, 6356.37probe position/s]Normalizing amplitudes:  62%|██████▏   | 10155/16384 [00:01<00:00, 6312.77probe position/s]Normalizing amplitudes:  66%|██████▌   | 10787/16384 [00:01<00:00, 6307.15probe position/s]Normalizing amplitudes:  70%|██████▉   | 11418/16384 [00:01<00:00, 6245.66probe position/s]Normalizing amplitudes:  74%|███████▎  | 12043/16384 [00:01<00:00, 6193.98probe position/s]Normalizing amplitudes:  78%|███████▊  | 12717/16384 [00:02<00:00, 6354.28probe position/s]Normalizing amplitudes:  82%|████████▏ | 13379/16384 [00:02<00:00, 6430.52probe position/s]Normalizing amplitudes:  86%|████████▌ | 14023/16384 [00:02<00:00, 6422.77probe position/s]Normalizing amplitudes:  90%|████████▉ | 14666/16384 [00:02<00:00, 6394.22probe position/s]Normalizing amplitudes:  93%|█████████▎| 15306/16384 [00:02<00:00, 6352.96probe position/s]Normalizing amplitudes:  97%|█████████▋| 15942/16384 [00:02<00:00, 6354.72probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6312.13probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random256_p3_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random256_p3_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.0236 in 1.701 sec
Iter: 2, Total Loss: 0.006534 in 1.676 sec
Iter: 3, Total Loss: 0.006448 in 1.685 sec
Iter: 4, Total Loss: 0.006412 in 1.633 sec
Iter: 5, Total Loss: 0.006388 in 1.609 sec
Iter: 6, Total Loss: 0.006368 in 1.641 sec
Iter: 7, Total Loss: 0.006347 in 1.630 sec
Iter: 8, Total Loss: 0.006326 in 1.643 sec
Iter: 9, Total Loss: 0.006303 in 1.670 sec
Iter: 10, Total Loss: 0.00628 in 1.657 sec
Iter: 11, Total Loss: 0.006256 in 1.632 sec
Iter: 12, Total Loss: 0.006233 in 1.616 sec
Iter: 13, Total Loss: 0.006208 in 1.643 sec
Iter: 14, Total Loss: 0.006186 in 1.679 sec
Iter: 15, Total Loss: 0.006162 in 1.630 sec
Iter: 16, Total Loss: 0.00614 in 1.618 sec
Iter: 17, Total Loss: 0.006118 in 1.628 sec
Iter: 18, Total Loss: 0.006096 in 1.628 sec
Iter: 19, Total Loss: 0.006075 in 1.654 sec
Iter: 20, Total Loss: 0.006055 in 1.623 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 1.645 with std = 0.025 sec ###
### py4DSTEM ptycho solver is finished in 35.654 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 913.70 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 256, 3, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 641/16384 [00:00<00:02, 6409.14probe position/s]Normalizing amplitudes:   8%|▊         | 1282/16384 [00:00<00:02, 6348.41probe position/s]Normalizing amplitudes:  12%|█▏        | 1918/16384 [00:00<00:02, 6351.35probe position/s]Normalizing amplitudes:  16%|█▌        | 2554/16384 [00:00<00:02, 6282.21probe position/s]Normalizing amplitudes:  19%|█▉        | 3183/16384 [00:00<00:02, 6247.95probe position/s]Normalizing amplitudes:  23%|██▎       | 3816/16384 [00:00<00:02, 6273.10probe position/s]Normalizing amplitudes:  27%|██▋       | 4444/16384 [00:00<00:01, 6184.76probe position/s]Normalizing amplitudes:  31%|███       | 5068/16384 [00:00<00:01, 6200.21probe position/s]Normalizing amplitudes:  35%|███▍      | 5714/16384 [00:00<00:01, 6277.52probe position/s]Normalizing amplitudes:  39%|███▊      | 6342/16384 [00:01<00:01, 6162.92probe position/s]Normalizing amplitudes:  42%|████▏     | 6959/16384 [00:01<00:01, 6164.69probe position/s]Normalizing amplitudes:  46%|████▋     | 7595/16384 [00:01<00:01, 6220.78probe position/s]Normalizing amplitudes:  50%|█████     | 8244/16384 [00:01<00:01, 6301.13probe position/s]Normalizing amplitudes:  54%|█████▍    | 8898/16384 [00:01<00:01, 6371.61probe position/s]Normalizing amplitudes:  58%|█████▊    | 9539/16384 [00:01<00:01, 6380.82probe position/s]Normalizing amplitudes:  62%|██████▏   | 10178/16384 [00:01<00:00, 6360.34probe position/s]Normalizing amplitudes:  66%|██████▌   | 10815/16384 [00:01<00:00, 6196.04probe position/s]Normalizing amplitudes:  70%|██████▉   | 11443/16384 [00:01<00:00, 6219.93probe position/s]Normalizing amplitudes:  74%|███████▎  | 12073/16384 [00:01<00:00, 6242.64probe position/s]Normalizing amplitudes:  78%|███████▊  | 12698/16384 [00:02<00:00, 6238.20probe position/s]Normalizing amplitudes:  81%|████████▏ | 13335/16384 [00:02<00:00, 6276.38probe position/s]Normalizing amplitudes:  85%|████████▌ | 13980/16384 [00:02<00:00, 6325.13probe position/s]Normalizing amplitudes:  89%|████████▉ | 14613/16384 [00:02<00:00, 6279.94probe position/s]Normalizing amplitudes:  93%|█████████▎| 15253/16384 [00:02<00:00, 6313.50probe position/s]Normalizing amplitudes:  97%|█████████▋| 15885/16384 [00:02<00:00, 6006.33probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6238.63probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random256_p3_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random256_p3_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.02368 in 4.379 sec
Iter: 2, Total Loss: 0.00653 in 4.270 sec
Iter: 3, Total Loss: 0.006387 in 4.320 sec
Iter: 4, Total Loss: 0.006334 in 4.362 sec
Iter: 5, Total Loss: 0.00629 in 4.319 sec
Iter: 6, Total Loss: 0.00625 in 4.329 sec
Iter: 7, Total Loss: 0.006211 in 4.297 sec
Iter: 8, Total Loss: 0.006174 in 4.298 sec
Iter: 9, Total Loss: 0.006137 in 4.343 sec
Iter: 10, Total Loss: 0.006102 in 4.270 sec
Iter: 11, Total Loss: 0.006067 in 4.338 sec
Iter: 12, Total Loss: 0.006035 in 4.370 sec
Iter: 13, Total Loss: 0.006001 in 4.331 sec
Iter: 14, Total Loss: 0.005969 in 4.288 sec
Iter: 15, Total Loss: 0.005937 in 4.334 sec
Iter: 16, Total Loss: 0.005906 in 4.320 sec
Iter: 17, Total Loss: 0.005875 in 4.309 sec
Iter: 18, Total Loss: 0.005846 in 4.307 sec
Iter: 19, Total Loss: 0.005817 in 4.320 sec
Iter: 20, Total Loss: 0.005789 in 4.335 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 4.322 with std = 0.029 sec ###
### py4DSTEM ptycho solver is finished in 1 min 29.209 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 913.66 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 256, 3, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 628/16384 [00:00<00:02, 6276.16probe position/s]Normalizing amplitudes:   8%|▊         | 1256/16384 [00:00<00:02, 6192.36probe position/s]Normalizing amplitudes:  11%|█▏        | 1876/16384 [00:00<00:02, 6128.03probe position/s]Normalizing amplitudes:  15%|█▌        | 2489/16384 [00:00<00:02, 6127.08probe position/s]Normalizing amplitudes:  19%|█▉        | 3102/16384 [00:00<00:02, 6070.18probe position/s]Normalizing amplitudes:  23%|██▎       | 3756/16384 [00:00<00:02, 6225.78probe position/s]Normalizing amplitudes:  27%|██▋       | 4379/16384 [00:00<00:01, 6205.20probe position/s]Normalizing amplitudes:  31%|███       | 5000/16384 [00:00<00:01, 6126.23probe position/s]Normalizing amplitudes:  34%|███▍      | 5624/16384 [00:00<00:01, 6160.24probe position/s]Normalizing amplitudes:  38%|███▊      | 6249/16384 [00:01<00:01, 6185.81probe position/s]Normalizing amplitudes:  42%|████▏     | 6868/16384 [00:01<00:01, 6179.68probe position/s]Normalizing amplitudes:  46%|████▌     | 7506/16384 [00:01<00:01, 6237.73probe position/s]Normalizing amplitudes:  50%|████▉     | 8146/16384 [00:01<00:01, 6283.98probe position/s]Normalizing amplitudes:  54%|█████▎    | 8796/16384 [00:01<00:01, 6346.35probe position/s]Normalizing amplitudes:  58%|█████▊    | 9431/16384 [00:01<00:01, 6282.30probe position/s]Normalizing amplitudes:  61%|██████▏   | 10065/16384 [00:01<00:01, 6296.48probe position/s]Normalizing amplitudes:  65%|██████▌   | 10695/16384 [00:01<00:00, 6248.67probe position/s]Normalizing amplitudes:  69%|██████▉   | 11321/16384 [00:01<00:00, 6227.56probe position/s]Normalizing amplitudes:  73%|███████▎  | 11944/16384 [00:01<00:00, 6194.93probe position/s]Normalizing amplitudes:  77%|███████▋  | 12587/16384 [00:02<00:00, 6263.78probe position/s]Normalizing amplitudes:  81%|████████  | 13228/16384 [00:02<00:00, 6305.90probe position/s]Normalizing amplitudes:  85%|████████▍ | 13864/16384 [00:02<00:00, 6321.31probe position/s]Normalizing amplitudes:  88%|████████▊ | 14497/16384 [00:02<00:00, 6312.69probe position/s]Normalizing amplitudes:  92%|█████████▏| 15129/16384 [00:02<00:00, 6268.49probe position/s]Normalizing amplitudes:  96%|█████████▌| 15767/16384 [00:02<00:00, 6298.31probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6213.34probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random256_p3_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random256_p3_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.02472 in 8.317 sec
Iter: 2, Total Loss: 0.006598 in 8.031 sec
Iter: 3, Total Loss: 0.006363 in 8.006 sec
Iter: 4, Total Loss: 0.006281 in 8.016 sec
Iter: 5, Total Loss: 0.006223 in 7.972 sec
Iter: 6, Total Loss: 0.006174 in 8.080 sec
Iter: 7, Total Loss: 0.006128 in 8.085 sec
Iter: 8, Total Loss: 0.006088 in 7.997 sec
Iter: 9, Total Loss: 0.006046 in 8.105 sec
Iter: 10, Total Loss: 0.006008 in 8.017 sec
Iter: 11, Total Loss: 0.005968 in 7.923 sec
Iter: 12, Total Loss: 0.005933 in 7.955 sec
Iter: 13, Total Loss: 0.005895 in 8.004 sec
Iter: 14, Total Loss: 0.005862 in 7.960 sec
Iter: 15, Total Loss: 0.005827 in 8.035 sec
Iter: 16, Total Loss: 0.005794 in 7.924 sec
Iter: 17, Total Loss: 0.005762 in 8.018 sec
Iter: 18, Total Loss: 0.005733 in 8.009 sec
Iter: 19, Total Loss: 0.005704 in 8.021 sec
Iter: 20, Total Loss: 0.005675 in 8.021 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 8.025 with std = 0.081 sec ###
### py4DSTEM ptycho solver is finished in 2 min 43.291 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 913.56 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 256, 6, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 582/16384 [00:00<00:02, 5816.44probe position/s]Normalizing amplitudes:   7%|▋         | 1164/16384 [00:00<00:02, 5677.84probe position/s]Normalizing amplitudes:  11%|█         | 1786/16384 [00:00<00:02, 5917.64probe position/s]Normalizing amplitudes:  15%|█▍        | 2426/16384 [00:00<00:02, 6102.51probe position/s]Normalizing amplitudes:  19%|█▉        | 3079/16384 [00:00<00:02, 6253.56probe position/s]Normalizing amplitudes:  23%|██▎       | 3731/16384 [00:00<00:01, 6340.21probe position/s]Normalizing amplitudes:  27%|██▋       | 4385/16384 [00:00<00:01, 6403.88probe position/s]Normalizing amplitudes:  31%|███       | 5026/16384 [00:00<00:01, 6278.33probe position/s]Normalizing amplitudes:  35%|███▍      | 5657/16384 [00:00<00:01, 6287.48probe position/s]Normalizing amplitudes:  38%|███▊      | 6287/16384 [00:01<00:01, 6267.54probe position/s]Normalizing amplitudes:  42%|████▏     | 6919/16384 [00:01<00:01, 6281.03probe position/s]Normalizing amplitudes:  46%|████▌     | 7548/16384 [00:01<00:01, 6224.36probe position/s]Normalizing amplitudes:  50%|████▉     | 8171/16384 [00:01<00:01, 6205.93probe position/s]Normalizing amplitudes:  54%|█████▎    | 8798/16384 [00:01<00:01, 6224.26probe position/s]Normalizing amplitudes:  58%|█████▊    | 9448/16384 [00:01<00:01, 6304.25probe position/s]Normalizing amplitudes:  62%|██████▏   | 10086/16384 [00:01<00:00, 6323.91probe position/s]Normalizing amplitudes:  65%|██████▌   | 10719/16384 [00:01<00:00, 6168.28probe position/s]Normalizing amplitudes:  69%|██████▉   | 11337/16384 [00:01<00:00, 6116.56probe position/s]Normalizing amplitudes:  73%|███████▎  | 11965/16384 [00:01<00:00, 6162.54probe position/s]Normalizing amplitudes:  77%|███████▋  | 12582/16384 [00:02<00:00, 6110.38probe position/s]Normalizing amplitudes:  81%|████████  | 13221/16384 [00:02<00:00, 6192.89probe position/s]Normalizing amplitudes:  85%|████████▍ | 13864/16384 [00:02<00:00, 6261.94probe position/s]Normalizing amplitudes:  89%|████████▊ | 14501/16384 [00:02<00:00, 6290.66probe position/s]Normalizing amplitudes:  93%|█████████▎| 15159/16384 [00:02<00:00, 6375.60probe position/s]Normalizing amplitudes:  96%|█████████▋| 15805/16384 [00:02<00:00, 6399.43probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6246.85probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random256_p6_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random256_p6_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.05757 in 3.054 sec
Iter: 2, Total Loss: 0.006577 in 2.860 sec
Iter: 3, Total Loss: 0.006441 in 2.873 sec
Iter: 4, Total Loss: 0.006379 in 2.894 sec
Iter: 5, Total Loss: 0.006337 in 2.875 sec
Iter: 6, Total Loss: 0.006301 in 2.855 sec
Iter: 7, Total Loss: 0.006268 in 2.877 sec
Iter: 8, Total Loss: 0.006235 in 2.884 sec
Iter: 9, Total Loss: 0.006203 in 2.939 sec
Iter: 10, Total Loss: 0.006171 in 2.912 sec
Iter: 11, Total Loss: 0.00614 in 2.892 sec
Iter: 12, Total Loss: 0.006109 in 2.846 sec
Iter: 13, Total Loss: 0.006079 in 2.846 sec
Iter: 14, Total Loss: 0.00605 in 2.911 sec
Iter: 15, Total Loss: 0.006021 in 2.878 sec
Iter: 16, Total Loss: 0.005993 in 2.828 sec
Iter: 17, Total Loss: 0.005963 in 2.855 sec
Iter: 18, Total Loss: 0.005935 in 2.920 sec
Iter: 19, Total Loss: 0.005907 in 2.865 sec
Iter: 20, Total Loss: 0.005879 in 2.822 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 2.884 with std = 0.049 sec ###
### py4DSTEM ptycho solver is finished in 1 min 0.447 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 923.30 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 256, 6, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 669/16384 [00:00<00:02, 6687.89probe position/s]Normalizing amplitudes:   8%|▊         | 1338/16384 [00:00<00:02, 6217.15probe position/s]Normalizing amplitudes:  12%|█▏        | 1982/16384 [00:00<00:02, 6312.57probe position/s]Normalizing amplitudes:  16%|█▌        | 2615/16384 [00:00<00:02, 6315.74probe position/s]Normalizing amplitudes:  20%|█▉        | 3253/16384 [00:00<00:02, 6337.05probe position/s]Normalizing amplitudes:  24%|██▍       | 3901/16384 [00:00<00:01, 6383.09probe position/s]Normalizing amplitudes:  28%|██▊       | 4574/16384 [00:00<00:01, 6494.51probe position/s]Normalizing amplitudes:  32%|███▏      | 5224/16384 [00:00<00:01, 6435.82probe position/s]Normalizing amplitudes:  36%|███▌      | 5876/16384 [00:00<00:01, 6460.51probe position/s]Normalizing amplitudes:  40%|███▉      | 6523/16384 [00:01<00:01, 6415.51probe position/s]Normalizing amplitudes:  44%|████▎     | 7165/16384 [00:01<00:01, 6265.72probe position/s]Normalizing amplitudes:  48%|████▊     | 7853/16384 [00:01<00:01, 6446.13probe position/s]Normalizing amplitudes:  52%|█████▏    | 8505/16384 [00:01<00:01, 6465.18probe position/s]Normalizing amplitudes:  56%|█████▌    | 9153/16384 [00:01<00:01, 6388.52probe position/s]Normalizing amplitudes:  60%|█████▉    | 9793/16384 [00:01<00:01, 6343.20probe position/s]Normalizing amplitudes:  64%|██████▍   | 10472/16384 [00:01<00:00, 6474.85probe position/s]Normalizing amplitudes:  68%|██████▊   | 11121/16384 [00:01<00:00, 6418.16probe position/s]Normalizing amplitudes:  72%|███████▏  | 11764/16384 [00:01<00:00, 6285.30probe position/s]Normalizing amplitudes:  76%|███████▌  | 12406/16384 [00:01<00:00, 6323.90probe position/s]Normalizing amplitudes:  80%|███████▉  | 13049/16384 [00:02<00:00, 6352.48probe position/s]Normalizing amplitudes:  84%|████████▎ | 13685/16384 [00:02<00:00, 6345.12probe position/s]Normalizing amplitudes:  88%|████████▊ | 14389/16384 [00:02<00:00, 6550.68probe position/s]Normalizing amplitudes:  92%|█████████▏| 15045/16384 [00:02<00:00, 6545.27probe position/s]Normalizing amplitudes:  96%|█████████▌| 15700/16384 [00:02<00:00, 6441.89probe position/s]Normalizing amplitudes: 100%|█████████▉| 16345/16384 [00:02<00:00, 6419.04probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6402.42probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random256_p6_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random256_p6_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.05764 in 7.993 sec
Iter: 2, Total Loss: 0.006733 in 7.881 sec
Iter: 3, Total Loss: 0.006398 in 7.874 sec
Iter: 4, Total Loss: 0.006288 in 7.915 sec
Iter: 5, Total Loss: 0.006215 in 8.028 sec
Iter: 6, Total Loss: 0.006157 in 8.047 sec
Iter: 7, Total Loss: 0.006105 in 7.968 sec
Iter: 8, Total Loss: 0.006057 in 7.960 sec
Iter: 9, Total Loss: 0.006012 in 7.921 sec
Iter: 10, Total Loss: 0.005969 in 7.898 sec
Iter: 11, Total Loss: 0.005927 in 7.953 sec
Iter: 12, Total Loss: 0.005888 in 7.924 sec
Iter: 13, Total Loss: 0.005848 in 7.942 sec
Iter: 14, Total Loss: 0.005811 in 7.977 sec
Iter: 15, Total Loss: 0.005774 in 7.935 sec
Iter: 16, Total Loss: 0.005738 in 7.911 sec
Iter: 17, Total Loss: 0.005704 in 7.943 sec
Iter: 18, Total Loss: 0.005671 in 7.914 sec
Iter: 19, Total Loss: 0.005639 in 7.938 sec
Iter: 20, Total Loss: 0.005608 in 7.836 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 7.938 with std = 0.049 sec ###
### py4DSTEM ptycho solver is finished in 2 min 41.673 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 913.37 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 256, 6, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 631/16384 [00:00<00:02, 6300.20probe position/s]Normalizing amplitudes:   8%|▊         | 1262/16384 [00:00<00:02, 6226.98probe position/s]Normalizing amplitudes:  12%|█▏        | 1885/16384 [00:00<00:02, 5947.32probe position/s]Normalizing amplitudes:  15%|█▌        | 2526/16384 [00:00<00:02, 6120.92probe position/s]Normalizing amplitudes:  19%|█▉        | 3140/16384 [00:00<00:02, 6064.99probe position/s]Normalizing amplitudes:  23%|██▎       | 3758/16384 [00:00<00:02, 6100.13probe position/s]Normalizing amplitudes:  27%|██▋       | 4388/16384 [00:00<00:01, 6161.17probe position/s]Normalizing amplitudes:  31%|███       | 5018/16384 [00:00<00:01, 6204.54probe position/s]Normalizing amplitudes:  34%|███▍      | 5639/16384 [00:00<00:01, 6184.81probe position/s]Normalizing amplitudes:  38%|███▊      | 6271/16384 [00:01<00:01, 6223.09probe position/s]Normalizing amplitudes:  42%|████▏     | 6894/16384 [00:01<00:01, 6160.12probe position/s]Normalizing amplitudes:  46%|████▌     | 7511/16384 [00:01<00:01, 5952.94probe position/s]Normalizing amplitudes:  49%|████▉     | 8108/16384 [00:01<00:01, 5848.76probe position/s]Normalizing amplitudes:  53%|█████▎    | 8721/16384 [00:01<00:01, 5930.15probe position/s]Normalizing amplitudes:  57%|█████▋    | 9368/16384 [00:01<00:01, 6086.45probe position/s]Normalizing amplitudes:  61%|██████    | 9998/16384 [00:01<00:01, 6148.09probe position/s]Normalizing amplitudes:  65%|██████▍   | 10614/16384 [00:01<00:00, 6066.60probe position/s]Normalizing amplitudes:  69%|██████▊   | 11250/16384 [00:01<00:00, 6151.49probe position/s]Normalizing amplitudes:  72%|███████▏  | 11866/16384 [00:01<00:00, 5770.69probe position/s]Normalizing amplitudes:  76%|███████▌  | 12449/16384 [00:02<00:00, 5777.51probe position/s]Normalizing amplitudes:  80%|███████▉  | 13078/16384 [00:02<00:00, 5925.20probe position/s]Normalizing amplitudes:  84%|████████▎ | 13706/16384 [00:02<00:00, 6027.60probe position/s]Normalizing amplitudes:  88%|████████▊ | 14337/16384 [00:02<00:00, 6107.64probe position/s]Normalizing amplitudes:  91%|█████████▏| 14955/16384 [00:02<00:00, 6126.46probe position/s]Normalizing amplitudes:  95%|█████████▌| 15569/16384 [00:02<00:00, 6117.14probe position/s]Normalizing amplitudes:  99%|█████████▉| 16193/16384 [00:02<00:00, 6151.46probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6073.53probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random256_p6_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random256_p6_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.06079 in 15.523 sec
Iter: 2, Total Loss: 0.007092 in 15.416 sec
Iter: 3, Total Loss: 0.006453 in 15.440 sec
Iter: 4, Total Loss: 0.0063 in 15.419 sec
Iter: 5, Total Loss: 0.006215 in 15.359 sec
Iter: 6, Total Loss: 0.00615 in 15.426 sec
Iter: 7, Total Loss: 0.006099 in 15.424 sec
Iter: 8, Total Loss: 0.00605 in 15.388 sec
Iter: 9, Total Loss: 0.006008 in 15.351 sec
Iter: 10, Total Loss: 0.005966 in 15.441 sec
Iter: 11, Total Loss: 0.005926 in 15.264 sec
Iter: 12, Total Loss: 0.00589 in 15.376 sec
Iter: 13, Total Loss: 0.005853 in 15.421 sec
Iter: 14, Total Loss: 0.005817 in 15.334 sec
Iter: 15, Total Loss: 0.005784 in 15.375 sec
Iter: 16, Total Loss: 0.005751 in 15.215 sec
Iter: 17, Total Loss: 0.00572 in 15.339 sec
Iter: 18, Total Loss: 0.005691 in 15.324 sec
Iter: 19, Total Loss: 0.005662 in 15.306 sec
Iter: 20, Total Loss: 0.005634 in 15.300 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 15.372 with std = 0.069 sec ###
### py4DSTEM ptycho solver is finished in 5 min 10.398 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 916.64 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 256, 12, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 614/16384 [00:00<00:02, 6139.32probe position/s]Normalizing amplitudes:   8%|▊         | 1239/16384 [00:00<00:02, 6199.57probe position/s]Normalizing amplitudes:  11%|█▏        | 1859/16384 [00:00<00:02, 6196.54probe position/s]Normalizing amplitudes:  15%|█▌        | 2502/16384 [00:00<00:02, 6287.18probe position/s]Normalizing amplitudes:  19%|█▉        | 3131/16384 [00:00<00:02, 6271.92probe position/s]Normalizing amplitudes:  23%|██▎       | 3759/16384 [00:00<00:02, 6203.12probe position/s]Normalizing amplitudes:  27%|██▋       | 4380/16384 [00:00<00:01, 6119.48probe position/s]Normalizing amplitudes:  31%|███       | 5011/16384 [00:00<00:01, 6177.55probe position/s]Normalizing amplitudes:  34%|███▍      | 5630/16384 [00:00<00:01, 6029.60probe position/s]Normalizing amplitudes:  38%|███▊      | 6234/16384 [00:01<00:01, 5934.65probe position/s]Normalizing amplitudes:  42%|████▏     | 6829/16384 [00:01<00:01, 5687.95probe position/s]Normalizing amplitudes:  45%|████▌     | 7454/16384 [00:01<00:01, 5849.16probe position/s]Normalizing amplitudes:  49%|████▉     | 8079/16384 [00:01<00:01, 5965.13probe position/s]Normalizing amplitudes:  53%|█████▎    | 8705/16384 [00:01<00:01, 6050.67probe position/s]Normalizing amplitudes:  57%|█████▋    | 9342/16384 [00:01<00:01, 6144.31probe position/s]Normalizing amplitudes:  61%|██████    | 9963/16384 [00:01<00:01, 6162.87probe position/s]Normalizing amplitudes:  65%|██████▍   | 10593/16384 [00:01<00:00, 6202.38probe position/s]Normalizing amplitudes:  68%|██████▊   | 11220/16384 [00:01<00:00, 6222.46probe position/s]Normalizing amplitudes:  72%|███████▏  | 11856/16384 [00:01<00:00, 6262.39probe position/s]Normalizing amplitudes:  76%|███████▌  | 12483/16384 [00:02<00:00, 6206.95probe position/s]Normalizing amplitudes:  80%|███████▉  | 13105/16384 [00:02<00:00, 6144.19probe position/s]Normalizing amplitudes:  84%|████████▍ | 13722/16384 [00:02<00:00, 6149.77probe position/s]Normalizing amplitudes:  88%|████████▊ | 14358/16384 [00:02<00:00, 6211.26probe position/s]Normalizing amplitudes:  92%|█████████▏| 14995/16384 [00:02<00:00, 6256.64probe position/s]Normalizing amplitudes:  95%|█████████▌| 15621/16384 [00:02<00:00, 6155.67probe position/s]Normalizing amplitudes:  99%|█████████▉| 16238/16384 [00:02<00:00, 6146.17probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6122.20probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random256_p12_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random256_p12_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.1418 in 5.401 sec
Iter: 2, Total Loss: 0.006694 in 5.308 sec
Iter: 3, Total Loss: 0.006472 in 5.279 sec
Iter: 4, Total Loss: 0.006377 in 5.379 sec
Iter: 5, Total Loss: 0.006317 in 5.278 sec
Iter: 6, Total Loss: 0.00627 in 5.313 sec
Iter: 7, Total Loss: 0.006227 in 5.248 sec
Iter: 8, Total Loss: 0.006188 in 5.392 sec
Iter: 9, Total Loss: 0.006151 in 5.289 sec
Iter: 10, Total Loss: 0.006115 in 5.283 sec
Iter: 11, Total Loss: 0.006079 in 5.320 sec
Iter: 12, Total Loss: 0.006043 in 5.389 sec
Iter: 13, Total Loss: 0.006007 in 5.339 sec
Iter: 14, Total Loss: 0.005972 in 5.381 sec
Iter: 15, Total Loss: 0.005937 in 5.345 sec
Iter: 16, Total Loss: 0.005903 in 5.280 sec
Iter: 17, Total Loss: 0.005869 in 5.267 sec
Iter: 18, Total Loss: 0.005836 in 5.316 sec
Iter: 19, Total Loss: 0.005804 in 5.291 sec
Iter: 20, Total Loss: 0.005773 in 5.333 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 5.322 with std = 0.045 sec ###
### py4DSTEM ptycho solver is finished in 1 min 49.487 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 919.53 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 256, 12, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 594/16384 [00:00<00:02, 5938.83probe position/s]Normalizing amplitudes:   8%|▊         | 1253/16384 [00:00<00:02, 6319.23probe position/s]Normalizing amplitudes:  12%|█▏        | 1907/16384 [00:00<00:02, 6419.09probe position/s]Normalizing amplitudes:  16%|█▌        | 2578/16384 [00:00<00:02, 6531.37probe position/s]Normalizing amplitudes:  20%|█▉        | 3232/16384 [00:00<00:02, 6530.21probe position/s]Normalizing amplitudes:  24%|██▎       | 3886/16384 [00:00<00:01, 6506.49probe position/s]Normalizing amplitudes:  28%|██▊       | 4537/16384 [00:00<00:01, 6480.03probe position/s]Normalizing amplitudes:  32%|███▏      | 5218/16384 [00:00<00:01, 6582.62probe position/s]Normalizing amplitudes:  36%|███▌      | 5877/16384 [00:00<00:01, 6524.64probe position/s]Normalizing amplitudes:  40%|███▉      | 6530/16384 [00:01<00:01, 6424.21probe position/s]Normalizing amplitudes:  44%|████▍     | 7173/16384 [00:01<00:01, 6412.06probe position/s]Normalizing amplitudes:  48%|████▊     | 7815/16384 [00:01<00:01, 6283.52probe position/s]Normalizing amplitudes:  52%|█████▏    | 8483/16384 [00:01<00:01, 6397.75probe position/s]Normalizing amplitudes:  56%|█████▌    | 9135/16384 [00:01<00:01, 6433.83probe position/s]Normalizing amplitudes:  60%|█████▉    | 9779/16384 [00:01<00:01, 6411.90probe position/s]Normalizing amplitudes:  64%|██████▎   | 10421/16384 [00:01<00:00, 6350.39probe position/s]Normalizing amplitudes:  68%|██████▊   | 11067/16384 [00:01<00:00, 6381.76probe position/s]Normalizing amplitudes:  71%|███████▏  | 11707/16384 [00:01<00:00, 6385.84probe position/s]Normalizing amplitudes:  75%|███████▌  | 12353/16384 [00:01<00:00, 6406.20probe position/s]Normalizing amplitudes:  79%|███████▉  | 12994/16384 [00:02<00:00, 6385.48probe position/s]Normalizing amplitudes:  83%|████████▎ | 13633/16384 [00:02<00:00, 6366.53probe position/s]Normalizing amplitudes:  87%|████████▋ | 14274/16384 [00:02<00:00, 6377.09probe position/s]Normalizing amplitudes:  91%|█████████ | 14912/16384 [00:02<00:00, 6349.07probe position/s]Normalizing amplitudes:  95%|█████████▌| 15568/16384 [00:02<00:00, 6411.80probe position/s]Normalizing amplitudes:  99%|█████████▉| 16210/16384 [00:02<00:00, 6402.26probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6411.94probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random256_p12_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random256_p12_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.1415 in 15.211 sec
Iter: 2, Total Loss: 0.007077 in 15.059 sec
Iter: 3, Total Loss: 0.006474 in 15.038 sec
Iter: 4, Total Loss: 0.006288 in 15.132 sec
Iter: 5, Total Loss: 0.006182 in 15.075 sec
Iter: 6, Total Loss: 0.006105 in 15.083 sec
Iter: 7, Total Loss: 0.006038 in 15.042 sec
Iter: 8, Total Loss: 0.005979 in 14.940 sec
Iter: 9, Total Loss: 0.005924 in 15.089 sec
Iter: 10, Total Loss: 0.00587 in 15.080 sec
Iter: 11, Total Loss: 0.005821 in 15.065 sec
Iter: 12, Total Loss: 0.005774 in 15.044 sec
Iter: 13, Total Loss: 0.005728 in 15.074 sec
Iter: 14, Total Loss: 0.005685 in 15.076 sec
Iter: 15, Total Loss: 0.005643 in 14.960 sec
Iter: 16, Total Loss: 0.005604 in 15.177 sec
Iter: 17, Total Loss: 0.005566 in 15.261 sec
Iter: 18, Total Loss: 0.00553 in 15.107 sec
Iter: 19, Total Loss: 0.005495 in 15.078 sec
Iter: 20, Total Loss: 0.005463 in 14.964 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 15.078 with std = 0.076 sec ###
### py4DSTEM ptycho solver is finished in 5 min 4.530 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 919.71 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 256, 12, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 632/16384 [00:00<00:02, 6318.06probe position/s]Normalizing amplitudes:   8%|▊         | 1283/16384 [00:00<00:02, 6427.83probe position/s]Normalizing amplitudes:  12%|█▏        | 1951/16384 [00:00<00:02, 6537.99probe position/s]Normalizing amplitudes:  16%|█▌        | 2628/16384 [00:00<00:02, 6628.46probe position/s]Normalizing amplitudes:  20%|██        | 3291/16384 [00:00<00:02, 6526.03probe position/s]Normalizing amplitudes:  24%|██▍       | 3944/16384 [00:00<00:01, 6497.60probe position/s]Normalizing amplitudes:  28%|██▊       | 4594/16384 [00:00<00:01, 6487.66probe position/s]Normalizing amplitudes:  32%|███▏      | 5244/16384 [00:00<00:01, 6491.03probe position/s]Normalizing amplitudes:  36%|███▌      | 5913/16384 [00:00<00:01, 6551.99probe position/s]Normalizing amplitudes:  40%|████      | 6573/16384 [00:01<00:01, 6566.57probe position/s]Normalizing amplitudes:  44%|████▍     | 7230/16384 [00:01<00:01, 6529.11probe position/s]Normalizing amplitudes:  48%|████▊     | 7883/16384 [00:01<00:01, 6519.29probe position/s]Normalizing amplitudes:  52%|█████▏    | 8535/16384 [00:01<00:01, 6443.49probe position/s]Normalizing amplitudes:  56%|█████▌    | 9180/16384 [00:01<00:01, 6430.24probe position/s]Normalizing amplitudes:  60%|█████▉    | 9824/16384 [00:01<00:01, 6099.17probe position/s]Normalizing amplitudes:  64%|██████▎   | 10438/16384 [00:01<00:00, 6101.80probe position/s]Normalizing amplitudes:  68%|██████▊   | 11071/16384 [00:01<00:00, 6167.79probe position/s]Normalizing amplitudes:  72%|███████▏  | 11733/16384 [00:01<00:00, 6297.10probe position/s]Normalizing amplitudes:  76%|███████▌  | 12392/16384 [00:01<00:00, 6383.53probe position/s]Normalizing amplitudes:  80%|███████▉  | 13037/16384 [00:02<00:00, 6402.10probe position/s]Normalizing amplitudes:  83%|████████▎ | 13679/16384 [00:02<00:00, 6329.94probe position/s]Normalizing amplitudes:  87%|████████▋ | 14313/16384 [00:02<00:00, 6299.89probe position/s]Normalizing amplitudes:  91%|█████████ | 14948/16384 [00:02<00:00, 6311.20probe position/s]Normalizing amplitudes:  95%|█████████▌| 15580/16384 [00:02<00:00, 6291.76probe position/s]Normalizing amplitudes:  99%|█████████▉| 16229/16384 [00:02<00:00, 6348.64probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6389.18probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random256_p12_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 256, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random256_p12_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 256 measurements.
Iter: 1, Total Loss: 0.1431 in 29.874 sec
Iter: 2, Total Loss: 0.007481 in 29.768 sec
Iter: 3, Total Loss: 0.006517 in 29.608 sec
Iter: 4, Total Loss: 0.006281 in 29.251 sec
Iter: 5, Total Loss: 0.006157 in 29.286 sec
Iter: 6, Total Loss: 0.006071 in 29.323 sec
Iter: 7, Total Loss: 0.006003 in 29.530 sec
Iter: 8, Total Loss: 0.005946 in 29.405 sec
Iter: 9, Total Loss: 0.005893 in 29.473 sec
Iter: 10, Total Loss: 0.005846 in 29.362 sec
Iter: 11, Total Loss: 0.005802 in 29.363 sec
Iter: 12, Total Loss: 0.005761 in 29.240 sec
Iter: 13, Total Loss: 0.005722 in 29.293 sec
Iter: 14, Total Loss: 0.005685 in 29.282 sec
Iter: 15, Total Loss: 0.00565 in 29.286 sec
Iter: 16, Total Loss: 0.005616 in 29.493 sec
Iter: 17, Total Loss: 0.005583 in 29.838 sec
Iter: 18, Total Loss: 0.005552 in 29.556 sec
Iter: 19, Total Loss: 0.005522 in 29.820 sec
Iter: 20, Total Loss: 0.005494 in 29.813 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 29.493 with std = 0.216 sec ###
### py4DSTEM ptycho solver is finished in 9 min 52.850 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 918.03 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 128, 1, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 656/16384 [00:00<00:02, 6555.16probe position/s]Normalizing amplitudes:   8%|▊         | 1312/16384 [00:00<00:02, 6426.81probe position/s]Normalizing amplitudes:  12%|█▏        | 1955/16384 [00:00<00:02, 6338.08probe position/s]Normalizing amplitudes:  16%|█▌        | 2589/16384 [00:00<00:02, 6165.26probe position/s]Normalizing amplitudes:  20%|█▉        | 3232/16384 [00:00<00:02, 6256.60probe position/s]Normalizing amplitudes:  24%|██▍       | 3901/16384 [00:00<00:01, 6399.76probe position/s]Normalizing amplitudes:  28%|██▊       | 4542/16384 [00:00<00:01, 6377.20probe position/s]Normalizing amplitudes:  32%|███▏      | 5181/16384 [00:00<00:01, 6364.30probe position/s]Normalizing amplitudes:  36%|███▌      | 5835/16384 [00:00<00:01, 6416.05probe position/s]Normalizing amplitudes:  40%|███▉      | 6488/16384 [00:01<00:01, 6450.83probe position/s]Normalizing amplitudes:  44%|████▍     | 7181/16384 [00:01<00:01, 6596.68probe position/s]Normalizing amplitudes:  48%|████▊     | 7841/16384 [00:01<00:01, 6558.55probe position/s]Normalizing amplitudes:  52%|█████▏    | 8500/16384 [00:01<00:01, 6567.95probe position/s]Normalizing amplitudes:  56%|█████▌    | 9157/16384 [00:01<00:01, 6533.50probe position/s]Normalizing amplitudes:  60%|█████▉    | 9811/16384 [00:01<00:01, 6448.49probe position/s]Normalizing amplitudes:  64%|██████▍   | 10494/16384 [00:01<00:00, 6559.37probe position/s]Normalizing amplitudes:  68%|██████▊   | 11151/16384 [00:01<00:00, 6515.08probe position/s]Normalizing amplitudes:  72%|███████▏  | 11803/16384 [00:01<00:00, 6410.34probe position/s]Normalizing amplitudes:  76%|███████▌  | 12445/16384 [00:01<00:00, 6240.22probe position/s]Normalizing amplitudes:  80%|███████▉  | 13071/16384 [00:02<00:00, 6009.23probe position/s]Normalizing amplitudes:  84%|████████▎ | 13707/16384 [00:02<00:00, 6108.93probe position/s]Normalizing amplitudes:  88%|████████▊ | 14411/16384 [00:02<00:00, 6375.99probe position/s]Normalizing amplitudes:  92%|█████████▏| 15051/16384 [00:02<00:00, 6313.82probe position/s]Normalizing amplitudes:  96%|█████████▌| 15684/16384 [00:02<00:00, 6284.64probe position/s]Normalizing amplitudes: 100%|█████████▉| 16314/16384 [00:02<00:00, 6218.50probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6358.67probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random128_p1_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random128_p1_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.008509 in 1.125 sec
Iter: 2, Total Loss: 0.006513 in 1.055 sec
Iter: 3, Total Loss: 0.006487 in 1.076 sec
Iter: 4, Total Loss: 0.006472 in 1.074 sec
Iter: 5, Total Loss: 0.006458 in 1.079 sec
Iter: 6, Total Loss: 0.006445 in 1.096 sec
Iter: 7, Total Loss: 0.006432 in 1.089 sec
Iter: 8, Total Loss: 0.006418 in 1.071 sec
Iter: 9, Total Loss: 0.006402 in 1.109 sec
Iter: 10, Total Loss: 0.006388 in 1.107 sec
Iter: 11, Total Loss: 0.006371 in 1.111 sec
Iter: 12, Total Loss: 0.006357 in 1.102 sec
Iter: 13, Total Loss: 0.006342 in 1.195 sec
Iter: 14, Total Loss: 0.006326 in 1.153 sec
Iter: 15, Total Loss: 0.006311 in 1.110 sec
Iter: 16, Total Loss: 0.006298 in 1.078 sec
Iter: 17, Total Loss: 0.006283 in 1.086 sec
Iter: 18, Total Loss: 0.00627 in 1.070 sec
Iter: 19, Total Loss: 0.006257 in 1.092 sec
Iter: 20, Total Loss: 0.006245 in 1.050 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 1.096 with std = 0.033 sec ###
### py4DSTEM ptycho solver is finished in 24.697 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 923.18 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 128, 1, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 619/16384 [00:00<00:02, 6188.93probe position/s]Normalizing amplitudes:   8%|▊         | 1247/16384 [00:00<00:02, 6239.30probe position/s]Normalizing amplitudes:  12%|█▏        | 1912/16384 [00:00<00:02, 6423.83probe position/s]Normalizing amplitudes:  16%|█▌        | 2578/16384 [00:00<00:02, 6514.97probe position/s]Normalizing amplitudes:  20%|█▉        | 3235/16384 [00:00<00:02, 6531.23probe position/s]Normalizing amplitudes:  24%|██▎       | 3889/16384 [00:00<00:01, 6516.01probe position/s]Normalizing amplitudes:  28%|██▊       | 4545/16384 [00:00<00:01, 6528.66probe position/s]Normalizing amplitudes:  32%|███▏      | 5201/16384 [00:00<00:01, 6537.15probe position/s]Normalizing amplitudes:  36%|███▌      | 5855/16384 [00:00<00:01, 6494.78probe position/s]Normalizing amplitudes:  40%|███▉      | 6505/16384 [00:01<00:01, 6479.80probe position/s]Normalizing amplitudes:  44%|████▎     | 7154/16384 [00:01<00:01, 6372.87probe position/s]Normalizing amplitudes:  48%|████▊     | 7820/16384 [00:01<00:01, 6456.55probe position/s]Normalizing amplitudes:  52%|█████▏    | 8490/16384 [00:01<00:01, 6526.24probe position/s]Normalizing amplitudes:  56%|█████▌    | 9143/16384 [00:01<00:01, 6508.97probe position/s]Normalizing amplitudes:  60%|█████▉    | 9795/16384 [00:01<00:01, 6427.97probe position/s]Normalizing amplitudes:  64%|██████▎   | 10439/16384 [00:01<00:00, 6370.37probe position/s]Normalizing amplitudes:  68%|██████▊   | 11077/16384 [00:01<00:00, 6165.72probe position/s]Normalizing amplitudes:  71%|███████▏  | 11707/16384 [00:01<00:00, 6204.46probe position/s]Normalizing amplitudes:  76%|███████▌  | 12379/16384 [00:01<00:00, 6353.98probe position/s]Normalizing amplitudes:  80%|███████▉  | 13071/16384 [00:02<00:00, 6518.16probe position/s]Normalizing amplitudes:  84%|████████▍ | 13724/16384 [00:02<00:00, 6441.31probe position/s]Normalizing amplitudes:  88%|████████▊ | 14369/16384 [00:02<00:00, 6435.62probe position/s]Normalizing amplitudes:  92%|█████████▏| 15027/16384 [00:02<00:00, 6477.65probe position/s]Normalizing amplitudes:  96%|█████████▌| 15676/16384 [00:02<00:00, 6458.63probe position/s]Normalizing amplitudes: 100%|█████████▉| 16323/16384 [00:02<00:00, 6425.42probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6428.41probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random128_p1_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random128_p1_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.008608 in 2.409 sec
Iter: 2, Total Loss: 0.00652 in 2.399 sec
Iter: 3, Total Loss: 0.006493 in 2.441 sec
Iter: 4, Total Loss: 0.006473 in 2.375 sec
Iter: 5, Total Loss: 0.006453 in 2.421 sec
Iter: 6, Total Loss: 0.006435 in 2.454 sec
Iter: 7, Total Loss: 0.006415 in 2.470 sec
Iter: 8, Total Loss: 0.006396 in 2.390 sec
Iter: 9, Total Loss: 0.006377 in 2.381 sec
Iter: 10, Total Loss: 0.00636 in 2.405 sec
Iter: 11, Total Loss: 0.00634 in 2.335 sec
Iter: 12, Total Loss: 0.006325 in 2.358 sec
Iter: 13, Total Loss: 0.006307 in 2.368 sec
Iter: 14, Total Loss: 0.006291 in 2.364 sec
Iter: 15, Total Loss: 0.006275 in 2.413 sec
Iter: 16, Total Loss: 0.006261 in 2.376 sec
Iter: 17, Total Loss: 0.006244 in 2.353 sec
Iter: 18, Total Loss: 0.006231 in 2.428 sec
Iter: 19, Total Loss: 0.006217 in 2.357 sec
Iter: 20, Total Loss: 0.006206 in 2.427 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 2.396 with std = 0.036 sec ###
### py4DSTEM ptycho solver is finished in 50.748 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 923.15 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 128, 1, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 649/16384 [00:00<00:02, 6483.30probe position/s]Normalizing amplitudes:   8%|▊         | 1298/16384 [00:00<00:02, 6460.08probe position/s]Normalizing amplitudes:  12%|█▏        | 1945/16384 [00:00<00:02, 6428.88probe position/s]Normalizing amplitudes:  16%|█▌        | 2639/16384 [00:00<00:02, 6629.03probe position/s]Normalizing amplitudes:  20%|██        | 3303/16384 [00:00<00:01, 6558.06probe position/s]Normalizing amplitudes:  24%|██▍       | 3959/16384 [00:00<00:01, 6484.06probe position/s]Normalizing amplitudes:  28%|██▊       | 4608/16384 [00:00<00:01, 6485.89probe position/s]Normalizing amplitudes:  32%|███▏      | 5262/16384 [00:00<00:01, 6502.14probe position/s]Normalizing amplitudes:  36%|███▌      | 5924/16384 [00:00<00:01, 6535.41probe position/s]Normalizing amplitudes:  40%|████      | 6578/16384 [00:01<00:01, 6526.98probe position/s]Normalizing amplitudes:  44%|████▍     | 7231/16384 [00:01<00:01, 6460.83probe position/s]Normalizing amplitudes:  48%|████▊     | 7884/16384 [00:01<00:01, 6480.26probe position/s]Normalizing amplitudes:  52%|█████▏    | 8537/16384 [00:01<00:01, 6494.25probe position/s]Normalizing amplitudes:  56%|█████▌    | 9187/16384 [00:01<00:01, 6425.34probe position/s]Normalizing amplitudes:  60%|█████▉    | 9830/16384 [00:01<00:01, 6371.95probe position/s]Normalizing amplitudes:  64%|██████▍   | 10486/16384 [00:01<00:00, 6425.85probe position/s]Normalizing amplitudes:  68%|██████▊   | 11129/16384 [00:01<00:00, 6312.78probe position/s]Normalizing amplitudes:  72%|███████▏  | 11761/16384 [00:01<00:00, 6304.07probe position/s]Normalizing amplitudes:  76%|███████▌  | 12417/16384 [00:01<00:00, 6376.65probe position/s]Normalizing amplitudes:  80%|███████▉  | 13067/16384 [00:02<00:00, 6409.88probe position/s]Normalizing amplitudes:  84%|████████▍ | 13726/16384 [00:02<00:00, 6462.05probe position/s]Normalizing amplitudes:  88%|████████▊ | 14378/16384 [00:02<00:00, 6478.45probe position/s]Normalizing amplitudes:  92%|█████████▏| 15045/16384 [00:02<00:00, 6533.73probe position/s]Normalizing amplitudes:  96%|█████████▌| 15702/16384 [00:02<00:00, 6542.11probe position/s]Normalizing amplitudes: 100%|█████████▉| 16370/16384 [00:02<00:00, 6582.60probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6477.05probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random128_p1_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random128_p1_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.008747 in 4.390 sec
Iter: 2, Total Loss: 0.006566 in 4.307 sec
Iter: 3, Total Loss: 0.006531 in 4.334 sec
Iter: 4, Total Loss: 0.006503 in 4.349 sec
Iter: 5, Total Loss: 0.006475 in 4.370 sec
Iter: 6, Total Loss: 0.006451 in 4.459 sec
Iter: 7, Total Loss: 0.006427 in 4.325 sec
Iter: 8, Total Loss: 0.006403 in 4.369 sec
Iter: 9, Total Loss: 0.00638 in 4.336 sec
Iter: 10, Total Loss: 0.006359 in 4.313 sec
Iter: 11, Total Loss: 0.006338 in 4.353 sec
Iter: 12, Total Loss: 0.00632 in 4.482 sec
Iter: 13, Total Loss: 0.006297 in 4.362 sec
Iter: 14, Total Loss: 0.006278 in 4.328 sec
Iter: 15, Total Loss: 0.006261 in 4.263 sec
Iter: 16, Total Loss: 0.006242 in 4.296 sec
Iter: 17, Total Loss: 0.006223 in 4.251 sec
Iter: 18, Total Loss: 0.006208 in 4.298 sec
Iter: 19, Total Loss: 0.006191 in 4.381 sec
Iter: 20, Total Loss: 0.006175 in 4.313 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 4.344 with std = 0.055 sec ###
### py4DSTEM ptycho solver is finished in 1 min 29.957 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 922.15 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 128, 3, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 658/16384 [00:00<00:02, 6576.20probe position/s]Normalizing amplitudes:   8%|▊         | 1316/16384 [00:00<00:02, 6373.02probe position/s]Normalizing amplitudes:  12%|█▏        | 1955/16384 [00:00<00:02, 6377.99probe position/s]Normalizing amplitudes:  16%|█▌        | 2611/16384 [00:00<00:02, 6445.40probe position/s]Normalizing amplitudes:  20%|█▉        | 3273/16384 [00:00<00:02, 6504.09probe position/s]Normalizing amplitudes:  24%|██▍       | 3924/16384 [00:00<00:01, 6467.20probe position/s]Normalizing amplitudes:  28%|██▊       | 4579/16384 [00:00<00:01, 6493.27probe position/s]Normalizing amplitudes:  32%|███▏      | 5229/16384 [00:00<00:01, 6337.55probe position/s]Normalizing amplitudes:  36%|███▌      | 5876/16384 [00:00<00:01, 6377.51probe position/s]Normalizing amplitudes:  40%|███▉      | 6541/16384 [00:01<00:01, 6459.00probe position/s]Normalizing amplitudes:  44%|████▍     | 7205/16384 [00:01<00:01, 6511.46probe position/s]Normalizing amplitudes:  48%|████▊     | 7857/16384 [00:01<00:01, 6445.63probe position/s]Normalizing amplitudes:  52%|█████▏    | 8502/16384 [00:01<00:01, 6364.46probe position/s]Normalizing amplitudes:  56%|█████▌    | 9170/16384 [00:01<00:01, 6455.91probe position/s]Normalizing amplitudes:  60%|██████    | 9861/16384 [00:01<00:00, 6587.18probe position/s]Normalizing amplitudes:  64%|██████▍   | 10521/16384 [00:01<00:00, 6575.67probe position/s]Normalizing amplitudes:  68%|██████▊   | 11179/16384 [00:01<00:00, 6483.03probe position/s]Normalizing amplitudes:  72%|███████▏  | 11841/16384 [00:01<00:00, 6523.50probe position/s]Normalizing amplitudes:  76%|███████▋  | 12494/16384 [00:01<00:00, 6521.24probe position/s]Normalizing amplitudes:  80%|████████  | 13147/16384 [00:02<00:00, 6497.13probe position/s]Normalizing amplitudes:  84%|████████▍ | 13798/16384 [00:02<00:00, 6499.91probe position/s]Normalizing amplitudes:  88%|████████▊ | 14449/16384 [00:02<00:00, 6487.14probe position/s]Normalizing amplitudes:  92%|█████████▏| 15100/16384 [00:02<00:00, 6491.91probe position/s]Normalizing amplitudes:  96%|█████████▌| 15769/16384 [00:02<00:00, 6548.49probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6487.31probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random128_p3_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random128_p3_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.01508 in 2.312 sec
Iter: 2, Total Loss: 0.00648 in 2.203 sec
Iter: 3, Total Loss: 0.006399 in 2.263 sec
Iter: 4, Total Loss: 0.006346 in 2.228 sec
Iter: 5, Total Loss: 0.006299 in 2.261 sec
Iter: 6, Total Loss: 0.006254 in 2.342 sec
Iter: 7, Total Loss: 0.00621 in 2.363 sec
Iter: 8, Total Loss: 0.006167 in 2.376 sec
Iter: 9, Total Loss: 0.006125 in 2.290 sec
Iter: 10, Total Loss: 0.006085 in 2.278 sec
Iter: 11, Total Loss: 0.006045 in 2.260 sec
Iter: 12, Total Loss: 0.006007 in 2.273 sec
Iter: 13, Total Loss: 0.00597 in 2.329 sec
Iter: 14, Total Loss: 0.005934 in 2.250 sec
Iter: 15, Total Loss: 0.005901 in 2.271 sec
Iter: 16, Total Loss: 0.005868 in 2.279 sec
Iter: 17, Total Loss: 0.005836 in 2.267 sec
Iter: 18, Total Loss: 0.005806 in 2.290 sec
Iter: 19, Total Loss: 0.005777 in 2.299 sec
Iter: 20, Total Loss: 0.005749 in 2.279 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 2.286 with std = 0.041 sec ###
### py4DSTEM ptycho solver is finished in 48.674 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 916.62 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 128, 3, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 606/16384 [00:00<00:02, 6056.19probe position/s]Normalizing amplitudes:   7%|▋         | 1212/16384 [00:00<00:02, 5919.80probe position/s]Normalizing amplitudes:  11%|█         | 1805/16384 [00:00<00:02, 5803.29probe position/s]Normalizing amplitudes:  15%|█▌        | 2461/16384 [00:00<00:02, 6093.74probe position/s]Normalizing amplitudes:  19%|█▉        | 3119/16384 [00:00<00:02, 6266.63probe position/s]Normalizing amplitudes:  23%|██▎       | 3784/16384 [00:00<00:01, 6394.26probe position/s]Normalizing amplitudes:  27%|██▋       | 4424/16384 [00:00<00:01, 6353.21probe position/s]Normalizing amplitudes:  31%|███       | 5060/16384 [00:00<00:01, 6337.64probe position/s]Normalizing amplitudes:  35%|███▍      | 5698/16384 [00:00<00:01, 6350.24probe position/s]Normalizing amplitudes:  39%|███▊      | 6334/16384 [00:01<00:01, 6334.29probe position/s]Normalizing amplitudes:  43%|████▎     | 6968/16384 [00:01<00:01, 6311.66probe position/s]Normalizing amplitudes:  46%|████▋     | 7613/16384 [00:01<00:01, 6352.69probe position/s]Normalizing amplitudes:  50%|█████     | 8255/16384 [00:01<00:01, 6370.59probe position/s]Normalizing amplitudes:  54%|█████▍    | 8918/16384 [00:01<00:01, 6446.85probe position/s]Normalizing amplitudes:  58%|█████▊    | 9580/16384 [00:01<00:01, 6495.72probe position/s]Normalizing amplitudes:  62%|██████▏   | 10237/16384 [00:01<00:00, 6516.07probe position/s]Normalizing amplitudes:  66%|██████▋   | 10889/16384 [00:01<00:00, 6467.66probe position/s]Normalizing amplitudes:  70%|███████   | 11536/16384 [00:01<00:00, 6416.22probe position/s]Normalizing amplitudes:  74%|███████▍  | 12178/16384 [00:01<00:00, 6343.36probe position/s]Normalizing amplitudes:  78%|███████▊  | 12821/16384 [00:02<00:00, 6366.92probe position/s]Normalizing amplitudes:  82%|████████▏ | 13458/16384 [00:02<00:00, 6290.69probe position/s]Normalizing amplitudes:  86%|████████▌ | 14115/16384 [00:02<00:00, 6372.90probe position/s]Normalizing amplitudes:  90%|█████████ | 14793/16384 [00:02<00:00, 6491.81probe position/s]Normalizing amplitudes:  94%|█████████▍| 15443/16384 [00:02<00:00, 6485.89probe position/s]Normalizing amplitudes:  98%|█████████▊| 16092/16384 [00:02<00:00, 6401.68probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6353.58probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random128_p3_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random128_p3_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.01506 in 6.206 sec
Iter: 2, Total Loss: 0.006419 in 6.183 sec
Iter: 3, Total Loss: 0.006306 in 6.088 sec
Iter: 4, Total Loss: 0.006232 in 6.131 sec
Iter: 5, Total Loss: 0.006167 in 6.152 sec
Iter: 6, Total Loss: 0.006103 in 6.076 sec
Iter: 7, Total Loss: 0.00604 in 6.157 sec
Iter: 8, Total Loss: 0.00598 in 6.125 sec
Iter: 9, Total Loss: 0.005921 in 6.086 sec
Iter: 10, Total Loss: 0.005865 in 6.074 sec
Iter: 11, Total Loss: 0.005813 in 6.115 sec
Iter: 12, Total Loss: 0.005763 in 6.104 sec
Iter: 13, Total Loss: 0.005716 in 6.280 sec
Iter: 14, Total Loss: 0.005673 in 6.115 sec
Iter: 15, Total Loss: 0.005633 in 6.182 sec
Iter: 16, Total Loss: 0.005596 in 6.173 sec
Iter: 17, Total Loss: 0.005563 in 6.140 sec
Iter: 18, Total Loss: 0.005533 in 6.003 sec
Iter: 19, Total Loss: 0.005505 in 6.079 sec
Iter: 20, Total Loss: 0.005479 in 6.071 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 6.127 with std = 0.059 sec ###
### py4DSTEM ptycho solver is finished in 2 min 5.423 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 916.55 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 128, 3, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 632/16384 [00:00<00:02, 6308.95probe position/s]Normalizing amplitudes:   8%|▊         | 1263/16384 [00:00<00:02, 6293.62probe position/s]Normalizing amplitudes:  12%|█▏        | 1893/16384 [00:00<00:02, 6271.65probe position/s]Normalizing amplitudes:  15%|█▌        | 2530/16384 [00:00<00:02, 6308.17probe position/s]Normalizing amplitudes:  19%|█▉        | 3161/16384 [00:00<00:02, 6247.24probe position/s]Normalizing amplitudes:  23%|██▎       | 3809/16384 [00:00<00:01, 6324.62probe position/s]Normalizing amplitudes:  27%|██▋       | 4473/16384 [00:00<00:01, 6425.08probe position/s]Normalizing amplitudes:  31%|███▏      | 5129/16384 [00:00<00:01, 6465.41probe position/s]Normalizing amplitudes:  35%|███▌      | 5776/16384 [00:00<00:01, 6371.82probe position/s]Normalizing amplitudes:  39%|███▉      | 6414/16384 [00:01<00:01, 6289.18probe position/s]Normalizing amplitudes:  43%|████▎     | 7044/16384 [00:01<00:01, 6231.77probe position/s]Normalizing amplitudes:  47%|████▋     | 7668/16384 [00:01<00:01, 6206.84probe position/s]Normalizing amplitudes:  51%|█████     | 8322/16384 [00:01<00:01, 6305.24probe position/s]Normalizing amplitudes:  55%|█████▍    | 8953/16384 [00:01<00:01, 6276.67probe position/s]Normalizing amplitudes:  59%|█████▊    | 9593/16384 [00:01<00:01, 6312.97probe position/s]Normalizing amplitudes:  62%|██████▏   | 10225/16384 [00:01<00:00, 6311.44probe position/s]Normalizing amplitudes:  66%|██████▋   | 10857/16384 [00:01<00:00, 6313.62probe position/s]Normalizing amplitudes:  70%|███████   | 11497/16384 [00:01<00:00, 6337.73probe position/s]Normalizing amplitudes:  74%|███████▍  | 12131/16384 [00:01<00:00, 6303.35probe position/s]Normalizing amplitudes:  78%|███████▊  | 12762/16384 [00:02<00:00, 6270.68probe position/s]Normalizing amplitudes:  82%|████████▏ | 13401/16384 [00:02<00:00, 6305.67probe position/s]Normalizing amplitudes:  86%|████████▌ | 14032/16384 [00:02<00:00, 6258.33probe position/s]Normalizing amplitudes:  90%|████████▉ | 14696/16384 [00:02<00:00, 6370.44probe position/s]Normalizing amplitudes:  94%|█████████▎| 15345/16384 [00:02<00:00, 6404.81probe position/s]Normalizing amplitudes:  98%|█████████▊| 15986/16384 [00:02<00:00, 6298.67probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6299.32probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random128_p3_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random128_p3_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.01591 in 11.641 sec
Iter: 2, Total Loss: 0.006388 in 11.564 sec
Iter: 3, Total Loss: 0.006226 in 11.589 sec
Iter: 4, Total Loss: 0.006136 in 11.581 sec
Iter: 5, Total Loss: 0.006059 in 11.679 sec
Iter: 6, Total Loss: 0.005988 in 11.593 sec
Iter: 7, Total Loss: 0.005921 in 11.532 sec
Iter: 8, Total Loss: 0.005859 in 11.593 sec
Iter: 9, Total Loss: 0.0058 in 11.724 sec
Iter: 10, Total Loss: 0.005745 in 11.576 sec
Iter: 11, Total Loss: 0.005692 in 11.717 sec
Iter: 12, Total Loss: 0.005644 in 11.700 sec
Iter: 13, Total Loss: 0.005599 in 11.635 sec
Iter: 14, Total Loss: 0.005558 in 11.636 sec
Iter: 15, Total Loss: 0.005521 in 11.656 sec
Iter: 16, Total Loss: 0.005487 in 11.765 sec
Iter: 17, Total Loss: 0.005456 in 11.535 sec
Iter: 18, Total Loss: 0.005427 in 11.547 sec
Iter: 19, Total Loss: 0.005401 in 11.662 sec
Iter: 20, Total Loss: 0.005377 in 11.644 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 11.628 with std = 0.065 sec ###
### py4DSTEM ptycho solver is finished in 3 min 55.463 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 916.50 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 128, 6, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 659/16384 [00:00<00:02, 6580.11probe position/s]Normalizing amplitudes:   8%|▊         | 1318/16384 [00:00<00:02, 6558.13probe position/s]Normalizing amplitudes:  12%|█▏        | 1974/16384 [00:00<00:02, 6501.91probe position/s]Normalizing amplitudes:  16%|█▌        | 2625/16384 [00:00<00:02, 6311.96probe position/s]Normalizing amplitudes:  20%|█▉        | 3257/16384 [00:00<00:02, 6284.81probe position/s]Normalizing amplitudes:  24%|██▍       | 3906/16384 [00:00<00:01, 6350.77probe position/s]Normalizing amplitudes:  28%|██▊       | 4542/16384 [00:00<00:01, 6334.03probe position/s]Normalizing amplitudes:  32%|███▏      | 5185/16384 [00:00<00:01, 6362.57probe position/s]Normalizing amplitudes:  36%|███▌      | 5835/16384 [00:00<00:01, 6403.34probe position/s]Normalizing amplitudes:  40%|███▉      | 6476/16384 [00:01<00:01, 6108.77probe position/s]Normalizing amplitudes:  43%|████▎     | 7090/16384 [00:01<00:01, 5823.92probe position/s]Normalizing amplitudes:  47%|████▋     | 7677/16384 [00:01<00:01, 5696.67probe position/s]Normalizing amplitudes:  51%|█████     | 8275/16384 [00:01<00:01, 5777.37probe position/s]Normalizing amplitudes:  54%|█████▍    | 8901/16384 [00:01<00:01, 5913.42probe position/s]Normalizing amplitudes:  58%|█████▊    | 9535/16384 [00:01<00:01, 6037.13probe position/s]Normalizing amplitudes:  62%|██████▏   | 10205/16384 [00:01<00:00, 6230.34probe position/s]Normalizing amplitudes:  66%|██████▌   | 10852/16384 [00:01<00:00, 6299.63probe position/s]Normalizing amplitudes:  70%|███████   | 11484/16384 [00:01<00:00, 6154.89probe position/s]Normalizing amplitudes:  74%|███████▍  | 12102/16384 [00:01<00:00, 5976.74probe position/s]Normalizing amplitudes:  78%|███████▊  | 12708/16384 [00:02<00:00, 5999.77probe position/s]Normalizing amplitudes:  81%|████████▏ | 13338/16384 [00:02<00:00, 6085.35probe position/s]Normalizing amplitudes:  85%|████████▌ | 13978/16384 [00:02<00:00, 6175.76probe position/s]Normalizing amplitudes:  89%|████████▉ | 14609/16384 [00:02<00:00, 6212.81probe position/s]Normalizing amplitudes:  93%|█████████▎| 15242/16384 [00:02<00:00, 6247.05probe position/s]Normalizing amplitudes:  97%|█████████▋| 15909/16384 [00:02<00:00, 6370.63probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6188.29probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random128_p6_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random128_p6_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.03192 in 4.314 sec
Iter: 2, Total Loss: 0.006508 in 4.204 sec
Iter: 3, Total Loss: 0.006388 in 4.193 sec
Iter: 4, Total Loss: 0.006315 in 4.257 sec
Iter: 5, Total Loss: 0.006255 in 4.219 sec
Iter: 6, Total Loss: 0.006199 in 4.325 sec
Iter: 7, Total Loss: 0.006146 in 4.196 sec
Iter: 8, Total Loss: 0.006095 in 4.261 sec
Iter: 9, Total Loss: 0.006043 in 4.238 sec
Iter: 10, Total Loss: 0.005993 in 4.270 sec
Iter: 11, Total Loss: 0.005943 in 4.279 sec
Iter: 12, Total Loss: 0.005894 in 4.257 sec
Iter: 13, Total Loss: 0.005848 in 4.289 sec
Iter: 14, Total Loss: 0.005802 in 4.215 sec
Iter: 15, Total Loss: 0.005759 in 4.261 sec
Iter: 16, Total Loss: 0.005716 in 4.240 sec
Iter: 17, Total Loss: 0.005675 in 4.174 sec
Iter: 18, Total Loss: 0.005637 in 4.225 sec
Iter: 19, Total Loss: 0.0056 in 4.170 sec
Iter: 20, Total Loss: 0.005565 in 4.267 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 4.243 with std = 0.042 sec ###
### py4DSTEM ptycho solver is finished in 1 min 27.708 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 915.23 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 128, 6, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 648/16384 [00:00<00:02, 6475.13probe position/s]Normalizing amplitudes:   8%|▊         | 1296/16384 [00:00<00:02, 5821.20probe position/s]Normalizing amplitudes:  11%|█▏        | 1883/16384 [00:00<00:02, 5829.54probe position/s]Normalizing amplitudes:  15%|█▌        | 2527/16384 [00:00<00:02, 6061.14probe position/s]Normalizing amplitudes:  19%|█▉        | 3168/16384 [00:00<00:02, 6183.17probe position/s]Normalizing amplitudes:  23%|██▎       | 3789/16384 [00:00<00:02, 6057.29probe position/s]Normalizing amplitudes:  27%|██▋       | 4397/16384 [00:00<00:01, 6033.65probe position/s]Normalizing amplitudes:  31%|███       | 5002/16384 [00:00<00:01, 6008.59probe position/s]Normalizing amplitudes:  35%|███▍      | 5655/16384 [00:00<00:01, 6167.40probe position/s]Normalizing amplitudes:  38%|███▊      | 6287/16384 [00:01<00:01, 6213.71probe position/s]Normalizing amplitudes:  42%|████▏     | 6909/16384 [00:01<00:01, 6185.98probe position/s]Normalizing amplitudes:  46%|████▌     | 7528/16384 [00:01<00:01, 6102.39probe position/s]Normalizing amplitudes:  50%|████▉     | 8139/16384 [00:01<00:01, 6097.89probe position/s]Normalizing amplitudes:  53%|█████▎    | 8750/16384 [00:01<00:01, 6054.95probe position/s]Normalizing amplitudes:  57%|█████▋    | 9356/16384 [00:01<00:01, 5875.72probe position/s]Normalizing amplitudes:  61%|██████    | 10002/16384 [00:01<00:01, 6045.47probe position/s]Normalizing amplitudes:  65%|██████▍   | 10637/16384 [00:01<00:00, 6133.28probe position/s]Normalizing amplitudes:  69%|██████▉   | 11265/16384 [00:01<00:00, 6176.27probe position/s]Normalizing amplitudes:  73%|███████▎  | 11896/16384 [00:01<00:00, 6214.33probe position/s]Normalizing amplitudes:  76%|███████▋  | 12524/16384 [00:02<00:00, 6232.05probe position/s]Normalizing amplitudes:  80%|████████  | 13153/16384 [00:02<00:00, 6247.98probe position/s]Normalizing amplitudes:  84%|████████▍ | 13779/16384 [00:02<00:00, 6215.04probe position/s]Normalizing amplitudes:  88%|████████▊ | 14403/16384 [00:02<00:00, 6221.02probe position/s]Normalizing amplitudes:  92%|█████████▏| 15047/16384 [00:02<00:00, 6283.55probe position/s]Normalizing amplitudes:  96%|█████████▌| 15676/16384 [00:02<00:00, 6282.48probe position/s]Normalizing amplitudes: 100%|█████████▉| 16339/16384 [00:02<00:00, 6384.33probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6161.65probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random128_p6_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random128_p6_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.03257 in 11.875 sec
Iter: 2, Total Loss: 0.006497 in 11.628 sec
Iter: 3, Total Loss: 0.006277 in 11.858 sec
Iter: 4, Total Loss: 0.006174 in 11.859 sec
Iter: 5, Total Loss: 0.00609 in 11.659 sec
Iter: 6, Total Loss: 0.006015 in 11.608 sec
Iter: 7, Total Loss: 0.005943 in 11.579 sec
Iter: 8, Total Loss: 0.005874 in 11.638 sec
Iter: 9, Total Loss: 0.00581 in 11.703 sec
Iter: 10, Total Loss: 0.005749 in 11.740 sec
Iter: 11, Total Loss: 0.00569 in 11.714 sec
Iter: 12, Total Loss: 0.005634 in 11.687 sec
Iter: 13, Total Loss: 0.005582 in 11.743 sec
Iter: 14, Total Loss: 0.005532 in 11.820 sec
Iter: 15, Total Loss: 0.005486 in 11.781 sec
Iter: 16, Total Loss: 0.005443 in 11.879 sec
Iter: 17, Total Loss: 0.005403 in 11.701 sec
Iter: 18, Total Loss: 0.005366 in 11.614 sec
Iter: 19, Total Loss: 0.005333 in 11.728 sec
Iter: 20, Total Loss: 0.005301 in 11.836 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 11.733 with std = 0.094 sec ###
### py4DSTEM ptycho solver is finished in 3 min 57.423 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 913.26 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 128, 6, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 602/16384 [00:00<00:02, 6016.53probe position/s]Normalizing amplitudes:   7%|▋         | 1204/16384 [00:00<00:02, 5989.87probe position/s]Normalizing amplitudes:  11%|█         | 1813/16384 [00:00<00:02, 6034.03probe position/s]Normalizing amplitudes:  15%|█▍        | 2417/16384 [00:00<00:02, 5919.81probe position/s]Normalizing amplitudes:  19%|█▊        | 3064/16384 [00:00<00:02, 6114.16probe position/s]Normalizing amplitudes:  22%|██▏       | 3676/16384 [00:00<00:02, 6018.28probe position/s]Normalizing amplitudes:  26%|██▌       | 4298/16384 [00:00<00:01, 6082.93probe position/s]Normalizing amplitudes:  30%|███       | 4948/16384 [00:00<00:01, 6210.16probe position/s]Normalizing amplitudes:  34%|███▍      | 5570/16384 [00:00<00:01, 6170.96probe position/s]Normalizing amplitudes:  38%|███▊      | 6199/16384 [00:01<00:01, 6206.59probe position/s]Normalizing amplitudes:  42%|████▏     | 6820/16384 [00:01<00:01, 6073.61probe position/s]Normalizing amplitudes:  45%|████▌     | 7448/16384 [00:01<00:01, 6134.52probe position/s]Normalizing amplitudes:  49%|████▉     | 8088/16384 [00:01<00:01, 6212.78probe position/s]Normalizing amplitudes:  53%|█████▎    | 8718/16384 [00:01<00:01, 6236.40probe position/s]Normalizing amplitudes:  57%|█████▋    | 9359/16384 [00:01<00:01, 6286.77probe position/s]Normalizing amplitudes:  61%|██████    | 9989/16384 [00:01<00:01, 6288.52probe position/s]Normalizing amplitudes:  65%|██████▍   | 10623/16384 [00:01<00:00, 6302.35probe position/s]Normalizing amplitudes:  69%|██████▊   | 11254/16384 [00:01<00:00, 6260.11probe position/s]Normalizing amplitudes:  73%|███████▎  | 11881/16384 [00:01<00:00, 6160.94probe position/s]Normalizing amplitudes:  76%|███████▋  | 12498/16384 [00:02<00:00, 6109.93probe position/s]Normalizing amplitudes:  80%|████████  | 13110/16384 [00:02<00:00, 5870.56probe position/s]Normalizing amplitudes:  84%|████████▎ | 13699/16384 [00:02<00:00, 5678.15probe position/s]Normalizing amplitudes:  88%|████████▊ | 14348/16384 [00:02<00:00, 5907.23probe position/s]Normalizing amplitudes:  91%|█████████ | 14942/16384 [00:02<00:00, 5871.30probe position/s]Normalizing amplitudes:  95%|█████████▍| 15546/16384 [00:02<00:00, 5917.84probe position/s]Normalizing amplitudes:  99%|█████████▊| 16140/16384 [00:02<00:00, 5787.18probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6038.78probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random128_p6_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random128_p6_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.03395 in 22.907 sec
Iter: 2, Total Loss: 0.006523 in 22.849 sec
Iter: 3, Total Loss: 0.006183 in 23.061 sec
Iter: 4, Total Loss: 0.006052 in 23.055 sec
Iter: 5, Total Loss: 0.005953 in 22.950 sec
Iter: 6, Total Loss: 0.005863 in 23.229 sec
Iter: 7, Total Loss: 0.005783 in 23.074 sec
Iter: 8, Total Loss: 0.005708 in 23.185 sec
Iter: 9, Total Loss: 0.005638 in 23.262 sec
Iter: 10, Total Loss: 0.005575 in 22.888 sec
Iter: 11, Total Loss: 0.005515 in 22.968 sec
Iter: 12, Total Loss: 0.005461 in 23.087 sec
Iter: 13, Total Loss: 0.005412 in 22.876 sec
Iter: 14, Total Loss: 0.005367 in 22.972 sec
Iter: 15, Total Loss: 0.005325 in 23.125 sec
Iter: 16, Total Loss: 0.005288 in 23.320 sec
Iter: 17, Total Loss: 0.005253 in 23.254 sec
Iter: 18, Total Loss: 0.00522 in 23.008 sec
Iter: 19, Total Loss: 0.005188 in 22.905 sec
Iter: 20, Total Loss: 0.005159 in 23.569 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 23.077 with std = 0.178 sec ###
### py4DSTEM ptycho solver is finished in 7 min 44.674 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 913.03 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 128, 12, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 655/16384 [00:00<00:02, 6541.80probe position/s]Normalizing amplitudes:   8%|▊         | 1310/16384 [00:00<00:02, 6127.56probe position/s]Normalizing amplitudes:  12%|█▏        | 1925/16384 [00:00<00:02, 5969.19probe position/s]Normalizing amplitudes:  15%|█▌        | 2523/16384 [00:00<00:02, 5651.31probe position/s]Normalizing amplitudes:  19%|█▉        | 3091/16384 [00:00<00:02, 5557.67probe position/s]Normalizing amplitudes:  22%|██▏       | 3648/16384 [00:00<00:02, 5514.91probe position/s]Normalizing amplitudes:  26%|██▌       | 4200/16384 [00:00<00:02, 5495.38probe position/s]Normalizing amplitudes:  29%|██▉       | 4808/16384 [00:00<00:02, 5674.55probe position/s]Normalizing amplitudes:  33%|███▎      | 5377/16384 [00:00<00:01, 5650.65probe position/s]Normalizing amplitudes:  36%|███▋      | 5943/16384 [00:01<00:01, 5637.40probe position/s]Normalizing amplitudes:  40%|███▉      | 6508/16384 [00:01<00:01, 5617.04probe position/s]Normalizing amplitudes:  43%|████▎     | 7070/16384 [00:01<00:01, 5563.83probe position/s]Normalizing amplitudes:  47%|████▋     | 7651/16384 [00:01<00:01, 5634.24probe position/s]Normalizing amplitudes:  50%|█████     | 8273/16384 [00:01<00:01, 5806.76probe position/s]Normalizing amplitudes:  54%|█████▍    | 8913/16384 [00:01<00:01, 5982.27probe position/s]Normalizing amplitudes:  58%|█████▊    | 9548/16384 [00:01<00:01, 6091.09probe position/s]Normalizing amplitudes:  62%|██████▏   | 10191/16384 [00:01<00:01, 6191.76probe position/s]Normalizing amplitudes:  66%|██████▌   | 10825/16384 [00:01<00:00, 6233.68probe position/s]Normalizing amplitudes:  70%|██████▉   | 11452/16384 [00:01<00:00, 6243.68probe position/s]Normalizing amplitudes:  74%|███████▎  | 12077/16384 [00:02<00:00, 6223.88probe position/s]Normalizing amplitudes:  78%|███████▊  | 12700/16384 [00:02<00:00, 6203.21probe position/s]Normalizing amplitudes:  81%|████████▏ | 13327/16384 [00:02<00:00, 6222.89probe position/s]Normalizing amplitudes:  85%|████████▌ | 13987/16384 [00:02<00:00, 6333.52probe position/s]Normalizing amplitudes:  89%|████████▉ | 14621/16384 [00:02<00:00, 6218.20probe position/s]Normalizing amplitudes:  93%|█████████▎| 15254/16384 [00:02<00:00, 6248.87probe position/s]Normalizing amplitudes:  97%|█████████▋| 15880/16384 [00:02<00:00, 6168.83probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5965.98probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random128_p12_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random128_p12_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.07475 in 8.008 sec
Iter: 2, Total Loss: 0.006568 in 8.070 sec
Iter: 3, Total Loss: 0.006392 in 8.046 sec
Iter: 4, Total Loss: 0.006296 in 7.970 sec
Iter: 5, Total Loss: 0.006222 in 8.096 sec
Iter: 6, Total Loss: 0.006156 in 8.004 sec
Iter: 7, Total Loss: 0.006092 in 8.004 sec
Iter: 8, Total Loss: 0.006032 in 8.000 sec
Iter: 9, Total Loss: 0.005972 in 8.030 sec
Iter: 10, Total Loss: 0.005912 in 8.011 sec
Iter: 11, Total Loss: 0.005856 in 7.998 sec
Iter: 12, Total Loss: 0.005803 in 7.936 sec
Iter: 13, Total Loss: 0.005754 in 8.094 sec
Iter: 14, Total Loss: 0.005707 in 8.121 sec
Iter: 15, Total Loss: 0.005663 in 8.081 sec
Iter: 16, Total Loss: 0.005622 in 8.018 sec
Iter: 17, Total Loss: 0.005584 in 8.192 sec
Iter: 18, Total Loss: 0.005548 in 8.232 sec
Iter: 19, Total Loss: 0.005513 in 8.357 sec
Iter: 20, Total Loss: 0.005481 in 8.057 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 8.066 with std = 0.096 sec ###
### py4DSTEM ptycho solver is finished in 2 min 44.311 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 912.76 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 128, 12, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 647/16384 [00:00<00:02, 6461.99probe position/s]Normalizing amplitudes:   8%|▊         | 1308/16384 [00:00<00:02, 6546.86probe position/s]Normalizing amplitudes:  12%|█▏        | 1970/16384 [00:00<00:02, 6577.67probe position/s]Normalizing amplitudes:  16%|█▌        | 2635/16384 [00:00<00:02, 6602.04probe position/s]Normalizing amplitudes:  20%|██        | 3296/16384 [00:00<00:02, 6534.20probe position/s]Normalizing amplitudes:  24%|██▍       | 3950/16384 [00:00<00:01, 6428.46probe position/s]Normalizing amplitudes:  28%|██▊       | 4594/16384 [00:00<00:01, 6405.55probe position/s]Normalizing amplitudes:  32%|███▏      | 5237/16384 [00:00<00:01, 6412.27probe position/s]Normalizing amplitudes:  36%|███▌      | 5914/16384 [00:00<00:01, 6522.09probe position/s]Normalizing amplitudes:  40%|████      | 6574/16384 [00:01<00:01, 6543.73probe position/s]Normalizing amplitudes:  44%|████▍     | 7229/16384 [00:01<00:01, 6457.77probe position/s]Normalizing amplitudes:  48%|████▊     | 7876/16384 [00:01<00:01, 6356.14probe position/s]Normalizing amplitudes:  52%|█████▏    | 8542/16384 [00:01<00:01, 6443.55probe position/s]Normalizing amplitudes:  56%|█████▋    | 9230/16384 [00:01<00:01, 6572.92probe position/s]Normalizing amplitudes:  60%|██████    | 9890/16384 [00:01<00:00, 6578.53probe position/s]Normalizing amplitudes:  64%|██████▍   | 10549/16384 [00:01<00:00, 6548.14probe position/s]Normalizing amplitudes:  68%|██████▊   | 11211/16384 [00:01<00:00, 6569.08probe position/s]Normalizing amplitudes:  72%|███████▏  | 11874/16384 [00:01<00:00, 6586.20probe position/s]Normalizing amplitudes:  76%|███████▋  | 12533/16384 [00:01<00:00, 6527.81probe position/s]Normalizing amplitudes:  81%|████████  | 13196/16384 [00:02<00:00, 6557.33probe position/s]Normalizing amplitudes:  85%|████████▍ | 13852/16384 [00:02<00:00, 6520.77probe position/s]Normalizing amplitudes:  89%|████████▊ | 14505/16384 [00:02<00:00, 6467.58probe position/s]Normalizing amplitudes:  93%|█████████▎| 15156/16384 [00:02<00:00, 6478.67probe position/s]Normalizing amplitudes:  97%|█████████▋| 15833/16384 [00:02<00:00, 6563.98probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6521.62probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random128_p12_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random128_p12_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.07525 in 22.837 sec
Iter: 2, Total Loss: 0.006564 in 22.320 sec
Iter: 3, Total Loss: 0.006265 in 22.374 sec
Iter: 4, Total Loss: 0.006134 in 22.324 sec
Iter: 5, Total Loss: 0.006032 in 22.393 sec
Iter: 6, Total Loss: 0.005941 in 22.444 sec
Iter: 7, Total Loss: 0.005854 in 22.459 sec
Iter: 8, Total Loss: 0.005771 in 22.453 sec
Iter: 9, Total Loss: 0.005694 in 22.568 sec
Iter: 10, Total Loss: 0.005623 in 22.634 sec
Iter: 11, Total Loss: 0.005558 in 22.417 sec
Iter: 12, Total Loss: 0.005498 in 22.620 sec
Iter: 13, Total Loss: 0.005445 in 22.687 sec
Iter: 14, Total Loss: 0.005397 in 22.449 sec
Iter: 15, Total Loss: 0.005352 in 22.834 sec
Iter: 16, Total Loss: 0.005313 in 22.975 sec
Iter: 17, Total Loss: 0.005275 in 22.904 sec
Iter: 18, Total Loss: 0.005241 in 22.870 sec
Iter: 19, Total Loss: 0.005207 in 22.723 sec
Iter: 20, Total Loss: 0.005176 in 22.573 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 22.593 with std = 0.202 sec ###
### py4DSTEM ptycho solver is finished in 7 min 34.717 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 916.61 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 128, 12, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 660/16384 [00:00<00:02, 6596.69probe position/s]Normalizing amplitudes:   8%|▊         | 1320/16384 [00:00<00:02, 6430.16probe position/s]Normalizing amplitudes:  12%|█▏        | 1964/16384 [00:00<00:02, 6409.10probe position/s]Normalizing amplitudes:  16%|█▌        | 2619/16384 [00:00<00:02, 6461.18probe position/s]Normalizing amplitudes:  20%|█▉        | 3266/16384 [00:00<00:02, 6375.55probe position/s]Normalizing amplitudes:  24%|██▍       | 3904/16384 [00:00<00:02, 6180.55probe position/s]Normalizing amplitudes:  28%|██▊       | 4524/16384 [00:00<00:01, 6057.35probe position/s]Normalizing amplitudes:  32%|███▏      | 5189/16384 [00:00<00:01, 6236.43probe position/s]Normalizing amplitudes:  35%|███▌      | 5814/16384 [00:00<00:01, 6187.41probe position/s]Normalizing amplitudes:  39%|███▉      | 6434/16384 [00:01<00:01, 6172.64probe position/s]Normalizing amplitudes:  43%|████▎     | 7052/16384 [00:01<00:01, 6016.64probe position/s]Normalizing amplitudes:  47%|████▋     | 7655/16384 [00:01<00:01, 5952.26probe position/s]Normalizing amplitudes:  51%|█████     | 8285/16384 [00:01<00:01, 6053.27probe position/s]Normalizing amplitudes:  54%|█████▍    | 8922/16384 [00:01<00:01, 6144.14probe position/s]Normalizing amplitudes:  58%|█████▊    | 9567/16384 [00:01<00:01, 6233.56probe position/s]Normalizing amplitudes:  62%|██████▏   | 10232/16384 [00:01<00:00, 6355.33probe position/s]Normalizing amplitudes:  66%|██████▋   | 10883/16384 [00:01<00:00, 6399.95probe position/s]Normalizing amplitudes:  70%|███████   | 11524/16384 [00:01<00:00, 6393.06probe position/s]Normalizing amplitudes:  74%|███████▍  | 12164/16384 [00:01<00:00, 6296.00probe position/s]Normalizing amplitudes:  78%|███████▊  | 12795/16384 [00:02<00:00, 6205.07probe position/s]Normalizing amplitudes:  82%|████████▏ | 13417/16384 [00:02<00:00, 6191.91probe position/s]Normalizing amplitudes:  86%|████████▌ | 14048/16384 [00:02<00:00, 6223.75probe position/s]Normalizing amplitudes:  90%|████████▉ | 14700/16384 [00:02<00:00, 6310.72probe position/s]Normalizing amplitudes:  94%|█████████▍| 15362/16384 [00:02<00:00, 6402.16probe position/s]Normalizing amplitudes:  98%|█████████▊| 16012/16384 [00:02<00:00, 6429.81probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6278.31probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random128_p12_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 128, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random128_p12_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 128 measurements.
Iter: 1, Total Loss: 0.07738 in 44.900 sec
Iter: 2, Total Loss: 0.006774 in 45.779 sec
Iter: 3, Total Loss: 0.006211 in 44.669 sec
Iter: 4, Total Loss: 0.006039 in 44.315 sec
Iter: 5, Total Loss: 0.005922 in 44.974 sec
Iter: 6, Total Loss: 0.005822 in 45.501 sec
Iter: 7, Total Loss: 0.005735 in 45.134 sec
Iter: 8, Total Loss: 0.005657 in 45.565 sec
Iter: 9, Total Loss: 0.005585 in 45.581 sec
Iter: 10, Total Loss: 0.005519 in 45.084 sec
Iter: 11, Total Loss: 0.005458 in 45.159 sec
Iter: 12, Total Loss: 0.005403 in 45.233 sec
Iter: 13, Total Loss: 0.005353 in 44.988 sec
Iter: 14, Total Loss: 0.005306 in 45.054 sec
Iter: 15, Total Loss: 0.005263 in 44.865 sec
Iter: 16, Total Loss: 0.005223 in 44.839 sec
Iter: 17, Total Loss: 0.005187 in 44.724 sec
Iter: 18, Total Loss: 0.005153 in 45.046 sec
Iter: 19, Total Loss: 0.005122 in 44.702 sec
Iter: 20, Total Loss: 0.005092 in 44.692 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 45.040 with std = 0.352 sec ###
### py4DSTEM ptycho solver is finished in 15 min 3.749 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 915.28 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 64, 1, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 556/16384 [00:00<00:02, 5550.38probe position/s]Normalizing amplitudes:   7%|▋         | 1216/16384 [00:00<00:02, 6166.55probe position/s]Normalizing amplitudes:  11%|█         | 1833/16384 [00:00<00:02, 6104.42probe position/s]Normalizing amplitudes:  15%|█▍        | 2444/16384 [00:00<00:02, 6091.96probe position/s]Normalizing amplitudes:  19%|█▉        | 3082/16384 [00:00<00:02, 6192.28probe position/s]Normalizing amplitudes:  23%|██▎       | 3724/16384 [00:00<00:02, 6268.32probe position/s]Normalizing amplitudes:  27%|██▋       | 4351/16384 [00:00<00:01, 6265.65probe position/s]Normalizing amplitudes:  30%|███       | 4978/16384 [00:00<00:01, 6231.81probe position/s]Normalizing amplitudes:  34%|███▍      | 5645/16384 [00:00<00:01, 6367.81probe position/s]Normalizing amplitudes:  38%|███▊      | 6292/16384 [00:01<00:01, 6396.91probe position/s]Normalizing amplitudes:  42%|████▏     | 6932/16384 [00:01<00:01, 6317.60probe position/s]Normalizing amplitudes:  46%|████▌     | 7565/16384 [00:01<00:01, 6279.36probe position/s]Normalizing amplitudes:  50%|█████     | 8194/16384 [00:01<00:01, 6273.19probe position/s]Normalizing amplitudes:  54%|█████▍    | 8822/16384 [00:01<00:01, 6270.37probe position/s]Normalizing amplitudes:  58%|█████▊    | 9460/16384 [00:01<00:01, 6300.91probe position/s]Normalizing amplitudes:  62%|██████▏   | 10110/16384 [00:01<00:00, 6359.53probe position/s]Normalizing amplitudes:  66%|██████▌   | 10776/16384 [00:01<00:00, 6447.70probe position/s]Normalizing amplitudes:  70%|██████▉   | 11421/16384 [00:01<00:00, 6188.97probe position/s]Normalizing amplitudes:  74%|███████▎  | 12043/16384 [00:01<00:00, 6189.92probe position/s]Normalizing amplitudes:  77%|███████▋  | 12664/16384 [00:02<00:00, 6174.96probe position/s]Normalizing amplitudes:  81%|████████  | 13283/16384 [00:02<00:00, 6156.42probe position/s]Normalizing amplitudes:  85%|████████▍ | 13909/16384 [00:02<00:00, 6186.32probe position/s]Normalizing amplitudes:  89%|████████▉ | 14542/16384 [00:02<00:00, 6226.99probe position/s]Normalizing amplitudes:  93%|█████████▎| 15202/16384 [00:02<00:00, 6336.87probe position/s]Normalizing amplitudes:  97%|█████████▋| 15848/16384 [00:02<00:00, 6371.90probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6266.82probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random64_p1_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random64_p1_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.007544 in 1.827 sec
Iter: 2, Total Loss: 0.006521 in 1.793 sec
Iter: 3, Total Loss: 0.006489 in 1.871 sec
Iter: 4, Total Loss: 0.006463 in 1.808 sec
Iter: 5, Total Loss: 0.006434 in 1.857 sec
Iter: 6, Total Loss: 0.006405 in 1.766 sec
Iter: 7, Total Loss: 0.006378 in 1.795 sec
Iter: 8, Total Loss: 0.006348 in 1.835 sec
Iter: 9, Total Loss: 0.00632 in 1.784 sec
Iter: 10, Total Loss: 0.006294 in 1.805 sec
Iter: 11, Total Loss: 0.006269 in 1.786 sec
Iter: 12, Total Loss: 0.006246 in 1.790 sec
Iter: 13, Total Loss: 0.006225 in 1.787 sec
Iter: 14, Total Loss: 0.006206 in 1.805 sec
Iter: 15, Total Loss: 0.006189 in 1.829 sec
Iter: 16, Total Loss: 0.006174 in 1.789 sec
Iter: 17, Total Loss: 0.006158 in 1.804 sec
Iter: 18, Total Loss: 0.006147 in 1.760 sec
Iter: 19, Total Loss: 0.006135 in 1.815 sec
Iter: 20, Total Loss: 0.006124 in 1.753 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 1.803 with std = 0.029 sec ###
### py4DSTEM ptycho solver is finished in 38.866 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 913.17 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 64, 1, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 647/16384 [00:00<00:02, 6465.24probe position/s]Normalizing amplitudes:   8%|▊         | 1294/16384 [00:00<00:02, 6281.24probe position/s]Normalizing amplitudes:  12%|█▏        | 1923/16384 [00:00<00:02, 6282.95probe position/s]Normalizing amplitudes:  16%|█▌        | 2556/16384 [00:00<00:02, 6300.33probe position/s]Normalizing amplitudes:  19%|█▉        | 3187/16384 [00:00<00:02, 6227.13probe position/s]Normalizing amplitudes:  23%|██▎       | 3825/16384 [00:00<00:02, 6277.51probe position/s]Normalizing amplitudes:  27%|██▋       | 4466/16384 [00:00<00:01, 6318.29probe position/s]Normalizing amplitudes:  31%|███       | 5098/16384 [00:00<00:01, 6305.25probe position/s]Normalizing amplitudes:  35%|███▍      | 5729/16384 [00:00<00:01, 6119.43probe position/s]Normalizing amplitudes:  39%|███▉      | 6364/16384 [00:01<00:01, 6187.04probe position/s]Normalizing amplitudes:  43%|████▎     | 7005/16384 [00:01<00:01, 6253.79probe position/s]Normalizing amplitudes:  47%|████▋     | 7646/16384 [00:01<00:01, 6298.32probe position/s]Normalizing amplitudes:  51%|█████     | 8277/16384 [00:01<00:01, 5843.48probe position/s]Normalizing amplitudes:  54%|█████▍    | 8869/16384 [00:01<00:01, 5693.00probe position/s]Normalizing amplitudes:  58%|█████▊    | 9523/16384 [00:01<00:01, 5930.58probe position/s]Normalizing amplitudes:  62%|██████▏   | 10121/16384 [00:01<00:01, 5942.15probe position/s]Normalizing amplitudes:  65%|██████▌   | 10724/16384 [00:01<00:00, 5965.11probe position/s]Normalizing amplitudes:  69%|██████▉   | 11365/16384 [00:01<00:00, 6095.49probe position/s]Normalizing amplitudes:  73%|███████▎  | 11993/16384 [00:01<00:00, 6148.32probe position/s]Normalizing amplitudes:  77%|███████▋  | 12629/16384 [00:02<00:00, 6208.16probe position/s]Normalizing amplitudes:  81%|████████  | 13251/16384 [00:02<00:00, 6127.75probe position/s]Normalizing amplitudes:  85%|████████▍ | 13872/16384 [00:02<00:00, 6148.91probe position/s]Normalizing amplitudes:  88%|████████▊ | 14488/16384 [00:02<00:00, 6131.40probe position/s]Normalizing amplitudes:  92%|█████████▏| 15118/16384 [00:02<00:00, 6179.95probe position/s]Normalizing amplitudes:  96%|█████████▌| 15754/16384 [00:02<00:00, 6233.15probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6152.51probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random64_p1_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random64_p1_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.007614 in 4.209 sec
Iter: 2, Total Loss: 0.006526 in 4.128 sec
Iter: 3, Total Loss: 0.006486 in 4.124 sec
Iter: 4, Total Loss: 0.006447 in 4.051 sec
Iter: 5, Total Loss: 0.006409 in 4.093 sec
Iter: 6, Total Loss: 0.006376 in 4.056 sec
Iter: 7, Total Loss: 0.006343 in 4.125 sec
Iter: 8, Total Loss: 0.006312 in 4.114 sec
Iter: 9, Total Loss: 0.006284 in 4.142 sec
Iter: 10, Total Loss: 0.006257 in 4.147 sec
Iter: 11, Total Loss: 0.006232 in 4.185 sec
Iter: 12, Total Loss: 0.00621 in 4.161 sec
Iter: 13, Total Loss: 0.006189 in 4.149 sec
Iter: 14, Total Loss: 0.006169 in 4.126 sec
Iter: 15, Total Loss: 0.006152 in 4.119 sec
Iter: 16, Total Loss: 0.006137 in 4.183 sec
Iter: 17, Total Loss: 0.006124 in 4.134 sec
Iter: 18, Total Loss: 0.006109 in 4.163 sec
Iter: 19, Total Loss: 0.006097 in 4.196 sec
Iter: 20, Total Loss: 0.006088 in 4.235 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 4.142 with std = 0.045 sec ###
### py4DSTEM ptycho solver is finished in 1 min 25.812 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 913.18 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 64, 1, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 638/16384 [00:00<00:02, 6372.02probe position/s]Normalizing amplitudes:   8%|▊         | 1276/16384 [00:00<00:02, 6223.96probe position/s]Normalizing amplitudes:  12%|█▏        | 1914/16384 [00:00<00:02, 6289.95probe position/s]Normalizing amplitudes:  16%|█▌        | 2544/16384 [00:00<00:02, 6282.64probe position/s]Normalizing amplitudes:  19%|█▉        | 3174/16384 [00:00<00:02, 6287.67probe position/s]Normalizing amplitudes:  23%|██▎       | 3803/16384 [00:00<00:02, 6280.55probe position/s]Normalizing amplitudes:  27%|██▋       | 4441/16384 [00:00<00:01, 6309.76probe position/s]Normalizing amplitudes:  31%|███       | 5073/16384 [00:00<00:01, 6284.06probe position/s]Normalizing amplitudes:  35%|███▍      | 5704/16384 [00:00<00:01, 6292.06probe position/s]Normalizing amplitudes:  39%|███▊      | 6334/16384 [00:01<00:01, 6264.74probe position/s]Normalizing amplitudes:  42%|████▏     | 6961/16384 [00:01<00:01, 6120.83probe position/s]Normalizing amplitudes:  46%|████▌     | 7574/16384 [00:01<00:01, 6075.87probe position/s]Normalizing amplitudes:  50%|████▉     | 8183/16384 [00:01<00:01, 6066.98probe position/s]Normalizing amplitudes:  54%|█████▎    | 8794/16384 [00:01<00:01, 6078.13probe position/s]Normalizing amplitudes:  57%|█████▋    | 9411/16384 [00:01<00:01, 6104.68probe position/s]Normalizing amplitudes:  61%|██████▏   | 10045/16384 [00:01<00:01, 6173.58probe position/s]Normalizing amplitudes:  65%|██████▌   | 10713/16384 [00:01<00:00, 6323.27probe position/s]Normalizing amplitudes:  69%|██████▉   | 11353/16384 [00:01<00:00, 6345.29probe position/s]Normalizing amplitudes:  73%|███████▎  | 11988/16384 [00:01<00:00, 6318.21probe position/s]Normalizing amplitudes:  77%|███████▋  | 12620/16384 [00:02<00:00, 6286.47probe position/s]Normalizing amplitudes:  81%|████████  | 13249/16384 [00:02<00:00, 6283.04probe position/s]Normalizing amplitudes:  85%|████████▍ | 13918/16384 [00:02<00:00, 6404.17probe position/s]Normalizing amplitudes:  89%|████████▉ | 14594/16384 [00:02<00:00, 6506.96probe position/s]Normalizing amplitudes:  93%|█████████▎| 15245/16384 [00:02<00:00, 6371.55probe position/s]Normalizing amplitudes:  97%|█████████▋| 15883/16384 [00:02<00:00, 6350.72probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6272.34probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random64_p1_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random64_p1_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.007728 in 7.716 sec
Iter: 2, Total Loss: 0.006583 in 7.635 sec
Iter: 3, Total Loss: 0.006519 in 7.568 sec
Iter: 4, Total Loss: 0.006474 in 7.512 sec
Iter: 5, Total Loss: 0.006433 in 7.531 sec
Iter: 6, Total Loss: 0.006392 in 7.619 sec
Iter: 7, Total Loss: 0.006354 in 7.644 sec
Iter: 8, Total Loss: 0.006319 in 7.672 sec
Iter: 9, Total Loss: 0.006288 in 7.667 sec
Iter: 10, Total Loss: 0.006258 in 7.508 sec
Iter: 11, Total Loss: 0.006232 in 7.649 sec
Iter: 12, Total Loss: 0.006203 in 7.628 sec
Iter: 13, Total Loss: 0.006181 in 7.597 sec
Iter: 14, Total Loss: 0.006155 in 7.454 sec
Iter: 15, Total Loss: 0.006132 in 7.727 sec
Iter: 16, Total Loss: 0.006112 in 7.552 sec
Iter: 17, Total Loss: 0.006094 in 7.477 sec
Iter: 18, Total Loss: 0.006073 in 7.580 sec
Iter: 19, Total Loss: 0.006055 in 7.634 sec
Iter: 20, Total Loss: 0.006036 in 7.569 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 7.597 with std = 0.074 sec ###
### py4DSTEM ptycho solver is finished in 2 min 34.851 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 916.47 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 64, 3, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 627/16384 [00:00<00:02, 6268.80probe position/s]Normalizing amplitudes:   8%|▊         | 1254/16384 [00:00<00:02, 6127.87probe position/s]Normalizing amplitudes:  11%|█▏        | 1868/16384 [00:00<00:02, 6068.65probe position/s]Normalizing amplitudes:  15%|█▌        | 2475/16384 [00:00<00:02, 6066.63probe position/s]Normalizing amplitudes:  19%|█▉        | 3136/16384 [00:00<00:02, 6260.30probe position/s]Normalizing amplitudes:  23%|██▎       | 3763/16384 [00:00<00:02, 6205.25probe position/s]Normalizing amplitudes:  27%|██▋       | 4384/16384 [00:00<00:01, 6012.22probe position/s]Normalizing amplitudes:  31%|███       | 5004/16384 [00:00<00:01, 6068.77probe position/s]Normalizing amplitudes:  34%|███▍      | 5627/16384 [00:00<00:01, 6116.25probe position/s]Normalizing amplitudes:  38%|███▊      | 6249/16384 [00:01<00:01, 6145.22probe position/s]Normalizing amplitudes:  42%|████▏     | 6878/16384 [00:01<00:01, 6187.96probe position/s]Normalizing amplitudes:  46%|████▌     | 7511/16384 [00:01<00:01, 6230.59probe position/s]Normalizing amplitudes:  50%|████▉     | 8184/16384 [00:01<00:01, 6379.47probe position/s]Normalizing amplitudes:  54%|█████▍    | 8833/16384 [00:01<00:01, 6410.76probe position/s]Normalizing amplitudes:  58%|█████▊    | 9475/16384 [00:01<00:01, 6379.75probe position/s]Normalizing amplitudes:  62%|██████▏   | 10117/16384 [00:01<00:00, 6390.05probe position/s]Normalizing amplitudes:  66%|██████▌   | 10757/16384 [00:01<00:00, 6359.92probe position/s]Normalizing amplitudes:  70%|██████▉   | 11394/16384 [00:01<00:00, 6140.88probe position/s]Normalizing amplitudes:  73%|███████▎  | 12035/16384 [00:01<00:00, 6218.12probe position/s]Normalizing amplitudes:  77%|███████▋  | 12667/16384 [00:02<00:00, 6245.31probe position/s]Normalizing amplitudes:  81%|████████▏ | 13318/16384 [00:02<00:00, 6321.91probe position/s]Normalizing amplitudes:  85%|████████▌ | 13956/16384 [00:02<00:00, 6337.07probe position/s]Normalizing amplitudes:  89%|████████▉ | 14591/16384 [00:02<00:00, 5920.22probe position/s]Normalizing amplitudes:  93%|█████████▎| 15221/16384 [00:02<00:00, 6026.81probe position/s]Normalizing amplitudes:  97%|█████████▋| 15834/16384 [00:02<00:00, 6054.47probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6192.35probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random64_p3_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random64_p3_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.01073 in 3.853 sec
Iter: 2, Total Loss: 0.00645 in 3.761 sec
Iter: 3, Total Loss: 0.006366 in 3.758 sec
Iter: 4, Total Loss: 0.006292 in 3.870 sec
Iter: 5, Total Loss: 0.006215 in 3.787 sec
Iter: 6, Total Loss: 0.006137 in 4.058 sec
Iter: 7, Total Loss: 0.006065 in 3.777 sec
Iter: 8, Total Loss: 0.005996 in 3.739 sec
Iter: 9, Total Loss: 0.005933 in 3.730 sec
Iter: 10, Total Loss: 0.005873 in 3.775 sec
Iter: 11, Total Loss: 0.005817 in 3.822 sec
Iter: 12, Total Loss: 0.005765 in 3.808 sec
Iter: 13, Total Loss: 0.005714 in 3.874 sec
Iter: 14, Total Loss: 0.005668 in 3.878 sec
Iter: 15, Total Loss: 0.005626 in 3.766 sec
Iter: 16, Total Loss: 0.005588 in 3.838 sec
Iter: 17, Total Loss: 0.005554 in 3.756 sec
Iter: 18, Total Loss: 0.005524 in 3.844 sec
Iter: 19, Total Loss: 0.005498 in 3.833 sec
Iter: 20, Total Loss: 0.005475 in 3.865 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 3.820 with std = 0.072 sec ###
### py4DSTEM ptycho solver is finished in 1 min 19.281 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 916.43 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 64, 3, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 601/16384 [00:00<00:02, 6007.01probe position/s]Normalizing amplitudes:   7%|▋         | 1225/16384 [00:00<00:02, 6143.40probe position/s]Normalizing amplitudes:  11%|█▏        | 1857/16384 [00:00<00:02, 6220.79probe position/s]Normalizing amplitudes:  15%|█▌        | 2480/16384 [00:00<00:02, 6214.52probe position/s]Normalizing amplitudes:  19%|█▉        | 3116/16384 [00:00<00:02, 6264.92probe position/s]Normalizing amplitudes:  23%|██▎       | 3770/16384 [00:00<00:01, 6357.88probe position/s]Normalizing amplitudes:  27%|██▋       | 4427/16384 [00:00<00:01, 6426.59probe position/s]Normalizing amplitudes:  31%|███       | 5070/16384 [00:00<00:01, 6232.29probe position/s]Normalizing amplitudes:  35%|███▍      | 5709/16384 [00:00<00:01, 6277.98probe position/s]Normalizing amplitudes:  39%|███▊      | 6338/16384 [00:01<00:01, 6181.54probe position/s]Normalizing amplitudes:  42%|████▏     | 6957/16384 [00:01<00:01, 6079.29probe position/s]Normalizing amplitudes:  46%|████▌     | 7566/16384 [00:01<00:01, 6029.99probe position/s]Normalizing amplitudes:  50%|████▉     | 8185/16384 [00:01<00:01, 6075.86probe position/s]Normalizing amplitudes:  54%|█████▍    | 8834/16384 [00:01<00:01, 6198.05probe position/s]Normalizing amplitudes:  58%|█████▊    | 9469/16384 [00:01<00:01, 6240.69probe position/s]Normalizing amplitudes:  62%|██████▏   | 10106/16384 [00:01<00:00, 6279.19probe position/s]Normalizing amplitudes:  66%|██████▌   | 10760/16384 [00:01<00:00, 6355.98probe position/s]Normalizing amplitudes:  70%|██████▉   | 11396/16384 [00:01<00:00, 6283.08probe position/s]Normalizing amplitudes:  73%|███████▎  | 12025/16384 [00:01<00:00, 6109.27probe position/s]Normalizing amplitudes:  77%|███████▋  | 12656/16384 [00:02<00:00, 6166.85probe position/s]Normalizing amplitudes:  81%|████████  | 13298/16384 [00:02<00:00, 6240.49probe position/s]Normalizing amplitudes:  85%|████████▍ | 13923/16384 [00:02<00:00, 6240.26probe position/s]Normalizing amplitudes:  89%|████████▉ | 14548/16384 [00:02<00:00, 6130.84probe position/s]Normalizing amplitudes:  93%|█████████▎| 15162/16384 [00:02<00:00, 6100.12probe position/s]Normalizing amplitudes:  96%|█████████▋| 15773/16384 [00:02<00:00, 6035.08probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6189.05probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random64_p3_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random64_p3_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.01095 in 10.170 sec
Iter: 2, Total Loss: 0.006331 in 10.169 sec
Iter: 3, Total Loss: 0.006179 in 10.176 sec
Iter: 4, Total Loss: 0.006052 in 10.114 sec
Iter: 5, Total Loss: 0.005931 in 10.212 sec
Iter: 6, Total Loss: 0.005824 in 10.166 sec
Iter: 7, Total Loss: 0.00573 in 10.171 sec
Iter: 8, Total Loss: 0.005654 in 10.097 sec
Iter: 9, Total Loss: 0.00559 in 10.082 sec
Iter: 10, Total Loss: 0.005537 in 10.010 sec
Iter: 11, Total Loss: 0.00549 in 10.054 sec
Iter: 12, Total Loss: 0.00545 in 9.983 sec
Iter: 13, Total Loss: 0.005413 in 9.912 sec
Iter: 14, Total Loss: 0.005379 in 10.121 sec
Iter: 15, Total Loss: 0.00535 in 10.181 sec
Iter: 16, Total Loss: 0.005321 in 10.149 sec
Iter: 17, Total Loss: 0.005295 in 10.061 sec
Iter: 18, Total Loss: 0.00527 in 10.228 sec
Iter: 19, Total Loss: 0.005246 in 10.416 sec
Iter: 20, Total Loss: 0.005223 in 10.379 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 10.143 with std = 0.115 sec ###
### py4DSTEM ptycho solver is finished in 3 min 25.799 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 928.05 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 64, 3, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 659/16384 [00:00<00:02, 6585.17probe position/s]Normalizing amplitudes:   8%|▊         | 1353/16384 [00:00<00:02, 6790.94probe position/s]Normalizing amplitudes:  12%|█▏        | 2033/16384 [00:00<00:02, 6689.97probe position/s]Normalizing amplitudes:  16%|█▋        | 2703/16384 [00:00<00:02, 6601.80probe position/s]Normalizing amplitudes:  21%|██        | 3364/16384 [00:00<00:01, 6514.70probe position/s]Normalizing amplitudes:  25%|██▍       | 4036/16384 [00:00<00:01, 6582.04probe position/s]Normalizing amplitudes:  29%|██▉       | 4722/16384 [00:00<00:01, 6670.70probe position/s]Normalizing amplitudes:  33%|███▎      | 5390/16384 [00:00<00:01, 6646.18probe position/s]Normalizing amplitudes:  37%|███▋      | 6062/16384 [00:00<00:01, 6668.40probe position/s]Normalizing amplitudes:  41%|████      | 6729/16384 [00:01<00:01, 6645.39probe position/s]Normalizing amplitudes:  45%|████▌     | 7409/16384 [00:01<00:01, 6691.63probe position/s]Normalizing amplitudes:  49%|████▉     | 8079/16384 [00:01<00:01, 6659.62probe position/s]Normalizing amplitudes:  53%|█████▎    | 8746/16384 [00:01<00:01, 6605.46probe position/s]Normalizing amplitudes:  57%|█████▋    | 9407/16384 [00:01<00:01, 6586.93probe position/s]Normalizing amplitudes:  61%|██████▏   | 10071/16384 [00:01<00:00, 6602.29probe position/s]Normalizing amplitudes:  66%|██████▌   | 10777/16384 [00:01<00:00, 6737.28probe position/s]Normalizing amplitudes:  70%|██████▉   | 11451/16384 [00:01<00:00, 6673.17probe position/s]Normalizing amplitudes:  74%|███████▍  | 12119/16384 [00:01<00:00, 6589.67probe position/s]Normalizing amplitudes:  78%|███████▊  | 12779/16384 [00:01<00:00, 6563.91probe position/s]Normalizing amplitudes:  82%|████████▏ | 13436/16384 [00:02<00:00, 6564.29probe position/s]Normalizing amplitudes:  86%|████████▌ | 14105/16384 [00:02<00:00, 6600.76probe position/s]Normalizing amplitudes:  90%|█████████ | 14766/16384 [00:02<00:00, 6576.06probe position/s]Normalizing amplitudes:  94%|█████████▍| 15424/16384 [00:02<00:00, 6555.30probe position/s]Normalizing amplitudes:  98%|█████████▊| 16126/16384 [00:02<00:00, 6691.25probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6630.46probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random64_p3_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random64_p3_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.01157 in 19.138 sec
Iter: 2, Total Loss: 0.006278 in 19.060 sec
Iter: 3, Total Loss: 0.006114 in 18.913 sec
Iter: 4, Total Loss: 0.005983 in 19.069 sec
Iter: 5, Total Loss: 0.005868 in 19.192 sec
Iter: 6, Total Loss: 0.005768 in 19.669 sec
Iter: 7, Total Loss: 0.005683 in 20.217 sec
Iter: 8, Total Loss: 0.005609 in 19.764 sec
Iter: 9, Total Loss: 0.005547 in 19.698 sec
Iter: 10, Total Loss: 0.005494 in 19.863 sec
Iter: 11, Total Loss: 0.00545 in 19.634 sec
Iter: 12, Total Loss: 0.005412 in 19.719 sec
Iter: 13, Total Loss: 0.005378 in 19.699 sec
Iter: 14, Total Loss: 0.005348 in 19.844 sec
Iter: 15, Total Loss: 0.005321 in 19.692 sec
Iter: 16, Total Loss: 0.005297 in 19.741 sec
Iter: 17, Total Loss: 0.005275 in 19.635 sec
Iter: 18, Total Loss: 0.005253 in 19.643 sec
Iter: 19, Total Loss: 0.005233 in 19.745 sec
Iter: 20, Total Loss: 0.005214 in 19.790 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 19.586 with std = 0.323 sec ###
### py4DSTEM ptycho solver is finished in 6 min 34.726 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 913.10 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 64, 6, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 597/16384 [00:00<00:02, 5964.12probe position/s]Normalizing amplitudes:   7%|▋         | 1194/16384 [00:00<00:02, 5868.83probe position/s]Normalizing amplitudes:  11%|█         | 1828/16384 [00:00<00:02, 6078.87probe position/s]Normalizing amplitudes:  15%|█▌        | 2499/16384 [00:00<00:02, 6325.94probe position/s]Normalizing amplitudes:  19%|█▉        | 3147/16384 [00:00<00:02, 6378.64probe position/s]Normalizing amplitudes:  23%|██▎       | 3786/16384 [00:00<00:02, 6256.37probe position/s]Normalizing amplitudes:  27%|██▋       | 4413/16384 [00:00<00:01, 6127.49probe position/s]Normalizing amplitudes:  31%|███       | 5027/16384 [00:00<00:01, 5980.06probe position/s]Normalizing amplitudes:  34%|███▍      | 5626/16384 [00:00<00:01, 5937.67probe position/s]Normalizing amplitudes:  38%|███▊      | 6269/16384 [00:01<00:01, 6083.38probe position/s]Normalizing amplitudes:  42%|████▏     | 6879/16384 [00:01<00:01, 5879.37probe position/s]Normalizing amplitudes:  46%|████▌     | 7469/16384 [00:01<00:01, 5839.91probe position/s]Normalizing amplitudes:  49%|████▉     | 8055/16384 [00:01<00:01, 5779.31probe position/s]Normalizing amplitudes:  53%|█████▎    | 8702/16384 [00:01<00:01, 5980.59probe position/s]Normalizing amplitudes:  57%|█████▋    | 9333/16384 [00:01<00:01, 6077.35probe position/s]Normalizing amplitudes:  61%|██████    | 9947/16384 [00:01<00:01, 6094.97probe position/s]Normalizing amplitudes:  65%|██████▍   | 10578/16384 [00:01<00:00, 6155.98probe position/s]Normalizing amplitudes:  68%|██████▊   | 11211/16384 [00:01<00:00, 6204.91probe position/s]Normalizing amplitudes:  72%|███████▏  | 11832/16384 [00:01<00:00, 5981.03probe position/s]Normalizing amplitudes:  76%|███████▌  | 12433/16384 [00:02<00:00, 5958.28probe position/s]Normalizing amplitudes:  80%|███████▉  | 13072/16384 [00:02<00:00, 6083.65probe position/s]Normalizing amplitudes:  84%|████████▎ | 13682/16384 [00:02<00:00, 6005.09probe position/s]Normalizing amplitudes:  87%|████████▋ | 14284/16384 [00:02<00:00, 5985.86probe position/s]Normalizing amplitudes:  91%|█████████ | 14924/16384 [00:02<00:00, 6106.69probe position/s]Normalizing amplitudes:  95%|█████████▌| 15575/16384 [00:02<00:00, 6225.61probe position/s]Normalizing amplitudes:  99%|█████████▉| 16200/16384 [00:02<00:00, 6231.90probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6073.59probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random64_p6_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random64_p6_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.01944 in 7.147 sec
Iter: 2, Total Loss: 0.006475 in 7.033 sec
Iter: 3, Total Loss: 0.006327 in 7.019 sec
Iter: 4, Total Loss: 0.006226 in 7.013 sec
Iter: 5, Total Loss: 0.006137 in 7.033 sec
Iter: 6, Total Loss: 0.006053 in 6.858 sec
Iter: 7, Total Loss: 0.005969 in 6.952 sec
Iter: 8, Total Loss: 0.00589 in 6.911 sec
Iter: 9, Total Loss: 0.005815 in 6.943 sec
Iter: 10, Total Loss: 0.005745 in 6.899 sec
Iter: 11, Total Loss: 0.005681 in 7.056 sec
Iter: 12, Total Loss: 0.005623 in 6.947 sec
Iter: 13, Total Loss: 0.00557 in 6.939 sec
Iter: 14, Total Loss: 0.005523 in 7.105 sec
Iter: 15, Total Loss: 0.005479 in 6.937 sec
Iter: 16, Total Loss: 0.00544 in 7.053 sec
Iter: 17, Total Loss: 0.005403 in 7.045 sec
Iter: 18, Total Loss: 0.005367 in 7.121 sec
Iter: 19, Total Loss: 0.005332 in 7.083 sec
Iter: 20, Total Loss: 0.005296 in 7.042 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 7.007 with std = 0.077 sec ###
### py4DSTEM ptycho solver is finished in 2 min 23.041 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 912.98 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 64, 6, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 638/16384 [00:00<00:02, 6379.58probe position/s]Normalizing amplitudes:   8%|▊         | 1276/16384 [00:00<00:02, 6305.46probe position/s]Normalizing amplitudes:  12%|█▏        | 1907/16384 [00:00<00:02, 6032.71probe position/s]Normalizing amplitudes:  15%|█▌        | 2512/16384 [00:00<00:02, 6024.02probe position/s]Normalizing amplitudes:  19%|█▉        | 3153/16384 [00:00<00:02, 6157.95probe position/s]Normalizing amplitudes:  23%|██▎       | 3794/16384 [00:00<00:02, 6239.55probe position/s]Normalizing amplitudes:  27%|██▋       | 4419/16384 [00:00<00:02, 5701.47probe position/s]Normalizing amplitudes:  31%|███       | 5040/16384 [00:00<00:01, 5850.05probe position/s]Normalizing amplitudes:  35%|███▍      | 5674/16384 [00:00<00:01, 5993.82probe position/s]Normalizing amplitudes:  38%|███▊      | 6279/16384 [00:01<00:01, 5972.89probe position/s]Normalizing amplitudes:  42%|████▏     | 6880/16384 [00:01<00:01, 5981.44probe position/s]Normalizing amplitudes:  46%|████▌     | 7489/16384 [00:01<00:01, 6012.98probe position/s]Normalizing amplitudes:  49%|████▉     | 8093/16384 [00:01<00:01, 5882.05probe position/s]Normalizing amplitudes:  53%|█████▎    | 8713/16384 [00:01<00:01, 5974.39probe position/s]Normalizing amplitudes:  57%|█████▋    | 9352/16384 [00:01<00:01, 6095.09probe position/s]Normalizing amplitudes:  61%|██████    | 9982/16384 [00:01<00:01, 6155.55probe position/s]Normalizing amplitudes:  65%|██████▍   | 10636/16384 [00:01<00:00, 6268.29probe position/s]Normalizing amplitudes:  69%|██████▉   | 11264/16384 [00:01<00:00, 6222.82probe position/s]Normalizing amplitudes:  73%|███████▎  | 11887/16384 [00:01<00:00, 6198.00probe position/s]Normalizing amplitudes:  77%|███████▋  | 12540/16384 [00:02<00:00, 6294.29probe position/s]Normalizing amplitudes:  80%|████████  | 13188/16384 [00:02<00:00, 6348.47probe position/s]Normalizing amplitudes:  84%|████████▍ | 13841/16384 [00:02<00:00, 6401.77probe position/s]Normalizing amplitudes:  88%|████████▊ | 14483/16384 [00:02<00:00, 6405.92probe position/s]Normalizing amplitudes:  92%|█████████▏| 15124/16384 [00:02<00:00, 6398.41probe position/s]Normalizing amplitudes:  96%|█████████▌| 15765/16384 [00:02<00:00, 6397.69probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6166.50probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random64_p6_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random64_p6_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.02004 in 19.808 sec
Iter: 2, Total Loss: 0.006364 in 19.850 sec
Iter: 3, Total Loss: 0.00611 in 19.573 sec
Iter: 4, Total Loss: 0.005952 in 19.603 sec
Iter: 5, Total Loss: 0.005817 in 19.529 sec
Iter: 6, Total Loss: 0.005697 in 19.470 sec
Iter: 7, Total Loss: 0.005596 in 19.327 sec
Iter: 8, Total Loss: 0.005507 in 19.182 sec
Iter: 9, Total Loss: 0.005429 in 18.972 sec
Iter: 10, Total Loss: 0.00536 in 19.144 sec
Iter: 11, Total Loss: 0.005297 in 19.301 sec
Iter: 12, Total Loss: 0.00524 in 19.415 sec
Iter: 13, Total Loss: 0.005186 in 19.164 sec
Iter: 14, Total Loss: 0.005135 in 19.460 sec
Iter: 15, Total Loss: 0.005087 in 19.345 sec
Iter: 16, Total Loss: 0.005041 in 19.339 sec
Iter: 17, Total Loss: 0.004998 in 19.534 sec
Iter: 18, Total Loss: 0.004958 in 19.545 sec
Iter: 19, Total Loss: 0.004922 in 19.504 sec
Iter: 20, Total Loss: 0.00489 in 19.657 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 19.436 with std = 0.215 sec ###
### py4DSTEM ptycho solver is finished in 6 min 31.724 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 913.14 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 64, 6, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 610/16384 [00:00<00:02, 6089.60probe position/s]Normalizing amplitudes:   7%|▋         | 1219/16384 [00:00<00:02, 6004.04probe position/s]Normalizing amplitudes:  11%|█▏        | 1854/16384 [00:00<00:02, 6157.57probe position/s]Normalizing amplitudes:  15%|█▌        | 2512/16384 [00:00<00:02, 6319.61probe position/s]Normalizing amplitudes:  19%|█▉        | 3168/16384 [00:00<00:02, 6405.24probe position/s]Normalizing amplitudes:  23%|██▎       | 3809/16384 [00:00<00:01, 6352.50probe position/s]Normalizing amplitudes:  27%|██▋       | 4445/16384 [00:00<00:01, 6320.29probe position/s]Normalizing amplitudes:  31%|███       | 5078/16384 [00:00<00:01, 6316.23probe position/s]Normalizing amplitudes:  35%|███▍      | 5710/16384 [00:00<00:01, 6129.71probe position/s]Normalizing amplitudes:  39%|███▊      | 6325/16384 [00:01<00:01, 5682.39probe position/s]Normalizing amplitudes:  42%|████▏     | 6955/16384 [00:01<00:01, 5856.37probe position/s]Normalizing amplitudes:  46%|████▌     | 7547/16384 [00:01<00:01, 5811.84probe position/s]Normalizing amplitudes:  50%|████▉     | 8142/16384 [00:01<00:01, 5850.11probe position/s]Normalizing amplitudes:  54%|█████▎    | 8775/16384 [00:01<00:01, 5989.22probe position/s]Normalizing amplitudes:  57%|█████▋    | 9407/16384 [00:01<00:01, 6086.26probe position/s]Normalizing amplitudes:  61%|██████    | 10018/16384 [00:01<00:01, 6082.26probe position/s]Normalizing amplitudes:  65%|██████▌   | 10675/16384 [00:01<00:00, 6226.28probe position/s]Normalizing amplitudes:  69%|██████▉   | 11322/16384 [00:01<00:00, 6297.60probe position/s]Normalizing amplitudes:  73%|███████▎  | 11976/16384 [00:01<00:00, 6367.79probe position/s]Normalizing amplitudes:  77%|███████▋  | 12629/16384 [00:02<00:00, 6414.19probe position/s]Normalizing amplitudes:  81%|████████  | 13271/16384 [00:02<00:00, 6398.69probe position/s]Normalizing amplitudes:  85%|████████▍ | 13912/16384 [00:02<00:00, 6375.59probe position/s]Normalizing amplitudes:  89%|████████▉ | 14550/16384 [00:02<00:00, 6360.91probe position/s]Normalizing amplitudes:  93%|█████████▎| 15187/16384 [00:02<00:00, 6339.91probe position/s]Normalizing amplitudes:  97%|█████████▋| 15822/16384 [00:02<00:00, 6315.34probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6198.57probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random64_p6_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random64_p6_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.02055 in 38.304 sec
Iter: 2, Total Loss: 0.006282 in 38.402 sec
Iter: 3, Total Loss: 0.006041 in 38.070 sec
Iter: 4, Total Loss: 0.005871 in 38.144 sec
Iter: 5, Total Loss: 0.005721 in 38.242 sec
Iter: 6, Total Loss: 0.005595 in 38.468 sec
Iter: 7, Total Loss: 0.005486 in 38.457 sec
Iter: 8, Total Loss: 0.005395 in 38.548 sec
Iter: 9, Total Loss: 0.005316 in 38.424 sec
Iter: 10, Total Loss: 0.00525 in 38.229 sec
Iter: 11, Total Loss: 0.005193 in 38.779 sec
Iter: 12, Total Loss: 0.005141 in 38.391 sec
Iter: 13, Total Loss: 0.005093 in 38.558 sec
Iter: 14, Total Loss: 0.005047 in 38.128 sec
Iter: 15, Total Loss: 0.005004 in 38.145 sec
Iter: 16, Total Loss: 0.004963 in 37.489 sec
Iter: 17, Total Loss: 0.004925 in 37.595 sec
Iter: 18, Total Loss: 0.004888 in 37.647 sec
Iter: 19, Total Loss: 0.004856 in 38.513 sec
Iter: 20, Total Loss: 0.004825 in 38.525 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 38.253 with std = 0.333 sec ###
### py4DSTEM ptycho solver is finished in 12 min 48.196 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 916.23 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 64, 12, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 654/16384 [00:00<00:02, 6532.27probe position/s]Normalizing amplitudes:   8%|▊         | 1308/16384 [00:00<00:02, 6438.83probe position/s]Normalizing amplitudes:  12%|█▏        | 1952/16384 [00:00<00:02, 6341.49probe position/s]Normalizing amplitudes:  16%|█▌        | 2591/16384 [00:00<00:02, 6356.49probe position/s]Normalizing amplitudes:  20%|█▉        | 3239/16384 [00:00<00:02, 6397.85probe position/s]Normalizing amplitudes:  24%|██▎       | 3879/16384 [00:00<00:01, 6353.05probe position/s]Normalizing amplitudes:  28%|██▊       | 4521/16384 [00:00<00:01, 6372.79probe position/s]Normalizing amplitudes:  32%|███▏      | 5168/16384 [00:00<00:01, 6402.56probe position/s]Normalizing amplitudes:  35%|███▌      | 5809/16384 [00:00<00:01, 6333.00probe position/s]Normalizing amplitudes:  39%|███▉      | 6443/16384 [00:01<00:01, 6149.21probe position/s]Normalizing amplitudes:  43%|████▎     | 7065/16384 [00:01<00:01, 6169.51probe position/s]Normalizing amplitudes:  47%|████▋     | 7696/16384 [00:01<00:01, 6210.35probe position/s]Normalizing amplitudes:  51%|█████     | 8318/16384 [00:01<00:01, 6177.16probe position/s]Normalizing amplitudes:  55%|█████▍    | 8958/16384 [00:01<00:01, 6241.49probe position/s]Normalizing amplitudes:  59%|█████▊    | 9617/16384 [00:01<00:01, 6342.52probe position/s]Normalizing amplitudes:  63%|██████▎   | 10252/16384 [00:01<00:00, 6327.91probe position/s]Normalizing amplitudes:  66%|██████▋   | 10886/16384 [00:01<00:00, 6291.06probe position/s]Normalizing amplitudes:  70%|███████   | 11516/16384 [00:01<00:00, 6273.93probe position/s]Normalizing amplitudes:  74%|███████▍  | 12152/16384 [00:01<00:00, 6298.68probe position/s]Normalizing amplitudes:  78%|███████▊  | 12782/16384 [00:02<00:00, 6282.26probe position/s]Normalizing amplitudes:  82%|████████▏ | 13456/16384 [00:02<00:00, 6416.03probe position/s]Normalizing amplitudes:  86%|████████▌ | 14098/16384 [00:02<00:00, 6320.22probe position/s]Normalizing amplitudes:  90%|█████████ | 14751/16384 [00:02<00:00, 6380.05probe position/s]Normalizing amplitudes:  94%|█████████▍| 15390/16384 [00:02<00:00, 6322.03probe position/s]Normalizing amplitudes:  98%|█████████▊| 16034/16384 [00:02<00:00, 6355.79probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6323.08probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random64_p12_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random64_p12_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.04074 in 13.492 sec
Iter: 2, Total Loss: 0.006459 in 13.357 sec
Iter: 3, Total Loss: 0.006291 in 13.426 sec
Iter: 4, Total Loss: 0.006169 in 13.349 sec
Iter: 5, Total Loss: 0.006055 in 13.270 sec
Iter: 6, Total Loss: 0.005946 in 13.269 sec
Iter: 7, Total Loss: 0.005846 in 13.245 sec
Iter: 8, Total Loss: 0.005756 in 13.010 sec
Iter: 9, Total Loss: 0.005677 in 12.955 sec
Iter: 10, Total Loss: 0.005608 in 12.947 sec
Iter: 11, Total Loss: 0.005547 in 12.944 sec
Iter: 12, Total Loss: 0.00549 in 13.112 sec
Iter: 13, Total Loss: 0.005436 in 12.914 sec
Iter: 14, Total Loss: 0.005384 in 12.939 sec
Iter: 15, Total Loss: 0.005334 in 12.918 sec
Iter: 16, Total Loss: 0.005286 in 13.023 sec
Iter: 17, Total Loss: 0.005239 in 12.953 sec
Iter: 18, Total Loss: 0.005191 in 12.938 sec
Iter: 19, Total Loss: 0.005144 in 12.902 sec
Iter: 20, Total Loss: 0.005098 in 12.812 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 13.089 with std = 0.201 sec ###
### py4DSTEM ptycho solver is finished in 4 min 24.611 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 933.55 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 64, 12, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 649/16384 [00:00<00:02, 6487.66probe position/s]Normalizing amplitudes:   8%|▊         | 1298/16384 [00:00<00:02, 6451.55probe position/s]Normalizing amplitudes:  12%|█▏        | 1944/16384 [00:00<00:02, 6078.62probe position/s]Normalizing amplitudes:  16%|█▌        | 2612/16384 [00:00<00:02, 6305.31probe position/s]Normalizing amplitudes:  20%|█▉        | 3259/16384 [00:00<00:02, 6362.04probe position/s]Normalizing amplitudes:  24%|██▍       | 3922/16384 [00:00<00:01, 6448.85probe position/s]Normalizing amplitudes:  28%|██▊       | 4577/16384 [00:00<00:01, 6480.47probe position/s]Normalizing amplitudes:  32%|███▏      | 5226/16384 [00:00<00:01, 6454.49probe position/s]Normalizing amplitudes:  36%|███▌      | 5873/16384 [00:00<00:01, 6417.38probe position/s]Normalizing amplitudes:  40%|███▉      | 6516/16384 [00:01<00:01, 6405.56probe position/s]Normalizing amplitudes:  44%|████▍     | 7180/16384 [00:01<00:01, 6476.09probe position/s]Normalizing amplitudes:  48%|████▊     | 7862/16384 [00:01<00:01, 6577.34probe position/s]Normalizing amplitudes:  52%|█████▏    | 8532/16384 [00:01<00:01, 6613.14probe position/s]Normalizing amplitudes:  56%|█████▋    | 9219/16384 [00:01<00:01, 6688.67probe position/s]Normalizing amplitudes:  60%|██████    | 9889/16384 [00:01<00:00, 6573.06probe position/s]Normalizing amplitudes:  64%|██████▍   | 10547/16384 [00:01<00:00, 6386.55probe position/s]Normalizing amplitudes:  68%|██████▊   | 11187/16384 [00:01<00:00, 6384.27probe position/s]Normalizing amplitudes:  72%|███████▏  | 11827/16384 [00:01<00:00, 6383.43probe position/s]Normalizing amplitudes:  76%|███████▋  | 12508/16384 [00:01<00:00, 6507.86probe position/s]Normalizing amplitudes:  80%|████████  | 13177/16384 [00:02<00:00, 6561.50probe position/s]Normalizing amplitudes:  85%|████████▍ | 13875/16384 [00:02<00:00, 6685.53probe position/s]Normalizing amplitudes:  89%|████████▉ | 14545/16384 [00:02<00:00, 6603.91probe position/s]Normalizing amplitudes:  93%|█████████▎| 15206/16384 [00:02<00:00, 6508.08probe position/s]Normalizing amplitudes:  97%|█████████▋| 15872/16384 [00:02<00:00, 6550.75probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6488.14probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random64_p12_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random64_p12_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.04156 in 37.716 sec
Iter: 2, Total Loss: 0.006416 in 38.003 sec
Iter: 3, Total Loss: 0.006127 in 38.039 sec
Iter: 4, Total Loss: 0.005959 in 38.257 sec
Iter: 5, Total Loss: 0.005812 in 38.506 sec
Iter: 6, Total Loss: 0.005682 in 38.397 sec
Iter: 7, Total Loss: 0.005571 in 38.945 sec
Iter: 8, Total Loss: 0.005476 in 38.962 sec
Iter: 9, Total Loss: 0.005396 in 38.305 sec
Iter: 10, Total Loss: 0.005325 in 38.082 sec
Iter: 11, Total Loss: 0.005261 in 38.268 sec
Iter: 12, Total Loss: 0.005201 in 37.957 sec
Iter: 13, Total Loss: 0.005146 in 38.686 sec
Iter: 14, Total Loss: 0.005094 in 38.415 sec
Iter: 15, Total Loss: 0.005043 in 38.452 sec
Iter: 16, Total Loss: 0.004994 in 38.341 sec
Iter: 17, Total Loss: 0.004947 in 39.167 sec
Iter: 18, Total Loss: 0.004903 in 38.735 sec
Iter: 19, Total Loss: 0.004862 in 38.793 sec
Iter: 20, Total Loss: 0.004824 in 38.632 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 38.433 with std = 0.367 sec ###
### py4DSTEM ptycho solver is finished in 12 min 51.762 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 915.50 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 64, 12, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 622/16384 [00:00<00:02, 6212.07probe position/s]Normalizing amplitudes:   8%|▊         | 1244/16384 [00:00<00:02, 6146.52probe position/s]Normalizing amplitudes:  12%|█▏        | 1909/16384 [00:00<00:02, 6374.60probe position/s]Normalizing amplitudes:  16%|█▌        | 2575/16384 [00:00<00:02, 6483.41probe position/s]Normalizing amplitudes:  20%|█▉        | 3224/16384 [00:00<00:02, 6430.64probe position/s]Normalizing amplitudes:  24%|██▎       | 3868/16384 [00:00<00:01, 6345.31probe position/s]Normalizing amplitudes:  27%|██▋       | 4504/16384 [00:00<00:01, 6347.75probe position/s]Normalizing amplitudes:  31%|███▏      | 5139/16384 [00:00<00:01, 6283.16probe position/s]Normalizing amplitudes:  35%|███▌      | 5768/16384 [00:00<00:01, 6100.47probe position/s]Normalizing amplitudes:  39%|███▉      | 6380/16384 [00:01<00:01, 6104.46probe position/s]Normalizing amplitudes:  43%|████▎     | 7004/16384 [00:01<00:01, 6144.68probe position/s]Normalizing amplitudes:  47%|████▋     | 7620/16384 [00:01<00:01, 6008.19probe position/s]Normalizing amplitudes:  50%|█████     | 8222/16384 [00:01<00:01, 5943.44probe position/s]Normalizing amplitudes:  54%|█████▍    | 8817/16384 [00:01<00:01, 5826.58probe position/s]Normalizing amplitudes:  57%|█████▋    | 9401/16384 [00:01<00:01, 5752.10probe position/s]Normalizing amplitudes:  61%|██████    | 9998/16384 [00:01<00:01, 5813.24probe position/s]Normalizing amplitudes:  65%|██████▍   | 10612/16384 [00:01<00:00, 5907.27probe position/s]Normalizing amplitudes:  68%|██████▊   | 11207/16384 [00:01<00:00, 5918.98probe position/s]Normalizing amplitudes:  72%|███████▏  | 11853/16384 [00:01<00:00, 6077.37probe position/s]Normalizing amplitudes:  76%|███████▌  | 12480/16384 [00:02<00:00, 6133.06probe position/s]Normalizing amplitudes:  80%|███████▉  | 13094/16384 [00:02<00:00, 6110.72probe position/s]Normalizing amplitudes:  84%|████████▎ | 13706/16384 [00:02<00:00, 6090.63probe position/s]Normalizing amplitudes:  87%|████████▋ | 14329/16384 [00:02<00:00, 6131.63probe position/s]Normalizing amplitudes:  91%|█████████▏| 14979/16384 [00:02<00:00, 6241.38probe position/s]Normalizing amplitudes:  95%|█████████▌| 15627/16384 [00:02<00:00, 6310.17probe position/s]Normalizing amplitudes:  99%|█████████▉| 16259/16384 [00:02<00:00, 6256.73probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6134.14probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random64_p12_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 64, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random64_p12_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 64 measurements.
Iter: 1, Total Loss: 0.04273 in 77.325 sec
Iter: 2, Total Loss: 0.006342 in 76.456 sec
Iter: 3, Total Loss: 0.005936 in 75.114 sec
Iter: 4, Total Loss: 0.005739 in 75.343 sec
Iter: 5, Total Loss: 0.005588 in 76.749 sec
Iter: 6, Total Loss: 0.005467 in 76.200 sec
Iter: 7, Total Loss: 0.005368 in 76.858 sec
Iter: 8, Total Loss: 0.005286 in 76.610 sec
Iter: 9, Total Loss: 0.005213 in 76.564 sec
Iter: 10, Total Loss: 0.005146 in 76.221 sec
Iter: 11, Total Loss: 0.005083 in 76.415 sec
Iter: 12, Total Loss: 0.005023 in 76.862 sec
Iter: 13, Total Loss: 0.004965 in 77.164 sec
Iter: 14, Total Loss: 0.004911 in 74.387 sec
Iter: 15, Total Loss: 0.004859 in 73.128 sec
Iter: 16, Total Loss: 0.004811 in 74.898 sec
Iter: 17, Total Loss: 0.004768 in 76.165 sec
Iter: 18, Total Loss: 0.004732 in 75.777 sec
Iter: 19, Total Loss: 0.004701 in 75.650 sec
Iter: 20, Total Loss: 0.004673 in 75.482 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 75.968 with std = 1.001 sec ###
### py4DSTEM ptycho solver is finished in 25 min 22.429 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 925.32 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 32, 1, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 640/16384 [00:00<00:02, 6394.27probe position/s]Normalizing amplitudes:   8%|▊         | 1280/16384 [00:00<00:02, 6327.29probe position/s]Normalizing amplitudes:  12%|█▏        | 1922/16384 [00:00<00:02, 6369.08probe position/s]Normalizing amplitudes:  16%|█▌        | 2566/16384 [00:00<00:02, 6394.39probe position/s]Normalizing amplitudes:  20%|█▉        | 3249/16384 [00:00<00:02, 6550.77probe position/s]Normalizing amplitudes:  24%|██▍       | 3908/16384 [00:00<00:01, 6563.35probe position/s]Normalizing amplitudes:  28%|██▊       | 4565/16384 [00:00<00:01, 6539.67probe position/s]Normalizing amplitudes:  32%|███▏      | 5220/16384 [00:00<00:01, 6483.00probe position/s]Normalizing amplitudes:  36%|███▌      | 5892/16384 [00:00<00:01, 6554.29probe position/s]Normalizing amplitudes:  40%|████      | 6578/16384 [00:01<00:01, 6647.50probe position/s]Normalizing amplitudes:  44%|████▍     | 7243/16384 [00:01<00:01, 6553.63probe position/s]Normalizing amplitudes:  48%|████▊     | 7899/16384 [00:01<00:01, 6545.32probe position/s]Normalizing amplitudes:  52%|█████▏    | 8570/16384 [00:01<00:01, 6592.67probe position/s]Normalizing amplitudes:  56%|█████▋    | 9250/16384 [00:01<00:01, 6654.02probe position/s]Normalizing amplitudes:  61%|██████    | 9931/16384 [00:01<00:00, 6697.96probe position/s]Normalizing amplitudes:  65%|██████▍   | 10601/16384 [00:01<00:00, 6478.53probe position/s]Normalizing amplitudes:  69%|██████▊   | 11251/16384 [00:01<00:00, 6420.98probe position/s]Normalizing amplitudes:  73%|███████▎  | 11895/16384 [00:01<00:00, 6394.64probe position/s]Normalizing amplitudes:  77%|███████▋  | 12553/16384 [00:01<00:00, 6447.70probe position/s]Normalizing amplitudes:  81%|████████  | 13222/16384 [00:02<00:00, 6517.93probe position/s]Normalizing amplitudes:  85%|████████▍ | 13875/16384 [00:02<00:00, 6507.49probe position/s]Normalizing amplitudes:  89%|████████▉ | 14545/16384 [00:02<00:00, 6562.17probe position/s]Normalizing amplitudes:  93%|█████████▎| 15202/16384 [00:02<00:00, 6560.46probe position/s]Normalizing amplitudes:  97%|█████████▋| 15859/16384 [00:02<00:00, 6547.37probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6529.59probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random32_p1_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random32_p1_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.007086 in 3.407 sec
Iter: 2, Total Loss: 0.006531 in 3.349 sec
Iter: 3, Total Loss: 0.006479 in 3.336 sec
Iter: 4, Total Loss: 0.006426 in 3.382 sec
Iter: 5, Total Loss: 0.006372 in 3.415 sec
Iter: 6, Total Loss: 0.00632 in 3.374 sec
Iter: 7, Total Loss: 0.006276 in 3.355 sec
Iter: 8, Total Loss: 0.006236 in 3.327 sec
Iter: 9, Total Loss: 0.006206 in 3.300 sec
Iter: 10, Total Loss: 0.006179 in 3.240 sec
Iter: 11, Total Loss: 0.006159 in 3.350 sec
Iter: 12, Total Loss: 0.00614 in 3.279 sec
Iter: 13, Total Loss: 0.006125 in 3.410 sec
Iter: 14, Total Loss: 0.006114 in 3.311 sec
Iter: 15, Total Loss: 0.006105 in 3.321 sec
Iter: 16, Total Loss: 0.006097 in 3.357 sec
Iter: 17, Total Loss: 0.00609 in 3.403 sec
Iter: 18, Total Loss: 0.006085 in 3.383 sec
Iter: 19, Total Loss: 0.00608 in 3.367 sec
Iter: 20, Total Loss: 0.006078 in 3.305 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 3.349 with std = 0.046 sec ###
### py4DSTEM ptycho solver is finished in 1 min 9.867 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 922.34 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 32, 1, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 633/16384 [00:00<00:02, 6325.96probe position/s]Normalizing amplitudes:   8%|▊         | 1293/16384 [00:00<00:02, 6481.38probe position/s]Normalizing amplitudes:  12%|█▏        | 1953/16384 [00:00<00:02, 6534.41probe position/s]Normalizing amplitudes:  16%|█▌        | 2607/16384 [00:00<00:02, 6446.93probe position/s]Normalizing amplitudes:  20%|█▉        | 3252/16384 [00:00<00:02, 6079.15probe position/s]Normalizing amplitudes:  24%|██▍       | 3922/16384 [00:00<00:01, 6278.40probe position/s]Normalizing amplitudes:  28%|██▊       | 4553/16384 [00:00<00:01, 6079.25probe position/s]Normalizing amplitudes:  32%|███▏      | 5192/16384 [00:00<00:01, 6171.34probe position/s]Normalizing amplitudes:  36%|███▌      | 5850/16384 [00:00<00:01, 6294.86probe position/s]Normalizing amplitudes:  40%|███▉      | 6517/16384 [00:01<00:01, 6407.42probe position/s]Normalizing amplitudes:  44%|████▎     | 7160/16384 [00:01<00:01, 6391.77probe position/s]Normalizing amplitudes:  48%|████▊     | 7817/16384 [00:01<00:01, 6442.80probe position/s]Normalizing amplitudes:  52%|█████▏    | 8475/16384 [00:01<00:01, 6481.66probe position/s]Normalizing amplitudes:  56%|█████▌    | 9149/16384 [00:01<00:01, 6558.09probe position/s]Normalizing amplitudes:  60%|█████▉    | 9806/16384 [00:01<00:01, 6547.08probe position/s]Normalizing amplitudes:  64%|██████▍   | 10462/16384 [00:01<00:00, 6483.64probe position/s]Normalizing amplitudes:  68%|██████▊   | 11129/16384 [00:01<00:00, 6537.41probe position/s]Normalizing amplitudes:  72%|███████▏  | 11800/16384 [00:01<00:00, 6588.74probe position/s]Normalizing amplitudes:  76%|███████▌  | 12460/16384 [00:01<00:00, 6590.86probe position/s]Normalizing amplitudes:  80%|████████  | 13120/16384 [00:02<00:00, 6574.22probe position/s]Normalizing amplitudes:  84%|████████▍ | 13778/16384 [00:02<00:00, 6566.38probe position/s]Normalizing amplitudes:  88%|████████▊ | 14435/16384 [00:02<00:00, 6541.33probe position/s]Normalizing amplitudes:  92%|█████████▏| 15092/16384 [00:02<00:00, 6548.57probe position/s]Normalizing amplitudes:  96%|█████████▌| 15756/16384 [00:02<00:00, 6574.23probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6461.57probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random32_p1_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random32_p1_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.007127 in 7.977 sec
Iter: 2, Total Loss: 0.006526 in 7.808 sec
Iter: 3, Total Loss: 0.006455 in 7.845 sec
Iter: 4, Total Loss: 0.00639 in 7.920 sec
Iter: 5, Total Loss: 0.006334 in 7.932 sec
Iter: 6, Total Loss: 0.006284 in 8.051 sec
Iter: 7, Total Loss: 0.006242 in 8.054 sec
Iter: 8, Total Loss: 0.006205 in 8.069 sec
Iter: 9, Total Loss: 0.006178 in 8.045 sec
Iter: 10, Total Loss: 0.006153 in 8.011 sec
Iter: 11, Total Loss: 0.006133 in 8.070 sec
Iter: 12, Total Loss: 0.006116 in 8.016 sec
Iter: 13, Total Loss: 0.006103 in 7.993 sec
Iter: 14, Total Loss: 0.00609 in 8.016 sec
Iter: 15, Total Loss: 0.006078 in 8.122 sec
Iter: 16, Total Loss: 0.006069 in 7.989 sec
Iter: 17, Total Loss: 0.006059 in 7.878 sec
Iter: 18, Total Loss: 0.006053 in 7.920 sec
Iter: 19, Total Loss: 0.006045 in 7.887 sec
Iter: 20, Total Loss: 0.00604 in 7.964 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 7.978 with std = 0.081 sec ###
### py4DSTEM ptycho solver is finished in 2 min 42.545 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 916.37 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 32, 1, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 607/16384 [00:00<00:02, 6067.23probe position/s]Normalizing amplitudes:   8%|▊         | 1256/16384 [00:00<00:02, 6314.85probe position/s]Normalizing amplitudes:  12%|█▏        | 1898/16384 [00:00<00:02, 6362.31probe position/s]Normalizing amplitudes:  16%|█▌        | 2568/16384 [00:00<00:02, 6493.68probe position/s]Normalizing amplitudes:  20%|█▉        | 3243/16384 [00:00<00:01, 6584.34probe position/s]Normalizing amplitudes:  24%|██▍       | 3902/16384 [00:00<00:01, 6385.56probe position/s]Normalizing amplitudes:  28%|██▊       | 4542/16384 [00:00<00:01, 6174.57probe position/s]Normalizing amplitudes:  32%|███▏      | 5162/16384 [00:00<00:01, 6112.87probe position/s]Normalizing amplitudes:  36%|███▌      | 5829/16384 [00:00<00:01, 6280.81probe position/s]Normalizing amplitudes:  40%|███▉      | 6525/16384 [00:01<00:01, 6484.23probe position/s]Normalizing amplitudes:  44%|████▍     | 7175/16384 [00:01<00:01, 6405.64probe position/s]Normalizing amplitudes:  48%|████▊     | 7817/16384 [00:01<00:01, 6335.16probe position/s]Normalizing amplitudes:  52%|█████▏    | 8452/16384 [00:01<00:01, 6322.08probe position/s]Normalizing amplitudes:  56%|█████▌    | 9108/16384 [00:01<00:01, 6390.62probe position/s]Normalizing amplitudes:  60%|█████▉    | 9750/16384 [00:01<00:01, 6397.40probe position/s]Normalizing amplitudes:  63%|██████▎   | 10391/16384 [00:01<00:00, 6208.56probe position/s]Normalizing amplitudes:  67%|██████▋   | 11014/16384 [00:01<00:00, 6150.92probe position/s]Normalizing amplitudes:  71%|███████   | 11631/16384 [00:01<00:00, 6154.52probe position/s]Normalizing amplitudes:  75%|███████▍  | 12270/16384 [00:01<00:00, 6222.55probe position/s]Normalizing amplitudes:  79%|███████▉  | 12928/16384 [00:02<00:00, 6326.75probe position/s]Normalizing amplitudes:  83%|████████▎ | 13586/16384 [00:02<00:00, 6400.98probe position/s]Normalizing amplitudes:  87%|████████▋ | 14227/16384 [00:02<00:00, 6361.31probe position/s]Normalizing amplitudes:  91%|█████████ | 14864/16384 [00:02<00:00, 6330.57probe position/s]Normalizing amplitudes:  95%|█████████▍| 15498/16384 [00:02<00:00, 6301.22probe position/s]Normalizing amplitudes:  99%|█████████▊| 16167/16384 [00:02<00:00, 6414.03probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6327.00probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random32_p1_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random32_p1_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.007221 in 14.832 sec
Iter: 2, Total Loss: 0.006578 in 14.639 sec
Iter: 3, Total Loss: 0.006487 in 14.670 sec
Iter: 4, Total Loss: 0.006419 in 14.545 sec
Iter: 5, Total Loss: 0.006361 in 14.733 sec
Iter: 6, Total Loss: 0.006311 in 15.003 sec
Iter: 7, Total Loss: 0.006266 in 14.527 sec
Iter: 8, Total Loss: 0.006228 in 14.737 sec
Iter: 9, Total Loss: 0.006196 in 14.735 sec
Iter: 10, Total Loss: 0.006166 in 14.440 sec
Iter: 11, Total Loss: 0.006139 in 14.564 sec
Iter: 12, Total Loss: 0.006119 in 14.534 sec
Iter: 13, Total Loss: 0.006095 in 14.577 sec
Iter: 14, Total Loss: 0.006071 in 14.600 sec
Iter: 15, Total Loss: 0.006054 in 14.578 sec
Iter: 16, Total Loss: 0.006036 in 14.824 sec
Iter: 17, Total Loss: 0.006018 in 14.817 sec
Iter: 18, Total Loss: 0.006003 in 14.590 sec
Iter: 19, Total Loss: 0.005987 in 14.577 sec
Iter: 20, Total Loss: 0.005972 in 14.697 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 14.661 with std = 0.132 sec ###
### py4DSTEM ptycho solver is finished in 4 min 56.257 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 915.70 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 32, 3, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 636/16384 [00:00<00:02, 6350.45probe position/s]Normalizing amplitudes:   8%|▊         | 1299/16384 [00:00<00:02, 6513.41probe position/s]Normalizing amplitudes:  12%|█▏        | 1954/16384 [00:00<00:02, 6527.45probe position/s]Normalizing amplitudes:  16%|█▌        | 2607/16384 [00:00<00:02, 6425.23probe position/s]Normalizing amplitudes:  20%|█▉        | 3250/16384 [00:00<00:02, 6402.69probe position/s]Normalizing amplitudes:  24%|██▍       | 3897/16384 [00:00<00:01, 6423.12probe position/s]Normalizing amplitudes:  28%|██▊       | 4561/16384 [00:00<00:01, 6492.58probe position/s]Normalizing amplitudes:  32%|███▏      | 5259/16384 [00:00<00:01, 6644.22probe position/s]Normalizing amplitudes:  36%|███▌      | 5924/16384 [00:00<00:01, 6558.28probe position/s]Normalizing amplitudes:  40%|████      | 6581/16384 [00:01<00:01, 6447.73probe position/s]Normalizing amplitudes:  44%|████▍     | 7227/16384 [00:01<00:01, 6411.69probe position/s]Normalizing amplitudes:  48%|████▊     | 7869/16384 [00:01<00:01, 6378.88probe position/s]Normalizing amplitudes:  52%|█████▏    | 8508/16384 [00:01<00:01, 6157.51probe position/s]Normalizing amplitudes:  56%|█████▌    | 9170/16384 [00:01<00:01, 6291.53probe position/s]Normalizing amplitudes:  60%|█████▉    | 9801/16384 [00:01<00:01, 6201.80probe position/s]Normalizing amplitudes:  64%|██████▎   | 10425/16384 [00:01<00:00, 6212.12probe position/s]Normalizing amplitudes:  68%|██████▊   | 11069/16384 [00:01<00:00, 6278.92probe position/s]Normalizing amplitudes:  71%|███████▏  | 11704/16384 [00:01<00:00, 6299.75probe position/s]Normalizing amplitudes:  75%|███████▌  | 12342/16384 [00:01<00:00, 6321.44probe position/s]Normalizing amplitudes:  79%|███████▉  | 12975/16384 [00:02<00:00, 6287.20probe position/s]Normalizing amplitudes:  83%|████████▎ | 13605/16384 [00:02<00:00, 6253.55probe position/s]Normalizing amplitudes:  87%|████████▋ | 14253/16384 [00:02<00:00, 6319.28probe position/s]Normalizing amplitudes:  91%|█████████ | 14913/16384 [00:02<00:00, 6401.55probe position/s]Normalizing amplitudes:  95%|█████████▍| 15562/16384 [00:02<00:00, 6427.22probe position/s]Normalizing amplitudes:  99%|█████████▉| 16205/16384 [00:02<00:00, 6399.33probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6371.99probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random32_p3_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random32_p3_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.00865 in 6.990 sec
Iter: 2, Total Loss: 0.006428 in 7.057 sec
Iter: 3, Total Loss: 0.006297 in 7.261 sec
Iter: 4, Total Loss: 0.006164 in 7.191 sec
Iter: 5, Total Loss: 0.006037 in 7.157 sec
Iter: 6, Total Loss: 0.005919 in 7.223 sec
Iter: 7, Total Loss: 0.00582 in 7.031 sec
Iter: 8, Total Loss: 0.005732 in 7.063 sec
Iter: 9, Total Loss: 0.00566 in 7.074 sec
Iter: 10, Total Loss: 0.005596 in 7.054 sec
Iter: 11, Total Loss: 0.005543 in 7.116 sec
Iter: 12, Total Loss: 0.005497 in 6.918 sec
Iter: 13, Total Loss: 0.005456 in 6.866 sec
Iter: 14, Total Loss: 0.005419 in 6.708 sec
Iter: 15, Total Loss: 0.005385 in 6.856 sec
Iter: 16, Total Loss: 0.005356 in 6.991 sec
Iter: 17, Total Loss: 0.005331 in 6.837 sec
Iter: 18, Total Loss: 0.005311 in 6.721 sec
Iter: 19, Total Loss: 0.005295 in 6.714 sec
Iter: 20, Total Loss: 0.005281 in 6.818 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 6.982 with std = 0.166 sec ###
### py4DSTEM ptycho solver is finished in 2 min 22.522 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 925.46 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 32, 3, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 620/16384 [00:00<00:02, 6198.51probe position/s]Normalizing amplitudes:   8%|▊         | 1240/16384 [00:00<00:02, 6191.64probe position/s]Normalizing amplitudes:  12%|█▏        | 1888/16384 [00:00<00:02, 6322.57probe position/s]Normalizing amplitudes:  16%|█▌        | 2562/16384 [00:00<00:02, 6484.75probe position/s]Normalizing amplitudes:  20%|█▉        | 3211/16384 [00:00<00:02, 6444.87probe position/s]Normalizing amplitudes:  24%|██▎       | 3856/16384 [00:00<00:01, 6425.12probe position/s]Normalizing amplitudes:  27%|██▋       | 4499/16384 [00:00<00:01, 6388.13probe position/s]Normalizing amplitudes:  31%|███▏      | 5138/16384 [00:00<00:01, 6294.03probe position/s]Normalizing amplitudes:  35%|███▌      | 5772/16384 [00:00<00:01, 6305.73probe position/s]Normalizing amplitudes:  39%|███▉      | 6449/16384 [00:01<00:01, 6445.70probe position/s]Normalizing amplitudes:  44%|████▎     | 7135/16384 [00:01<00:01, 6571.27probe position/s]Normalizing amplitudes:  48%|████▊     | 7799/16384 [00:01<00:01, 6590.78probe position/s]Normalizing amplitudes:  52%|█████▏    | 8476/16384 [00:01<00:01, 6642.81probe position/s]Normalizing amplitudes:  56%|█████▌    | 9141/16384 [00:01<00:01, 6600.02probe position/s]Normalizing amplitudes:  60%|█████▉    | 9802/16384 [00:01<00:01, 6569.59probe position/s]Normalizing amplitudes:  64%|██████▍   | 10460/16384 [00:01<00:00, 6558.34probe position/s]Normalizing amplitudes:  68%|██████▊   | 11116/16384 [00:01<00:00, 6535.28probe position/s]Normalizing amplitudes:  72%|███████▏  | 11790/16384 [00:01<00:00, 6595.02probe position/s]Normalizing amplitudes:  76%|███████▌  | 12479/16384 [00:01<00:00, 6682.36probe position/s]Normalizing amplitudes:  80%|████████  | 13148/16384 [00:02<00:00, 6681.16probe position/s]Normalizing amplitudes:  84%|████████▍ | 13817/16384 [00:02<00:00, 6616.82probe position/s]Normalizing amplitudes:  88%|████████▊ | 14479/16384 [00:02<00:00, 6580.46probe position/s]Normalizing amplitudes:  92%|█████████▏| 15138/16384 [00:02<00:00, 6540.62probe position/s]Normalizing amplitudes:  97%|█████████▋| 15819/16384 [00:02<00:00, 6619.65probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6529.83probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random32_p3_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random32_p3_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.008827 in 18.897 sec
Iter: 2, Total Loss: 0.006288 in 19.014 sec
Iter: 3, Total Loss: 0.006094 in 18.977 sec
Iter: 4, Total Loss: 0.005924 in 18.779 sec
Iter: 5, Total Loss: 0.005769 in 18.730 sec
Iter: 6, Total Loss: 0.005642 in 18.717 sec
Iter: 7, Total Loss: 0.005545 in 18.861 sec
Iter: 8, Total Loss: 0.005472 in 19.187 sec
Iter: 9, Total Loss: 0.005415 in 19.071 sec
Iter: 10, Total Loss: 0.005367 in 19.027 sec
Iter: 11, Total Loss: 0.005324 in 18.981 sec
Iter: 12, Total Loss: 0.005284 in 19.143 sec
Iter: 13, Total Loss: 0.005247 in 18.995 sec
Iter: 14, Total Loss: 0.005214 in 19.174 sec
Iter: 15, Total Loss: 0.005184 in 19.133 sec
Iter: 16, Total Loss: 0.005159 in 19.152 sec
Iter: 17, Total Loss: 0.005137 in 19.172 sec
Iter: 18, Total Loss: 0.005117 in 19.135 sec
Iter: 19, Total Loss: 0.005101 in 19.308 sec
Iter: 20, Total Loss: 0.005087 in 19.143 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 19.030 with std = 0.160 sec ###
### py4DSTEM ptycho solver is finished in 6 min 23.541 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 915.64 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 32, 3, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 631/16384 [00:00<00:02, 6305.44probe position/s]Normalizing amplitudes:   8%|▊         | 1264/16384 [00:00<00:02, 6315.23probe position/s]Normalizing amplitudes:  12%|█▏        | 1921/16384 [00:00<00:02, 6428.99probe position/s]Normalizing amplitudes:  16%|█▌        | 2581/16384 [00:00<00:02, 6494.16probe position/s]Normalizing amplitudes:  20%|█▉        | 3231/16384 [00:00<00:02, 6468.70probe position/s]Normalizing amplitudes:  24%|██▎       | 3878/16384 [00:00<00:01, 6461.09probe position/s]Normalizing amplitudes:  28%|██▊       | 4525/16384 [00:00<00:01, 6327.59probe position/s]Normalizing amplitudes:  32%|███▏      | 5165/16384 [00:00<00:01, 6346.46probe position/s]Normalizing amplitudes:  36%|███▌      | 5835/16384 [00:00<00:01, 6453.36probe position/s]Normalizing amplitudes:  40%|███▉      | 6481/16384 [00:01<00:01, 6451.92probe position/s]Normalizing amplitudes:  43%|████▎     | 7127/16384 [00:01<00:01, 6180.31probe position/s]Normalizing amplitudes:  47%|████▋     | 7753/16384 [00:01<00:01, 6202.08probe position/s]Normalizing amplitudes:  51%|█████     | 8375/16384 [00:01<00:01, 6173.91probe position/s]Normalizing amplitudes:  55%|█████▍    | 8994/16384 [00:01<00:01, 5762.55probe position/s]Normalizing amplitudes:  58%|█████▊    | 9577/16384 [00:01<00:01, 5763.94probe position/s]Normalizing amplitudes:  62%|██████▏   | 10191/16384 [00:01<00:01, 5870.00probe position/s]Normalizing amplitudes:  66%|██████▌   | 10800/16384 [00:01<00:00, 5933.28probe position/s]Normalizing amplitudes:  70%|██████▉   | 11407/16384 [00:01<00:00, 5971.02probe position/s]Normalizing amplitudes:  73%|███████▎  | 12037/16384 [00:01<00:00, 6067.62probe position/s]Normalizing amplitudes:  77%|███████▋  | 12646/16384 [00:02<00:00, 5972.91probe position/s]Normalizing amplitudes:  81%|████████  | 13245/16384 [00:02<00:00, 5949.19probe position/s]Normalizing amplitudes:  85%|████████▍ | 13896/16384 [00:02<00:00, 6112.67probe position/s]Normalizing amplitudes:  89%|████████▉ | 14541/16384 [00:02<00:00, 6210.39probe position/s]Normalizing amplitudes:  93%|█████████▎| 15189/16384 [00:02<00:00, 6290.36probe position/s]Normalizing amplitudes:  97%|█████████▋| 15822/16384 [00:02<00:00, 6301.71probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6194.07probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random32_p3_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random32_p3_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.00902 in 37.181 sec
Iter: 2, Total Loss: 0.006172 in 37.285 sec
Iter: 3, Total Loss: 0.005935 in 37.624 sec
Iter: 4, Total Loss: 0.005744 in 37.360 sec
Iter: 5, Total Loss: 0.005601 in 37.527 sec
Iter: 6, Total Loss: 0.005501 in 37.425 sec
Iter: 7, Total Loss: 0.005432 in 37.042 sec
Iter: 8, Total Loss: 0.00538 in 35.922 sec
Iter: 9, Total Loss: 0.005338 in 36.539 sec
Iter: 10, Total Loss: 0.005301 in 38.991 sec
Iter: 11, Total Loss: 0.005266 in 40.061 sec
Iter: 12, Total Loss: 0.005232 in 39.616 sec
Iter: 13, Total Loss: 0.005198 in 38.306 sec
Iter: 14, Total Loss: 0.005167 in 38.062 sec
Iter: 15, Total Loss: 0.005137 in 37.422 sec
Iter: 16, Total Loss: 0.005112 in 37.818 sec
Iter: 17, Total Loss: 0.00509 in 37.753 sec
Iter: 18, Total Loss: 0.005073 in 37.804 sec
Iter: 19, Total Loss: 0.005056 in 37.662 sec
Iter: 20, Total Loss: 0.005042 in 37.818 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 37.761 with std = 0.924 sec ###
### py4DSTEM ptycho solver is finished in 12 min 38.477 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 916.19 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 32, 6, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▎         | 583/16384 [00:00<00:02, 5828.91probe position/s]Normalizing amplitudes:   7%|▋         | 1166/16384 [00:00<00:02, 5682.75probe position/s]Normalizing amplitudes:  11%|█         | 1740/16384 [00:00<00:02, 5705.69probe position/s]Normalizing amplitudes:  14%|█▍        | 2341/16384 [00:00<00:02, 5822.70probe position/s]Normalizing amplitudes:  18%|█▊        | 3007/16384 [00:00<00:02, 6120.09probe position/s]Normalizing amplitudes:  22%|██▏       | 3655/16384 [00:00<00:02, 6240.77probe position/s]Normalizing amplitudes:  26%|██▌       | 4280/16384 [00:00<00:01, 6175.82probe position/s]Normalizing amplitudes:  30%|██▉       | 4898/16384 [00:00<00:01, 6120.07probe position/s]Normalizing amplitudes:  34%|███▍      | 5532/16384 [00:00<00:01, 6187.77probe position/s]Normalizing amplitudes:  38%|███▊      | 6152/16384 [00:01<00:01, 6169.04probe position/s]Normalizing amplitudes:  41%|████▏     | 6770/16384 [00:01<00:01, 6118.20probe position/s]Normalizing amplitudes:  45%|████▌     | 7388/16384 [00:01<00:01, 6133.59probe position/s]Normalizing amplitudes:  49%|████▉     | 8002/16384 [00:01<00:01, 6074.53probe position/s]Normalizing amplitudes:  53%|█████▎    | 8610/16384 [00:01<00:01, 5957.77probe position/s]Normalizing amplitudes:  56%|█████▋    | 9248/16384 [00:01<00:01, 6080.15probe position/s]Normalizing amplitudes:  60%|██████    | 9860/16384 [00:01<00:01, 6091.01probe position/s]Normalizing amplitudes:  64%|██████▍   | 10470/16384 [00:01<00:01, 5825.86probe position/s]Normalizing amplitudes:  68%|██████▊   | 11104/16384 [00:01<00:00, 5972.84probe position/s]Normalizing amplitudes:  72%|███████▏  | 11746/16384 [00:01<00:00, 6103.26probe position/s]Normalizing amplitudes:  75%|███████▌  | 12367/16384 [00:02<00:00, 6131.59probe position/s]Normalizing amplitudes:  79%|███████▉  | 12982/16384 [00:02<00:00, 6051.23probe position/s]Normalizing amplitudes:  83%|████████▎ | 13611/16384 [00:02<00:00, 6118.42probe position/s]Normalizing amplitudes:  87%|████████▋ | 14224/16384 [00:02<00:00, 6100.02probe position/s]Normalizing amplitudes:  91%|█████████ | 14835/16384 [00:02<00:00, 6013.75probe position/s]Normalizing amplitudes:  94%|█████████▍| 15462/16384 [00:02<00:00, 6086.82probe position/s]Normalizing amplitudes:  98%|█████████▊| 16106/16384 [00:02<00:00, 6188.60probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6078.06probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random32_p6_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random32_p6_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.01301 in 13.081 sec
Iter: 2, Total Loss: 0.006409 in 12.978 sec
Iter: 3, Total Loss: 0.006246 in 13.090 sec
Iter: 4, Total Loss: 0.006095 in 13.089 sec
Iter: 5, Total Loss: 0.005952 in 13.146 sec
Iter: 6, Total Loss: 0.005823 in 13.228 sec
Iter: 7, Total Loss: 0.005715 in 13.207 sec
Iter: 8, Total Loss: 0.00562 in 12.956 sec
Iter: 9, Total Loss: 0.005535 in 12.936 sec
Iter: 10, Total Loss: 0.005457 in 12.836 sec
Iter: 11, Total Loss: 0.005381 in 12.925 sec
Iter: 12, Total Loss: 0.005306 in 13.027 sec
Iter: 13, Total Loss: 0.00523 in 12.823 sec
Iter: 14, Total Loss: 0.005159 in 13.046 sec
Iter: 15, Total Loss: 0.005099 in 12.916 sec
Iter: 16, Total Loss: 0.005052 in 12.889 sec
Iter: 17, Total Loss: 0.005015 in 12.808 sec
Iter: 18, Total Loss: 0.004986 in 12.853 sec
Iter: 19, Total Loss: 0.004962 in 12.622 sec
Iter: 20, Total Loss: 0.004942 in 12.764 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 12.961 with std = 0.151 sec ###
### py4DSTEM ptycho solver is finished in 4 min 22.466 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 920.14 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 32, 6, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   3%|▎         | 518/16384 [00:00<00:03, 5179.09probe position/s]Normalizing amplitudes:   6%|▋         | 1036/16384 [00:00<00:03, 4686.07probe position/s]Normalizing amplitudes:  10%|█         | 1654/16384 [00:00<00:02, 5329.94probe position/s]Normalizing amplitudes:  14%|█▍        | 2333/16384 [00:00<00:02, 5885.72probe position/s]Normalizing amplitudes:  18%|█▊        | 2993/16384 [00:00<00:02, 6137.07probe position/s]Normalizing amplitudes:  22%|██▏       | 3664/16384 [00:00<00:02, 6326.22probe position/s]Normalizing amplitudes:  26%|██▌       | 4300/16384 [00:00<00:01, 6275.42probe position/s]Normalizing amplitudes:  30%|███       | 4978/16384 [00:00<00:01, 6431.82probe position/s]Normalizing amplitudes:  34%|███▍      | 5623/16384 [00:00<00:01, 6309.34probe position/s]Normalizing amplitudes:  38%|███▊      | 6256/16384 [00:01<00:01, 6208.57probe position/s]Normalizing amplitudes:  42%|████▏     | 6944/16384 [00:01<00:01, 6405.93probe position/s]Normalizing amplitudes:  46%|████▋     | 7586/16384 [00:01<00:01, 6266.42probe position/s]Normalizing amplitudes:  50%|█████     | 8238/16384 [00:01<00:01, 6338.67probe position/s]Normalizing amplitudes:  54%|█████▍    | 8886/16384 [00:01<00:01, 6379.69probe position/s]Normalizing amplitudes:  58%|█████▊    | 9532/16384 [00:01<00:01, 6402.88probe position/s]Normalizing amplitudes:  62%|██████▏   | 10206/16384 [00:01<00:00, 6501.95probe position/s]Normalizing amplitudes:  66%|██████▋   | 10857/16384 [00:01<00:00, 6410.98probe position/s]Normalizing amplitudes:  70%|███████   | 11500/16384 [00:01<00:00, 6416.12probe position/s]Normalizing amplitudes:  74%|███████▍  | 12155/16384 [00:01<00:00, 6453.11probe position/s]Normalizing amplitudes:  78%|███████▊  | 12801/16384 [00:02<00:00, 6357.20probe position/s]Normalizing amplitudes:  82%|████████▏ | 13456/16384 [00:02<00:00, 6412.10probe position/s]Normalizing amplitudes:  86%|████████▌ | 14099/16384 [00:02<00:00, 6416.06probe position/s]Normalizing amplitudes:  90%|█████████ | 14765/16384 [00:02<00:00, 6486.52probe position/s]Normalizing amplitudes:  94%|█████████▍| 15419/16384 [00:02<00:00, 6500.46probe position/s]Normalizing amplitudes:  98%|█████████▊| 16070/16384 [00:02<00:00, 6478.64probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6299.23probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random32_p6_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random32_p6_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.01322 in 36.078 sec
Iter: 2, Total Loss: 0.00623 in 35.413 sec
Iter: 3, Total Loss: 0.005991 in 35.910 sec
Iter: 4, Total Loss: 0.005788 in 36.163 sec
Iter: 5, Total Loss: 0.005617 in 36.206 sec
Iter: 6, Total Loss: 0.00548 in 36.341 sec
Iter: 7, Total Loss: 0.005371 in 36.993 sec
Iter: 8, Total Loss: 0.005274 in 36.425 sec
Iter: 9, Total Loss: 0.005184 in 36.286 sec
Iter: 10, Total Loss: 0.005097 in 36.280 sec
Iter: 11, Total Loss: 0.00502 in 36.530 sec
Iter: 12, Total Loss: 0.004957 in 36.710 sec
Iter: 13, Total Loss: 0.004909 in 36.343 sec
Iter: 14, Total Loss: 0.004872 in 36.237 sec
Iter: 15, Total Loss: 0.004844 in 36.283 sec
Iter: 16, Total Loss: 0.004821 in 36.644 sec
Iter: 17, Total Loss: 0.004802 in 37.196 sec
Iter: 18, Total Loss: 0.004785 in 36.815 sec
Iter: 19, Total Loss: 0.004771 in 36.268 sec
Iter: 20, Total Loss: 0.004758 in 36.398 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 36.376 with std = 0.376 sec ###
### py4DSTEM ptycho solver is finished in 12 min 10.566 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 915.89 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 32, 6, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 653/16384 [00:00<00:02, 6527.42probe position/s]Normalizing amplitudes:   8%|▊         | 1306/16384 [00:00<00:02, 6446.83probe position/s]Normalizing amplitudes:  12%|█▏        | 1951/16384 [00:00<00:02, 6396.57probe position/s]Normalizing amplitudes:  16%|█▌        | 2591/16384 [00:00<00:02, 6384.64probe position/s]Normalizing amplitudes:  20%|█▉        | 3230/16384 [00:00<00:02, 6351.80probe position/s]Normalizing amplitudes:  24%|██▎       | 3866/16384 [00:00<00:02, 6073.06probe position/s]Normalizing amplitudes:  27%|██▋       | 4493/16384 [00:00<00:01, 6134.77probe position/s]Normalizing amplitudes:  31%|███▏      | 5142/16384 [00:00<00:01, 6244.10probe position/s]Normalizing amplitudes:  35%|███▌      | 5781/16384 [00:00<00:01, 6288.21probe position/s]Normalizing amplitudes:  39%|███▉      | 6411/16384 [00:01<00:01, 6276.45probe position/s]Normalizing amplitudes:  43%|████▎     | 7040/16384 [00:01<00:01, 6108.66probe position/s]Normalizing amplitudes:  47%|████▋     | 7653/16384 [00:01<00:01, 5930.30probe position/s]Normalizing amplitudes:  50%|█████     | 8248/16384 [00:01<00:01, 5910.87probe position/s]Normalizing amplitudes:  54%|█████▍    | 8841/16384 [00:01<00:01, 5839.63probe position/s]Normalizing amplitudes:  58%|█████▊    | 9492/16384 [00:01<00:01, 6034.36probe position/s]Normalizing amplitudes:  62%|██████▏   | 10132/16384 [00:01<00:01, 6141.49probe position/s]Normalizing amplitudes:  66%|██████▌   | 10748/16384 [00:01<00:00, 6069.01probe position/s]Normalizing amplitudes:  69%|██████▉   | 11356/16384 [00:01<00:00, 5994.33probe position/s]Normalizing amplitudes:  73%|███████▎  | 11957/16384 [00:01<00:00, 5974.73probe position/s]Normalizing amplitudes:  77%|███████▋  | 12603/16384 [00:02<00:00, 6115.98probe position/s]Normalizing amplitudes:  81%|████████  | 13262/16384 [00:02<00:00, 6254.85probe position/s]Normalizing amplitudes:  85%|████████▍ | 13903/16384 [00:02<00:00, 6300.69probe position/s]Normalizing amplitudes:  89%|████████▊ | 14534/16384 [00:02<00:00, 6283.88probe position/s]Normalizing amplitudes:  93%|█████████▎| 15163/16384 [00:02<00:00, 6277.28probe position/s]Normalizing amplitudes:  96%|█████████▋| 15791/16384 [00:02<00:00, 6154.57probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6139.68probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random32_p6_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random32_p6_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.01422 in 71.441 sec
Iter: 2, Total Loss: 0.006158 in 71.356 sec
Iter: 3, Total Loss: 0.005809 in 71.426 sec
Iter: 4, Total Loss: 0.005599 in 72.120 sec
Iter: 5, Total Loss: 0.005438 in 71.628 sec
Iter: 6, Total Loss: 0.005312 in 70.972 sec
Iter: 7, Total Loss: 0.005205 in 69.154 sec
Iter: 8, Total Loss: 0.005109 in 68.553 sec
Iter: 9, Total Loss: 0.005021 in 69.772 sec
Iter: 10, Total Loss: 0.004944 in 70.423 sec
Iter: 11, Total Loss: 0.004884 in 69.442 sec
Iter: 12, Total Loss: 0.00484 in 69.475 sec
Iter: 13, Total Loss: 0.004806 in 71.175 sec
Iter: 14, Total Loss: 0.00478 in 71.747 sec
Iter: 15, Total Loss: 0.004758 in 71.393 sec
Iter: 16, Total Loss: 0.00474 in 71.169 sec
Iter: 17, Total Loss: 0.004724 in 71.498 sec
Iter: 18, Total Loss: 0.004711 in 71.339 sec
Iter: 19, Total Loss: 0.004699 in 70.805 sec
Iter: 20, Total Loss: 0.004687 in 70.845 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 70.787 with std = 0.960 sec ###
### py4DSTEM ptycho solver is finished in 23 min 38.738 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 918.89 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 32, 12, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 635/16384 [00:00<00:02, 6339.41probe position/s]Normalizing amplitudes:   8%|▊         | 1269/16384 [00:00<00:02, 6266.99probe position/s]Normalizing amplitudes:  12%|█▏        | 1918/16384 [00:00<00:02, 6367.52probe position/s]Normalizing amplitudes:  16%|█▌        | 2559/16384 [00:00<00:02, 6383.79probe position/s]Normalizing amplitudes:  20%|█▉        | 3198/16384 [00:00<00:02, 6333.26probe position/s]Normalizing amplitudes:  23%|██▎       | 3832/16384 [00:00<00:02, 5819.40probe position/s]Normalizing amplitudes:  27%|██▋       | 4421/16384 [00:00<00:02, 5799.64probe position/s]Normalizing amplitudes:  31%|███       | 5006/16384 [00:00<00:02, 5498.66probe position/s]Normalizing amplitudes:  34%|███▍      | 5561/16384 [00:00<00:02, 5380.93probe position/s]Normalizing amplitudes:  38%|███▊      | 6201/16384 [00:01<00:01, 5672.85probe position/s]Normalizing amplitudes:  42%|████▏     | 6827/16384 [00:01<00:01, 5843.17probe position/s]Normalizing amplitudes:  45%|████▌     | 7443/16384 [00:01<00:01, 5936.28probe position/s]Normalizing amplitudes:  49%|████▉     | 8063/16384 [00:01<00:01, 6011.41probe position/s]Normalizing amplitudes:  53%|█████▎    | 8674/16384 [00:01<00:01, 6039.12probe position/s]Normalizing amplitudes:  57%|█████▋    | 9286/16384 [00:01<00:01, 6062.40probe position/s]Normalizing amplitudes:  61%|██████    | 9938/16384 [00:01<00:01, 6197.46probe position/s]Normalizing amplitudes:  65%|██████▍   | 10623/16384 [00:01<00:00, 6390.59probe position/s]Normalizing amplitudes:  69%|██████▊   | 11263/16384 [00:01<00:00, 6320.17probe position/s]Normalizing amplitudes:  73%|███████▎  | 11896/16384 [00:01<00:00, 6207.39probe position/s]Normalizing amplitudes:  76%|███████▋  | 12518/16384 [00:02<00:00, 6176.29probe position/s]Normalizing amplitudes:  80%|████████  | 13155/16384 [00:02<00:00, 6230.76probe position/s]Normalizing amplitudes:  84%|████████▍ | 13795/16384 [00:02<00:00, 6279.29probe position/s]Normalizing amplitudes:  88%|████████▊ | 14424/16384 [00:02<00:00, 6225.50probe position/s]Normalizing amplitudes:  92%|█████████▏| 15047/16384 [00:02<00:00, 6083.24probe position/s]Normalizing amplitudes:  96%|█████████▌| 15664/16384 [00:02<00:00, 6107.63probe position/s]Normalizing amplitudes:  99%|█████████▉| 16276/16384 [00:02<00:00, 6099.16probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6062.35probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random32_p12_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random32_p12_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.02368 in 24.148 sec
Iter: 2, Total Loss: 0.00641 in 23.938 sec
Iter: 3, Total Loss: 0.006203 in 24.035 sec
Iter: 4, Total Loss: 0.006025 in 24.167 sec
Iter: 5, Total Loss: 0.005864 in 24.756 sec
Iter: 6, Total Loss: 0.005733 in 24.677 sec
Iter: 7, Total Loss: 0.005624 in 24.485 sec
Iter: 8, Total Loss: 0.005523 in 24.461 sec
Iter: 9, Total Loss: 0.005428 in 24.589 sec
Iter: 10, Total Loss: 0.005335 in 24.746 sec
Iter: 11, Total Loss: 0.005242 in 24.742 sec
Iter: 12, Total Loss: 0.005152 in 24.443 sec
Iter: 13, Total Loss: 0.005073 in 24.414 sec
Iter: 14, Total Loss: 0.005009 in 24.370 sec
Iter: 15, Total Loss: 0.004958 in 24.472 sec
Iter: 16, Total Loss: 0.004917 in 24.328 sec
Iter: 17, Total Loss: 0.004883 in 24.154 sec
Iter: 18, Total Loss: 0.004854 in 24.553 sec
Iter: 19, Total Loss: 0.004828 in 24.627 sec
Iter: 20, Total Loss: 0.004806 in 24.500 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 24.430 with std = 0.234 sec ###
### py4DSTEM ptycho solver is finished in 8 min 11.688 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 915.90 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 32, 12, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 635/16384 [00:00<00:02, 6345.85probe position/s]Normalizing amplitudes:   8%|▊         | 1274/16384 [00:00<00:02, 6368.61probe position/s]Normalizing amplitudes:  12%|█▏        | 1914/16384 [00:00<00:02, 6381.47probe position/s]Normalizing amplitudes:  16%|█▌        | 2562/16384 [00:00<00:02, 6418.90probe position/s]Normalizing amplitudes:  20%|█▉        | 3219/16384 [00:00<00:02, 6472.59probe position/s]Normalizing amplitudes:  24%|██▎       | 3867/16384 [00:00<00:01, 6270.45probe position/s]Normalizing amplitudes:  28%|██▊       | 4516/16384 [00:00<00:01, 6339.16probe position/s]Normalizing amplitudes:  31%|███▏      | 5151/16384 [00:00<00:01, 6170.61probe position/s]Normalizing amplitudes:  35%|███▌      | 5794/16384 [00:00<00:01, 6247.18probe position/s]Normalizing amplitudes:  39%|███▉      | 6420/16384 [00:01<00:01, 6239.65probe position/s]Normalizing amplitudes:  43%|████▎     | 7049/16384 [00:01<00:01, 6253.44probe position/s]Normalizing amplitudes:  47%|████▋     | 7675/16384 [00:01<00:01, 6252.96probe position/s]Normalizing amplitudes:  51%|█████     | 8301/16384 [00:01<00:01, 6058.89probe position/s]Normalizing amplitudes:  54%|█████▍    | 8909/16384 [00:01<00:01, 5997.42probe position/s]Normalizing amplitudes:  58%|█████▊    | 9532/16384 [00:01<00:01, 6063.47probe position/s]Normalizing amplitudes:  62%|██████▏   | 10184/16384 [00:01<00:01, 6196.17probe position/s]Normalizing amplitudes:  66%|██████▌   | 10836/16384 [00:01<00:00, 6291.42probe position/s]Normalizing amplitudes:  70%|██████▉   | 11466/16384 [00:01<00:00, 6264.12probe position/s]Normalizing amplitudes:  74%|███████▍  | 12093/16384 [00:01<00:00, 6152.02probe position/s]Normalizing amplitudes:  78%|███████▊  | 12731/16384 [00:02<00:00, 6217.93probe position/s]Normalizing amplitudes:  82%|████████▏ | 13354/16384 [00:02<00:00, 6208.63probe position/s]Normalizing amplitudes:  85%|████████▌ | 13979/16384 [00:02<00:00, 6220.40probe position/s]Normalizing amplitudes:  89%|████████▉ | 14602/16384 [00:02<00:00, 6178.49probe position/s]Normalizing amplitudes:  93%|█████████▎| 15234/16384 [00:02<00:00, 6219.18probe position/s]Normalizing amplitudes:  97%|█████████▋| 15877/16384 [00:02<00:00, 6280.92probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6232.39probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random32_p12_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random32_p12_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.02434 in 71.544 sec
Iter: 2, Total Loss: 0.006178 in 70.973 sec
Iter: 3, Total Loss: 0.005834 in 70.964 sec
Iter: 4, Total Loss: 0.005625 in 71.307 sec
Iter: 5, Total Loss: 0.005472 in 70.961 sec
Iter: 6, Total Loss: 0.005334 in 69.729 sec
Iter: 7, Total Loss: 0.0052 in 69.472 sec
Iter: 8, Total Loss: 0.005072 in 68.466 sec
Iter: 9, Total Loss: 0.00496 in 68.258 sec
Iter: 10, Total Loss: 0.004872 in 69.032 sec
Iter: 11, Total Loss: 0.004806 in 68.963 sec
Iter: 12, Total Loss: 0.004756 in 69.649 sec
Iter: 13, Total Loss: 0.004717 in 70.519 sec
Iter: 14, Total Loss: 0.004685 in 70.000 sec
Iter: 15, Total Loss: 0.004659 in 70.169 sec
Iter: 16, Total Loss: 0.004636 in 71.160 sec
Iter: 17, Total Loss: 0.004616 in 71.576 sec
Iter: 18, Total Loss: 0.004599 in 71.384 sec
Iter: 19, Total Loss: 0.004583 in 71.391 sec
Iter: 20, Total Loss: 0.004569 in 70.391 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 70.295 with std = 1.029 sec ###
### py4DSTEM ptycho solver is finished in 23 min 29.079 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 919.62 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 32, 12, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 632/16384 [00:00<00:02, 6313.14probe position/s]Normalizing amplitudes:   8%|▊         | 1264/16384 [00:00<00:02, 6249.20probe position/s]Normalizing amplitudes:  12%|█▏        | 1896/16384 [00:00<00:02, 6280.93probe position/s]Normalizing amplitudes:  16%|█▌        | 2565/16384 [00:00<00:02, 6441.40probe position/s]Normalizing amplitudes:  20%|█▉        | 3210/16384 [00:00<00:02, 6409.05probe position/s]Normalizing amplitudes:  24%|██▎       | 3851/16384 [00:00<00:01, 6361.81probe position/s]Normalizing amplitudes:  27%|██▋       | 4488/16384 [00:00<00:01, 6353.30probe position/s]Normalizing amplitudes:  31%|███▏      | 5124/16384 [00:00<00:01, 6248.16probe position/s]Normalizing amplitudes:  35%|███▌      | 5750/16384 [00:00<00:01, 6241.09probe position/s]Normalizing amplitudes:  39%|███▉      | 6391/16384 [00:01<00:01, 6291.80probe position/s]Normalizing amplitudes:  43%|████▎     | 7034/16384 [00:01<00:01, 6330.46probe position/s]Normalizing amplitudes:  47%|████▋     | 7684/16384 [00:01<00:01, 6381.00probe position/s]Normalizing amplitudes:  51%|█████     | 8335/16384 [00:01<00:01, 6417.72probe position/s]Normalizing amplitudes:  55%|█████▍    | 8990/16384 [00:01<00:01, 6455.20probe position/s]Normalizing amplitudes:  59%|█████▉    | 9636/16384 [00:01<00:01, 6405.77probe position/s]Normalizing amplitudes:  63%|██████▎   | 10277/16384 [00:01<00:00, 6383.84probe position/s]Normalizing amplitudes:  67%|██████▋   | 10916/16384 [00:01<00:00, 6335.64probe position/s]Normalizing amplitudes:  71%|███████   | 11560/16384 [00:01<00:00, 6364.42probe position/s]Normalizing amplitudes:  74%|███████▍  | 12203/16384 [00:01<00:00, 6382.87probe position/s]Normalizing amplitudes:  78%|███████▊  | 12842/16384 [00:02<00:00, 6228.77probe position/s]Normalizing amplitudes:  82%|████████▏ | 13466/16384 [00:02<00:00, 6215.15probe position/s]Normalizing amplitudes:  86%|████████▌ | 14089/16384 [00:02<00:00, 6211.95probe position/s]Normalizing amplitudes:  90%|████████▉ | 14711/16384 [00:02<00:00, 6203.90probe position/s]Normalizing amplitudes:  94%|█████████▍| 15362/16384 [00:02<00:00, 6294.76probe position/s]Normalizing amplitudes:  98%|█████████▊| 16001/16384 [00:02<00:00, 6322.20probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6326.44probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random32_p12_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 32, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random32_p12_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 32 measurements.
Iter: 1, Total Loss: 0.02578 in 140.283 sec
Iter: 2, Total Loss: 0.006111 in 141.492 sec
Iter: 3, Total Loss: 0.005617 in 141.066 sec
Iter: 4, Total Loss: 0.005379 in 140.819 sec
Iter: 5, Total Loss: 0.005201 in 139.757 sec
Iter: 6, Total Loss: 0.005045 in 141.254 sec
Iter: 7, Total Loss: 0.004912 in 140.791 sec
Iter: 8, Total Loss: 0.004813 in 138.342 sec
Iter: 9, Total Loss: 0.004743 in 137.655 sec
Iter: 10, Total Loss: 0.004693 in 139.056 sec
Iter: 11, Total Loss: 0.004656 in 139.665 sec
Iter: 12, Total Loss: 0.004627 in 139.981 sec
Iter: 13, Total Loss: 0.004602 in 138.586 sec
Iter: 14, Total Loss: 0.004582 in 138.054 sec
Iter: 15, Total Loss: 0.004565 in 139.518 sec
Iter: 16, Total Loss: 0.00455 in 139.512 sec
Iter: 17, Total Loss: 0.004536 in 138.837 sec
Iter: 18, Total Loss: 0.004524 in 139.164 sec
Iter: 19, Total Loss: 0.004513 in 138.386 sec
Iter: 20, Total Loss: 0.004503 in 138.943 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 139.558 with std = 1.090 sec ###
### py4DSTEM ptycho solver is finished in 46 min 34.383 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 916.35 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 16, 1, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 619/16384 [00:00<00:02, 6180.75probe position/s]Normalizing amplitudes:   8%|▊         | 1261/16384 [00:00<00:02, 6319.13probe position/s]Normalizing amplitudes:  12%|█▏        | 1921/16384 [00:00<00:02, 6443.64probe position/s]Normalizing amplitudes:  16%|█▌        | 2566/16384 [00:00<00:02, 6392.83probe position/s]Normalizing amplitudes:  20%|█▉        | 3206/16384 [00:00<00:02, 6367.24probe position/s]Normalizing amplitudes:  24%|██▎       | 3853/16384 [00:00<00:01, 6400.71probe position/s]Normalizing amplitudes:  27%|██▋       | 4505/16384 [00:00<00:01, 6437.99probe position/s]Normalizing amplitudes:  31%|███▏      | 5149/16384 [00:00<00:01, 6414.05probe position/s]Normalizing amplitudes:  35%|███▌      | 5804/16384 [00:00<00:01, 6453.99probe position/s]Normalizing amplitudes:  39%|███▉      | 6465/16384 [00:01<00:01, 6501.15probe position/s]Normalizing amplitudes:  43%|████▎     | 7116/16384 [00:01<00:01, 6482.50probe position/s]Normalizing amplitudes:  47%|████▋     | 7765/16384 [00:01<00:01, 6455.24probe position/s]Normalizing amplitudes:  52%|█████▏    | 8450/16384 [00:01<00:01, 6573.33probe position/s]Normalizing amplitudes:  56%|█████▌    | 9108/16384 [00:01<00:01, 6540.57probe position/s]Normalizing amplitudes:  60%|█████▉    | 9763/16384 [00:01<00:01, 6387.99probe position/s]Normalizing amplitudes:  64%|██████▎   | 10411/16384 [00:01<00:00, 6414.12probe position/s]Normalizing amplitudes:  68%|██████▊   | 11074/16384 [00:01<00:00, 6476.58probe position/s]Normalizing amplitudes:  72%|███████▏  | 11725/16384 [00:01<00:00, 6486.04probe position/s]Normalizing amplitudes:  76%|███████▌  | 12375/16384 [00:01<00:00, 6487.02probe position/s]Normalizing amplitudes:  79%|███████▉  | 13024/16384 [00:02<00:00, 6340.58probe position/s]Normalizing amplitudes:  83%|████████▎ | 13659/16384 [00:02<00:00, 6317.60probe position/s]Normalizing amplitudes:  87%|████████▋ | 14302/16384 [00:02<00:00, 6350.66probe position/s]Normalizing amplitudes:  92%|█████████▏| 15002/16384 [00:02<00:00, 6540.63probe position/s]Normalizing amplitudes:  96%|█████████▌| 15657/16384 [00:02<00:00, 6523.59probe position/s]Normalizing amplitudes: 100%|█████████▉| 16310/16384 [00:02<00:00, 6412.41probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6432.27probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random16_p1_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random16_p1_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.006894 in 6.610 sec
Iter: 2, Total Loss: 0.006558 in 6.579 sec
Iter: 3, Total Loss: 0.006463 in 6.574 sec
Iter: 4, Total Loss: 0.006371 in 6.716 sec
Iter: 5, Total Loss: 0.006296 in 6.761 sec
Iter: 6, Total Loss: 0.006241 in 6.759 sec
Iter: 7, Total Loss: 0.006203 in 6.685 sec
Iter: 8, Total Loss: 0.006177 in 6.691 sec
Iter: 9, Total Loss: 0.006161 in 6.802 sec
Iter: 10, Total Loss: 0.006147 in 6.742 sec
Iter: 11, Total Loss: 0.006138 in 6.715 sec
Iter: 12, Total Loss: 0.00613 in 6.678 sec
Iter: 13, Total Loss: 0.006126 in 6.604 sec
Iter: 14, Total Loss: 0.006124 in 6.548 sec
Iter: 15, Total Loss: 0.006119 in 6.451 sec
Iter: 16, Total Loss: 0.006116 in 6.623 sec
Iter: 17, Total Loss: 0.006114 in 6.473 sec
Iter: 18, Total Loss: 0.006112 in 6.451 sec
Iter: 19, Total Loss: 0.006111 in 6.481 sec
Iter: 20, Total Loss: 0.00611 in 6.378 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 6.616 with std = 0.119 sec ###
### py4DSTEM ptycho solver is finished in 2 min 15.242 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 934.21 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 16, 1, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 689/16384 [00:00<00:02, 6888.00probe position/s]Normalizing amplitudes:   8%|▊         | 1379/16384 [00:00<00:02, 6894.81probe position/s]Normalizing amplitudes:  13%|█▎        | 2071/16384 [00:00<00:02, 6904.15probe position/s]Normalizing amplitudes:  17%|█▋        | 2762/16384 [00:00<00:02, 6736.97probe position/s]Normalizing amplitudes:  21%|██        | 3437/16384 [00:00<00:01, 6671.44probe position/s]Normalizing amplitudes:  25%|██▌       | 4111/16384 [00:00<00:01, 6691.80probe position/s]Normalizing amplitudes:  29%|██▉       | 4781/16384 [00:00<00:01, 6640.37probe position/s]Normalizing amplitudes:  33%|███▎      | 5450/16384 [00:00<00:01, 6653.51probe position/s]Normalizing amplitudes:  37%|███▋      | 6122/16384 [00:00<00:01, 6672.25probe position/s]Normalizing amplitudes:  42%|████▏     | 6815/16384 [00:01<00:01, 6750.21probe position/s]Normalizing amplitudes:  46%|████▌     | 7491/16384 [00:01<00:01, 6636.97probe position/s]Normalizing amplitudes:  50%|████▉     | 8156/16384 [00:01<00:01, 6598.63probe position/s]Normalizing amplitudes:  54%|█████▍    | 8825/16384 [00:01<00:01, 6623.72probe position/s]Normalizing amplitudes:  58%|█████▊    | 9492/16384 [00:01<00:01, 6635.13probe position/s]Normalizing amplitudes:  62%|██████▏   | 10156/16384 [00:01<00:00, 6621.05probe position/s]Normalizing amplitudes:  66%|██████▌   | 10819/16384 [00:01<00:00, 6601.31probe position/s]Normalizing amplitudes:  70%|███████   | 11499/16384 [00:01<00:00, 6659.08probe position/s]Normalizing amplitudes:  74%|███████▍  | 12180/16384 [00:01<00:00, 6703.75probe position/s]Normalizing amplitudes:  79%|███████▊  | 12888/16384 [00:01<00:00, 6814.90probe position/s]Normalizing amplitudes:  83%|████████▎ | 13570/16384 [00:02<00:00, 6800.16probe position/s]Normalizing amplitudes:  87%|████████▋ | 14251/16384 [00:02<00:00, 6753.44probe position/s]Normalizing amplitudes:  91%|█████████ | 14935/16384 [00:02<00:00, 6777.38probe position/s]Normalizing amplitudes:  95%|█████████▌| 15613/16384 [00:02<00:00, 6694.38probe position/s]Normalizing amplitudes:  99%|█████████▉| 16283/16384 [00:02<00:00, 6688.46probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6704.95probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random16_p1_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random16_p1_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.006923 in 15.211 sec
Iter: 2, Total Loss: 0.006523 in 15.208 sec
Iter: 3, Total Loss: 0.006412 in 15.091 sec
Iter: 4, Total Loss: 0.006324 in 15.063 sec
Iter: 5, Total Loss: 0.006261 in 15.119 sec
Iter: 6, Total Loss: 0.006218 in 14.992 sec
Iter: 7, Total Loss: 0.006185 in 15.455 sec
Iter: 8, Total Loss: 0.006164 in 15.863 sec
Iter: 9, Total Loss: 0.006146 in 15.036 sec
Iter: 10, Total Loss: 0.006134 in 15.717 sec
Iter: 11, Total Loss: 0.00612 in 15.770 sec
Iter: 12, Total Loss: 0.006112 in 15.630 sec
Iter: 13, Total Loss: 0.006104 in 15.796 sec
Iter: 14, Total Loss: 0.006095 in 15.707 sec
Iter: 15, Total Loss: 0.006088 in 15.743 sec
Iter: 16, Total Loss: 0.006082 in 15.560 sec
Iter: 17, Total Loss: 0.006075 in 15.519 sec
Iter: 18, Total Loss: 0.006069 in 15.347 sec
Iter: 19, Total Loss: 0.006064 in 15.494 sec
Iter: 20, Total Loss: 0.006056 in 15.678 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 15.450 with std = 0.284 sec ###
### py4DSTEM ptycho solver is finished in 5 min 12.186 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 926.22 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 16, 1, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 665/16384 [00:00<00:02, 6641.65probe position/s]Normalizing amplitudes:   8%|▊         | 1343/16384 [00:00<00:02, 6722.25probe position/s]Normalizing amplitudes:  12%|█▏        | 2023/16384 [00:00<00:02, 6757.38probe position/s]Normalizing amplitudes:  16%|█▋        | 2699/16384 [00:00<00:02, 6601.03probe position/s]Normalizing amplitudes:  21%|██        | 3360/16384 [00:00<00:01, 6549.46probe position/s]Normalizing amplitudes:  25%|██▍       | 4016/16384 [00:00<00:01, 6513.45probe position/s]Normalizing amplitudes:  29%|██▊       | 4681/16384 [00:00<00:01, 6555.47probe position/s]Normalizing amplitudes:  33%|███▎      | 5399/16384 [00:00<00:01, 6749.68probe position/s]Normalizing amplitudes:  37%|███▋      | 6075/16384 [00:00<00:01, 6664.73probe position/s]Normalizing amplitudes:  41%|████      | 6742/16384 [00:01<00:01, 6583.30probe position/s]Normalizing amplitudes:  45%|████▌     | 7401/16384 [00:01<00:01, 6419.87probe position/s]Normalizing amplitudes:  49%|████▉     | 8061/16384 [00:01<00:01, 6472.61probe position/s]Normalizing amplitudes:  53%|█████▎    | 8726/16384 [00:01<00:01, 6523.71probe position/s]Normalizing amplitudes:  57%|█████▋    | 9386/16384 [00:01<00:01, 6545.81probe position/s]Normalizing amplitudes:  61%|██████▏   | 10044/16384 [00:01<00:00, 6555.04probe position/s]Normalizing amplitudes:  65%|██████▌   | 10700/16384 [00:01<00:00, 6533.67probe position/s]Normalizing amplitudes:  69%|██████▉   | 11354/16384 [00:01<00:00, 6529.87probe position/s]Normalizing amplitudes:  73%|███████▎  | 12012/16384 [00:01<00:00, 6542.88probe position/s]Normalizing amplitudes:  77%|███████▋  | 12667/16384 [00:01<00:00, 6513.54probe position/s]Normalizing amplitudes:  81%|████████▏ | 13337/16384 [00:02<00:00, 6566.86probe position/s]Normalizing amplitudes:  85%|████████▌ | 13994/16384 [00:02<00:00, 6555.53probe position/s]Normalizing amplitudes:  90%|████████▉ | 14694/16384 [00:02<00:00, 6688.02probe position/s]Normalizing amplitudes:  94%|█████████▍| 15397/16384 [00:02<00:00, 6789.69probe position/s]Normalizing amplitudes:  98%|█████████▊| 16077/16384 [00:02<00:00, 6727.17probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6602.03probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random16_p1_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random16_p1_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.006995 in 29.293 sec
Iter: 2, Total Loss: 0.006554 in 29.125 sec
Iter: 3, Total Loss: 0.00644 in 29.244 sec
Iter: 4, Total Loss: 0.006361 in 29.168 sec
Iter: 5, Total Loss: 0.006301 in 28.978 sec
Iter: 6, Total Loss: 0.00626 in 29.789 sec
Iter: 7, Total Loss: 0.00623 in 29.203 sec
Iter: 8, Total Loss: 0.006205 in 29.487 sec
Iter: 9, Total Loss: 0.006181 in 29.713 sec
Iter: 10, Total Loss: 0.006157 in 29.712 sec
Iter: 11, Total Loss: 0.006134 in 29.713 sec
Iter: 12, Total Loss: 0.006111 in 29.496 sec
Iter: 13, Total Loss: 0.006087 in 29.090 sec
Iter: 14, Total Loss: 0.006065 in 28.985 sec
Iter: 15, Total Loss: 0.006045 in 29.368 sec
Iter: 16, Total Loss: 0.006022 in 29.246 sec
Iter: 17, Total Loss: 0.006009 in 29.461 sec
Iter: 18, Total Loss: 0.005992 in 29.616 sec
Iter: 19, Total Loss: 0.005978 in 29.611 sec
Iter: 20, Total Loss: 0.005965 in 29.604 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 29.395 with std = 0.252 sec ###
### py4DSTEM ptycho solver is finished in 9 min 52.875 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 916.30 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 16, 3, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 676/16384 [00:00<00:02, 6755.13probe position/s]Normalizing amplitudes:   8%|▊         | 1352/16384 [00:00<00:02, 6700.24probe position/s]Normalizing amplitudes:  12%|█▏        | 2023/16384 [00:00<00:02, 6511.33probe position/s]Normalizing amplitudes:  16%|█▋        | 2675/16384 [00:00<00:02, 6465.30probe position/s]Normalizing amplitudes:  20%|██        | 3322/16384 [00:00<00:02, 6356.44probe position/s]Normalizing amplitudes:  24%|██▍       | 3986/16384 [00:00<00:01, 6450.35probe position/s]Normalizing amplitudes:  28%|██▊       | 4652/16384 [00:00<00:01, 6517.25probe position/s]Normalizing amplitudes:  32%|███▏      | 5305/16384 [00:00<00:01, 6446.05probe position/s]Normalizing amplitudes:  36%|███▋      | 5950/16384 [00:00<00:01, 6371.25probe position/s]Normalizing amplitudes:  40%|████      | 6588/16384 [00:01<00:01, 6369.87probe position/s]Normalizing amplitudes:  44%|████▍     | 7236/16384 [00:01<00:01, 6402.43probe position/s]Normalizing amplitudes:  48%|████▊     | 7877/16384 [00:01<00:01, 6390.06probe position/s]Normalizing amplitudes:  52%|█████▏    | 8538/16384 [00:01<00:01, 6454.87probe position/s]Normalizing amplitudes:  56%|█████▌    | 9187/16384 [00:01<00:01, 6463.55probe position/s]Normalizing amplitudes:  60%|██████    | 9834/16384 [00:01<00:01, 6446.23probe position/s]Normalizing amplitudes:  64%|██████▍   | 10479/16384 [00:01<00:00, 6386.62probe position/s]Normalizing amplitudes:  68%|██████▊   | 11118/16384 [00:01<00:00, 6357.22probe position/s]Normalizing amplitudes:  72%|███████▏  | 11770/16384 [00:01<00:00, 6403.40probe position/s]Normalizing amplitudes:  76%|███████▌  | 12425/16384 [00:01<00:00, 6445.12probe position/s]Normalizing amplitudes:  80%|███████▉  | 13070/16384 [00:02<00:00, 6417.46probe position/s]Normalizing amplitudes:  84%|████████▎ | 13712/16384 [00:02<00:00, 6332.59probe position/s]Normalizing amplitudes:  88%|████████▊ | 14346/16384 [00:02<00:00, 6328.58probe position/s]Normalizing amplitudes:  91%|█████████▏| 14980/16384 [00:02<00:00, 6316.58probe position/s]Normalizing amplitudes:  95%|█████████▌| 15633/16384 [00:02<00:00, 6378.20probe position/s]Normalizing amplitudes:  99%|█████████▉| 16289/16384 [00:02<00:00, 6430.71probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6420.41probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random16_p3_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random16_p3_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.007613 in 14.072 sec
Iter: 2, Total Loss: 0.006395 in 14.093 sec
Iter: 3, Total Loss: 0.006158 in 13.904 sec
Iter: 4, Total Loss: 0.00594 in 13.951 sec
Iter: 5, Total Loss: 0.005788 in 13.927 sec
Iter: 6, Total Loss: 0.005682 in 14.018 sec
Iter: 7, Total Loss: 0.005595 in 14.404 sec
Iter: 8, Total Loss: 0.005516 in 14.394 sec
Iter: 9, Total Loss: 0.005445 in 14.085 sec
Iter: 10, Total Loss: 0.005388 in 14.068 sec
Iter: 11, Total Loss: 0.005347 in 14.131 sec
Iter: 12, Total Loss: 0.005318 in 14.006 sec
Iter: 13, Total Loss: 0.005295 in 13.795 sec
Iter: 14, Total Loss: 0.005278 in 13.556 sec
Iter: 15, Total Loss: 0.005264 in 13.622 sec
Iter: 16, Total Loss: 0.005253 in 13.659 sec
Iter: 17, Total Loss: 0.005244 in 13.705 sec
Iter: 18, Total Loss: 0.005236 in 13.656 sec
Iter: 19, Total Loss: 0.005229 in 13.702 sec
Iter: 20, Total Loss: 0.005223 in 13.897 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 13.932 with std = 0.233 sec ###
### py4DSTEM ptycho solver is finished in 4 min 41.684 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 918.54 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 16, 3, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 666/16384 [00:00<00:02, 6658.39probe position/s]Normalizing amplitudes:   8%|▊         | 1332/16384 [00:00<00:02, 6357.12probe position/s]Normalizing amplitudes:  12%|█▏        | 1969/16384 [00:00<00:02, 6042.59probe position/s]Normalizing amplitudes:  16%|█▌        | 2575/16384 [00:00<00:02, 6039.48probe position/s]Normalizing amplitudes:  19%|█▉        | 3191/16384 [00:00<00:02, 6081.51probe position/s]Normalizing amplitudes:  23%|██▎       | 3800/16384 [00:00<00:02, 5766.35probe position/s]Normalizing amplitudes:  27%|██▋       | 4380/16384 [00:00<00:02, 5564.90probe position/s]Normalizing amplitudes:  30%|███       | 4968/16384 [00:00<00:02, 5658.65probe position/s]Normalizing amplitudes:  34%|███▍      | 5599/16384 [00:00<00:01, 5851.41probe position/s]Normalizing amplitudes:  38%|███▊      | 6187/16384 [00:01<00:01, 5499.01probe position/s]Normalizing amplitudes:  41%|████▏     | 6759/16384 [00:01<00:01, 5561.79probe position/s]Normalizing amplitudes:  45%|████▍     | 7329/16384 [00:01<00:01, 5601.24probe position/s]Normalizing amplitudes:  48%|████▊     | 7893/16384 [00:01<00:01, 5526.99probe position/s]Normalizing amplitudes:  52%|█████▏    | 8448/16384 [00:01<00:01, 5153.40probe position/s]Normalizing amplitudes:  55%|█████▌    | 9033/16384 [00:01<00:01, 5347.51probe position/s]Normalizing amplitudes:  59%|█████▉    | 9659/16384 [00:01<00:01, 5606.82probe position/s]Normalizing amplitudes:  63%|██████▎   | 10259/16384 [00:01<00:01, 5718.67probe position/s]Normalizing amplitudes:  66%|██████▌   | 10835/16384 [00:01<00:00, 5658.82probe position/s]Normalizing amplitudes:  70%|███████   | 11487/16384 [00:02<00:00, 5909.64probe position/s]Normalizing amplitudes:  74%|███████▍  | 12135/16384 [00:02<00:00, 6074.34probe position/s]Normalizing amplitudes:  78%|███████▊  | 12745/16384 [00:02<00:00, 6031.92probe position/s]Normalizing amplitudes:  81%|████████▏ | 13350/16384 [00:02<00:00, 6031.85probe position/s]Normalizing amplitudes:  85%|████████▌ | 13992/16384 [00:02<00:00, 6146.82probe position/s]Normalizing amplitudes:  90%|████████▉ | 14676/16384 [00:02<00:00, 6351.72probe position/s]Normalizing amplitudes:  93%|█████████▎| 15312/16384 [00:02<00:00, 6319.09probe position/s]Normalizing amplitudes:  97%|█████████▋| 15945/16384 [00:02<00:00, 6307.41probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 5871.25probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random16_p3_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random16_p3_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.007626 in 38.399 sec
Iter: 2, Total Loss: 0.006172 in 37.733 sec
Iter: 3, Total Loss: 0.005881 in 37.532 sec
Iter: 4, Total Loss: 0.005677 in 37.620 sec
Iter: 5, Total Loss: 0.005543 in 37.912 sec
Iter: 6, Total Loss: 0.005446 in 37.481 sec
Iter: 7, Total Loss: 0.005368 in 37.523 sec
Iter: 8, Total Loss: 0.005305 in 37.451 sec
Iter: 9, Total Loss: 0.005255 in 37.689 sec
Iter: 10, Total Loss: 0.005215 in 37.686 sec
Iter: 11, Total Loss: 0.005183 in 37.772 sec
Iter: 12, Total Loss: 0.005155 in 37.330 sec
Iter: 13, Total Loss: 0.00513 in 37.773 sec
Iter: 14, Total Loss: 0.005109 in 37.774 sec
Iter: 15, Total Loss: 0.005088 in 37.242 sec
Iter: 16, Total Loss: 0.00507 in 35.997 sec
Iter: 17, Total Loss: 0.005054 in 37.047 sec
Iter: 18, Total Loss: 0.00504 in 38.454 sec
Iter: 19, Total Loss: 0.005027 in 38.401 sec
Iter: 20, Total Loss: 0.005015 in 38.152 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 37.648 with std = 0.530 sec ###
### py4DSTEM ptycho solver is finished in 12 min 36.459 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 940.36 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 16, 3, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 648/16384 [00:00<00:02, 6478.52probe position/s]Normalizing amplitudes:   8%|▊         | 1296/16384 [00:00<00:02, 6036.05probe position/s]Normalizing amplitudes:  12%|█▏        | 1902/16384 [00:00<00:02, 5975.62probe position/s]Normalizing amplitudes:  15%|█▌        | 2505/16384 [00:00<00:02, 5992.94probe position/s]Normalizing amplitudes:  19%|█▉        | 3105/16384 [00:00<00:02, 5916.01probe position/s]Normalizing amplitudes:  23%|██▎       | 3737/16384 [00:00<00:02, 6049.91probe position/s]Normalizing amplitudes:  27%|██▋       | 4399/16384 [00:00<00:01, 6231.23probe position/s]Normalizing amplitudes:  31%|███       | 5023/16384 [00:00<00:01, 6190.14probe position/s]Normalizing amplitudes:  35%|███▍      | 5679/16384 [00:00<00:01, 6303.70probe position/s]Normalizing amplitudes:  39%|███▊      | 6310/16384 [00:01<00:01, 6129.90probe position/s]Normalizing amplitudes:  42%|████▏     | 6927/16384 [00:01<00:01, 6139.57probe position/s]Normalizing amplitudes:  46%|████▌     | 7554/16384 [00:01<00:01, 6177.07probe position/s]Normalizing amplitudes:  51%|█████     | 8322/16384 [00:01<00:01, 6624.73probe position/s]Normalizing amplitudes:  55%|█████▍    | 8986/16384 [00:01<00:01, 6586.49probe position/s]Normalizing amplitudes:  59%|█████▉    | 9646/16384 [00:01<00:01, 6404.05probe position/s]Normalizing amplitudes:  63%|██████▎   | 10288/16384 [00:01<00:00, 6205.18probe position/s]Normalizing amplitudes:  67%|██████▋   | 10911/16384 [00:01<00:00, 5987.67probe position/s]Normalizing amplitudes:  71%|███████   | 11620/16384 [00:01<00:00, 6299.92probe position/s]Normalizing amplitudes:  76%|███████▌  | 12383/16384 [00:01<00:00, 6681.29probe position/s]Normalizing amplitudes:  80%|███████▉  | 13055/16384 [00:02<00:00, 6510.29probe position/s]Normalizing amplitudes:  84%|████████▎ | 13710/16384 [00:02<00:00, 6452.40probe position/s]Normalizing amplitudes:  88%|████████▊ | 14358/16384 [00:02<00:00, 6320.16probe position/s]Normalizing amplitudes:  92%|█████████▏| 14992/16384 [00:02<00:00, 6271.87probe position/s]Normalizing amplitudes:  95%|█████████▌| 15633/16384 [00:02<00:00, 6311.35probe position/s]Normalizing amplitudes: 100%|█████████▉| 16337/16384 [00:02<00:00, 6523.02probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6304.39probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random16_p3_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random16_p3_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.007841 in 71.274 sec
Iter: 2, Total Loss: 0.006038 in 72.688 sec
Iter: 3, Total Loss: 0.005733 in 72.892 sec
Iter: 4, Total Loss: 0.005564 in 72.933 sec
Iter: 5, Total Loss: 0.005456 in 72.993 sec
Iter: 6, Total Loss: 0.005368 in 73.763 sec
Iter: 7, Total Loss: 0.005287 in 73.497 sec
Iter: 8, Total Loss: 0.005218 in 72.784 sec
Iter: 9, Total Loss: 0.005166 in 71.940 sec
Iter: 10, Total Loss: 0.005127 in 71.286 sec
Iter: 11, Total Loss: 0.005095 in 72.724 sec
Iter: 12, Total Loss: 0.005068 in 72.897 sec
Iter: 13, Total Loss: 0.005046 in 73.164 sec
Iter: 14, Total Loss: 0.005027 in 72.983 sec
Iter: 15, Total Loss: 0.005008 in 72.355 sec
Iter: 16, Total Loss: 0.004992 in 72.372 sec
Iter: 17, Total Loss: 0.004979 in 73.208 sec
Iter: 18, Total Loss: 0.004966 in 72.061 sec
Iter: 19, Total Loss: 0.004954 in 71.446 sec
Iter: 20, Total Loss: 0.004945 in 72.853 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 72.606 with std = 0.678 sec ###
### py4DSTEM ptycho solver is finished in 24 min 15.434 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 916.40 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 16, 6, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 648/16384 [00:00<00:02, 6471.29probe position/s]Normalizing amplitudes:   8%|▊         | 1296/16384 [00:00<00:02, 5988.60probe position/s]Normalizing amplitudes:  12%|█▏        | 1898/16384 [00:00<00:02, 5982.17probe position/s]Normalizing amplitudes:  15%|█▌        | 2498/16384 [00:00<00:02, 5962.60probe position/s]Normalizing amplitudes:  19%|█▉        | 3132/16384 [00:00<00:02, 6093.22probe position/s]Normalizing amplitudes:  23%|██▎       | 3790/16384 [00:00<00:02, 6253.32probe position/s]Normalizing amplitudes:  27%|██▋       | 4444/16384 [00:00<00:01, 6343.45probe position/s]Normalizing amplitudes:  31%|███▏      | 5121/16384 [00:00<00:01, 6475.56probe position/s]Normalizing amplitudes:  35%|███▌      | 5770/16384 [00:00<00:01, 6386.13probe position/s]Normalizing amplitudes:  39%|███▉      | 6427/16384 [00:01<00:01, 6441.19probe position/s]Normalizing amplitudes:  43%|████▎     | 7079/16384 [00:01<00:01, 6463.07probe position/s]Normalizing amplitudes:  47%|████▋     | 7745/16384 [00:01<00:01, 6520.50probe position/s]Normalizing amplitudes:  51%|█████▏    | 8398/16384 [00:01<00:01, 6488.56probe position/s]Normalizing amplitudes:  55%|█████▌    | 9048/16384 [00:01<00:01, 6413.80probe position/s]Normalizing amplitudes:  59%|█████▉    | 9690/16384 [00:01<00:01, 6359.86probe position/s]Normalizing amplitudes:  63%|██████▎   | 10327/16384 [00:01<00:00, 6155.59probe position/s]Normalizing amplitudes:  67%|██████▋   | 10986/16384 [00:01<00:00, 6280.75probe position/s]Normalizing amplitudes:  71%|███████   | 11649/16384 [00:01<00:00, 6382.47probe position/s]Normalizing amplitudes:  75%|███████▌  | 12309/16384 [00:01<00:00, 6445.45probe position/s]Normalizing amplitudes:  79%|███████▉  | 12955/16384 [00:02<00:00, 6444.13probe position/s]Normalizing amplitudes:  83%|████████▎ | 13601/16384 [00:02<00:00, 6340.63probe position/s]Normalizing amplitudes:  87%|████████▋ | 14236/16384 [00:02<00:00, 6333.65probe position/s]Normalizing amplitudes:  91%|█████████ | 14870/16384 [00:02<00:00, 6270.20probe position/s]Normalizing amplitudes:  95%|█████████▍| 15511/16384 [00:02<00:00, 6309.92probe position/s]Normalizing amplitudes:  99%|█████████▊| 16167/16384 [00:02<00:00, 6382.99probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6338.88probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random16_p6_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random16_p6_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.009838 in 24.774 sec
Iter: 2, Total Loss: 0.00639 in 24.852 sec
Iter: 3, Total Loss: 0.006154 in 25.019 sec
Iter: 4, Total Loss: 0.005932 in 24.911 sec
Iter: 5, Total Loss: 0.005763 in 24.805 sec
Iter: 6, Total Loss: 0.005624 in 24.763 sec
Iter: 7, Total Loss: 0.005496 in 24.977 sec
Iter: 8, Total Loss: 0.005366 in 25.270 sec
Iter: 9, Total Loss: 0.005246 in 25.133 sec
Iter: 10, Total Loss: 0.005157 in 24.873 sec
Iter: 11, Total Loss: 0.005094 in 24.880 sec
Iter: 12, Total Loss: 0.005048 in 24.955 sec
Iter: 13, Total Loss: 0.005013 in 24.965 sec
Iter: 14, Total Loss: 0.004983 in 24.732 sec
Iter: 15, Total Loss: 0.004958 in 24.721 sec
Iter: 16, Total Loss: 0.004937 in 24.192 sec
Iter: 17, Total Loss: 0.004918 in 24.015 sec
Iter: 18, Total Loss: 0.004902 in 24.081 sec
Iter: 19, Total Loss: 0.004888 in 23.851 sec
Iter: 20, Total Loss: 0.004875 in 23.947 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 24.686 with std = 0.411 sec ###
### py4DSTEM ptycho solver is finished in 8 min 16.633 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 936.57 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 16, 6, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 680/16384 [00:00<00:02, 6798.55probe position/s]Normalizing amplitudes:   8%|▊         | 1360/16384 [00:00<00:02, 6650.35probe position/s]Normalizing amplitudes:  12%|█▏        | 2042/16384 [00:00<00:02, 6724.48probe position/s]Normalizing amplitudes:  17%|█▋        | 2767/16384 [00:00<00:01, 6928.99probe position/s]Normalizing amplitudes:  21%|██        | 3461/16384 [00:00<00:01, 6888.36probe position/s]Normalizing amplitudes:  25%|██▌       | 4151/16384 [00:00<00:01, 6856.88probe position/s]Normalizing amplitudes:  30%|██▉       | 4851/16384 [00:00<00:01, 6901.98probe position/s]Normalizing amplitudes:  34%|███▍      | 5573/16384 [00:00<00:01, 7000.74probe position/s]Normalizing amplitudes:  38%|███▊      | 6281/16384 [00:00<00:01, 7023.53probe position/s]Normalizing amplitudes:  43%|████▎     | 6984/16384 [00:01<00:01, 6972.13probe position/s]Normalizing amplitudes:  47%|████▋     | 7705/16384 [00:01<00:01, 7041.92probe position/s]Normalizing amplitudes:  51%|█████▏    | 8424/16384 [00:01<00:01, 7086.46probe position/s]Normalizing amplitudes:  56%|█████▌    | 9133/16384 [00:01<00:01, 7038.33probe position/s]Normalizing amplitudes:  60%|██████    | 9837/16384 [00:01<00:00, 6994.58probe position/s]Normalizing amplitudes:  64%|██████▍   | 10551/16384 [00:01<00:00, 7035.88probe position/s]Normalizing amplitudes:  69%|██████▊   | 11259/16384 [00:01<00:00, 7047.95probe position/s]Normalizing amplitudes:  73%|███████▎  | 11964/16384 [00:01<00:00, 6987.18probe position/s]Normalizing amplitudes:  77%|███████▋  | 12666/16384 [00:01<00:00, 6996.44probe position/s]Normalizing amplitudes:  82%|████████▏ | 13366/16384 [00:01<00:00, 6944.22probe position/s]Normalizing amplitudes:  86%|████████▌ | 14061/16384 [00:02<00:00, 6780.83probe position/s]Normalizing amplitudes:  90%|█████████ | 14776/16384 [00:02<00:00, 6888.04probe position/s]Normalizing amplitudes:  95%|█████████▍| 15550/16384 [00:02<00:00, 7136.30probe position/s]Normalizing amplitudes:  99%|█████████▉| 16265/16384 [00:02<00:00, 6994.46probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6961.43probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random16_p6_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random16_p6_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.009841 in 71.643 sec
Iter: 2, Total Loss: 0.00611 in 72.986 sec
Iter: 3, Total Loss: 0.005768 in 74.358 sec
Iter: 4, Total Loss: 0.005539 in 71.198 sec
Iter: 5, Total Loss: 0.005366 in 70.288 sec
Iter: 6, Total Loss: 0.005204 in 70.450 sec
Iter: 7, Total Loss: 0.005068 in 70.526 sec
Iter: 8, Total Loss: 0.004981 in 70.239 sec
Iter: 9, Total Loss: 0.004925 in 70.726 sec
Iter: 10, Total Loss: 0.004885 in 71.230 sec
Iter: 11, Total Loss: 0.004852 in 70.942 sec
Iter: 12, Total Loss: 0.004826 in 71.225 sec
Iter: 13, Total Loss: 0.004803 in 70.900 sec
Iter: 14, Total Loss: 0.004782 in 70.728 sec
Iter: 15, Total Loss: 0.004764 in 70.395 sec
Iter: 16, Total Loss: 0.004748 in 70.585 sec
Iter: 17, Total Loss: 0.004732 in 70.513 sec
Iter: 18, Total Loss: 0.004718 in 69.812 sec
Iter: 19, Total Loss: 0.004705 in 70.260 sec
Iter: 20, Total Loss: 0.004693 in 70.586 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 70.979 with std = 1.011 sec ###
### py4DSTEM ptycho solver is finished in 23 min 42.595 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 919.85 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 16, 6, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 654/16384 [00:00<00:02, 6539.35probe position/s]Normalizing amplitudes:   8%|▊         | 1308/16384 [00:00<00:02, 6484.84probe position/s]Normalizing amplitudes:  12%|█▏        | 1978/16384 [00:00<00:02, 6580.69probe position/s]Normalizing amplitudes:  16%|█▌        | 2637/16384 [00:00<00:02, 6566.08probe position/s]Normalizing amplitudes:  20%|██        | 3294/16384 [00:00<00:02, 6530.55probe position/s]Normalizing amplitudes:  24%|██▍       | 3963/16384 [00:00<00:01, 6581.95probe position/s]Normalizing amplitudes:  28%|██▊       | 4630/16384 [00:00<00:01, 6608.11probe position/s]Normalizing amplitudes:  32%|███▏      | 5305/16384 [00:00<00:01, 6648.86probe position/s]Normalizing amplitudes:  36%|███▋      | 5970/16384 [00:00<00:01, 6609.40probe position/s]Normalizing amplitudes:  40%|████      | 6632/16384 [00:01<00:01, 6594.57probe position/s]Normalizing amplitudes:  45%|████▍     | 7292/16384 [00:01<00:01, 6587.73probe position/s]Normalizing amplitudes:  49%|████▊     | 7951/16384 [00:01<00:01, 6558.61probe position/s]Normalizing amplitudes:  53%|█████▎    | 8615/16384 [00:01<00:01, 6580.93probe position/s]Normalizing amplitudes:  57%|█████▋    | 9283/16384 [00:01<00:01, 6609.57probe position/s]Normalizing amplitudes:  61%|██████    | 9944/16384 [00:01<00:00, 6601.34probe position/s]Normalizing amplitudes:  65%|██████▍   | 10605/16384 [00:01<00:00, 6448.74probe position/s]Normalizing amplitudes:  69%|██████▊   | 11251/16384 [00:01<00:00, 6449.02probe position/s]Normalizing amplitudes:  73%|███████▎  | 11903/16384 [00:01<00:00, 6468.73probe position/s]Normalizing amplitudes:  77%|███████▋  | 12551/16384 [00:01<00:00, 6451.53probe position/s]Normalizing amplitudes:  81%|████████  | 13222/16384 [00:02<00:00, 6528.31probe position/s]Normalizing amplitudes:  85%|████████▍ | 13876/16384 [00:02<00:00, 6465.91probe position/s]Normalizing amplitudes:  89%|████████▊ | 14523/16384 [00:02<00:00, 6465.62probe position/s]Normalizing amplitudes:  93%|█████████▎| 15170/16384 [00:02<00:00, 6118.06probe position/s]Normalizing amplitudes:  96%|█████████▋| 15786/16384 [00:02<00:00, 6031.38probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6431.97probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random16_p6_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random16_p6_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.01012 in 141.081 sec
Iter: 2, Total Loss: 0.005859 in 140.071 sec
Iter: 3, Total Loss: 0.0055 in 140.706 sec
Iter: 4, Total Loss: 0.005275 in 137.342 sec
Iter: 5, Total Loss: 0.005092 in 136.542 sec
Iter: 6, Total Loss: 0.004971 in 138.812 sec
Iter: 7, Total Loss: 0.004896 in 140.113 sec
Iter: 8, Total Loss: 0.004845 in 140.582 sec
Iter: 9, Total Loss: 0.004807 in 140.522 sec
Iter: 10, Total Loss: 0.004778 in 140.838 sec
Iter: 11, Total Loss: 0.004753 in 138.370 sec
Iter: 12, Total Loss: 0.004734 in 137.608 sec
Iter: 13, Total Loss: 0.004716 in 137.906 sec
Iter: 14, Total Loss: 0.004701 in 139.196 sec
Iter: 15, Total Loss: 0.004687 in 138.423 sec
Iter: 16, Total Loss: 0.004675 in 137.624 sec
Iter: 17, Total Loss: 0.004664 in 135.611 sec
Iter: 18, Total Loss: 0.004654 in 133.563 sec
Iter: 19, Total Loss: 0.004644 in 132.216 sec
Iter: 20, Total Loss: 0.004635 in 132.729 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 137.993 with std = 2.632 sec ###
### py4DSTEM ptycho solver is finished in 46 min 3.039 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 933.99 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 16, 12, 1)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstatePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 674/16384 [00:00<00:02, 6731.42probe position/s]Normalizing amplitudes:   8%|▊         | 1348/16384 [00:00<00:02, 6545.30probe position/s]Normalizing amplitudes:  12%|█▏        | 2021/16384 [00:00<00:02, 6625.41probe position/s]Normalizing amplitudes:  16%|█▋        | 2688/16384 [00:00<00:02, 6638.65probe position/s]Normalizing amplitudes:  21%|██        | 3360/16384 [00:00<00:01, 6666.46probe position/s]Normalizing amplitudes:  25%|██▍       | 4027/16384 [00:00<00:01, 6650.18probe position/s]Normalizing amplitudes:  29%|██▊       | 4693/16384 [00:00<00:01, 6623.16probe position/s]Normalizing amplitudes:  33%|███▎      | 5366/16384 [00:00<00:01, 6654.39probe position/s]Normalizing amplitudes:  37%|███▋      | 6041/16384 [00:00<00:01, 6681.77probe position/s]Normalizing amplitudes:  41%|████      | 6710/16384 [00:01<00:01, 6641.90probe position/s]Normalizing amplitudes:  45%|████▌     | 7379/16384 [00:01<00:01, 6653.41probe position/s]Normalizing amplitudes:  49%|████▉     | 8083/16384 [00:01<00:01, 6769.05probe position/s]Normalizing amplitudes:  53%|█████▎    | 8761/16384 [00:01<00:01, 6740.48probe position/s]Normalizing amplitudes:  58%|█████▊    | 9444/16384 [00:01<00:01, 6766.51probe position/s]Normalizing amplitudes:  62%|██████▏   | 10121/16384 [00:01<00:00, 6752.75probe position/s]Normalizing amplitudes:  66%|██████▌   | 10797/16384 [00:01<00:00, 6663.52probe position/s]Normalizing amplitudes:  70%|██████▉   | 11464/16384 [00:01<00:00, 6531.93probe position/s]Normalizing amplitudes:  74%|███████▍  | 12131/16384 [00:01<00:00, 6572.03probe position/s]Normalizing amplitudes:  78%|███████▊  | 12789/16384 [00:01<00:00, 6542.90probe position/s]Normalizing amplitudes:  82%|████████▏ | 13453/16384 [00:02<00:00, 6570.64probe position/s]Normalizing amplitudes:  86%|████████▌ | 14127/16384 [00:02<00:00, 6620.37probe position/s]Normalizing amplitudes:  90%|█████████ | 14814/16384 [00:02<00:00, 6691.20probe position/s]Normalizing amplitudes:  95%|█████████▍| 15509/16384 [00:02<00:00, 6767.86probe position/s]Normalizing amplitudes:  99%|█████████▉| 16186/16384 [00:02<00:00, 6727.36probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6656.58probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random16_p12_1slice_update0.5' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random16_p12_1slice_update0.5'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.01524 in 46.136 sec
Iter: 2, Total Loss: 0.00636 in 47.657 sec
Iter: 3, Total Loss: 0.006079 in 48.496 sec
Iter: 4, Total Loss: 0.005824 in 47.265 sec
Iter: 5, Total Loss: 0.005631 in 46.491 sec
Iter: 6, Total Loss: 0.005477 in 47.568 sec
Iter: 7, Total Loss: 0.005329 in 47.182 sec
Iter: 8, Total Loss: 0.005194 in 47.620 sec
Iter: 9, Total Loss: 0.00509 in 48.354 sec
Iter: 10, Total Loss: 0.005015 in 47.846 sec
Iter: 11, Total Loss: 0.004957 in 47.710 sec
Iter: 12, Total Loss: 0.004911 in 47.015 sec
Iter: 13, Total Loss: 0.004872 in 47.048 sec
Iter: 14, Total Loss: 0.004838 in 47.096 sec
Iter: 15, Total Loss: 0.004806 in 46.946 sec
Iter: 16, Total Loss: 0.004777 in 47.198 sec
Iter: 17, Total Loss: 0.00475 in 47.602 sec
Iter: 18, Total Loss: 0.004725 in 47.705 sec
Iter: 19, Total Loss: 0.004702 in 46.867 sec
Iter: 20, Total Loss: 0.00468 in 47.425 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 47.361 with std = 0.549 sec ###
### py4DSTEM ptycho solver is finished in 15 min 50.452 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 917.05 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 16, 12, 3)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 659/16384 [00:00<00:02, 6584.90probe position/s]Normalizing amplitudes:   8%|▊         | 1318/16384 [00:00<00:02, 6378.19probe position/s]Normalizing amplitudes:  12%|█▏        | 1957/16384 [00:00<00:02, 6310.23probe position/s]Normalizing amplitudes:  16%|█▌        | 2595/16384 [00:00<00:02, 6335.89probe position/s]Normalizing amplitudes:  20%|█▉        | 3249/16384 [00:00<00:02, 6407.11probe position/s]Normalizing amplitudes:  24%|██▍       | 3893/16384 [00:00<00:01, 6417.68probe position/s]Normalizing amplitudes:  28%|██▊       | 4535/16384 [00:00<00:01, 6396.38probe position/s]Normalizing amplitudes:  32%|███▏      | 5175/16384 [00:00<00:01, 6330.16probe position/s]Normalizing amplitudes:  35%|███▌      | 5809/16384 [00:00<00:01, 6219.78probe position/s]Normalizing amplitudes:  39%|███▉      | 6451/16384 [00:01<00:01, 6277.44probe position/s]Normalizing amplitudes:  43%|████▎     | 7080/16384 [00:01<00:01, 6225.82probe position/s]Normalizing amplitudes:  47%|████▋     | 7703/16384 [00:01<00:01, 6116.30probe position/s]Normalizing amplitudes:  51%|█████     | 8324/16384 [00:01<00:01, 6142.56probe position/s]Normalizing amplitudes:  55%|█████▍    | 8971/16384 [00:01<00:01, 6239.43probe position/s]Normalizing amplitudes:  59%|█████▊    | 9616/16384 [00:01<00:01, 6300.24probe position/s]Normalizing amplitudes:  63%|██████▎   | 10273/16384 [00:01<00:00, 6379.74probe position/s]Normalizing amplitudes:  67%|██████▋   | 10912/16384 [00:01<00:00, 6336.87probe position/s]Normalizing amplitudes:  71%|███████   | 11555/16384 [00:01<00:00, 6364.30probe position/s]Normalizing amplitudes:  75%|███████▍  | 12207/16384 [00:01<00:00, 6409.70probe position/s]Normalizing amplitudes:  78%|███████▊  | 12849/16384 [00:02<00:00, 6334.16probe position/s]Normalizing amplitudes:  82%|████████▏ | 13483/16384 [00:02<00:00, 6315.86probe position/s]Normalizing amplitudes:  86%|████████▌ | 14115/16384 [00:02<00:00, 6295.26probe position/s]Normalizing amplitudes:  90%|████████▉ | 14745/16384 [00:02<00:00, 6272.06probe position/s]Normalizing amplitudes:  94%|█████████▍| 15402/16384 [00:02<00:00, 6357.50probe position/s]Normalizing amplitudes:  98%|█████████▊| 16038/16384 [00:02<00:00, 6355.27probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6319.64probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random16_p12_3slice_dz4_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random16_p12_3slice_dz4_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.01535 in 137.767 sec
Iter: 2, Total Loss: 0.006024 in 139.149 sec
Iter: 3, Total Loss: 0.005609 in 138.968 sec
Iter: 4, Total Loss: 0.005363 in 137.957 sec
Iter: 5, Total Loss: 0.005159 in 137.384 sec
Iter: 6, Total Loss: 0.004991 in 137.388 sec
Iter: 7, Total Loss: 0.004882 in 133.305 sec
Iter: 8, Total Loss: 0.00481 in 137.105 sec
Iter: 9, Total Loss: 0.004756 in 137.533 sec
Iter: 10, Total Loss: 0.004713 in 137.359 sec
Iter: 11, Total Loss: 0.004677 in 136.403 sec
Iter: 12, Total Loss: 0.004646 in 136.417 sec
Iter: 13, Total Loss: 0.004618 in 135.831 sec
Iter: 14, Total Loss: 0.004594 in 137.160 sec
Iter: 15, Total Loss: 0.004572 in 137.459 sec
Iter: 16, Total Loss: 0.004554 in 137.768 sec
Iter: 17, Total Loss: 0.004538 in 136.597 sec
Iter: 18, Total Loss: 0.004524 in 136.705 sec
Iter: 19, Total Loss: 0.004512 in 136.900 sec
Iter: 20, Total Loss: 0.004501 in 135.271 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 137.021 with std = 1.235 sec ###
### py4DSTEM ptycho solver is finished in 45 min 43.471 sec###

### System information ###
Operating System: Linux 4.18.0-372.26.1.el8_6.x86_64
OS Version: #1 SMP Tue Sep 13 18:09:48 UTC 2022
Machine: x86_64
Processor: x86_64
Available CPU cores: 4
Total Memory: 1007.45 GB
Available Memory: 939.98 GB
CUDA Runtime Version: 11.8
GPU Device: ['NVIDIA A100-SXM4-80GB MIG 2g.20gb']
Python Executable: /home/fs01/cl2696/miniforge3/envs/py4DSTEM/bin/python
Python Version: 3.11.13 | packaged by conda-forge | (main, Jun  4 2025, 14:48:23) [GCC 13.3.0]
NumPy Version: 1.26.4
Cupy Version: 13.4.1
Success! Loaded .yml file path = 01_params/py4dstem_table_tBL_WSe2.yml
Running (round_idx, batch, pmode, slice) = (5, 16, 12, 6)
Imported meausrements shape / dtype = (16384, 128, 128), float32
Imported meausrements int. statistics (min, mean, max) = (-30.8785, 1814.7064, 99441.8047)
Reshaping measurements into [128, 128, 128, 128]
Flipping measurements with [flipup, fliplr, transpose] = [1, 0, 0]
Minimum value of -30.8785 subtracted due to the positive px value constraint of measurements
Normalizing measurements so the averaged measurement has max intensity at 1
Processed meausrements int. statistics (min, mean, max) = (0.0000, 0.0275, 1.4818)
py4DSTEM datacube.shape = (128, 128, 128, 128) (N_scan_slow, N_scan_fast, ky, kx)
pos_extent = [367.5502008 367.5502008] px, object_extent = [594.66024096 594.66024096], object_padding_px = (113.0, 113.0)
Initializing MixedstateMultislicePtychography
Best fit rotation = 3 degrees.
Normalizing amplitudes:   0%|          | 0/16384 [00:00<?, ?probe position/s]Normalizing amplitudes:   4%|▍         | 668/16384 [00:00<00:02, 6677.84probe position/s]Normalizing amplitudes:   8%|▊         | 1388/16384 [00:00<00:02, 6981.62probe position/s]Normalizing amplitudes:  13%|█▎        | 2095/16384 [00:00<00:02, 7020.02probe position/s]Normalizing amplitudes:  17%|█▋        | 2797/16384 [00:00<00:01, 6983.61probe position/s]Normalizing amplitudes:  21%|██▏       | 3502/16384 [00:00<00:01, 7007.19probe position/s]Normalizing amplitudes:  26%|██▌       | 4221/16384 [00:00<00:01, 7068.02probe position/s]Normalizing amplitudes:  30%|███       | 4928/16384 [00:00<00:01, 6987.28probe position/s]Normalizing amplitudes:  34%|███▍      | 5631/16384 [00:00<00:01, 6999.38probe position/s]Normalizing amplitudes:  39%|███▊      | 6343/16384 [00:00<00:01, 7036.34probe position/s]Normalizing amplitudes:  43%|████▎     | 7050/16384 [00:01<00:01, 7045.86probe position/s]Normalizing amplitudes:  47%|████▋     | 7755/16384 [00:01<00:01, 7021.79probe position/s]Normalizing amplitudes:  52%|█████▏    | 8458/16384 [00:01<00:01, 6869.14probe position/s]Normalizing amplitudes:  56%|█████▌    | 9146/16384 [00:01<00:01, 6407.75probe position/s]Normalizing amplitudes:  60%|█████▉    | 9793/16384 [00:01<00:01, 6289.36probe position/s]Normalizing amplitudes:  64%|██████▎   | 10427/16384 [00:01<00:00, 6111.94probe position/s]Normalizing amplitudes:  67%|██████▋   | 11042/16384 [00:01<00:00, 6039.03probe position/s]Normalizing amplitudes:  72%|███████▏  | 11753/16384 [00:01<00:00, 6343.24probe position/s]Normalizing amplitudes:  76%|███████▌  | 12470/16384 [00:01<00:00, 6581.03probe position/s]Normalizing amplitudes:  80%|████████  | 13168/16384 [00:01<00:00, 6697.38probe position/s]Normalizing amplitudes:  85%|████████▍ | 13879/16384 [00:02<00:00, 6813.41probe position/s]Normalizing amplitudes:  89%|████████▉ | 14596/16384 [00:02<00:00, 6918.21probe position/s]Normalizing amplitudes:  93%|█████████▎| 15290/16384 [00:02<00:00, 6861.86probe position/s]Normalizing amplitudes:  98%|█████████▊| 15978/16384 [00:02<00:00, 6860.60probe position/s]Normalizing amplitudes: 100%|██████████| 16384/16384 [00:02<00:00, 6737.41probe position/s]
output_path = '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random16_p12_6slice_dz2_update0.5_kzf1' is generated!
reconstruction kwargs = {'num_iter': 20, 'reconstruction_method': 'gradient-descent', 'max_batch_size': 16, 'step_size': 0.5, 'reset': True, 'progress_bar': False, 'store_iterations': False, 'save_iters': 20, 'save_result': ['model', 'objp'], 'result_modes': {'obj_dim': [2, 3], 'FOV': ['crop'], 'bit': ['8']}, 'output_path': '03_output/tBL_WSe2/20250608_py4DSTEM_table_r5/N16384_dp128_flipT100_random16_p12_6slice_dz2_update0.5_kzf1'}
Performing 20 iterations using a complex object type, with the gradient-descent algorithm, with normalization_min: 1 and step _size: 0.5, in batches of max 16 measurements.
Iter: 1, Total Loss: 0.01613 in 271.289 sec
Iter: 2, Total Loss: 0.005835 in 278.913 sec
Iter: 3, Total Loss: 0.005408 in 282.285 sec
Iter: 4, Total Loss: 0.005152 in 279.831 sec
Iter: 5, Total Loss: 0.004964 in 278.093 sec
Iter: 6, Total Loss: 0.004847 in 277.549 sec
Iter: 7, Total Loss: 0.004769 in 278.877 sec
Iter: 8, Total Loss: 0.004713 in 280.306 sec
Iter: 9, Total Loss: 0.00467 in 278.095 sec
Iter: 10, Total Loss: 0.004635 in 279.470 sec
Iter: 11, Total Loss: 0.004605 in 281.354 sec
Iter: 12, Total Loss: 0.00458 in 278.523 sec
Iter: 13, Total Loss: 0.004558 in 278.451 sec
Iter: 14, Total Loss: 0.004538 in 269.839 sec
Iter: 15, Total Loss: 0.004521 in 270.410 sec
Iter: 16, Total Loss: 0.004506 in 293.616 sec
Iter: 17, Total Loss: 0.004493 in 272.307 sec
Iter: 18, Total Loss: 0.004481 in 275.863 sec
Iter: 19, Total Loss: 0.004471 in 274.610 sec
Iter: 20, Total Loss: 0.004462 in 267.331 sec
Saving results for iter 20
### Finished 20 iterations, averaged iter_t = 277.351 with std = 5.521 sec ###
### py4DSTEM ptycho solver is finished in 1 hr 32 min 30.056 sec###

Wed Jun 11 03:32:28 EDT 2025
